{"version":3,"file":"peaks.ext.js","sources":["../node_modules/eventemitter3/index.js","../src/cue.js","../src/utils.js","../src/cue-emitter.js","../src/point.js","../src/waveform-points.js","../src/segment.js","../src/waveform-segments.js","../src/keyboard-handler.js","../src/mediaelement-player.js","../src/player.js","../src/default-point-marker.js","../src/default-segment-marker.js","../src/marker-factories.js","../src/highlight-layer.js","../src/point-marker.js","../src/points-layer.js","../src/playhead-layer.js","../src/overlay-segment-marker.js","../src/segment-marker.js","../src/waveform-shape.js","../src/segment-shape.js","../src/segments-layer.js","../src/waveform-axis.js","../src/waveform-view.js","../src/mouse-drag-handler.js","../src/seek-mouse-drag-handler.js","../src/waveform-overview.js","../src/insert-segment-mouse-drag-handler.js","../src/scroll-mouse-drag-handler.js","../src/waveform-zoomview.js","../src/scrollbar.js","../src/view-controller.js","../src/zoom-controller.js","../src/waveform-builder.js","../src/main.js"],"sourcesContent":["'use strict';\n\nvar has = Object.prototype.hasOwnProperty\n  , prefix = '~';\n\n/**\n * Constructor to create a storage for our `EE` objects.\n * An `Events` instance is a plain object whose properties are event names.\n *\n * @constructor\n * @private\n */\nfunction Events() {}\n\n//\n// We try to not inherit from `Object.prototype`. In some engines creating an\n// instance in this way is faster than calling `Object.create(null)` directly.\n// If `Object.create(null)` is not supported we prefix the event names with a\n// character to make sure that the built-in object properties are not\n// overridden or used as an attack vector.\n//\nif (Object.create) {\n  Events.prototype = Object.create(null);\n\n  //\n  // This hack is needed because the `__proto__` property is still inherited in\n  // some old browsers like Android 4, iPhone 5.1, Opera 11 and Safari 5.\n  //\n  if (!new Events().__proto__) prefix = false;\n}\n\n/**\n * Representation of a single event listener.\n *\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} [once=false] Specify if the listener is a one-time listener.\n * @constructor\n * @private\n */\nfunction EE(fn, context, once) {\n  this.fn = fn;\n  this.context = context;\n  this.once = once || false;\n}\n\n/**\n * Add a listener for a given event.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} once Specify if the listener is a one-time listener.\n * @returns {EventEmitter}\n * @private\n */\nfunction addListener(emitter, event, fn, context, once) {\n  if (typeof fn !== 'function') {\n    throw new TypeError('The listener must be a function');\n  }\n\n  var listener = new EE(fn, context || emitter, once)\n    , evt = prefix ? prefix + event : event;\n\n  if (!emitter._events[evt]) emitter._events[evt] = listener, emitter._eventsCount++;\n  else if (!emitter._events[evt].fn) emitter._events[evt].push(listener);\n  else emitter._events[evt] = [emitter._events[evt], listener];\n\n  return emitter;\n}\n\n/**\n * Clear event by name.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} evt The Event name.\n * @private\n */\nfunction clearEvent(emitter, evt) {\n  if (--emitter._eventsCount === 0) emitter._events = new Events();\n  else delete emitter._events[evt];\n}\n\n/**\n * Minimal `EventEmitter` interface that is molded against the Node.js\n * `EventEmitter` interface.\n *\n * @constructor\n * @public\n */\nfunction EventEmitter() {\n  this._events = new Events();\n  this._eventsCount = 0;\n}\n\n/**\n * Return an array listing the events for which the emitter has registered\n * listeners.\n *\n * @returns {Array}\n * @public\n */\nEventEmitter.prototype.eventNames = function eventNames() {\n  var names = []\n    , events\n    , name;\n\n  if (this._eventsCount === 0) return names;\n\n  for (name in (events = this._events)) {\n    if (has.call(events, name)) names.push(prefix ? name.slice(1) : name);\n  }\n\n  if (Object.getOwnPropertySymbols) {\n    return names.concat(Object.getOwnPropertySymbols(events));\n  }\n\n  return names;\n};\n\n/**\n * Return the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Array} The registered listeners.\n * @public\n */\nEventEmitter.prototype.listeners = function listeners(event) {\n  var evt = prefix ? prefix + event : event\n    , handlers = this._events[evt];\n\n  if (!handlers) return [];\n  if (handlers.fn) return [handlers.fn];\n\n  for (var i = 0, l = handlers.length, ee = new Array(l); i < l; i++) {\n    ee[i] = handlers[i].fn;\n  }\n\n  return ee;\n};\n\n/**\n * Return the number of listeners listening to a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Number} The number of listeners.\n * @public\n */\nEventEmitter.prototype.listenerCount = function listenerCount(event) {\n  var evt = prefix ? prefix + event : event\n    , listeners = this._events[evt];\n\n  if (!listeners) return 0;\n  if (listeners.fn) return 1;\n  return listeners.length;\n};\n\n/**\n * Calls each of the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Boolean} `true` if the event had listeners, else `false`.\n * @public\n */\nEventEmitter.prototype.emit = function emit(event, a1, a2, a3, a4, a5) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return false;\n\n  var listeners = this._events[evt]\n    , len = arguments.length\n    , args\n    , i;\n\n  if (listeners.fn) {\n    if (listeners.once) this.removeListener(event, listeners.fn, undefined, true);\n\n    switch (len) {\n      case 1: return listeners.fn.call(listeners.context), true;\n      case 2: return listeners.fn.call(listeners.context, a1), true;\n      case 3: return listeners.fn.call(listeners.context, a1, a2), true;\n      case 4: return listeners.fn.call(listeners.context, a1, a2, a3), true;\n      case 5: return listeners.fn.call(listeners.context, a1, a2, a3, a4), true;\n      case 6: return listeners.fn.call(listeners.context, a1, a2, a3, a4, a5), true;\n    }\n\n    for (i = 1, args = new Array(len -1); i < len; i++) {\n      args[i - 1] = arguments[i];\n    }\n\n    listeners.fn.apply(listeners.context, args);\n  } else {\n    var length = listeners.length\n      , j;\n\n    for (i = 0; i < length; i++) {\n      if (listeners[i].once) this.removeListener(event, listeners[i].fn, undefined, true);\n\n      switch (len) {\n        case 1: listeners[i].fn.call(listeners[i].context); break;\n        case 2: listeners[i].fn.call(listeners[i].context, a1); break;\n        case 3: listeners[i].fn.call(listeners[i].context, a1, a2); break;\n        case 4: listeners[i].fn.call(listeners[i].context, a1, a2, a3); break;\n        default:\n          if (!args) for (j = 1, args = new Array(len -1); j < len; j++) {\n            args[j - 1] = arguments[j];\n          }\n\n          listeners[i].fn.apply(listeners[i].context, args);\n      }\n    }\n  }\n\n  return true;\n};\n\n/**\n * Add a listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.on = function on(event, fn, context) {\n  return addListener(this, event, fn, context, false);\n};\n\n/**\n * Add a one-time listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.once = function once(event, fn, context) {\n  return addListener(this, event, fn, context, true);\n};\n\n/**\n * Remove the listeners of a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn Only remove the listeners that match this function.\n * @param {*} context Only remove the listeners that have this context.\n * @param {Boolean} once Only remove one-time listeners.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeListener = function removeListener(event, fn, context, once) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return this;\n  if (!fn) {\n    clearEvent(this, evt);\n    return this;\n  }\n\n  var listeners = this._events[evt];\n\n  if (listeners.fn) {\n    if (\n      listeners.fn === fn &&\n      (!once || listeners.once) &&\n      (!context || listeners.context === context)\n    ) {\n      clearEvent(this, evt);\n    }\n  } else {\n    for (var i = 0, events = [], length = listeners.length; i < length; i++) {\n      if (\n        listeners[i].fn !== fn ||\n        (once && !listeners[i].once) ||\n        (context && listeners[i].context !== context)\n      ) {\n        events.push(listeners[i]);\n      }\n    }\n\n    //\n    // Reset the array, or remove it completely if we have no more listeners.\n    //\n    if (events.length) this._events[evt] = events.length === 1 ? events[0] : events;\n    else clearEvent(this, evt);\n  }\n\n  return this;\n};\n\n/**\n * Remove all listeners, or those of the specified event.\n *\n * @param {(String|Symbol)} [event] The event name.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeAllListeners = function removeAllListeners(event) {\n  var evt;\n\n  if (event) {\n    evt = prefix ? prefix + event : event;\n    if (this._events[evt]) clearEvent(this, evt);\n  } else {\n    this._events = new Events();\n    this._eventsCount = 0;\n  }\n\n  return this;\n};\n\n//\n// Alias methods names because people roll like that.\n//\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\nEventEmitter.prototype.addListener = EventEmitter.prototype.on;\n\n//\n// Expose the prefix.\n//\nEventEmitter.prefixed = prefix;\n\n//\n// Allow `EventEmitter` to be imported as module namespace.\n//\nEventEmitter.EventEmitter = EventEmitter;\n\n//\n// Expose the module.\n//\nif ('undefined' !== typeof module) {\n  module.exports = EventEmitter;\n}\n","/**\n * @file\n *\n * Defines the {@link Cue} class.\n *\n * @module cue\n */\n\n/**\n * A cue represents an event to be triggered at some point on the media\n * timeline.\n *\n * @class\n * @alias Cue\n *\n * @param {Number} time Cue time, in seconds.\n * @param {Number} type Cue mark type, either <code>Cue.POINT</code>,\n *   <code>Cue.SEGMENT_START</code>, or <code>Cue.SEGMENT_END</code>.\n * @param {String} id The id of the {@link Point} or {@link Segment}.\n */\n\nfunction Cue(time, type, id) {\n  this.time = time;\n  this.type = type;\n  this.id = id;\n}\n\n/**\n  * @constant\n  * @type {Number}\n  */\n\nCue.POINT = 0;\nCue.SEGMENT_START = 1;\nCue.SEGMENT_END = 2;\n\n/**\n * Callback function for use with Array.prototype.sort().\n *\n * @static\n * @param {Cue} a\n * @param {Cue} b\n * @return {Number}\n */\n\nCue.sorter = function(a, b) {\n  return a.time - b.time;\n};\n\nexport default Cue;\n","import Konva from 'konva/lib/Core';\n\nfunction zeroPad(number, precision) {\n  number = number.toString();\n\n  while (number.length < precision) {\n    number = '0' + number;\n  }\n\n  return number;\n}\n\n/**\n * Returns a formatted time string.\n *\n * @param {Number} time The time to be formatted, in seconds.\n * @param {Number} precision Decimal places to which time is displayed\n * @returns {String}\n */\n\nexport function formatTime(time, precision) {\n  let result = [];\n\n  const fractionSeconds = Math.floor((time % 1) * Math.pow(10, precision));\n  const seconds = Math.floor(time);\n  const minutes = Math.floor(seconds / 60);\n  const hours = Math.floor(minutes / 60);\n\n  if (hours > 0) {\n    result.push(hours); // Hours\n  }\n  result.push(minutes % 60); // Mins\n  result.push(seconds % 60); // Seconds\n\n  for (let i = 0; i < result.length; i++) {\n    result[i] = zeroPad(result[i], 2);\n  }\n\n  result = result.join(':');\n\n  if (precision > 0) {\n    result += '.' + zeroPad(fractionSeconds, precision);\n  }\n\n  return result;\n}\n\n/**\n * Rounds the given value up to the nearest given multiple.\n *\n * @param {Number} value\n * @param {Number} multiple\n * @returns {Number}\n *\n * @example\n * roundUpToNearest(5.5, 3); // returns 6\n * roundUpToNearest(141.0, 10); // returns 150\n * roundUpToNearest(-5.5, 3); // returns -6\n */\n\nexport function roundUpToNearest(value, multiple) {\n  if (multiple === 0) {\n    return 0;\n  }\n\n  let multiplier = 1;\n\n  if (value < 0.0) {\n    multiplier = -1;\n    value = -value;\n  }\n\n  const roundedUp = Math.ceil(value);\n\n  return multiplier * (((roundedUp + multiple - 1) / multiple) | 0) * multiple;\n}\n\nexport function clamp(value, min, max) {\n  if (value < min) {\n    return min;\n  }\n  else if (value > max) {\n    return max;\n  }\n  else {\n    return value;\n  }\n}\n\nexport function objectHasProperty(object, field) {\n  return Object.prototype.hasOwnProperty.call(object, field);\n}\n\nexport function extend(to, from) {\n  for (const key in from) {\n    if (objectHasProperty(from, key)) {\n      to[key] = from[key];\n    }\n  }\n\n  return to;\n}\n\n/**\n * Checks whether the given array contains values in ascending order.\n *\n * @param {Array<Number>} array The array to test\n * @returns {Boolean}\n */\n\nexport function isInAscendingOrder(array) {\n  if (array.length === 0) {\n    return true;\n  }\n\n  let value = array[0];\n\n  for (let i = 1; i < array.length; i++) {\n    if (value >= array[i]) {\n      return false;\n    }\n\n    value = array[i];\n  }\n\n  return true;\n}\n\n/**\n * Checks whether the given value is a number.\n *\n * @param {Number} value The value to test\n * @returns {Boolean}\n */\n\nexport function isNumber(value) {\n  return typeof value === 'number';\n}\n\n/**\n * Checks whether the given value is a finite number.\n *\n * @param {Number} value The value to test\n * @returns {Boolean}\n */\n\nexport function isFinite(value) {\n  if (typeof value !== 'number') {\n    return false;\n  }\n\n  // Check for NaN and infinity\n  // eslint-disable-next-line no-self-compare\n  if (value !== value || value === Infinity || value === -Infinity) {\n    return false;\n  }\n\n  return true;\n}\n\n/**\n * Checks whether the given value is a valid timestamp.\n *\n * @param {Number} value The value to test\n * @returns {Boolean}\n */\n\nexport function isValidTime(value) {\n  return (typeof value === 'number') && Number.isFinite(value);\n}\n\n/**\n * Checks whether the given value is a valid object.\n *\n * @param {Object|Array} value The value to test\n * @returns {Boolean}\n */\n\nexport function isObject(value) {\n  return (value !== null) && (typeof value === 'object')\n    && !Array.isArray(value);\n}\n\n/**\n * Checks whether the given value is a valid string.\n *\n * @param {String} value The value to test\n * @returns {Boolean}\n */\n\nexport function isString(value) {\n  return typeof value === 'string';\n}\n\n/**\n * Checks whether the given value is a valid ArrayBuffer.\n *\n * @param {ArrayBuffer} value The value to test\n * @returns {Boolean}\n */\n\nexport function isArrayBuffer(value) {\n  return Object.prototype.toString.call(value).includes('ArrayBuffer');\n}\n\n/**\n * Checks whether the given value is null or undefined.\n *\n * @param {Object} value The value to test\n * @returns {Boolean}\n */\n\nexport function isNullOrUndefined(value) {\n  return value === undefined || value === null;\n}\n\n/**\n * Checks whether the given value is a function.\n *\n * @param {Function} value The value to test\n * @returns {Boolean}\n */\n\nexport function isFunction(value) {\n  return typeof value === 'function';\n}\n\n/**\n * Checks whether the given value is a boolean.\n *\n * @param {Function} value The value to test\n * @returns {Boolean}\n */\n\nexport function isBoolean(value) {\n  return value === true || value === false;\n}\n\n/**\n * Checks whether the given value is a valid HTML element.\n *\n * @param {HTMLElement} value The value to test\n * @returns {Boolean}\n */\n\nexport function isHTMLElement(value) {\n  return value instanceof HTMLElement;\n}\n\n/**\n * Checks whether the given value is an array\n *\n * @param {Function} value The value to test\n * @returns {Boolean}\n */\n\nexport function isArray(value) {\n  return Array.isArray(value);\n}\n\n/**\n * Checks whether the given value is a valid linear gradient color\n *\n * @param {Function} value The value to test\n * @returns {Boolean}\n */\n\nexport function isLinearGradientColor(value) {\n  return isObject(value) &&\n    objectHasProperty(value, 'linearGradientStart') &&\n    objectHasProperty(value, 'linearGradientEnd') &&\n    objectHasProperty(value, 'linearGradientColorStops') &&\n    isNumber(value.linearGradientStart) &&\n    isNumber(value.linearGradientEnd) &&\n    isArray(value.linearGradientColorStops) &&\n    value.linearGradientColorStops.length === 2;\n}\n\nexport function getMarkerObject(obj) {\n  while (obj.parent !== null) {\n    if (obj.parent instanceof Konva.Layer) {\n      return obj;\n    }\n\n    obj = obj.parent;\n  }\n\n  return null;\n}\n","/**\n * @file\n *\n * Defines the {@link CueEmitter} class.\n *\n * @module cue-emitter\n */\n\nimport Cue from './cue';\nimport { objectHasProperty } from './utils';\n\nconst isHeadless = /HeadlessChrome/.test(navigator.userAgent);\n\nfunction windowIsVisible() {\n  if (isHeadless || navigator.webdriver) {\n    return false;\n  }\n\n  return (typeof document === 'object') &&\n    ('visibilityState' in document) &&\n    (document.visibilityState === 'visible');\n}\n\nconst requestAnimationFrame =\n  window.requestAnimationFrame ||\n  window.mozRequestAnimationFrame ||\n  window.webkitRequestAnimationFrame ||\n  window.msRequestAnimationFrame;\n\nconst cancelAnimationFrame =\n  window.cancelAnimationFrame ||\n  window.mozCancelAnimationFrame ||\n  window.webkitCancelAnimationFrame ||\n  window.msCancelAnimationFrame;\n\nconst eventTypes = {\n  forward: {},\n  reverse: {}\n};\n\nconst EVENT_TYPE_POINT = 0;\nconst EVENT_TYPE_SEGMENT_ENTER = 1;\nconst EVENT_TYPE_SEGMENT_EXIT = 2;\n\neventTypes.forward[Cue.POINT] = EVENT_TYPE_POINT;\neventTypes.forward[Cue.SEGMENT_START] = EVENT_TYPE_SEGMENT_ENTER;\neventTypes.forward[Cue.SEGMENT_END] = EVENT_TYPE_SEGMENT_EXIT;\n\neventTypes.reverse[Cue.POINT] = EVENT_TYPE_POINT;\neventTypes.reverse[Cue.SEGMENT_START] = EVENT_TYPE_SEGMENT_EXIT;\neventTypes.reverse[Cue.SEGMENT_END] = EVENT_TYPE_SEGMENT_ENTER;\n\nconst eventNames = {};\n\neventNames[EVENT_TYPE_POINT] = 'points.enter';\neventNames[EVENT_TYPE_SEGMENT_ENTER] = 'segments.enter';\neventNames[EVENT_TYPE_SEGMENT_EXIT] = 'segments.exit';\n\nconst eventAttributes = {};\n\neventAttributes[EVENT_TYPE_POINT] = 'point';\neventAttributes[EVENT_TYPE_SEGMENT_ENTER] = 'segment';\neventAttributes[EVENT_TYPE_SEGMENT_EXIT] = 'segment';\n\n/**\n * Given a cue instance, returns the corresponding {@link Point}\n * {@link Segment}.\n *\n * @param {Peaks} peaks\n * @param {Cue} cue\n * @return {Point|Segment}\n * @throws {Error}\n */\n\nfunction getPointOrSegment(peaks, cue) {\n  switch (cue.type) {\n    case Cue.POINT:\n      return peaks.points.getPoint(cue.id);\n\n    case Cue.SEGMENT_START:\n    case Cue.SEGMENT_END:\n      return peaks.segments.getSegment(cue.id);\n\n    default:\n      throw new Error('getPointOrSegment: id not found?');\n  }\n}\n\n/**\n * CueEmitter is responsible for emitting <code>points.enter</code>,\n * <code>segments.enter</code>, and <code>segments.exit</code> events.\n *\n * @class\n * @alias CueEmitter\n *\n * @param {Peaks} peaks Parent {@link Peaks} instance.\n */\n\nfunction CueEmitter(peaks) {\n  this._cues = [];\n  this._peaks = peaks;\n  this._previousTime = -1;\n  this._updateCues = this._updateCues.bind(this);\n  this._onPlaying = this._onPlaying.bind(this);\n  this._onSeeked = this._onSeeked.bind(this);\n  this._onTimeUpdate = this._onTimeUpdate.bind(this);\n  this._onAnimationFrame = this._onAnimationFrame.bind(this);\n  this._rAFHandle = null;\n  this._activeSegments = {};\n  this._attachEventHandlers();\n}\n\n/**\n * This function is bound to all {@link Peaks} events relating to mutated\n * [Points]{@link Point} or [Segments]{@link Segment}, and updates the\n * list of cues accordingly.\n *\n * @private\n */\n\nCueEmitter.prototype._updateCues = function() {\n  const self = this;\n\n  const points = self._peaks.points.getPoints();\n  const segments = self._peaks.segments.getSegments();\n\n  self._cues.length = 0;\n\n  points.forEach(function(point) {\n    self._cues.push(new Cue(point.time, Cue.POINT, point.id));\n  });\n\n  segments.forEach(function(segment) {\n    self._cues.push(new Cue(segment.startTime, Cue.SEGMENT_START, segment.id));\n    self._cues.push(new Cue(segment.endTime, Cue.SEGMENT_END, segment.id));\n  });\n\n  self._cues.sort(Cue.sorter);\n\n  const time = self._peaks.player.getCurrentTime();\n\n  self._updateActiveSegments(time);\n};\n\n/**\n * Emits events for any cues passed through during media playback.\n *\n * @param {Number} time The current time on the media timeline.\n * @param {Number} previousTime The previous time on the media timeline when\n *   this function was called.\n */\n\nCueEmitter.prototype._onUpdate = function(time, previousTime) {\n  const isForward = time > previousTime;\n  let start;\n  let end;\n  let step;\n\n  if (isForward) {\n    start = 0;\n    end = this._cues.length;\n    step = 1;\n  }\n  else {\n    start = this._cues.length - 1;\n    end = -1;\n    step = -1;\n  }\n\n  // Cues are sorted.\n\n  for (let i = start; isForward ? i < end : i > end; i += step) {\n    const cue = this._cues[i];\n\n    if (isForward ? cue.time > previousTime : cue.time < previousTime) {\n      if (isForward ? cue.time > time : cue.time < time) {\n        break;\n      }\n\n      // Cue falls between time and previousTime.\n\n      const marker = getPointOrSegment(this._peaks, cue);\n\n      const eventType = isForward ? eventTypes.forward[cue.type] :\n                                    eventTypes.reverse[cue.type];\n\n      if (eventType === EVENT_TYPE_SEGMENT_ENTER) {\n        this._activeSegments[marker.id] = marker;\n      }\n      else if (eventType === EVENT_TYPE_SEGMENT_EXIT) {\n        delete this._activeSegments[marker.id];\n      }\n\n      const event = {\n        time: time\n      };\n\n      event[eventAttributes[eventType]] = marker;\n\n      this._peaks.emit(eventNames[eventType], event);\n    }\n  }\n};\n\n// The next handler and onAnimationFrame are bound together\n// when the window isn't in focus, rAF is throttled\n// falling back to timeUpdate.\n\nCueEmitter.prototype._onTimeUpdate = function(time) {\n  if (windowIsVisible()) {\n    return;\n  }\n\n  if (this._peaks.player.isPlaying() && !this._peaks.player.isSeeking()) {\n    this._onUpdate(time, this._previousTime);\n  }\n\n  this._previousTime = time;\n};\n\nCueEmitter.prototype._onAnimationFrame = function() {\n  const time = this._peaks.player.getCurrentTime();\n\n  if (!this._peaks.player.isSeeking()) {\n    this._onUpdate(time, this._previousTime);\n  }\n\n  this._previousTime = time;\n\n  if (this._peaks.player.isPlaying()) {\n    this._rAFHandle = requestAnimationFrame(this._onAnimationFrame);\n  }\n};\n\nCueEmitter.prototype._onPlaying = function() {\n  this._previousTime = this._peaks.player.getCurrentTime();\n  this._rAFHandle = requestAnimationFrame(this._onAnimationFrame);\n};\n\nCueEmitter.prototype._onSeeked = function(time) {\n  this._previousTime = time;\n\n  this._updateActiveSegments(time);\n};\n\nfunction getSegmentIdComparator(id) {\n  return function compareSegmentIds(segment) {\n    return segment.id === id;\n  };\n}\n\n/**\n * The active segments is the set of all segments which overlap the current\n * playhead position. This function updates that set and emits\n * <code>segments.enter</code> and <code>segments.exit</code> events.\n */\n\nCueEmitter.prototype._updateActiveSegments = function(time) {\n  const self = this;\n\n  const activeSegments = self._peaks.segments.getSegmentsAtTime(time);\n\n  // Remove any segments no longer active.\n\n  for (const id in self._activeSegments) {\n    if (objectHasProperty(self._activeSegments, id)) {\n      const segment = activeSegments.find(getSegmentIdComparator(id));\n\n      if (!segment) {\n        self._peaks.emit('segments.exit', {\n          segment: self._activeSegments[id],\n          time: time\n        });\n\n        delete self._activeSegments[id];\n      }\n    }\n  }\n\n  // Add new active segments.\n\n  activeSegments.forEach(function(segment) {\n    if (!(segment.id in self._activeSegments)) {\n      self._activeSegments[segment.id] = segment;\n\n      self._peaks.emit('segments.enter', {\n        segment: segment,\n        time: time\n      });\n    }\n  });\n};\n\nconst events = [\n  'points.update',\n  'points.dragmove',\n  'points.add',\n  'points.remove',\n  'points.remove_all',\n  'segments.update',\n  'segments.dragged',\n  'segments.add',\n  'segments.remove',\n  'segments.remove_all'\n];\n\nCueEmitter.prototype._attachEventHandlers = function() {\n  this._peaks.on('player.timeupdate', this._onTimeUpdate);\n  this._peaks.on('player.playing', this._onPlaying);\n  this._peaks.on('player.seeked', this._onSeeked);\n\n  for (let i = 0; i < events.length; i++) {\n    this._peaks.on(events[i], this._updateCues);\n  }\n\n  this._updateCues();\n};\n\nCueEmitter.prototype._detachEventHandlers = function() {\n  this._peaks.off('player.timeupdate', this._onTimeUpdate);\n  this._peaks.off('player.playing', this._onPlaying);\n  this._peaks.off('player.seeked', this._onSeeked);\n\n  for (let i = 0; i < events.length; i++) {\n    this._peaks.off(events[i], this._updateCues);\n  }\n};\n\nCueEmitter.prototype.destroy = function() {\n  if (this._rAFHandle) {\n    cancelAnimationFrame(this._rAFHandle);\n    this._rAFHandle = null;\n  }\n\n  this._detachEventHandlers();\n\n  this._previousTime = -1;\n};\n\nexport default CueEmitter;\n","/**\n * @file\n *\n * Defines the {@link Point} class.\n *\n * @module point\n */\n\nimport {\n  isBoolean, isLinearGradientColor, isNullOrUndefined, isString,\n  isValidTime, objectHasProperty\n} from './utils';\n\nconst pointOptions = [\n  'id', 'pid', 'time', 'labelText', 'color', 'editable'\n];\n\nconst invalidOptions = [\n  'update', 'isVisible', 'peaks', 'pid'\n];\n\nfunction setDefaultPointOptions(options, peaksOptions) {\n  if (isNullOrUndefined(options.labelText)) {\n    options.labelText = '';\n  }\n\n  if (isNullOrUndefined(options.editable)) {\n    options.editable = false;\n  }\n\n  if (isNullOrUndefined(options.color)) {\n    options.color = peaksOptions.pointMarkerColor;\n  }\n}\n\nfunction validatePointOptions(options, updating) {\n  const context = updating ? 'update()' : 'add()';\n\n  if (!updating || (updating && objectHasProperty(options, 'time'))) {\n    if (!isValidTime(options.time)) {\n      throw new TypeError('peaks.points.' + context + ': time should be a numeric value');\n    }\n  }\n\n  if (options.time < 0) {\n    throw new RangeError('peaks.points.' + context + ': time should not be negative');\n  }\n\n  if (objectHasProperty(options, 'labelText') && !isString(options.labelText)) {\n    throw new TypeError('peaks.points.' + context + ': labelText must be a string');\n  }\n\n  if (objectHasProperty(options, 'editable') && !isBoolean(options.editable)) {\n    throw new TypeError('peaks.points.' + context + ': editable must be true or false');\n  }\n\n  if (objectHasProperty(options, 'color') &&\n    !isString(options.color) &&\n    !isLinearGradientColor(options.color)) {\n    // eslint-disable-next-line @stylistic/js/max-len\n    throw new TypeError('peaks.points.' + context + ': color must be a string or a valid linear gradient object');\n  }\n\n  invalidOptions.forEach(function(name) {\n    if (objectHasProperty(options, name)) {\n      throw new Error('peaks.points.' + context + ': invalid option name: ' + name);\n    }\n  });\n\n  pointOptions.forEach(function(name) {\n    if (objectHasProperty(options, '_' + name)) {\n      throw new Error('peaks.points.' + context + ': invalid option name: _' + name);\n    }\n  });\n}\n\n/**\n * A point is a single instant of time, with associated label and color.\n *\n * @class\n * @alias Point\n *\n * @param {Peaks} peaks A reference to the Peaks instance.\n * @param {Number} pid An internal unique identifier for the point.\n * @param {PointOptions} options User specified point attributes.\n */\n\nfunction Point(peaks, pid, options) {\n  this._peaks = peaks;\n  this._pid = pid;\n  this._setUserData(options);\n}\n\nPoint.prototype._setUserData = function(options) {\n  for (const key in options) {\n    if (objectHasProperty(options, key)) {\n      if (pointOptions.indexOf(key) === -1) {\n        this[key] = options[key];\n      }\n      else {\n        this['_' + key] = options[key];\n      }\n    }\n  }\n};\n\nObject.defineProperties(Point.prototype, {\n  id: {\n    enumerable: true,\n    get: function() {\n      return this._id;\n    }\n  },\n  pid: {\n    enumerable: true,\n    get: function() {\n      return this._pid;\n    }\n  },\n  time: {\n    enumerable: true,\n    get: function() {\n      return this._time;\n    }\n  },\n  labelText: {\n    get: function() {\n      return this._labelText;\n    }\n  },\n  color: {\n    enumerable: true,\n    get: function() {\n      return this._color;\n    }\n  },\n  editable: {\n    enumerable: true,\n    get: function() {\n      return this._editable;\n    }\n  }\n});\n\nPoint.prototype.update = function(options) {\n  validatePointOptions(options, true);\n\n  if (objectHasProperty(options, 'id')) {\n    if (isNullOrUndefined(options.id)) {\n      throw new TypeError('point.update(): invalid id');\n    }\n\n    this._peaks.points.updatePointId(this, options.id);\n  }\n\n  this._setUserData(options);\n\n  this._peaks.emit('points.update', this, options);\n};\n\n/**\n * Returns <code>true</code> if the point lies with in a given time range.\n *\n * @param {Number} startTime The start of the time region, in seconds.\n * @param {Number} endTime The end of the time region, in seconds.\n * @returns {Boolean}\n */\n\nPoint.prototype.isVisible = function(startTime, endTime) {\n  return this.time >= startTime && this.time < endTime;\n};\n\nPoint.prototype._setTime = function(time) {\n  this._time = time;\n};\n\nexport { Point, setDefaultPointOptions, validatePointOptions };\n","/**\n * @file\n *\n * Defines the {@link WaveformPoints} class.\n *\n * @module waveform-points\n */\n\nimport { Point, setDefaultPointOptions, validatePointOptions } from './point';\nimport { extend, isNullOrUndefined, objectHasProperty } from './utils';\n\n/**\n * Point parameters.\n *\n * @typedef {Object} PointOptions\n * @global\n * @property {Number} time Point time, in seconds.\n * @property {Boolean=} editable If <code>true</code> the point time can be\n *   adjusted via the user interface.\n *   Default: <code>false</code>.\n * @property {String=} color Point marker color.\n *   Default: a random color.\n * @property {String=} labelText Point label text.\n *   Default: an empty string.\n * @property {String=} id A unique point identifier.\n *   Default: an automatically generated identifier.\n * @property {*} data Optional application-specific data.\n */\n\n/**\n * Handles all functionality related to the adding, removing and manipulation\n * of points. A point is a single instant of time.\n *\n * @class\n * @alias WaveformPoints\n *\n * @param {Peaks} peaks The parent Peaks object.\n */\n\nfunction WaveformPoints(peaks) {\n  this._peaks = peaks;\n  this._points = [];\n  this._pointsById = {};\n  this._pointsByPid = {};\n  this._pointIdCounter = 0;\n  this._pointPid = 0;\n}\n\n/**\n * Returns a new unique point id value.\n *\n * @returns {String}\n */\n\nWaveformPoints.prototype._getNextPointId = function() {\n  return 'peaks.point.' + this._pointIdCounter++;\n};\n\n/**\n * Returns a new unique point id value, for internal use within\n * Peaks.js only.\n *\n * @returns {Number}\n */\n\nWaveformPoints.prototype._getNextPid = function() {\n  return this._pointPid++;\n};\n\n/**\n * Adds a new point object.\n *\n * @private\n * @param {Point} point\n */\n\nWaveformPoints.prototype._addPoint = function(point) {\n  this._points.push(point);\n\n  this._pointsById[point.id] = point;\n  this._pointsByPid[point.pid] = point;\n};\n\n/**\n * Creates a new point object.\n *\n * @private\n * @param {PointOptions} options\n * @returns {Point}\n */\n\nWaveformPoints.prototype._createPoint = function(options) {\n  const pointOptions = {};\n\n  extend(pointOptions, options);\n\n  if (isNullOrUndefined(pointOptions.id)) {\n    pointOptions.id = this._getNextPointId();\n  }\n\n  const pid = this._getNextPid();\n\n  setDefaultPointOptions(pointOptions, this._peaks.options);\n\n  validatePointOptions(pointOptions, false);\n\n  return new Point(this._peaks, pid, pointOptions);\n};\n\n/**\n * Returns all points.\n *\n * @returns {Array<Point>}\n */\n\nWaveformPoints.prototype.getPoints = function() {\n  return this._points;\n};\n\n/**\n * Returns the point with the given id, or <code>undefined</code> if not found.\n *\n * @param {String} id\n * @returns {Point}\n */\n\nWaveformPoints.prototype.getPoint = function(id) {\n  return this._pointsById[id];\n};\n\n/**\n * Returns all points within a given time region.\n *\n * @param {Number} startTime The start of the time region, in seconds.\n * @param {Number} endTime The end of the time region, in seconds.\n * @returns {Array<Point>}\n */\n\nWaveformPoints.prototype.find = function(startTime, endTime) {\n  return this._points.filter(function(point) {\n    return point.isVisible(startTime, endTime);\n  });\n};\n\n/**\n * Adds one or more points to the timeline.\n *\n * @param {PointOptions|Array<PointOptions>} pointOrPoints\n *\n * @returns Point|Array<Point>\n */\n\nWaveformPoints.prototype.add = function(/* pointOrPoints */) {\n  const self = this;\n\n  const arrayArgs = Array.isArray(arguments[0]);\n  let points = arrayArgs ?\n               arguments[0] :\n               Array.prototype.slice.call(arguments);\n\n  points = points.map(function(pointOptions) {\n    const point = self._createPoint(pointOptions);\n\n    if (objectHasProperty(self._pointsById, point.id)) {\n      throw new Error('peaks.points.add(): duplicate id');\n    }\n\n    return point;\n  });\n\n  points.forEach(function(point) {\n    self._addPoint(point);\n  });\n\n  this._peaks.emit('points.add', {\n    points: points\n  });\n\n  return arrayArgs ? points : points[0];\n};\n\nWaveformPoints.prototype.updatePointId = function(point, newPointId) {\n  if (this._pointsById[point.id]) {\n    if (this._pointsById[newPointId]) {\n      throw new Error('point.update(): duplicate id');\n    }\n    else {\n      delete this._pointsById[point.id];\n      this._pointsById[newPointId] = point;\n    }\n  }\n};\n\n/**\n * Returns the indexes of points that match the given predicate.\n *\n * @private\n * @param {Function} predicate Predicate function to find matching points.\n * @returns {Array<Number>} An array of indexes into the points array of\n *   the matching elements.\n */\n\nWaveformPoints.prototype._findPoint = function(predicate) {\n  const indexes = [];\n\n  for (let i = 0, length = this._points.length; i < length; i++) {\n    if (predicate(this._points[i])) {\n      indexes.push(i);\n    }\n  }\n\n  return indexes;\n};\n\n/**\n * Removes the points at the given array indexes.\n *\n * @private\n * @param {Array<Number>} indexes The array indexes to remove.\n * @returns {Array<Point>} The removed {@link Point} objects.\n */\n\nWaveformPoints.prototype._removeIndexes = function(indexes) {\n  const removed = [];\n\n  for (let i = 0; i < indexes.length; i++) {\n    const index = indexes[i] - removed.length;\n\n    const itemRemoved = this._points.splice(index, 1)[0];\n\n    delete this._pointsById[itemRemoved.id];\n    delete this._pointsByPid[itemRemoved.pid];\n\n    removed.push(itemRemoved);\n  }\n\n  return removed;\n};\n\n/**\n * Removes all points that match a given predicate function.\n *\n * After removing the points, this function emits a\n * <code>points.remove</code> event with the removed {@link Point}\n * objects.\n *\n * @private\n * @param {Function} predicate A predicate function that identifies which\n *   points to remove.\n * @returns {Array<Point>} The removed {@link Points} objects.\n */\n\nWaveformPoints.prototype._removePoints = function(predicate) {\n  const indexes = this._findPoint(predicate);\n\n  const removed = this._removeIndexes(indexes);\n\n  this._peaks.emit('points.remove', {\n    points: removed\n  });\n\n  return removed;\n};\n\n/**\n * Removes the given point.\n *\n * @param {Point} point The point to remove.\n * @returns {Array<Point>} The removed points.\n */\n\nWaveformPoints.prototype.remove = function(point) {\n  return this._removePoints(function(p) {\n    return p === point;\n  });\n};\n\n/**\n * Removes any points with the given id.\n *\n * @param {String} id\n * @returns {Array<Point>} The removed {@link Point} objects.\n */\n\nWaveformPoints.prototype.removeById = function(pointId) {\n  return this._removePoints(function(point) {\n    return point.id === pointId;\n  });\n};\n\n/**\n * Removes any points at the given time.\n *\n * @param {Number} time\n * @returns {Array<Point>} The removed {@link Point} objects.\n */\n\nWaveformPoints.prototype.removeByTime = function(time) {\n  return this._removePoints(function(point) {\n    return point.time === time;\n  });\n};\n\n/**\n * Removes all points.\n *\n * After removing the points, this function emits a\n * <code>points.remove_all</code> event.\n */\n\nWaveformPoints.prototype.removeAll = function() {\n  this._points = [];\n  this._pointsById = {};\n  this._pointsByPid = {};\n  this._peaks.emit('points.remove_all');\n};\n\nexport default WaveformPoints;\n","/**\n * @file\n *\n * Defines the {@link Segment} class.\n *\n * @module segment\n */\n\nimport {\n  isBoolean, isNullOrUndefined, isLinearGradientColor,\n  isString, isValidTime, objectHasProperty\n} from './utils';\n\nconst segmentOptions = [\n  'id', 'pid', 'startTime', 'endTime', 'labelText', 'color', 'borderColor',\n  'markers', 'overlay', 'editable'\n];\n\nconst invalidOptions = [\n  'update', 'isVisible', 'peaks', 'pid'\n];\n\nfunction setDefaultSegmentOptions(options, globalSegmentOptions) {\n  if (isNullOrUndefined(options.color)) {\n    if (globalSegmentOptions.overlay) {\n      options.color = globalSegmentOptions.overlayColor;\n    }\n    else {\n      options.color = globalSegmentOptions.waveformColor;\n    }\n  }\n\n  if (isNullOrUndefined(options.borderColor)) {\n    options.borderColor = globalSegmentOptions.overlayBorderColor;\n  }\n\n  if (isNullOrUndefined(options.labelText)) {\n    options.labelText = '';\n  }\n\n  if (isNullOrUndefined(options.markers)) {\n    options.markers = globalSegmentOptions.markers;\n  }\n\n  if (isNullOrUndefined(options.overlay)) {\n    options.overlay = globalSegmentOptions.overlay;\n  }\n\n  if (isNullOrUndefined(options.editable)) {\n    options.editable = false;\n  }\n}\n\nfunction validateSegmentOptions(options, updating) {\n  const context = updating ? 'update()' : 'add()';\n\n  if (objectHasProperty(options, 'startTime') && !isValidTime(options.startTime)) {\n    throw new TypeError('peaks.segments.' + context + ': startTime should be a valid number');\n  }\n\n  if (objectHasProperty(options, 'endTime') && !isValidTime(options.endTime)) {\n    throw new TypeError('peaks.segments.' + context + ': endTime should be a valid number');\n  }\n\n  if (!updating) {\n    if (!objectHasProperty(options, 'startTime') || !objectHasProperty(options, 'endTime')) {\n      throw new TypeError('peaks.segments.' + context + ': missing startTime or endTime');\n    }\n  }\n\n  if (options.startTime < 0) {\n    throw new RangeError('peaks.segments.' + context + ': startTime should not be negative');\n  }\n\n  if (options.endTime < 0) {\n    throw new RangeError('peaks.segments.' + context + ': endTime should not be negative');\n  }\n\n  if (options.endTime < options.startTime) {\n    // eslint-disable-next-line @stylistic/js/max-len\n    throw new RangeError('peaks.segments.' + context + ': endTime should not be less than startTime');\n  }\n\n  if (objectHasProperty(options, 'labelText') && !isString(options.labelText)) {\n    throw new TypeError('peaks.segments.' + context + ': labelText must be a string');\n  }\n\n  if (updating && objectHasProperty(options, 'markers')) {\n    throw new TypeError('peaks.segments.' + context + ': cannot update markers attribute');\n  }\n\n  if (objectHasProperty(options, 'markers') && !isBoolean(options.markers)) {\n    throw new TypeError('peaks.segments.' + context + ': markers must be true or false');\n  }\n\n  if (updating && objectHasProperty(options, 'overlay')) {\n    throw new TypeError('peaks.segments.' + context + ': cannot update overlay attribute');\n  }\n\n  if (objectHasProperty(options, 'overlay') && !isBoolean(options.overlay)) {\n    throw new TypeError('peaks.segments.' + context + ': overlay must be true or false');\n  }\n\n  if (objectHasProperty(options, 'editable') && !isBoolean(options.editable)) {\n    throw new TypeError('peaks.segments.' + context + ': editable must be true or false');\n  }\n\n  if (objectHasProperty(options, 'color') &&\n    !isString(options.color) &&\n    !isLinearGradientColor(options.color)) {\n    // eslint-disable-next-line @stylistic/js/max-len\n    throw new TypeError('peaks.segments.' + context + ': color must be a string or a valid linear gradient object');\n  }\n\n  if (objectHasProperty(options, 'borderColor') && !isString(options.borderColor)) {\n    throw new TypeError('peaks.segments.' + context + ': borderColor must be a string');\n  }\n\n  invalidOptions.forEach(function(name) {\n    if (objectHasProperty(options, name)) {\n      throw new Error('peaks.segments.' + context + ': invalid option name: ' + name);\n    }\n  });\n\n  segmentOptions.forEach(function(name) {\n    if (objectHasProperty(options, '_' + name)) {\n      throw new Error('peaks.segments.' + context + ': invalid option name: _' + name);\n    }\n  });\n}\n\n/**\n * A segment is a region of time, with associated label and color.\n *\n * @class\n * @alias Segment\n *\n * @param {Peaks} peaks A reference to the Peaks instance.\n * @param {Number} pid An internal unique identifier for the segment.\n * @param {SegmentOptions} options User specified segment attributes.\n */\n\nfunction Segment(peaks, pid, options) {\n  this._peaks       = peaks;\n  this._pid         = pid;\n  this._id          = options.id;\n  this._startTime   = options.startTime;\n  this._endTime     = options.endTime;\n  this._labelText   = options.labelText;\n  this._color       = options.color;\n  this._borderColor = options.borderColor;\n  this._editable    = options.editable;\n  this._markers     = options.markers;\n  this._overlay     = options.overlay;\n\n  this._setUserData(options);\n}\n\nSegment.prototype._setUserData = function(options) {\n  for (const key in options) {\n    if (objectHasProperty(options, key)) {\n      if (segmentOptions.indexOf(key) === -1) {\n        this[key] = options[key];\n      }\n      else {\n        this['_' + key] = options[key];\n      }\n    }\n  }\n};\n\nObject.defineProperties(Segment.prototype, {\n  id: {\n    enumerable: true,\n    get: function() {\n      return this._id;\n    }\n  },\n  pid: {\n    enumerable: true,\n    get: function() {\n      return this._pid;\n    }\n  },\n  startTime: {\n    enumerable: true,\n    get: function() {\n      return this._startTime;\n    }\n  },\n  endTime: {\n    enumerable: true,\n    get: function() {\n      return this._endTime;\n    }\n  },\n  labelText: {\n    enumerable: true,\n    get: function() {\n      return this._labelText;\n    }\n  },\n  color: {\n    enumerable: true,\n    get: function() {\n      return this._color;\n    }\n  },\n  borderColor: {\n    enumerable: true,\n    get: function() {\n      return this._borderColor;\n    }\n  },\n  markers: {\n    enumerable: true,\n    get: function() {\n      return this._markers;\n    }\n  },\n  overlay: {\n    enumerable: true,\n    get: function() {\n      return this._overlay;\n    }\n  },\n  editable: {\n    enumerable: true,\n    get: function() {\n      return this._editable;\n    }\n  }\n});\n\nSegment.prototype.update = function(options) {\n  validateSegmentOptions(options, true);\n\n  if (objectHasProperty(options, 'id')) {\n    if (isNullOrUndefined(options.id)) {\n      throw new TypeError('segment.update(): invalid id');\n    }\n\n    this._peaks.segments.updateSegmentId(this, options.id);\n  }\n\n  this._setUserData(options);\n\n  this._peaks.emit('segments.update', this, options);\n};\n\n/**\n * Returns <code>true</code> if the segment overlaps a given time region.\n *\n * @param {Number} startTime The start of the time region, in seconds.\n * @param {Number} endTime The end of the time region, in seconds.\n * @returns {Boolean}\n */\n\nSegment.prototype.isVisible = function(startTime, endTime) {\n  // A special case, where the segment has zero duration\n  // and is at the start of the region.\n  if (this.startTime === this.endTime && this.startTime === startTime) {\n    return true;\n  }\n\n  // Segment ends before start of region.\n  if (this.endTime <= startTime) {\n    return false;\n  }\n\n  // Segment starts after end of region\n  if (this.startTime >= endTime) {\n    return false;\n  }\n\n  return true;\n};\n\nSegment.prototype._setStartTime = function(time) {\n  this._startTime = time;\n};\n\nSegment.prototype._setEndTime = function(time) {\n  this._endTime = time;\n};\n\nexport { Segment, setDefaultSegmentOptions, validateSegmentOptions };\n","/**\n * @file\n *\n * Defines the {@link WaveformSegments} class.\n *\n * @module waveform-segments\n */\n\nimport { Segment, setDefaultSegmentOptions, validateSegmentOptions } from './segment';\nimport { extend, isNullOrUndefined, objectHasProperty } from './utils';\n\n/**\n * Segment parameters.\n *\n * @typedef {Object} SegmentOptions\n * @global\n * @property {Number} startTime Segment start time, in seconds.\n * @property {Number} endTime Segment end time, in seconds.\n * @property {Boolean=} editable If <code>true</code> the segment start and\n *   end times can be adjusted via the user interface.\n *   Default: <code>false</code>.\n * @property {String=} color Segment waveform color.\n *   Default: Set by the <code>segmentOptions.waveformColor</code> option\n *   or the <code>segmentOptions.overlayColor</code> option.\n * @property {String=} borderColor Segment border color.\n *   Default: Set by the <code>segmentOptions.overlayBorderColor</code> option.\n * @property {String=} labelText Segment label text.\n *   Default: an empty string.\n * @property {String=} id A unique segment identifier.\n *   Default: an automatically generated identifier.\n * @property {*} data Optional application specific data.\n */\n\n/**\n * Handles all functionality related to the adding, removing and manipulation\n * of segments.\n *\n * @class\n * @alias WaveformSegments\n *\n * @param {Peaks} peaks The parent Peaks object.\n */\n\nfunction WaveformSegments(peaks) {\n  this._peaks = peaks;\n  this._segments = [];\n  this._segmentsById = {};\n  this._segmentsByPid = {};\n  this._segmentIdCounter = 0;\n  this._segmentPid = 0;\n  this._isInserting = false;\n}\n\n/**\n * Returns a new unique segment id value.\n *\n * @private\n * @returns {String}\n */\n\nWaveformSegments.prototype._getNextSegmentId = function() {\n  return 'peaks.segment.' + this._segmentIdCounter++;\n};\n\n/**\n * Returns a new unique segment id value, for internal use within\n * Peaks.js only.\n *\n * @private\n * @returns {Number}\n */\n\nWaveformSegments.prototype._getNextPid = function() {\n  return this._segmentPid++;\n};\n\n/**\n * Adds a new segment object.\n *\n * @private\n * @param {Segment} segment\n */\n\nWaveformSegments.prototype._addSegment = function(segment) {\n  this._segments.push(segment);\n\n  this._segmentsById[segment.id] = segment;\n  this._segmentsByPid[segment.pid] = segment;\n};\n\n/**\n * Creates a new segment object.\n *\n * @private\n * @param {SegmentOptions} options\n * @return {Segment}\n */\n\nWaveformSegments.prototype._createSegment = function(options) {\n  const segmentOptions = {};\n\n  extend(segmentOptions, options);\n\n  if (isNullOrUndefined(segmentOptions.id)) {\n    segmentOptions.id = this._getNextSegmentId();\n  }\n\n  const pid = this._getNextPid();\n\n  setDefaultSegmentOptions(segmentOptions, this._peaks.options.segmentOptions);\n\n  validateSegmentOptions(segmentOptions, false);\n\n  return new Segment(this._peaks, pid, segmentOptions);\n};\n\n/**\n * Returns all segments.\n *\n * @returns {Array<Segment>}\n */\n\nWaveformSegments.prototype.getSegments = function() {\n  return this._segments;\n};\n\n/**\n * Returns the segment with the given id, or <code>undefined</code> if not found.\n *\n * @param {String} id\n * @returns {Segment}\n */\n\nWaveformSegments.prototype.getSegment = function(id) {\n  return this._segmentsById[id];\n};\n\n/**\n * Returns all segments that overlap a given point in time.\n *\n * @param {Number} time\n * @returns {Array<Segment>}\n */\n\nWaveformSegments.prototype.getSegmentsAtTime = function(time) {\n  return this._segments.filter(function(segment) {\n    return time >= segment.startTime && time < segment.endTime;\n  });\n};\n\n/**\n * Returns all segments that overlap a given time region.\n *\n * @param {Number} startTime The start of the time region, in seconds.\n * @param {Number} endTime The end of the time region, in seconds.\n *\n * @returns {Array<Segment>}\n */\n\nWaveformSegments.prototype.find = function(startTime, endTime) {\n  return this._segments.filter(function(segment) {\n    return segment.isVisible(startTime, endTime);\n  });\n};\n\n/**\n * Returns a copy of the segments array, sorted by ascending segment start time.\n *\n * @returns {Array<Segment>}\n */\n\nWaveformSegments.prototype._getSortedSegments = function() {\n  return this._segments.slice().sort(function(a, b) {\n    return a.startTime - b.startTime;\n  });\n};\n\nWaveformSegments.prototype.findPreviousSegment = function(segment) {\n  const sortedSegments = this._getSortedSegments();\n\n  const index = sortedSegments.findIndex(function(s) {\n    return s.id === segment.id;\n  });\n\n  if (index !== -1) {\n    return sortedSegments[index - 1];\n  }\n\n  return undefined;\n};\n\nWaveformSegments.prototype.findNextSegment = function(segment) {\n  const sortedSegments = this._getSortedSegments();\n\n  const index = sortedSegments.findIndex(function(s) {\n    return s.id === segment.id;\n  });\n\n  if (index !== -1) {\n    return sortedSegments[index + 1];\n  }\n\n  return undefined;\n};\n\n/**\n * Adds one or more segments to the timeline.\n *\n * @param {SegmentOptions|Array<SegmentOptions>} segmentOrSegments\n *\n * @returns Segment|Array<Segment>\n */\n\nWaveformSegments.prototype.add = function(/* segmentOrSegments */) {\n  const self = this;\n\n  const arrayArgs = Array.isArray(arguments[0]);\n  let segments = arrayArgs ?\n                 arguments[0] :\n                 Array.prototype.slice.call(arguments);\n\n  segments = segments.map(function(segmentOptions) {\n    const segment = self._createSegment(segmentOptions);\n\n    if (objectHasProperty(self._segmentsById, segment.id)) {\n      throw new Error('peaks.segments.add(): duplicate id');\n    }\n\n    return segment;\n  });\n\n  segments.forEach(function(segment) {\n    self._addSegment(segment);\n  });\n\n  this._peaks.emit('segments.add', {\n    segments: segments,\n    insert: this._isInserting\n  });\n\n  return arrayArgs ? segments : segments[0];\n};\n\nWaveformSegments.prototype.updateSegmentId = function(segment, newSegmentId) {\n  if (this._segmentsById[segment.id]) {\n    if (this._segmentsById[newSegmentId]) {\n      throw new Error('segment.update(): duplicate id');\n    }\n    else {\n      delete this._segmentsById[segment.id];\n      this._segmentsById[newSegmentId] = segment;\n    }\n  }\n};\n\n/**\n * Returns the indexes of segments that match the given predicate.\n *\n * @private\n * @param {Function} predicate Predicate function to find matching segments.\n * @returns {Array<Number>} An array of indexes into the segments array of\n *   the matching elements.\n */\n\nWaveformSegments.prototype._findSegment = function(predicate) {\n  const indexes = [];\n\n  for (let i = 0, length = this._segments.length; i < length; i++) {\n    if (predicate(this._segments[i])) {\n      indexes.push(i);\n    }\n  }\n\n  return indexes;\n};\n\n/**\n * Removes the segments at the given array indexes.\n *\n * @private\n * @param {Array<Number>} indexes The array indexes to remove.\n * @returns {Array<Segment>} The removed {@link Segment} objects.\n */\n\nWaveformSegments.prototype._removeIndexes = function(indexes) {\n  const removed = [];\n\n  for (let i = 0; i < indexes.length; i++) {\n    const index = indexes[i] - removed.length;\n\n    const itemRemoved = this._segments.splice(index, 1)[0];\n\n    delete this._segmentsById[itemRemoved.id];\n    delete this._segmentsByPid[itemRemoved.pid];\n\n    removed.push(itemRemoved);\n  }\n\n  return removed;\n};\n\n/**\n * Removes all segments that match a given predicate function.\n *\n * After removing the segments, this function also emits a\n * <code>segments.remove</code> event with the removed {@link Segment}\n * objects.\n *\n * @private\n * @param {Function} predicate A predicate function that identifies which\n *   segments to remove.\n * @returns {Array<Segment>} The removed {@link Segment} objects.\n */\n\nWaveformSegments.prototype._removeSegments = function(predicate) {\n  const indexes = this._findSegment(predicate);\n\n  const removed = this._removeIndexes(indexes);\n\n  this._peaks.emit('segments.remove', {\n    segments: removed\n  });\n\n  return removed;\n};\n\n/**\n * Removes the given segment.\n *\n * @param {Segment} segment The segment to remove.\n * @returns {Array<Segment>} The removed segment.\n */\n\nWaveformSegments.prototype.remove = function(segment) {\n  return this._removeSegments(function(s) {\n    return s === segment;\n  });\n};\n\n/**\n * Removes any segments with the given id.\n *\n * @param {String} id\n * @returns {Array<Segment>} The removed {@link Segment} objects.\n */\n\nWaveformSegments.prototype.removeById = function(segmentId) {\n  return this._removeSegments(function(segment) {\n    return segment.id === segmentId;\n  });\n};\n\n/**\n * Removes any segments with the given start time, and optional end time.\n *\n * @param {Number} startTime Segments with this start time are removed.\n * @param {Number?} endTime If present, only segments with both the given\n *   start time and end time are removed.\n * @returns {Array<Segment>} The removed {@link Segment} objects.\n */\n\nWaveformSegments.prototype.removeByTime = function(startTime, endTime) {\n  endTime = (typeof endTime === 'number') ? endTime : 0;\n\n  let filter;\n\n  if (endTime > 0) {\n    filter = function(segment) {\n      return segment.startTime === startTime && segment.endTime === endTime;\n    };\n  }\n  else {\n    filter = function(segment) {\n      return segment.startTime === startTime;\n    };\n  }\n\n  return this._removeSegments(filter);\n};\n\n/**\n * Removes all segments.\n *\n * After removing the segments, this function emits a\n * <code>segments.remove_all</code> event.\n */\n\nWaveformSegments.prototype.removeAll = function() {\n  this._segments = [];\n  this._segmentsById = {};\n  this._segmentsByPid = {};\n  this._peaks.emit('segments.remove_all');\n};\n\nWaveformSegments.prototype.setInserting = function(value) {\n  this._isInserting = value;\n};\n\nWaveformSegments.prototype.isInserting = function() {\n  return this._isInserting;\n};\n\nexport default WaveformSegments;\n","/**\n * @file\n *\n * Defines the {@link KeyboardHandler} class.\n *\n * @module keyboard-handler\n */\n\nconst nodes = ['OBJECT', 'TEXTAREA', 'INPUT', 'SELECT', 'OPTION'];\n\nconst SPACE = 32,\n    TAB = 9,\n    LEFT_ARROW = 37,\n    RIGHT_ARROW = 39;\n\nconst keys = [SPACE, TAB, LEFT_ARROW, RIGHT_ARROW];\n\n/**\n * Configures keyboard event handling.\n *\n * @class\n * @alias KeyboardHandler\n *\n * @param {EventEmitter} eventEmitter\n */\n\nfunction KeyboardHandler(eventEmitter) {\n  this.eventEmitter = eventEmitter;\n\n  this._handleKeyEvent = this._handleKeyEvent.bind(this);\n\n  document.addEventListener('keydown', this._handleKeyEvent);\n  document.addEventListener('keypress', this._handleKeyEvent);\n  document.addEventListener('keyup', this._handleKeyEvent);\n}\n\n/**\n * Keyboard event handler function.\n *\n * @note Arrow keys only triggered on keydown, not keypress.\n *\n * @param {KeyboardEvent} event\n * @private\n */\n\nKeyboardHandler.prototype._handleKeyEvent = function handleKeyEvent(event) {\n  if (nodes.indexOf(event.target.nodeName) === -1) {\n    if (keys.indexOf(event.type) > -1) {\n      event.preventDefault();\n    }\n\n    if (event.type === 'keydown' || event.type === 'keypress') {\n      switch (event.keyCode) {\n        case SPACE:\n          this.eventEmitter.emit('keyboard.space');\n          break;\n\n        case TAB:\n          this.eventEmitter.emit('keyboard.tab');\n          break;\n      }\n    }\n    else if (event.type === 'keyup') {\n      switch (event.keyCode) {\n        case LEFT_ARROW:\n          if (event.shiftKey) {\n            this.eventEmitter.emit('keyboard.shift_left');\n          }\n          else {\n            this.eventEmitter.emit('keyboard.left');\n          }\n          break;\n\n        case RIGHT_ARROW:\n          if (event.shiftKey) {\n            this.eventEmitter.emit('keyboard.shift_right');\n          }\n          else {\n            this.eventEmitter.emit('keyboard.right');\n          }\n          break;\n      }\n    }\n  }\n};\n\nKeyboardHandler.prototype.destroy = function() {\n  document.removeEventListener('keydown', this._handleKeyEvent);\n  document.removeEventListener('keypress', this._handleKeyEvent);\n  document.removeEventListener('keyup', this._handleKeyEvent);\n};\n\nexport default KeyboardHandler;\n","/**\n * @file\n *\n * Implementation of {@link Player} adapter based on an <code>&lt;audio&gt;</code>\n * or <code>&lt;video&gt;</code> HTML element.\n *\n * @module mediaelement-player\n */\n\n/**\n * Checks whether the given HTMLMediaElement has either a src attribute\n * or any child <code>&lt;source&gt;</code> nodes.\n */\n\nfunction mediaElementHasSource(mediaElement) {\n  if (mediaElement.src) {\n    return true;\n  }\n\n  if (mediaElement.querySelector('source')) {\n    return true;\n  }\n\n  return false;\n}\n\n/**\n * A wrapper for interfacing with the HTMLMediaElement API.\n * Initializes the player for a given media element.\n *\n * @class\n * @alias MediaElementPlayer\n * @param {HTMLMediaElement} mediaElement The HTML <code>&lt;audio&gt;</code>\n *   or <code>&lt;video&gt;</code> element to associate with the\n *   {@link Peaks} instance.\n */\n\nfunction MediaElementPlayer(mediaElement) {\n  this._mediaElement = mediaElement;\n}\n\n/**\n * Adds an event listener to the media element.\n *\n * @private\n * @param {String} type The event type to listen for.\n * @param {Function} callback An event handler function.\n */\n\nMediaElementPlayer.prototype._addMediaListener = function(type, callback) {\n  this._listeners.push({ type: type, callback: callback });\n  this._mediaElement.addEventListener(type, callback);\n};\n\nMediaElementPlayer.prototype.init = function(eventEmitter) {\n  const self = this;\n\n  self._eventEmitter = eventEmitter;\n  self._listeners = [];\n  self._duration = self.getDuration();\n\n  self._addMediaListener('timeupdate', function() {\n    self._eventEmitter.emit('player.timeupdate', self.getCurrentTime());\n  });\n\n  self._addMediaListener('playing', function() {\n    self._eventEmitter.emit('player.playing', self.getCurrentTime());\n  });\n\n  self._addMediaListener('pause', function() {\n    self._eventEmitter.emit('player.pause', self.getCurrentTime());\n  });\n\n  self._addMediaListener('ended', function() {\n    self._eventEmitter.emit('player.ended');\n  });\n\n  self._addMediaListener('seeked', function() {\n    self._eventEmitter.emit('player.seeked', self.getCurrentTime());\n  });\n\n  self._addMediaListener('canplay', function() {\n    self._eventEmitter.emit('player.canplay');\n  });\n\n  self._addMediaListener('error', function(event) {\n    self._eventEmitter.emit('player.error', event.target.error);\n  });\n\n  self._interval = null;\n\n  if (!mediaElementHasSource(self._mediaElement)) {\n    return Promise.resolve();\n  }\n  else if (self._mediaElement.error &&\n           self._mediaElement.error.code === MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED) {\n    // The media element has a source, but the format is not supported.\n    return Promise.reject(self._mediaElement.error);\n  }\n\n  return new Promise(function(resolve, reject) {\n    function eventHandler(event) {\n      self._mediaElement.removeEventListener('loadedmetadata', eventHandler);\n      self._mediaElement.removeEventListener('error', eventHandler);\n\n      if (event.type === 'loadedmetadata') {\n        resolve();\n      }\n      else {\n        reject(event.target.error);\n      }\n    }\n\n    // If the media element has preload=\"none\", clicking to seek in the\n    // waveform won't work, so here we force the media to load.\n    if (self._mediaElement.readyState === HTMLMediaElement.HAVE_NOTHING) {\n      // Wait for the readyState to change to HAVE_METADATA so we know the\n      // duration is valid, otherwise it could be NaN.\n      self._mediaElement.addEventListener('loadedmetadata', eventHandler);\n      self._mediaElement.addEventListener('error', eventHandler);\n      self._mediaElement.load();\n    }\n    else {\n      resolve();\n    }\n  });\n};\n\n/**\n * Cleans up the player object, removing all event listeners from the\n * associated media element.\n */\n\nMediaElementPlayer.prototype.destroy = function() {\n  for (let i = 0; i < this._listeners.length; i++) {\n    const listener = this._listeners[i];\n\n    this._mediaElement.removeEventListener(\n      listener.type,\n      listener.callback\n    );\n  }\n\n  this._listeners.length = 0;\n\n  this._mediaElement = null;\n};\n\nMediaElementPlayer.prototype.play = function() {\n  return this._mediaElement.play();\n};\n\nMediaElementPlayer.prototype.pause = function() {\n  this._mediaElement.pause();\n};\n\nMediaElementPlayer.prototype.isPlaying = function() {\n  return !this._mediaElement.paused;\n};\n\nMediaElementPlayer.prototype.isSeeking = function() {\n  return this._mediaElement.seeking;\n};\n\nMediaElementPlayer.prototype.getCurrentTime = function() {\n  return this._mediaElement.currentTime;\n};\n\nMediaElementPlayer.prototype.getDuration = function() {\n  return this._mediaElement.duration;\n};\n\nMediaElementPlayer.prototype.seek = function(time) {\n  this._mediaElement.currentTime = time;\n};\n\nfunction SetSourceHandler(eventEmitter, mediaElement) {\n  this._eventEmitter = eventEmitter;\n  this._mediaElement = mediaElement;\n  this._playerCanPlayHandler = this._playerCanPlayHandler.bind(this);\n  this._playerErrorHandler = this._playerErrorHandler.bind(this);\n}\n\nSetSourceHandler.prototype.setSource = function(options, callback) {\n  const self = this;\n\n  self._options = options;\n  self._callback = callback;\n\n  self._eventEmitter.on('player.canplay', self._playerCanPlayHandler);\n  self._eventEmitter.on('player.error', self._playerErrorHandler);\n\n  return new Promise(function(resolve, reject) {\n    self._resolve = resolve;\n    self._reject = reject;\n\n    self._eventEmitter.on('player.canplay', self._playerCanPlayHandler);\n    self._eventEmitter.on('player.error', self._playerErrorHandler);\n\n    self._mediaElement.setAttribute('src', options.mediaUrl);\n\n    // Force the media element to load, in case the media element\n    // has preload=\"none\".\n    if (self._mediaElement.readyState === HTMLMediaElement.HAVE_NOTHING) {\n      self._mediaElement.load();\n    }\n  });\n};\n\nSetSourceHandler.prototype._reset = function() {\n  this._eventEmitter.removeListener('player.canplay', this._playerCanPlayHandler);\n  this._eventEmitter.removeListener('player.error', this._playerErrorHandler);\n};\n\nSetSourceHandler.prototype._playerCanPlayHandler = function() {\n  this._reset();\n\n  this._resolve();\n};\n\nSetSourceHandler.prototype._playerErrorHandler = function(err) {\n  this._reset();\n\n  // Return the MediaError object from the media element\n  this._reject(err);\n};\n\nMediaElementPlayer.prototype.setSource = function(options) {\n  if (!options.mediaUrl) {\n    // eslint-disable-next-line @stylistic/js/max-len\n    return Promise.reject(new Error('peaks.setSource(): options must contain a mediaUrl when using mediaElement'));\n  }\n\n  const setSourceHandler = new SetSourceHandler(this._eventEmitter, this._mediaElement);\n\n  return setSourceHandler.setSource(options);\n};\n\nexport default MediaElementPlayer;\n","/**\n * @file\n *\n * A general audio player class which interfaces with external audio players.\n * The default audio player in Peaks.js is {@link MediaElementPlayer}.\n *\n * @module player\n */\n\nimport { isValidTime } from './utils';\n\nfunction getAllPropertiesFrom(adapter) {\n  const allProperties = [];\n  let obj = adapter;\n\n  while (obj) {\n    Object.getOwnPropertyNames(obj).forEach(function(p) {\n      allProperties.push(p);\n    });\n\n    obj = Object.getPrototypeOf(obj);\n  }\n\n  return allProperties;\n}\n\nfunction validateAdapter(adapter) {\n  const publicAdapterMethods = [\n    'init',\n    'destroy',\n    'play',\n    'pause',\n    'isPlaying',\n    'isSeeking',\n    'getCurrentTime',\n    'getDuration',\n    'seek'\n  ];\n\n  const allProperties = getAllPropertiesFrom(adapter);\n\n  publicAdapterMethods.forEach(function(method) {\n    if (!allProperties.includes(method)) {\n      throw new TypeError('Peaks.init(): Player method ' + method + ' is undefined');\n    }\n\n    if ((typeof adapter[method]) !== 'function') {\n      throw new TypeError('Peaks.init(): Player method ' + method + ' is not a function');\n    }\n  });\n}\n\n/**\n * A wrapper for interfacing with an external player API.\n *\n * @class\n * @alias Player\n *\n * @param {Peaks} peaks The parent {@link Peaks} object.\n * @param {Adapter} adapter The player adapter.\n */\n\nfunction Player(peaks, adapter) {\n  this._peaks = peaks;\n\n  this._playingSegment = false;\n  this._segment = null;\n  this._loop = false;\n  this._playSegmentTimerCallback = this._playSegmentTimerCallback.bind(this);\n\n  validateAdapter(adapter);\n  this._adapter = adapter;\n}\n\nPlayer.prototype.init = function() {\n  return this._adapter.init(this._peaks);\n};\n\n/**\n * Cleans up the player object.\n */\n\nPlayer.prototype.destroy = function() {\n  this._adapter.destroy();\n};\n\n/**\n * Starts playback.\n * @returns {Promise}\n */\n\nPlayer.prototype.play = function() {\n  return this._adapter.play();\n};\n\n/**\n * Pauses playback.\n */\n\nPlayer.prototype.pause = function() {\n  this._adapter.pause();\n};\n\n/**\n * @returns {Boolean} <code>true</code> if playing, <code>false</code>\n * otherwise.\n */\n\nPlayer.prototype.isPlaying = function() {\n  return this._adapter.isPlaying();\n};\n\n/**\n * @returns {boolean} <code>true</code> if seeking\n */\n\nPlayer.prototype.isSeeking = function() {\n  return this._adapter.isSeeking();\n};\n\n/**\n * Returns the current playback time position, in seconds.\n *\n * @returns {Number}\n */\n\nPlayer.prototype.getCurrentTime = function() {\n  return this._adapter.getCurrentTime();\n};\n\n/**\n * Returns the media duration, in seconds.\n *\n * @returns {Number}\n */\n\nPlayer.prototype.getDuration = function() {\n  return this._adapter.getDuration();\n};\n\n/**\n * Seeks to a given time position within the media.\n *\n * @param {Number} time The time position, in seconds.\n */\n\nPlayer.prototype.seek = function(time) {\n  if (!isValidTime(time)) {\n    this._peaks._logger('peaks.player.seek(): parameter must be a valid time, in seconds');\n    return;\n  }\n\n  this._adapter.seek(time);\n};\n\n/**\n * Plays the given segment.\n *\n * @param {Segment} segment The segment denoting the time region to play.\n * @param {Boolean} loop If true, playback is looped.\n */\n\nPlayer.prototype.playSegment = function(segment, loop) {\n  const self = this;\n\n  if (!segment ||\n    !isValidTime(segment.startTime) ||\n    !isValidTime(segment.endTime)) {\n    return Promise.reject(\n      new Error('peaks.player.playSegment(): parameter must be a segment object')\n    );\n  }\n\n  self._segment = segment;\n  self._loop = loop;\n\n  // Set audio time to segment start time\n  self.seek(segment.startTime);\n\n  self._peaks.once('player.playing', function() {\n    if (!self._playingSegment) {\n      self._playingSegment = true;\n\n      // We need to use requestAnimationFrame here as the timeupdate event\n      // doesn't fire often enough.\n      window.requestAnimationFrame(self._playSegmentTimerCallback);\n    }\n  });\n\n  // Start playing audio\n  return self.play();\n};\n\nPlayer.prototype._playSegmentTimerCallback = function() {\n  if (!this.isPlaying()) {\n    this._playingSegment = false;\n    return;\n  }\n  else if (this.getCurrentTime() >= this._segment.endTime) {\n    if (this._loop) {\n      this.seek(this._segment.startTime);\n    }\n    else {\n      this.pause();\n      this._peaks.emit('player.ended');\n      this._playingSegment = false;\n      return;\n    }\n  }\n\n  window.requestAnimationFrame(this._playSegmentTimerCallback);\n};\n\nPlayer.prototype._setSource = function(options) {\n  return this._adapter.setSource(options);\n};\n\nexport default Player;\n","/**\n * @file\n *\n * Defines the {@link DefaultPointMarker} class.\n *\n * @module default-point-marker\n */\n\nimport { Line } from 'konva/lib/shapes/Line';\nimport { Rect } from 'konva/lib/shapes/Rect';\nimport { Text } from 'konva/lib/shapes/Text';\n\n/**\n * Creates a point marker handle.\n *\n * @class\n * @alias DefaultPointMarker\n *\n * @param {CreatePointMarkerOptions} options\n */\n\nfunction DefaultPointMarker(options) {\n  this._options = options;\n  this._draggable = options.editable;\n}\n\nDefaultPointMarker.prototype.init = function(group) {\n  const handleWidth  = 10;\n  const handleHeight = 20;\n  const handleX      = -(handleWidth / 2) + 0.5; // Place in the middle of the marker\n\n  // Label\n\n  if (this._options.view === 'zoomview') {\n    // Label - create with default y, the real value is set in fitToView().\n    this._label = new Text({\n      x:          2,\n      y:          0,\n      text:       this._options.point.labelText,\n      textAlign:  'left',\n      fontFamily: this._options.fontFamily || 'sans-serif',\n      fontSize:   this._options.fontSize || 10,\n      fontStyle:  this._options.fontStyle || 'normal',\n      fill:       '#000'\n    });\n  }\n\n  // Handle - create with default y, the real value is set in fitToView().\n\n  this._handle = new Rect({\n    x:       handleX,\n    y:       0,\n    width:   handleWidth,\n    height:  handleHeight,\n    fill:    this._options.color,\n    visible: this._draggable\n  });\n\n  // Line - create with default y and points, the real values\n  // are set in fitToView().\n  this._line = new Line({\n    x:           0,\n    y:           0,\n    stroke:      this._options.color,\n    strokeWidth: 1\n  });\n\n  // Time label - create with default y, the real value is set\n  // in fitToView().\n  this._time = new Text({\n    x:          -24,\n    y:          0,\n    text:       this._options.layer.formatTime(this._options.point.time),\n    fontFamily: this._options.fontFamily,\n    fontSize:   this._options.fontSize,\n    fontStyle:  this._options.fontStyle,\n    fill:       '#000',\n    textAlign:  'center'\n  });\n\n  this._time.hide();\n\n  group.add(this._handle);\n\n  group.add(this._line);\n\n  if (this._label) {\n    group.add(this._label);\n  }\n\n  group.add(this._time);\n\n  this.fitToView();\n\n  this.bindEventHandlers(group);\n};\n\nDefaultPointMarker.prototype.bindEventHandlers = function(group) {\n  const self = this;\n\n  self._handle.on('mouseover touchstart', function() {\n    if (self._draggable) {\n      // Position text to the left of the marker\n      self._time.setX(-24 - self._time.getWidth());\n      self._time.show();\n    }\n  });\n\n  self._handle.on('mouseout touchend', function() {\n    if (self._draggable) {\n      self._time.hide();\n    }\n  });\n\n  group.on('dragstart', function() {\n    self._time.setX(-24 - self._time.getWidth());\n    self._time.show();\n  });\n\n  group.on('dragend', function() {\n    self._time.hide();\n  });\n};\n\nDefaultPointMarker.prototype.fitToView = function() {\n  const height = this._options.layer.getHeight();\n\n  this._line.points([0.5, 0, 0.5, height]);\n\n  if (this._label) {\n    this._label.y(12);\n  }\n\n  if (this._handle) {\n    this._handle.y(height / 2 - 10.5);\n  }\n\n  if (this._time) {\n    this._time.y(height / 2 - 5);\n  }\n};\n\nDefaultPointMarker.prototype.update = function(options) {\n  if (options.time !== undefined) {\n    if (this._time) {\n      this._time.setText(this._options.layer.formatTime(options.time));\n    }\n  }\n\n  if (options.labelText !== undefined) {\n    if (this._label) {\n      this._label.text(options.labelText);\n    }\n  }\n\n  if (options.color !== undefined) {\n    if (this._handle) {\n      this._handle.fill(options.color);\n    }\n\n    this._line.stroke(options.color);\n  }\n\n  if (options.editable !== undefined) {\n    this._draggable = options.editable;\n\n    this._handle.visible(this._draggable);\n  }\n};\n\nexport default DefaultPointMarker;\n","/**\n * @file\n *\n * Defines the {@link DefaultSegmentMarker} class.\n *\n * @module default-segment-marker\n */\n\nimport { Line } from 'konva/lib/shapes/Line';\nimport { Rect } from 'konva/lib/shapes/Rect';\nimport { Text } from 'konva/lib/shapes/Text';\n\n/**\n * Creates a segment marker handle.\n *\n * @class\n * @alias DefaultSegmentMarker\n *\n * @param {CreateSegmentMarkerOptions} options\n */\n\nfunction DefaultSegmentMarker(options) {\n  this._options = options;\n  this._editable = options.editable;\n}\n\nDefaultSegmentMarker.prototype.init = function(group) {\n  const handleWidth  = 10;\n  const handleHeight = 20;\n  const handleX      = -(handleWidth / 2) + 0.5; // Place in the middle of the marker\n\n  const xPosition = this._options.startMarker ? -24 : 24;\n\n  const time = this._options.startMarker ? this._options.segment.startTime :\n                                           this._options.segment.endTime;\n\n  // Label - create with default y, the real value is set in fitToView().\n  this._label = new Text({\n    x:          xPosition,\n    y:          0,\n    text:       this._options.layer.formatTime(time),\n    fontFamily: this._options.fontFamily,\n    fontSize:   this._options.fontSize,\n    fontStyle:  this._options.fontStyle,\n    fill:       '#000',\n    textAlign:  'center',\n    visible:    this._editable\n  });\n\n  this._label.hide();\n\n  // Handle - create with default y, the real value is set in fitToView().\n  this._handle = new Rect({\n    x:           handleX,\n    y:           0,\n    width:       handleWidth,\n    height:      handleHeight,\n    fill:        this._options.color,\n    stroke:      this._options.color,\n    strokeWidth: 1,\n    visible:     this._editable\n  });\n\n  // Vertical Line - create with default y and points, the real values\n  // are set in fitToView().\n  this._line = new Line({\n    x:           0,\n    y:           0,\n    stroke:      this._options.color,\n    strokeWidth: 1,\n    visible:     this._editable\n  });\n\n  group.add(this._label);\n  group.add(this._line);\n  group.add(this._handle);\n\n  this.fitToView();\n\n  this.bindEventHandlers(group);\n};\n\nDefaultSegmentMarker.prototype.bindEventHandlers = function(group) {\n  const self = this;\n\n  const xPosition = self._options.startMarker ? -24 : 24;\n\n  group.on('dragstart', function() {\n    if (self._options.startMarker) {\n      self._label.setX(xPosition - self._label.getWidth());\n    }\n\n    self._label.show();\n  });\n\n  group.on('dragend', function() {\n    self._label.hide();\n  });\n\n  self._handle.on('mouseover touchstart', function() {\n    if (self._options.startMarker) {\n      self._label.setX(xPosition - self._label.getWidth());\n    }\n\n    self._label.show();\n  });\n\n  self._handle.on('mouseout touchend', function() {\n    self._label.hide();\n  });\n};\n\nDefaultSegmentMarker.prototype.fitToView = function() {\n  const height = this._options.layer.getHeight();\n\n  this._label.y(height / 2 - 5);\n  this._handle.y(height / 2 - 10.5);\n  this._line.points([0.5, 0, 0.5, height]);\n};\n\nDefaultSegmentMarker.prototype.update = function(options) {\n  if (options.startTime !== undefined && this._options.startMarker) {\n    this._label.text(this._options.layer.formatTime(options.startTime));\n  }\n\n  if (options.endTime !== undefined && !this._options.startMarker) {\n    this._label.text(this._options.layer.formatTime(options.endTime));\n  }\n\n  if (options.editable !== undefined) {\n    this._editable = options.editable;\n\n    this._label.visible(this._editable);\n    this._handle.visible(this._editable);\n    this._line.visible(this._editable);\n  }\n};\n\nexport default DefaultSegmentMarker;\n","/**\n * @file\n *\n * Factory functions for creating point and segment marker handles.\n *\n * @module marker-factories\n */\n\nimport DefaultPointMarker from './default-point-marker';\nimport DefaultSegmentMarker from './default-segment-marker';\nimport { Text } from 'konva/lib/shapes/Text';\n\n/**\n * Parameters for the {@link createSegmentMarker} function.\n *\n * @typedef {Object} CreateSegmentMarkerOptions\n * @global\n * @property {Segment} segment\n * @property {Boolean} draggable If true, marker is draggable.\n * @property {Boolean} startMarker\n * @property {String} color\n * @property {String} fontFamily\n * @property {Number} fontSize\n * @property {String} fontStyle\n * @property {Layer} layer\n * @property {String} view\n * @property {SegmentDisplayOptions} segmentOptions\n */\n\n/**\n * Creates a left or right side segment marker handle.\n *\n * @param {CreateSegmentMarkerOptions} options\n * @returns {Marker}\n */\n\nexport function createSegmentMarker(options) {\n  if (options.view === 'zoomview') {\n    return new DefaultSegmentMarker(options);\n  }\n\n  return null;\n}\n\n/**\n * Parameters for the {@link createSegmentLabel} function.\n *\n * @typedef {Object} SegmentLabelOptions\n * @global\n * @property {Segment} segment The {@link Segment} object associated with this\n *   label.\n * @property {String} view The name of the view that the label is being\n *   created in, either <code>zoomview</code> or <code>overview</code>.\n * @property {SegmentsLayer} layer\n * @property {String} fontFamily\n * @property {Number} fontSize\n * @property {String} fontStyle\n */\n\n/**\n * Creates a Konva object that renders information about a segment, such as\n * its label text.\n *\n * @param {SegmentLabelOptions} options\n * @returns {Konva.Text}\n */\n\nexport function createSegmentLabel(options) {\n  return new Text({\n    x:          12,\n    y:          12,\n    text:       options.segment.labelText,\n    textAlign:  'center',\n    fontFamily: options.fontFamily || 'sans-serif',\n    fontSize:   options.fontSize || 12,\n    fontStyle:  options.fontStyle || 'normal',\n    fill:       '#000'\n  });\n}\n\n/**\n * Parameters for the {@link createPointMarker} function.\n *\n * @typedef {Object} CreatePointMarkerOptions\n * @global\n * @property {Point} point\n * @property {Boolean} editable If true, marker is draggable.\n * @property {String} color\n * @property {Layer} layer\n * @property {String} view\n * @property {String} fontFamily\n * @property {Number} fontSize\n * @property {String} fontStyle\n */\n\n/**\n * Creates a point marker handle.\n *\n * @param {CreatePointMarkerOptions} options\n * @returns {Marker}\n */\n\nexport function createPointMarker(options) {\n  return new DefaultPointMarker(options);\n}\n","/**\n * @file\n *\n * Defines the {@link HighlightLayer} class.\n *\n * @module highlight-layer\n */\n\nimport Konva from 'konva/lib/Core';\nimport { Rect } from 'konva/lib/shapes/Rect';\n\nimport { clamp } from  './utils';\n\n/**\n * Highlight layer options\n *\n * @typedef {Object} HighlightLayerOptions\n * @global\n * @property {Number} highlightOffset\n * @property {String} highlightColor\n * @property {String} highlightStrokeColor\n * @property {Number} highlightOpacity\n * @property {Number} highlightCornerRadius\n */\n\n/**\n * Creates the highlight region that shows the position of the zoomable\n * waveform view in the overview waveform.\n *\n * @class\n * @alias HighlightLayer\n *\n * @param {WaveformOverview} view\n * @param {HighlightLayerOptions} options\n */\n\nfunction HighlightLayer(view, options) {\n  this._view          = view;\n  this._offset        = options.highlightOffset;\n  this._color         = options.highlightColor;\n  this._layer         = new Konva.Layer({ listening: false });\n  this._highlightRect = null;\n  this._startTime     = null;\n  this._endTime       = null;\n  this._strokeColor   = options.highlightStrokeColor;\n  this._opacity       = options.highlightOpacity;\n  this._cornerRadius  = options.highlightCornerRadius;\n}\n\nHighlightLayer.prototype.addToStage = function(stage) {\n  stage.add(this._layer);\n};\n\nHighlightLayer.prototype.showHighlight = function(startTime, endTime) {\n  if (!this._highlightRect) {\n    this._createHighlightRect(startTime, endTime);\n  }\n\n  this._update(startTime, endTime);\n};\n\n/**\n * Updates the position of the highlight region.\n *\n * @param {Number} startTime The start of the highlight region, in seconds.\n * @param {Number} endTime The end of the highlight region, in seconds.\n */\n\nHighlightLayer.prototype._update = function(startTime, endTime) {\n  this._startTime = startTime;\n  this._endTime = endTime;\n\n  const startOffset = this._view.timeToPixels(startTime);\n  const endOffset   = this._view.timeToPixels(endTime);\n\n  this._highlightRect.setAttrs({\n    x:     startOffset,\n    width: endOffset - startOffset\n  });\n};\n\nHighlightLayer.prototype._createHighlightRect = function(startTime, endTime) {\n  this._startTime = startTime;\n  this._endTime   = endTime;\n\n  const startOffset = this._view.timeToPixels(startTime);\n  const endOffset   = this._view.timeToPixels(endTime);\n\n  // Create with default y and height, the real values are set in fitToView().\n  this._highlightRect = new Rect({\n    x:            startOffset,\n    y:            0,\n    width:        endOffset - startOffset,\n    height:       0,\n    stroke:       this._strokeColor,\n    strokeWidth:  1,\n    fill:         this._color,\n    opacity:      this._opacity,\n    cornerRadius: this._cornerRadius\n  });\n\n  this.fitToView();\n\n  this._layer.add(this._highlightRect);\n};\n\nHighlightLayer.prototype.removeHighlight = function() {\n  if (this._highlightRect) {\n    this._highlightRect.destroy();\n    this._highlightRect = null;\n  }\n};\n\nHighlightLayer.prototype.updateHighlight = function() {\n  if (this._highlightRect) {\n    this._update(this._startTime, this._endTime);\n  }\n};\n\nHighlightLayer.prototype.fitToView = function() {\n  if (this._highlightRect) {\n    const height = this._view.getHeight();\n    const offset = clamp(this._offset, 0, Math.floor(height / 2));\n\n    this._highlightRect.setAttrs({\n      y: offset,\n      height: height - (offset * 2)\n    });\n  }\n};\n\nexport default HighlightLayer;\n","/**\n * @file\n *\n * Defines the {@link PointMarker} class.\n *\n * @module point-marker\n */\n\nimport Konva from 'konva/lib/Core';\n\n/**\n * Parameters for the {@link PointMarker} constructor.\n *\n * @typedef {Object} PointMarkerOptions\n * @global\n * @property {Point} point Point object with timestamp.\n * @property {Boolean} editable If true, marker is draggable.\n * @property {Marker} marker\n * @property {Function} onclick\n * @property {Function} onDblClick\n * @property {Function} onDragStart\n * @property {Function} onDragMove Callback during mouse drag operations.\n * @property {Function} onDragEnd\n * @property {Function} dragBoundFunc\n * @property {Function} onMouseEnter\n * @property {Function} onMouseLeave\n * @property {Function} onContextMenu\n */\n\n/**\n * Creates a point marker handle.\n *\n * @class\n * @alias PointMarker\n *\n * @param {PointMarkerOptions} options\n */\n\nfunction PointMarker(options) {\n  this._point     = options.point;\n  this._marker    = options.marker;\n  this._draggable = options.draggable;\n\n  this._onDragStart   = options.onDragStart;\n  this._onDragMove    = options.onDragMove;\n  this._onDragEnd     = options.onDragEnd;\n  this._dragBoundFunc = options.dragBoundFunc;\n  this._onMouseEnter  = options.onMouseEnter;\n  this._onMouseLeave  = options.onMouseLeave;\n\n  this._group = new Konva.Group({\n    name:          'point-marker',\n    point:         this._point,\n    draggable:     this._draggable,\n    dragBoundFunc: options.dragBoundFunc\n  });\n\n  this._bindDefaultEventHandlers();\n\n  this._marker.init(this._group);\n}\n\nPointMarker.prototype._bindDefaultEventHandlers = function() {\n  const self = this;\n\n  self._group.on('dragstart', function(event) {\n    self._onDragStart(event, self._point);\n  });\n\n  self._group.on('dragmove', function(event) {\n    self._onDragMove(event, self._point);\n  });\n\n  self._group.on('dragend', function(event) {\n    self._onDragEnd(event, self._point);\n  });\n\n  self._group.on('mouseenter', function(event) {\n    self._onMouseEnter(event, self._point);\n  });\n\n  self._group.on('mouseleave', function(event) {\n    self._onMouseLeave(event, self._point);\n  });\n};\n\n/**\n * @param {Konva.Layer} layer\n */\n\nPointMarker.prototype.addToLayer = function(layer) {\n  layer.add(this._group);\n};\n\nPointMarker.prototype.fitToView = function() {\n  this._marker.fitToView();\n};\n\nPointMarker.prototype.getPoint = function() {\n  return this._point;\n};\n\nPointMarker.prototype.getX = function() {\n  return this._group.getX();\n};\n\nPointMarker.prototype.setX = function(x) {\n  this._group.setX(x);\n};\n\nPointMarker.prototype.getWidth = function() {\n  return this._group.getWidth();\n};\n\nPointMarker.prototype.getAbsolutePosition = function() {\n  return this._group.getAbsolutePosition();\n};\n\nPointMarker.prototype.update = function(options) {\n  if (options.editable !== undefined) {\n    this._group.draggable(options.editable);\n  }\n\n  if (this._marker.update) {\n    this._marker.update(options);\n  }\n};\n\nPointMarker.prototype.destroy = function() {\n  if (this._marker.destroy) {\n    this._marker.destroy();\n  }\n\n  this._group.destroyChildren();\n  this._group.destroy();\n};\n\nexport default PointMarker;\n","/**\n * @file\n *\n * Defines the {@link PointsLayer} class.\n *\n * @module points-layer\n */\n\nimport PointMarker from './point-marker';\nimport { clamp, objectHasProperty } from './utils';\nimport Konva from 'konva/lib/Core';\n\n/**\n * Creates a Konva.Layer that displays point markers against the audio\n * waveform.\n *\n * @class\n * @alias PointsLayer\n *\n * @param {Peaks} peaks\n * @param {WaveformOverview|WaveformZoomView} view\n * @param {Boolean} enableEditing\n */\n\nfunction PointsLayer(peaks, view, enableEditing) {\n  this._peaks         = peaks;\n  this._view          = view;\n  this._enableEditing = enableEditing;\n  this._pointMarkers  = {};\n  this._layer         = new Konva.Layer();\n\n  this._onPointsDrag = this._onPointsDrag.bind(this);\n\n  this._onPointMarkerDragStart   = this._onPointMarkerDragStart.bind(this);\n  this._onPointMarkerDragMove    = this._onPointMarkerDragMove.bind(this);\n  this._onPointMarkerDragEnd     = this._onPointMarkerDragEnd.bind(this);\n  this._pointMarkerDragBoundFunc = this._pointMarkerDragBoundFunc.bind(this);\n  this._onPointMarkerMouseEnter  = this._onPointMarkerMouseEnter.bind(this);\n  this._onPointMarkerMouseLeave  = this._onPointMarkerMouseLeave.bind(this);\n\n  this._onPointsUpdate    = this._onPointsUpdate.bind(this);\n  this._onPointsAdd       = this._onPointsAdd.bind(this);\n  this._onPointsRemove    = this._onPointsRemove.bind(this);\n  this._onPointsRemoveAll = this._onPointsRemoveAll.bind(this);\n\n  this._peaks.on('points.update', this._onPointsUpdate);\n  this._peaks.on('points.add', this._onPointsAdd);\n  this._peaks.on('points.remove', this._onPointsRemove);\n  this._peaks.on('points.remove_all', this._onPointsRemoveAll);\n\n  this._peaks.on('points.dragstart', this._onPointsDrag);\n  this._peaks.on('points.dragmove', this._onPointsDrag);\n  this._peaks.on('points.dragend', this._onPointsDrag);\n}\n\n/**\n * Adds the layer to the given {Konva.Stage}.\n *\n * @param {Konva.Stage} stage\n */\n\nPointsLayer.prototype.addToStage = function(stage) {\n  stage.add(this._layer);\n};\n\nPointsLayer.prototype.setListening = function(listening) {\n  this._layer.listening(listening);\n};\n\nPointsLayer.prototype.enableEditing = function(enable) {\n  this._enableEditing = enable;\n};\n\nPointsLayer.prototype.getPointMarker = function(point) {\n  return this._pointMarkers[point.pid];\n};\n\nPointsLayer.prototype.formatTime = function(time) {\n  return this._view.formatTime(time);\n};\n\nPointsLayer.prototype._onPointsUpdate = function(point, options) {\n  const frameStartTime = this._view.getStartTime();\n  const frameEndTime   = this._view.getEndTime();\n\n  const pointMarker = this.getPointMarker(point);\n  const isVisible = point.isVisible(frameStartTime, frameEndTime);\n\n  if (pointMarker && !isVisible) {\n    // Remove point marker that is no longer visible.\n    this._removePoint(point);\n  }\n  else if (!pointMarker && isVisible) {\n    // Add point marker for visible point.\n    this._updatePoint(point);\n  }\n  else if (pointMarker && isVisible) {\n    // Update the point marker with the changed attributes.\n    if (objectHasProperty(options, 'time')) {\n      const pointMarkerOffset = this._view.timeToPixels(point.time);\n\n      const pointMarkerX = pointMarkerOffset - this._view.getFrameOffset();\n\n      pointMarker.setX(pointMarkerX);\n    }\n\n    pointMarker.update(options);\n  }\n};\n\nPointsLayer.prototype._onPointsAdd = function(event) {\n  const self = this;\n\n  const frameStartTime = self._view.getStartTime();\n  const frameEndTime   = self._view.getEndTime();\n\n  event.points.forEach(function(point) {\n    if (point.isVisible(frameStartTime, frameEndTime)) {\n      self._updatePoint(point);\n    }\n  });\n};\n\nPointsLayer.prototype._onPointsRemove = function(event) {\n  const self = this;\n\n  event.points.forEach(function(point) {\n    self._removePoint(point);\n  });\n};\n\nPointsLayer.prototype._onPointsRemoveAll = function() {\n  this._layer.removeChildren();\n  this._pointMarkers = {};\n};\n\n/**\n * Creates the Konva UI objects for a given point.\n *\n * @private\n * @param {Point} point\n * @returns {PointMarker}\n */\n\nPointsLayer.prototype._createPointMarker = function(point) {\n  const editable = this._enableEditing && point.editable;\n  const viewOptions = this._view.getViewOptions();\n\n  const marker = this._peaks.options.createPointMarker({\n    point:      point,\n    editable:   editable,\n    color:      point.color,\n    fontFamily: viewOptions.fontFamily,\n    fontSize:   viewOptions.fontSize,\n    fontStyle:  viewOptions.fontStyle,\n    layer:      this,\n    view:       this._view.getName()\n  });\n\n  return new PointMarker({\n    point:         point,\n    draggable:     editable,\n    marker:        marker,\n    onDragStart:   this._onPointMarkerDragStart,\n    onDragMove:    this._onPointMarkerDragMove,\n    onDragEnd:     this._onPointMarkerDragEnd,\n    dragBoundFunc: this._pointMarkerDragBoundFunc,\n    onMouseEnter:  this._onPointMarkerMouseEnter,\n    onMouseLeave:  this._onPointMarkerMouseLeave\n  });\n};\n\nPointsLayer.prototype.getHeight = function() {\n  return this._view.getHeight();\n};\n\n/**\n * Adds a Konva UI object to the layer for a given point.\n *\n * @private\n * @param {Point} point\n * @returns {PointMarker}\n */\n\nPointsLayer.prototype._addPointMarker = function(point) {\n  const pointMarker = this._createPointMarker(point);\n\n  this._pointMarkers[point.pid] = pointMarker;\n\n  pointMarker.addToLayer(this._layer);\n\n  return pointMarker;\n};\n\nPointsLayer.prototype._onPointsDrag = function(event) {\n  const pointMarker = this._updatePoint(event.point);\n\n  pointMarker.update({ time: event.point.time });\n};\n\n/**\n * @param {KonvaEventObject} event\n * @param {Point} point\n */\n\nPointsLayer.prototype._onPointMarkerMouseEnter = function(event, point) {\n  this._peaks.emit('points.mouseenter', {\n    point: point,\n    evt: event.evt\n  });\n};\n\n/**\n * @param {KonvaEventObject} event\n * @param {Point} point\n */\n\nPointsLayer.prototype._onPointMarkerMouseLeave = function(event, point) {\n  this._peaks.emit('points.mouseleave', {\n    point: point,\n    evt: event.evt\n  });\n};\n\n/**\n * @param {KonvaEventObject} event\n * @param {Point} point\n */\n\nPointsLayer.prototype._onPointMarkerDragStart = function(event, point) {\n  this._dragPointMarker = this.getPointMarker(point);\n\n  this._peaks.emit('points.dragstart', {\n    point: point,\n    evt: event.evt\n  });\n};\n\n/**\n * @param {KonvaEventObject} event\n * @param {Point} point\n */\n\nPointsLayer.prototype._onPointMarkerDragMove = function(event, point) {\n  const pointMarker = this._pointMarkers[point.pid];\n\n  const markerX = pointMarker.getX();\n\n  const offset = markerX + pointMarker.getWidth();\n\n  point._setTime(this._view.pixelOffsetToTime(offset));\n\n  this._peaks.emit('points.dragmove', {\n    point: point,\n    evt: event.evt\n  });\n};\n\n/**\n * @param {KonvaEventObject} event\n * @param {Point} point\n */\n\nPointsLayer.prototype._onPointMarkerDragEnd = function(event, point) {\n  this._dragPointMarker = null;\n\n  this._peaks.emit('points.dragend', {\n    point: point,\n    evt: event.evt\n  });\n};\n\nPointsLayer.prototype._pointMarkerDragBoundFunc = function(pos) {\n  // Allow the marker to be moved horizontally but not vertically.\n  return {\n    x: clamp(pos.x, 0, this._view.getWidth()),\n    y: this._dragPointMarker.getAbsolutePosition().y\n  };\n};\n\n/**\n * Updates the positions of all displayed points in the view.\n *\n * @param {Number} startTime The start of the visible range in the view,\n *   in seconds.\n * @param {Number} endTime The end of the visible range in the view,\n *   in seconds.\n */\n\nPointsLayer.prototype.updatePoints = function(startTime, endTime) {\n  // Update all points in the visible time range.\n  const points = this._peaks.points.find(startTime, endTime);\n\n  points.forEach(this._updatePoint.bind(this));\n\n  // TODO: In the overview all points are visible, so no need to do this.\n  this._removeInvisiblePoints(startTime, endTime);\n};\n\n/**\n * @private\n * @param {Point} point\n */\n\nPointsLayer.prototype._updatePoint = function(point) {\n  let pointMarker = this.getPointMarker(point);\n\n  if (!pointMarker) {\n    pointMarker = this._addPointMarker(point);\n  }\n\n  const pointMarkerOffset = this._view.timeToPixels(point.time);\n  const pointMarkerX = pointMarkerOffset - this._view.getFrameOffset();\n\n  pointMarker.setX(pointMarkerX);\n\n  return pointMarker;\n};\n\n/**\n * Remove any points that are not visible, i.e., are outside the given time\n * range.\n *\n * @private\n * @param {Number} startTime The start of the visible time range, in seconds.\n * @param {Number} endTime The end of the visible time range, in seconds.\n */\n\nPointsLayer.prototype._removeInvisiblePoints = function(startTime, endTime) {\n  for (const pointPid in this._pointMarkers) {\n    if (objectHasProperty(this._pointMarkers, pointPid)) {\n      const point = this._pointMarkers[pointPid].getPoint();\n\n      if (!point.isVisible(startTime, endTime)) {\n        this._removePoint(point);\n      }\n    }\n  }\n};\n\n/**\n * Removes the UI object for a given point.\n *\n * @private\n * @param {Point} point\n */\n\nPointsLayer.prototype._removePoint = function(point) {\n  const pointMarker = this.getPointMarker(point);\n\n  if (pointMarker) {\n    pointMarker.destroy();\n    delete this._pointMarkers[point.pid];\n  }\n};\n\n/**\n * Toggles visibility of the points layer.\n *\n * @param {Boolean} visible\n */\n\nPointsLayer.prototype.setVisible = function(visible) {\n  this._layer.setVisible(visible);\n};\n\nPointsLayer.prototype.destroy = function() {\n  this._peaks.off('points.update', this._onPointsUpdate);\n  this._peaks.off('points.add', this._onPointsAdd);\n  this._peaks.off('points.remove', this._onPointsRemove);\n  this._peaks.off('points.remove_all', this._onPointsRemoveAll);\n  this._peaks.off('points.dragstart', this._onPointsDrag);\n  this._peaks.off('points.dragmove', this._onPointsDrag);\n  this._peaks.off('points.dragend', this._onPointsDrag);\n};\n\nPointsLayer.prototype.fitToView = function() {\n  for (const pointPid in this._pointMarkers) {\n    if (objectHasProperty(this._pointMarkers, pointPid)) {\n      const pointMarker = this._pointMarkers[pointPid];\n\n      pointMarker.fitToView();\n    }\n  }\n};\n\nPointsLayer.prototype.draw = function() {\n  this._layer.draw();\n};\n\nexport default PointsLayer;\n","/**\n * @file\n *\n * Defines the {@link PlayheadLayer} class.\n *\n * @module playhead-layer\n */\n\nimport Konva from 'konva/lib/Core';\nimport { Animation } from 'konva/lib/Animation';\nimport { Line } from 'konva/lib/shapes/Line';\nimport { Text } from 'konva/lib/shapes/Text';\n\n/**\n * Creates a Konva.Layer that displays a playhead marker.\n *\n * @class\n * @alias PlayheadLayer\n *\n * @param {Player} player\n * @param {WaveformOverview|WaveformZoomView} view\n * @param {Object} options\n * @param {Boolean} options.showPlayheadTime If <code>true</code> The playback time position\n *   is shown next to the playhead.\n * @param {String} options.playheadColor\n * @param {String} options.playheadTextColor\n * @param {String} options.playheadBackgroundColor\n * @param {Number} options.playheadPadding\n * @param {Number} options.playheadWidth\n * @param {String} options.playheadFontFamily\n * @param {Number} options.playheadFontSize\n * @param {String} options.playheadFontStyle\n */\n\nfunction PlayheadLayer(player, view, options) {\n  this._player = player;\n  this._view = view;\n  this._playheadPixel = 0;\n  this._playheadLineAnimation = null;\n  this._playheadVisible = false;\n  this._playheadColor = options.playheadColor;\n  this._playheadTextColor = options.playheadTextColor;\n  this._playheadBackgroundColor = options.playheadBackgroundColor;\n  this._playheadPadding = options.playheadPadding;\n  this._playheadWidth = options.playheadWidth;\n\n  this._playheadFontFamily = options.playheadFontFamily;\n  this._playheadFontSize = options.playheadFontSize;\n  this._playheadFontStyle = options.playheadFontStyle;\n\n  this._playheadLayer = new Konva.Layer({ listening: false });\n\n  this._createPlayhead();\n\n  if (options.showPlayheadTime) {\n    this._createPlayheadText();\n  }\n\n  this.fitToView();\n\n  this.zoomLevelChanged();\n}\n\n/**\n * Adds the layer to the given {Konva.Stage}.\n *\n * @param {Konva.Stage} stage\n */\n\nPlayheadLayer.prototype.addToStage = function(stage) {\n  stage.add(this._playheadLayer);\n};\n\n/**\n * Decides whether to use an animation to update the playhead position.\n *\n * If the zoom level is such that the number of pixels per second of audio is\n * low, we can use timeupdate events from the HTMLMediaElement to\n * set the playhead position. Otherwise, we use an animation to update the\n * playhead position more smoothly. The animation is CPU intensive, so we\n * avoid using it where possible.\n */\n\nPlayheadLayer.prototype.zoomLevelChanged = function() {\n  const pixelsPerSecond = this._view.timeToPixels(1.0);\n\n  this._useAnimation = pixelsPerSecond >= 5;\n\n  if (this._useAnimation) {\n    if (this._player.isPlaying() && !this._playheadLineAnimation) {\n      // Start the animation\n      this._start();\n    }\n  }\n  else {\n    if (this._playheadLineAnimation) {\n      // Stop the animation\n      const time = this._player.getCurrentTime();\n\n      this.stop(time);\n    }\n  }\n};\n\n/**\n * Resizes the playhead UI objects to fit the available space in the\n * view.\n */\n\nPlayheadLayer.prototype.fitToView = function() {\n  const height = this._view.getHeight();\n\n  this._playheadLine.points([0.5, 0, 0.5, height]);\n\n  if (this._playheadText) {\n    this._playheadText.y(12);\n  }\n};\n\n/**\n * Creates the playhead UI objects.\n *\n * @private\n * @param {String} color\n */\n\nPlayheadLayer.prototype._createPlayhead = function() {\n  // Create with default points, the real values are set in fitToView().\n  this._playheadLine = new Line({\n    stroke:      this._playheadColor,\n    strokeWidth: this._playheadWidth\n  });\n\n  this._playheadGroup = new Konva.Group({\n    x: 0,\n    y: 0\n  });\n\n  this._playheadGroup.add(this._playheadLine);\n  this._playheadLayer.add(this._playheadGroup);\n};\n\nPlayheadLayer.prototype._createPlayheadText = function() {\n  const self = this;\n\n  const time = self._player.getCurrentTime();\n  const text = self._view.formatTime(time);\n\n  // Create with default y, the real value is set in fitToView().\n  self._playheadText = new Text({\n    x: 0,\n    y: 0,\n    padding: self._playheadPadding,\n    text: text,\n    fontSize: self._playheadFontSize,\n    fontFamily: self._playheadFontFamily,\n    fontStyle: self._playheadFontStyle,\n    fill: self._playheadTextColor,\n    align: 'right',\n    sceneFunc: function(context, shape) {\n      const width = shape.width();\n      const height = shape.height() + 2 * self._playheadPadding;\n\n      context.fillStyle = self._playheadBackgroundColor;\n      context.fillRect(0, -self._playheadPadding, width, height);\n      shape._sceneFunc(context);\n    }\n  });\n\n  self._playheadGroup.add(self._playheadText);\n};\n\n/**\n * Updates the playhead position.\n *\n * @param {Number} time Current playhead position, in seconds.\n */\n\nPlayheadLayer.prototype.updatePlayheadTime = function(time) {\n  this._syncPlayhead(time);\n\n  if (this._player.isPlaying()) {\n    this._start();\n  }\n};\n\n/**\n * Updates the playhead position.\n *\n * @private\n * @param {Number} time Current playhead position, in seconds.\n */\n\nPlayheadLayer.prototype._syncPlayhead = function(time) {\n  const pixelIndex = this._view.timeToPixels(time);\n\n  const frameOffset = this._view.getFrameOffset();\n  const width = this._view.getWidth();\n\n  const isVisible = (pixelIndex >= frameOffset) &&\n                    (pixelIndex <= frameOffset + width);\n\n  this._playheadPixel = pixelIndex;\n\n  if (isVisible) {\n    const playheadX = this._playheadPixel - frameOffset;\n\n    if (!this._playheadVisible) {\n      this._playheadVisible = true;\n      this._playheadGroup.show();\n    }\n\n    this._playheadGroup.setX(playheadX);\n\n    if (this._playheadText) {\n      const text = this._view.formatTime(time);\n      const playheadTextWidth = this._playheadText.width();\n\n      this._playheadText.setText(text);\n\n      if (playheadTextWidth + playheadX > width - 2) {\n        this._playheadText.setX(-playheadTextWidth);\n      }\n      else if (playheadTextWidth + playheadX < width) {\n        this._playheadText.setX(0);\n      }\n    }\n  }\n  else {\n    if (this._playheadVisible) {\n      this._playheadVisible = false;\n      this._playheadGroup.hide();\n    }\n  }\n\n  if (this._view.playheadPosChanged) {\n    this._view.playheadPosChanged(time);\n  }\n};\n\n/**\n * Starts a playhead animation in sync with the media playback.\n *\n * @private\n */\n\nPlayheadLayer.prototype._start = function() {\n  const self = this;\n\n  if (self._playheadLineAnimation) {\n    self._playheadLineAnimation.stop();\n    self._playheadLineAnimation = null;\n  }\n\n  if (!self._useAnimation) {\n    return;\n  }\n\n  let lastPlayheadPosition = null;\n\n  self._playheadLineAnimation = new Animation(function() {\n    const time = self._player.getCurrentTime();\n    const playheadPosition = self._view.timeToPixels(time);\n\n    if (playheadPosition !== lastPlayheadPosition) {\n      self._syncPlayhead(time);\n      lastPlayheadPosition = playheadPosition;\n    }\n  }, self._playheadLayer);\n\n  self._playheadLineAnimation.start();\n};\n\nPlayheadLayer.prototype.stop = function(time) {\n  if (this._playheadLineAnimation) {\n    this._playheadLineAnimation.stop();\n    this._playheadLineAnimation = null;\n  }\n\n  this._syncPlayhead(time);\n};\n\nPlayheadLayer.prototype.getPlayheadPixel = function() {\n  return this._playheadPixel;\n};\n\nPlayheadLayer.prototype.showPlayheadTime = function(show) {\n  if (show) {\n    if (!this._playheadText) {\n      // Create it\n      this._createPlayheadText(this._playheadTextColor,\n        this._playheadBackgroundColor, this._playheadPadding);\n      this.fitToView();\n    }\n  }\n  else {\n    if (this._playheadText) {\n      this._playheadText.remove();\n      this._playheadText.destroy();\n      this._playheadText = null;\n    }\n  }\n};\n\nPlayheadLayer.prototype.updatePlayheadText = function() {\n  if (this._playheadText) {\n    const time = this._player.getCurrentTime();\n    const text = this._view.formatTime(time);\n\n    this._playheadText.setText(text);\n  }\n};\n\nPlayheadLayer.prototype.destroy = function() {\n  if (this._playheadLineAnimation) {\n    this._playheadLineAnimation.stop();\n    this._playheadLineAnimation = null;\n  }\n};\n\nexport default PlayheadLayer;\n","/**\n * @file\n *\n * Defines the {@link OverlaySegmentMarker} class.\n *\n * @module overlay-segment-marker\n */\n\nimport { Rect } from 'konva/lib/shapes/Rect';\nimport { Text } from 'konva/lib/shapes/Text';\n\nimport { clamp } from './utils';\n\n/**\n * Creates a segment marker handle.\n *\n * @class\n * @alias OverlaySegmentMarker\n *\n * @param {CreateSegmentMarkerOptions} options\n */\n\nfunction OverlaySegmentMarker(options) {\n  this._options = options;\n}\n\nOverlaySegmentMarker.prototype.init = function(group) {\n  const handleWidth  = 10;\n  const handleHeight = 20;\n  const handleX      = -(handleWidth / 2) + 0.5; // Place in the middle of the marker\n\n  const xPosition = this._options.startMarker ? -24 : 24;\n\n  const time = this._options.startMarker ? this._options.segment.startTime :\n                                           this._options.segment.endTime;\n\n  // Label - create with default y, the real value is set in fitToView().\n  this._label = new Text({\n    x:          xPosition,\n    y:          0,\n    text:       this._options.layer.formatTime(time),\n    fontFamily: this._options.fontFamily,\n    fontSize:   this._options.fontSize,\n    fontStyle:  this._options.fontStyle,\n    fill:       '#000',\n    textAlign:  'center',\n    visible:    false\n  });\n\n  // Handle - create with default y, the real value is set in fitToView().\n  this._handle = new Rect({\n    x:       handleX,\n    y:       0,\n    width:   handleWidth,\n    height:  handleHeight\n  });\n\n  group.add(this._label);\n  group.add(this._handle);\n\n  this.fitToView();\n\n  this.bindEventHandlers(group);\n};\n\nOverlaySegmentMarker.prototype.bindEventHandlers = function(group) {\n  const self = this;\n\n  const xPosition = self._options.startMarker ? -24 : 24;\n\n  group.on('dragstart', function() {\n    if (self._options.startMarker) {\n      self._label.setX(xPosition - self._label.getWidth());\n    }\n\n    self._label.show();\n  });\n\n  group.on('dragend', function() {\n    self._label.hide();\n  });\n\n  self._handle.on('mouseover touchstart', function() {\n    if (self._options.startMarker) {\n      self._label.setX(xPosition - self._label.getWidth());\n    }\n\n    self._label.show();\n\n    document.body.style.cursor = 'ew-resize';\n  });\n\n  self._handle.on('mouseout touchend', function() {\n    self._label.hide();\n\n    document.body.style.cursor = 'default';\n  });\n};\n\nOverlaySegmentMarker.prototype.fitToView = function() {\n  const viewHeight = this._options.layer.getHeight();\n\n  const overlayOffset = this._options.segmentOptions.overlayOffset;\n  const overlayRectHeight = clamp(0, viewHeight - 2 * overlayOffset);\n\n  this._label.y(viewHeight / 2 - 5);\n  this._handle.y(overlayOffset);\n  this._handle.height(overlayRectHeight);\n};\n\nOverlaySegmentMarker.prototype.update = function(options) {\n  if (options.startTime !== undefined && this._options.startMarker) {\n    this._label.text(this._options.layer.formatTime(options.startTime));\n  }\n\n  if (options.endTime !== undefined && !this._options.startMarker) {\n    this._label.text(this._options.layer.formatTime(options.endTime));\n  }\n};\n\nexport default OverlaySegmentMarker;\n","/**\n * @file\n *\n * Defines the {@link SegmentMarker} class.\n *\n * @module segment-marker\n */\n\nimport Konva from 'konva/lib/Core';\n\n/**\n * Parameters for the {@link SegmentMarker} constructor.\n *\n * @typedef {Object} SegmentMarkerOptions\n * @global\n * @property {Segment} segment\n * @property {SegmentShape} segmentShape\n * @property {Boolean} editable If true, marker is draggable.\n * @property {Boolean} startMarker If <code>true</code>, the marker indicates\n *   the start time of the segment. If <code>false</code>, the marker\n *   indicates the end time of the segment.\n * @property {Function} onDragStart\n * @property {Function} onDragMove\n * @property {Function} onDragEnd\n * @property {Function} dragBoundFunc\n */\n\n/**\n * Creates a segment handle marker for the start or end of a segment.\n *\n * @class\n * @alias SegmentMarker\n *\n * @param {SegmentMarkerOptions} options\n */\n\nfunction SegmentMarker(options) {\n  const self = this;\n\n  self._segment      = options.segment;\n  self._marker       = options.marker;\n  self._segmentShape = options.segmentShape;\n  self._editable     = options.editable;\n  self._startMarker  = options.startMarker;\n\n  self._onClick      = options.onClick;\n  self._onDragStart  = options.onDragStart;\n  self._onDragMove   = options.onDragMove;\n  self._onDragEnd    = options.onDragEnd;\n\n  self._group = new Konva.Group({\n    name:          'segment-marker',\n    segment:       self._segment,\n    draggable:     self._editable,\n    visible:       self._editable,\n    dragBoundFunc: function(pos) {\n      return options.dragBoundFunc(self, pos);\n    }\n  });\n\n  self._bindDefaultEventHandlers();\n\n  self._marker.init(self._group);\n}\n\nSegmentMarker.prototype._bindDefaultEventHandlers = function() {\n  const self = this;\n\n  self._group.on('click', function(event) {\n    self._onClick(self, event);\n  });\n\n  self._group.on('dragstart', function(event) {\n    self._onDragStart(self, event);\n  });\n\n  self._group.on('dragmove', function(event) {\n    self._onDragMove(self, event);\n  });\n\n  self._group.on('dragend', function(event) {\n    self._onDragEnd(self, event);\n  });\n};\n\nSegmentMarker.prototype.addToLayer = function(layer) {\n  layer.add(this._group);\n};\n\nSegmentMarker.prototype.moveToTop = function() {\n  this._group.moveToTop();\n};\n\nSegmentMarker.prototype.fitToView = function() {\n  this._marker.fitToView();\n};\n\nSegmentMarker.prototype.getSegment = function() {\n  return this._segment;\n};\n\nSegmentMarker.prototype.getX = function() {\n  return this._group.getX();\n};\n\nSegmentMarker.prototype.setX = function(x) {\n  this._group.setX(x);\n};\n\nSegmentMarker.prototype.getWidth = function() {\n  return this._group.getWidth();\n};\n\nSegmentMarker.prototype.getAbsolutePosition = function() {\n  return this._group.getAbsolutePosition();\n};\n\nSegmentMarker.prototype.isStartMarker = function() {\n  return this._startMarker;\n};\n\nSegmentMarker.prototype.update = function(options) {\n  if (options.editable !== undefined) {\n    this._group.visible(options.editable);\n    this._group.draggable(options.editable);\n  }\n\n  if (this._marker.update) {\n    this._marker.update(options);\n  }\n};\n\nSegmentMarker.prototype.destroy = function() {\n  if (this._marker.destroy) {\n    this._marker.destroy();\n  }\n\n  this._group.destroyChildren();\n  this._group.destroy();\n};\n\nSegmentMarker.prototype.startDrag = function() {\n  this._group.startDrag();\n};\n\nSegmentMarker.prototype.stopDrag = function() {\n  this._group.stopDrag();\n};\n\nexport default SegmentMarker;\n","/**\n * @file\n *\n * Defines the {@link WaveformShape} class.\n *\n * @module waveform-shape\n */\n\nimport { clamp, isLinearGradientColor, isString } from './utils';\nimport Konva from 'konva/lib/Core';\n\n/**\n * Waveform shape options.\n *\n * @typedef {Object} WaveformShapeOptions\n * @global\n * @property {String | LinearGradientColor} color Waveform color.\n * @property {WaveformOverview|WaveformZoomView} view The view object\n *   that contains the waveform shape.\n * @property {Segment?} segment If given, render a waveform image\n *   covering the segment's time range. Otherwise, render the entire\n *   waveform duration.\n */\n\n/**\n * Creates a Konva.Shape object that renders a waveform image.\n *\n * @class\n * @alias WaveformShape\n *\n * @param {WaveformShapeOptions} options\n */\n\nfunction WaveformShape(options) {\n  this._color = options.color;\n\n  const shapeOptions = {};\n\n  if (isString(options.color)) {\n    shapeOptions.fill = options.color;\n  }\n  else if (isLinearGradientColor(options.color)) {\n    const startY = options.view._height * (options.color.linearGradientStart / 100);\n    const endY = options.view._height * (options.color.linearGradientEnd / 100);\n\n    shapeOptions.fillLinearGradientStartPointY = startY;\n    shapeOptions.fillLinearGradientEndPointY = endY;\n    shapeOptions.fillLinearGradientColorStops = [\n      0, options.color.linearGradientColorStops[0],\n      1, options.color.linearGradientColorStops[1]\n    ];\n  }\n  else {\n    throw new TypeError('Unknown type for color property');\n  }\n\n  this._shape = new Konva.Shape(shapeOptions);\n  this._view = options.view;\n  this._segment = options.segment;\n\n  this._shape.sceneFunc(this._sceneFunc.bind(this));\n}\n\nWaveformShape.prototype.getX = function() {\n  return this._shape.getX();\n};\n\nWaveformShape.prototype.setX = function(x) {\n  return this._shape.setX(x);\n};\n\nWaveformShape.prototype.setSegment = function(segment) {\n  this._segment = segment;\n};\n\nWaveformShape.prototype.setWaveformColor = function(color) {\n  if (isString(color)) {\n    this._shape.fill(color);\n\n    this._shape.fillLinearGradientStartPointY(null);\n    this._shape.fillLinearGradientEndPointY(null);\n    this._shape.fillLinearGradientColorStops(null);\n  }\n  else if (isLinearGradientColor(color)) {\n    this._shape.fill(null);\n\n    const startY = this._view._height * (color.linearGradientStart / 100);\n    const endY = this._view._height * (color.linearGradientEnd / 100);\n\n    this._shape.fillLinearGradientStartPointY(startY);\n    this._shape.fillLinearGradientEndPointY(endY);\n    this._shape.fillLinearGradientColorStops([\n      0, color.linearGradientColorStops[0],\n      1, color.linearGradientColorStops[1]\n    ]);\n  }\n  else {\n    throw new TypeError('Unknown type for color property');\n  }\n};\n\nWaveformShape.prototype.fitToView = function() {\n  this.setWaveformColor(this._color);\n};\n\nWaveformShape.prototype._sceneFunc = function(context) {\n  const frameOffset = this._view.getFrameOffset();\n  const width = this._view.getWidth();\n  const height = this._view.getHeight();\n\n  this._drawWaveform(\n    context,\n    this._view.getWaveformData(),\n    frameOffset,\n    this._segment ? this._view.timeToPixels(this._segment.startTime) : frameOffset,\n    this._segment ? this._view.timeToPixels(this._segment.endTime)   : frameOffset + width,\n    width,\n    height\n  );\n};\n\n/**\n * Draws a waveform on a canvas context.\n *\n * @param {Konva.Context} context The canvas context to draw on.\n * @param {WaveformData} waveformData The waveform data to draw.\n * @param {Number} frameOffset The start position of the waveform shown\n *   in the view, in pixels.\n * @param {Number} startPixels The start position of the waveform to draw,\n *   in pixels.\n * @param {Number} endPixels The end position of the waveform to draw,\n *   in pixels.\n * @param {Number} width The width of the waveform area, in pixels.\n * @param {Number} height The height of the waveform area, in pixels.\n */\n\nWaveformShape.prototype._drawWaveform = function(context, waveformData,\n    frameOffset, startPixels, endPixels, width, height) {\n  if (startPixels < frameOffset) {\n    startPixels = frameOffset;\n  }\n\n  const limit = frameOffset + width;\n\n  if (endPixels > limit) {\n    endPixels = limit;\n  }\n\n  if (endPixels > waveformData.length - 1) {\n    endPixels = waveformData.length - 1;\n  }\n\n  const channels = waveformData.channels;\n\n  let waveformTop = 0;\n  let waveformHeight = Math.floor(height / channels);\n\n  for (let i = 0; i < channels; i++) {\n    if (i === channels - 1) {\n      waveformHeight = height - (channels - 1) * waveformHeight;\n    }\n\n    this._drawChannel(\n      context,\n      waveformData.channel(i),\n      frameOffset,\n      startPixels,\n      endPixels,\n      waveformTop,\n      waveformHeight\n    );\n\n    waveformTop += waveformHeight;\n  }\n};\n\n/**\n * Draws a single waveform channel on a canvas context.\n *\n * @param {Konva.Context} context The canvas context to draw on.\n * @param {WaveformDataChannel} channel The waveform data to draw.\n * @param {Number} frameOffset The start position of the waveform shown\n *   in the view, in pixels.\n * @param {Number} startPixels The start position of the waveform to draw,\n *   in pixels.\n * @param {Number} endPixels The end position of the waveform to draw,\n *   in pixels.\n * @param {Number} top The top of the waveform channel area, in pixels.\n * @param {Number} height The height of the waveform channel area, in pixels.\n */\n\nWaveformShape.prototype._drawChannel = function(context, channel,\n    frameOffset, startPixels, endPixels, top, height) {\n  let x, amplitude;\n\n  const amplitudeScale = this._view.getAmplitudeScale();\n\n  let lineX, lineY;\n\n  context.beginPath();\n\n  for (x = startPixels; x <= endPixels; x++) {\n    amplitude = channel.min_sample(x);\n\n    lineX = x - frameOffset + 0.5;\n    lineY = top + WaveformShape.scaleY(amplitude, height, amplitudeScale) + 0.5;\n\n    context.lineTo(lineX, lineY);\n  }\n\n  for (x = endPixels; x >= startPixels; x--) {\n    amplitude = channel.max_sample(x);\n\n    lineX = x - frameOffset + 0.5;\n    lineY = top + WaveformShape.scaleY(amplitude, height, amplitudeScale) + 1.0;\n\n    context.lineTo(lineX, lineY);\n  }\n\n  context.closePath();\n\n  context.fillShape(this._shape);\n};\n\nWaveformShape.prototype.addToLayer = function(layer) {\n  layer.add(this._shape);\n};\n\nWaveformShape.prototype.destroy = function() {\n  this._shape.destroy();\n  this._shape = null;\n};\n\nWaveformShape.prototype.on = function(event, handler) {\n  this._shape.on(event, handler);\n};\n\nWaveformShape.prototype.off = function(event, handler) {\n  this._shape.off(event, handler);\n};\n\n/**\n * Scales the waveform data for drawing on a canvas context.\n *\n * @see {@link https://stats.stackexchange.com/questions/281162}\n *\n * @todo Assumes 8-bit waveform data (-128 to 127 range)\n *\n * @param {Number} amplitude The waveform data point amplitude.\n * @param {Number} height The height of the waveform, in pixels.\n * @param {Number} scale Amplitude scaling factor.\n * @returns {Number} The scaled waveform data point.\n */\n\nWaveformShape.scaleY = function(amplitude, height, scale) {\n  const y = -(height - 1) * (amplitude * scale + 128) / 255 + (height - 1);\n\n  return clamp(Math.floor(y), 0, height - 1);\n};\n\nexport default WaveformShape;\n","/**\n * @file\n *\n * Defines the {@link SegmentShape} class.\n *\n * @module segment-shape\n */\n\nimport Konva from 'konva/lib/Core';\n\nimport OverlaySegmentMarker from './overlay-segment-marker';\nimport SegmentMarker from './segment-marker';\nimport WaveformShape from './waveform-shape';\nimport { clamp } from './utils';\n\n/**\n * Options that control segments' visual appearance\n *\n * @typedef {Object} SegmentDisplayOptions\n * @global\n * @property {Boolean} markers\n * @property {Boolean} overlay\n * @property {String} startMarkerColor\n * @property {String} endMarkerColor\n * @property {String} waveformColor\n * @property {String} overlayColor\n * @property {Number} overlayOpacity\n * @property {String} overlayBorderColor\n * @property {Number} overlayBorderWidth\n * @property {Number} overlayCornerRadius\n * @property {Number} overlayOffset\n * @property {String} overlayLabelAlign\n * @property {String} overlayLabelVerticalAlign\n * @property {Number} overlayLabelPadding\n * @property {String} overlayLabelColor\n * @property {String} overlayFontFamily\n * @property {Number} overlayFontSize\n * @property {String} overlayFontStyle\n */\n\n/**\n * Creates a waveform segment shape with optional start and end markers.\n *\n * @class\n * @alias SegmentShape\n *\n * @param {Segment} segment\n * @param {Peaks} peaks\n * @param {SegmentsLayer} layer\n * @param {WaveformOverview|WaveformZoomView} view\n */\n\nfunction SegmentShape(segment, peaks, layer, view) {\n  this._segment     = segment;\n  this._peaks       = peaks;\n  this._layer       = layer;\n  this._view        = view;\n  this._label       = null;\n  this._startMarker = null;\n  this._endMarker   = null;\n  this._color       = segment.color;\n  this._borderColor = segment.borderColor;\n  this._draggable   = this._segment.editable && this._view.isSegmentDraggingEnabled();\n  this._dragging    = false;\n\n  const viewOptions = view.getViewOptions();\n  const segmentOptions = viewOptions.segmentOptions;\n\n  this._overlayOffset = segmentOptions.overlayOffset;\n\n  if (!segment.overlay) {\n    this._waveformShape = new WaveformShape({\n      color:   segment.color,\n      view:    view,\n      segment: segment\n    });\n  }\n\n  this._onMouseEnter = this._onMouseEnter.bind(this);\n  this._onMouseLeave = this._onMouseLeave.bind(this);\n  this._onMouseDown  = this._onMouseDown.bind(this);\n  this._onMouseUp    = this._onMouseUp.bind(this);\n\n  this._dragBoundFunc      = this._dragBoundFunc.bind(this);\n  this._onSegmentDragStart = this._onSegmentDragStart.bind(this);\n  this._onSegmentDragMove  = this._onSegmentDragMove.bind(this);\n  this._onSegmentDragEnd   = this._onSegmentDragEnd.bind(this);\n\n  // Event handlers for markers\n  this._onSegmentMarkerClick       = this._onSegmentMarkerClick.bind(this);\n  this._onSegmentMarkerDragStart   = this._onSegmentMarkerDragStart.bind(this);\n  this._onSegmentMarkerDragMove    = this._onSegmentMarkerDragMove.bind(this);\n  this._onSegmentMarkerDragEnd     = this._onSegmentMarkerDragEnd.bind(this);\n  this._segmentMarkerDragBoundFunc = this._segmentMarkerDragBoundFunc.bind(this);\n\n  this._label = this._peaks.options.createSegmentLabel({\n    segment:    segment,\n    view:       this._view.getName(),\n    layer:      this._layer,\n    fontFamily: viewOptions.fontFamily,\n    fontSize:   viewOptions.fontSize,\n    fontStyle:  viewOptions.fontStyle\n  });\n\n  if (this._label) {\n    this._label.hide();\n  }\n\n  // Create with default y and height, the real values are set in fitToView().\n  const segmentStartOffset = this._view.timeToPixelOffset(this._segment.startTime);\n  const segmentEndOffset   = this._view.timeToPixelOffset(this._segment.endTime);\n\n  const overlayRectHeight = clamp(0, this._view.getHeight() - 2 * this._overlayOffset);\n\n  // The clip rectangle prevents text in the overlay from appearing\n  // outside the overlay.\n\n  this._overlay = new Konva.Group({\n    name:          'segment-overlay',\n    segment:       this._segment,\n    x:             segmentStartOffset,\n    y:             0,\n    width:         segmentEndOffset - segmentStartOffset,\n    height:        this._view.getHeight(),\n    clipX:         0,\n    clipY:         this._overlayOffset,\n    clipWidth:     segmentEndOffset - segmentStartOffset,\n    clipHeight:    overlayRectHeight,\n    draggable:     this._draggable,\n    dragBoundFunc: this._dragBoundFunc\n  });\n\n  let overlayBorderColor, overlayBorderWidth, overlayColor, overlayOpacity, overlayCornerRadius;\n\n  if (segment.overlay) {\n    overlayBorderColor  = this._borderColor || segmentOptions.overlayBorderColor;\n    overlayBorderWidth  = segmentOptions.overlayBorderWidth;\n    overlayColor        = this._color || segmentOptions.overlayColor;\n    overlayOpacity      = segmentOptions.overlayOpacity;\n    overlayCornerRadius = segmentOptions.overlayCornerRadius;\n  }\n\n  this._overlayRect = new Konva.Rect({\n    x:            0,\n    y:            this._overlayOffset,\n    width:        segmentEndOffset - segmentStartOffset,\n    stroke:       overlayBorderColor,\n    strokeWidth:  overlayBorderWidth,\n    height:       overlayRectHeight,\n    fill:         overlayColor,\n    opacity:      overlayOpacity,\n    cornerRadius: overlayCornerRadius\n  });\n\n  this._overlay.add(this._overlayRect);\n\n  if (segment.overlay) {\n    this._overlayText = new Konva.Text({\n      x:             0,\n      y:             this._overlayOffset,\n      text:          this._segment.labelText,\n      fontFamily:    segmentOptions.overlayFontFamily,\n      fontSize:      segmentOptions.overlayFontSize,\n      fontStyle:     segmentOptions.overlayFontStyle,\n      fill:          segmentOptions.overlayLabelColor,\n      listening:     false,\n      align:         segmentOptions.overlayLabelAlign,\n      width:         segmentEndOffset - segmentStartOffset,\n      verticalAlign: segmentOptions.overlayLabelVerticalAlign,\n      height:        overlayRectHeight,\n      padding:       segmentOptions.overlayLabelPadding\n    });\n\n    this._overlay.add(this._overlayText);\n  }\n\n  // Set up event handlers to show/hide the segment label text when the user\n  // hovers the mouse over the segment.\n  this._overlay.on('mouseenter', this._onMouseEnter);\n  this._overlay.on('mouseleave', this._onMouseLeave);\n\n  this._overlay.on('mousedown', this._onMouseDown);\n  this._overlay.on('mouseup', this._onMouseUp);\n\n  if (this._draggable) {\n    this._overlay.on('dragstart', this._onSegmentDragStart);\n    this._overlay.on('dragmove', this._onSegmentDragMove);\n    this._overlay.on('dragend', this._onSegmentDragEnd);\n  }\n\n  this._createMarkers();\n}\n\nfunction createOverlayMarker(options) {\n  return new OverlaySegmentMarker(options);\n}\n\nSegmentShape.prototype._createMarkers = function() {\n  const editable = this._layer.isEditingEnabled() && this._segment.editable;\n  const viewOptions = this._view.getViewOptions();\n  const segmentOptions = viewOptions.segmentOptions;\n\n  let createSegmentMarker, startMarker, endMarker;\n\n  if (this._segment.markers) {\n    createSegmentMarker = this._peaks.options.createSegmentMarker;\n  }\n  else if (this._segment.overlay) {\n    createSegmentMarker = createOverlayMarker;\n  }\n\n  if (createSegmentMarker) {\n    startMarker = createSegmentMarker({\n      segment:        this._segment,\n      editable:       editable,\n      startMarker:    true,\n      color:          segmentOptions.startMarkerColor,\n      fontFamily:     viewOptions.fontFamily,\n      fontSize:       viewOptions.fontSize,\n      fontStyle:      viewOptions.fontStyle,\n      layer:          this._layer,\n      view:           this._view.getName(),\n      segmentOptions: this._view.getViewOptions().segmentOptions\n    });\n  }\n\n  if (startMarker) {\n    this._startMarker = new SegmentMarker({\n      segment:       this._segment,\n      segmentShape:  this,\n      editable:      editable,\n      startMarker:   true,\n      marker:        startMarker,\n      onClick:       this._onSegmentMarkerClick,\n      onDragStart:   this._onSegmentMarkerDragStart,\n      onDragMove:    this._onSegmentMarkerDragMove,\n      onDragEnd:     this._onSegmentMarkerDragEnd,\n      dragBoundFunc: this._segmentMarkerDragBoundFunc\n    });\n  }\n\n  if (createSegmentMarker) {\n    endMarker = createSegmentMarker({\n      segment:        this._segment,\n      editable:       editable,\n      startMarker:    false,\n      color:          segmentOptions.endMarkerColor,\n      fontFamily:     viewOptions.fontFamily,\n      fontSize:       viewOptions.fontSize,\n      fontStyle:      viewOptions.fontStyle,\n      layer:          this._layer,\n      view:           this._view.getName(),\n      segmentOptions: this._view.getViewOptions().segmentOptions\n    });\n  }\n\n  if (endMarker) {\n    this._endMarker = new SegmentMarker({\n      segment:       this._segment,\n      segmentShape:  this,\n      editable:      editable,\n      startMarker:   false,\n      marker:        endMarker,\n      onClick:       this._onSegmentMarkerClick,\n      onDragStart:   this._onSegmentMarkerDragStart,\n      onDragMove:    this._onSegmentMarkerDragMove,\n      onDragEnd:     this._onSegmentMarkerDragEnd,\n      dragBoundFunc: this._segmentMarkerDragBoundFunc\n    });\n  }\n};\n\nSegmentShape.prototype._dragBoundFunc = function(pos) {\n  // Allow the segment to be moved horizontally but not vertically.\n  return {\n    x: pos.x,\n    y: 0\n  };\n};\n\n/**\n * Update the segment shape after the segment's attributes have changed.\n */\n\nSegmentShape.prototype.update = function(options) {\n  const segmentStartOffset = this._view.timeToPixelOffset(this._segment.startTime);\n  const segmentEndOffset   = this._view.timeToPixelOffset(this._segment.endTime);\n  const width = segmentEndOffset - segmentStartOffset;\n  let marker;\n\n  if ((marker = this.getStartMarker())) {\n    marker.setX(segmentStartOffset - marker.getWidth());\n\n    if (options) {\n      marker.update(options);\n    }\n  }\n\n  if ((marker = this.getEndMarker())) {\n    marker.setX(segmentEndOffset);\n\n    if (options) {\n      marker.update(options);\n    }\n  }\n\n  this._color = this._segment.color;\n  this._borderColor = this._segment.bordercolor;\n\n  if (this._label) {\n    this._label.text(this._segment.labelText);\n  }\n\n  if (this._overlayText) {\n    this._overlayText.text(this._segment.labelText);\n  }\n\n  if (this._segment.overlay) {\n    if (this._color) {\n      this._overlayRect.fill(this._color);\n    }\n\n    if (this._borderColor) {\n      this._overlayRect.stroke(this._borderColor);\n    }\n  }\n  else {\n    this._waveformShape.setWaveformColor(this._segment.color);\n  }\n\n  // While dragging, the overlay position is controlled in _onSegmentDragMove().\n\n  if (!this._dragging) {\n    if (this._overlay) {\n      this._overlay.setAttrs({\n        x:         segmentStartOffset,\n        width:     width,\n        clipWidth: width < 1 ? 1 : width\n      });\n\n      this._overlayRect.setAttrs({\n        x:     0,\n        width: width\n      });\n\n      if (this._overlayText) {\n        this._overlayText.setAttrs({\n          width: width\n        });\n      }\n    }\n  }\n};\n\nSegmentShape.prototype.getSegment = function() {\n  return this._segment;\n};\n\nSegmentShape.prototype.getStartMarker = function() {\n  return this._startMarker;\n};\n\nSegmentShape.prototype.getEndMarker = function() {\n  return this._endMarker;\n};\n\nSegmentShape.prototype.addToLayer = function(layer) {\n  if (this._waveformShape) {\n    this._waveformShape.addToLayer(layer);\n  }\n\n  if (this._label) {\n    layer.add(this._label);\n  }\n\n  if (this._overlay) {\n    layer.add(this._overlay);\n  }\n\n  if (this._startMarker) {\n    this._startMarker.addToLayer(layer);\n  }\n\n  if (this._endMarker) {\n    this._endMarker.addToLayer(layer);\n  }\n};\n\nSegmentShape.prototype.isDragging = function() {\n  return this._dragging;\n};\n\nSegmentShape.prototype._onMouseEnter = function(event) {\n  if (this._label) {\n    this._label.moveToTop();\n    this._label.show();\n  }\n\n  this._peaks.emit('segments.mouseenter', {\n    segment: this._segment,\n    evt: event.evt\n  });\n};\n\nSegmentShape.prototype._onMouseLeave = function(event) {\n  if (this._label) {\n    this._label.hide();\n  }\n\n  this._peaks.emit('segments.mouseleave', {\n    segment: this._segment,\n    evt: event.evt\n  });\n};\n\nSegmentShape.prototype._onMouseDown = function(event) {\n  this._peaks.emit('segments.mousedown', {\n    segment: this._segment,\n    evt: event.evt\n  });\n};\n\nSegmentShape.prototype._onMouseUp = function(event) {\n  this._peaks.emit('segments.mouseup', {\n    segment: this._segment,\n    evt: event.evt\n  });\n};\n\nSegmentShape.prototype.segmentClicked = function(eventName, event) {\n  this._moveToTop();\n\n  this._peaks.emit('segments.' + eventName, event);\n};\n\nSegmentShape.prototype._moveToTop = function() {\n  this._overlay.moveToTop();\n\n  this._layer.moveSegmentMarkersToTop();\n};\n\nSegmentShape.prototype.enableSegmentDragging = function(enable) {\n  if (!this._segment.editable) {\n    return;\n  }\n\n  if (!this._draggable && enable) {\n    this._overlay.on('dragstart', this._onSegmentDragStart);\n    this._overlay.on('dragmove', this._onSegmentDragMove);\n    this._overlay.on('dragend', this._onSegmentDragEnd);\n  }\n  else if (this._draggable && !enable) {\n    this._overlay.off('dragstart', this._onSegmentDragStart);\n    this._overlay.off('dragmove', this._onSegmentDragMove);\n    this._overlay.off('dragend', this._onSegmentDragEnd);\n  }\n\n  this._overlay.draggable(enable);\n  this._draggable = enable;\n};\n\nSegmentShape.prototype._setPreviousAndNextSegments = function() {\n  if (this._view.getSegmentDragMode() !== 'overlap') {\n    this._nextSegment = this._peaks.segments.findNextSegment(this._segment);\n    this._previousSegment = this._peaks.segments.findPreviousSegment(this._segment);\n  }\n  else {\n    this._nextSegment = null;\n    this._previousSegment = null;\n  }\n};\n\nSegmentShape.prototype._onSegmentDragStart = function(event) {\n  this._setPreviousAndNextSegments();\n\n  this._dragging = true;\n  this._dragStartX = this._overlay.getX();\n  this._dragStartTime = this._segment.startTime;\n  this._dragEndTime = this._segment.endTime;\n\n  this._peaks.emit('segments.dragstart', {\n    segment: this._segment,\n    marker: false,\n    startMarker: false,\n    evt: event.evt\n  });\n};\n\nSegmentShape.prototype._onSegmentDragMove = function(event) {\n  const x = this._overlay.getX();\n  const offsetX = x - this._dragStartX;\n  const timeOffset = this._view.pixelsToTime(offsetX);\n\n  // The WaveformShape for a segment fills the canvas width\n  // but only draws a subset of the horizontal range. When dragged\n  // we need to keep the shape object in its position but\n  // update the segment start and end time so that the right\n  // subset is drawn.\n\n  // Calculate new segment start/end time based on drag position. We'll\n  // correct this later based on the drag mode, to prevent overlapping\n  // segments or to compress the adjacent segment.\n\n  let startTime = this._dragStartTime + timeOffset;\n  let endTime = this._dragEndTime + timeOffset;\n  const segmentDuration = this._segment.endTime - this._segment.startTime;\n  let dragMode;\n  const minSegmentWidth = this._view.getMinSegmentDragWidth();\n  const minSegmentDuration = this._view.pixelsToTime(minSegmentWidth);\n  let previousSegmentUpdated = false;\n  let nextSegmentUpdated = false;\n\n  // Prevent the segment from being dragged beyond the start of the waveform.\n\n  if (startTime < 0) {\n    startTime = 0;\n    endTime = segmentDuration;\n    this._overlay.setX(this._view.timeToPixelOffset(startTime));\n  }\n\n  // Adjust segment position if it now overlaps the previous segment?\n\n  if (this._previousSegment) {\n    let previousSegmentEndX = this._view.timeToPixelOffset(this._previousSegment.endTime);\n\n    if (startTime < this._previousSegment.endTime) {\n      dragMode = this._view.getSegmentDragMode();\n\n      if (dragMode === 'no-overlap' ||\n          (dragMode === 'compress' && !this._previousSegment.editable)) {\n        startTime = this._previousSegment.endTime;\n        endTime = startTime + segmentDuration;\n        this._overlay.setX(previousSegmentEndX);\n      }\n      else if (dragMode === 'compress') {\n        let previousSegmentEndTime = startTime;\n\n        const minPreviousSegmentEndTime = this._previousSegment.startTime + minSegmentDuration;\n\n        if (previousSegmentEndTime < minPreviousSegmentEndTime) {\n          previousSegmentEndTime = minPreviousSegmentEndTime;\n\n          previousSegmentEndX = this._view.timeToPixelOffset(previousSegmentEndTime);\n\n          this._overlay.setX(previousSegmentEndX);\n\n          startTime = previousSegmentEndTime;\n          endTime = startTime + segmentDuration;\n        }\n\n        this._previousSegment.update({ endTime: previousSegmentEndTime });\n\n        previousSegmentUpdated = true;\n      }\n    }\n  }\n\n  // Adjust segment position if it now overlaps the following segment?\n\n  if (this._nextSegment) {\n    let nextSegmentStartX = this._view.timeToPixelOffset(this._nextSegment.startTime);\n\n    if (endTime > this._nextSegment.startTime) {\n      dragMode = this._view.getSegmentDragMode();\n\n      if (dragMode === 'no-overlap' ||\n          (dragMode === 'compress' && !this._nextSegment.editable)) {\n        endTime = this._nextSegment.startTime;\n        startTime = endTime - segmentDuration;\n        this._overlay.setX(nextSegmentStartX - this._overlay.getWidth());\n      }\n      else if (dragMode === 'compress') {\n        let nextSegmentStartTime = endTime;\n\n        const maxNextSegmentStartTime = this._nextSegment.endTime - minSegmentDuration;\n\n        if (nextSegmentStartTime > maxNextSegmentStartTime) {\n          nextSegmentStartTime = maxNextSegmentStartTime;\n\n          nextSegmentStartX = this._view.timeToPixelOffset(nextSegmentStartTime);\n\n          this._overlay.setX(nextSegmentStartX - this._overlay.getWidth());\n\n          endTime = nextSegmentStartTime;\n          startTime = endTime - segmentDuration;\n        }\n\n        this._nextSegment.update({ startTime: nextSegmentStartTime });\n\n        nextSegmentUpdated = true;\n      }\n    }\n  }\n\n  this._segment._setStartTime(startTime);\n  this._segment._setEndTime(endTime);\n\n  this._peaks.emit('segments.dragged', {\n    segment: this._segment,\n    marker: false,\n    startMarker: false,\n    evt: event.evt\n  });\n\n  if (previousSegmentUpdated) {\n    this._peaks.emit('segments.dragged', {\n      segment: this._previousSegment,\n      marker: false,\n      startMarker: false,\n      evt: event.evt\n    });\n  }\n  else if (nextSegmentUpdated) {\n    this._peaks.emit('segments.dragged', {\n      segment: this._nextSegment,\n      marker: false,\n      startMarker: false,\n      evt: event.evt\n    });\n  }\n};\n\nSegmentShape.prototype._onSegmentDragEnd = function(event) {\n  this._dragging = false;\n\n  this._peaks.emit('segments.dragend', {\n    segment: this._segment,\n    marker: false,\n    startMarker: false,\n    evt: event.evt\n  });\n};\n\nSegmentShape.prototype.moveMarkersToTop = function() {\n  if (this._startMarker) {\n    this._startMarker.moveToTop();\n  }\n\n  if (this._endMarker) {\n    this._endMarker.moveToTop();\n  }\n};\n\nSegmentShape.prototype.startDrag = function() {\n  if (this._endMarker) {\n    this._endMarker.startDrag();\n  }\n};\n\nSegmentShape.prototype.stopDrag = function() {\n  if (this._endMarker) {\n    this._endMarker.stopDrag();\n  }\n};\n\n/**\n * @param {SegmentMarker} segmentMarker\n */\n\nSegmentShape.prototype._onSegmentMarkerDragStart = function(segmentMarker, event) {\n  this._setPreviousAndNextSegments();\n\n  // Move this segment to the top of the z-order, so that it remains on top\n  // of any adjacent segments that the marker is dragged over.\n  this._moveToTop();\n\n  this._startMarkerX = this._startMarker.getX();\n  this._endMarkerX = this._endMarker.getX();\n\n  this._peaks.emit('segments.dragstart', {\n    segment: this._segment,\n    marker: true,\n    startMarker: segmentMarker.isStartMarker(),\n    evt: event.evt\n  });\n};\n\n/**\n * @param {SegmentMarker} segmentMarker\n */\n\nSegmentShape.prototype._onSegmentMarkerDragMove = function(segmentMarker, event) {\n  if (segmentMarker.isStartMarker()) {\n    this._segmentStartMarkerDragMove(segmentMarker, event);\n    segmentMarker.update({ startTime: this._segment.startTime });\n  }\n  else {\n    this._segmentEndMarkerDragMove(segmentMarker, event);\n    segmentMarker.update({ endTime: this._segment.endTime });\n  }\n};\n\nfunction getDuration(segment) {\n  return segment.endTime - segment.startTime;\n}\n\nSegmentShape.prototype._segmentStartMarkerDragMove = function(segmentMarker, event) {\n  const width = this._view.getWidth();\n\n  let startMarkerX = this._startMarker.getX();\n  const endMarkerX = this._endMarker.getX();\n\n  let minSegmentDuration = this._view.pixelsToTime(50);\n  const minSegmentWidth = this._view.getMinSegmentDragWidth();\n\n  let upperLimit = this._endMarker.getX() - minSegmentWidth;\n\n  if (upperLimit > width) {\n    upperLimit = width;\n  }\n\n  let previousSegmentVisible = false;\n  let previousSegmentUpdated = false;\n  let previousSegmentEndX;\n\n  if (this._previousSegment) {\n    previousSegmentEndX = this._view.timeToPixelOffset(this._previousSegment.endTime);\n    previousSegmentVisible = previousSegmentEndX >= 0;\n  }\n\n  if (startMarkerX > upperLimit) {\n    segmentMarker.setX(upperLimit);\n    this._overlay.clipWidth(upperLimit - endMarkerX);\n\n    if (minSegmentWidth === 0 && upperLimit < width) {\n      this._segment._setStartTime(this._segment.endTime);\n    }\n    else {\n      this._segment._setStartTime(this._view.pixelOffsetToTime(upperLimit));\n    }\n  }\n  else if (this._previousSegment && previousSegmentVisible) {\n    const dragMode = this._view.getSegmentDragMode();\n\n    const fixedPreviousSegment = dragMode === 'no-overlap' ||\n      (dragMode === 'compress' && !this._previousSegment.editable);\n\n    const compressPreviousSegment = dragMode === 'compress' && this._previousSegment.editable;\n\n    if (startMarkerX <= previousSegmentEndX) {\n      if (fixedPreviousSegment) {\n        segmentMarker.setX(previousSegmentEndX);\n        this._overlay.clipWidth(previousSegmentEndX - endMarkerX);\n\n        this._segment._setStartTime(this._previousSegment.endTime);\n      }\n      else if (compressPreviousSegment) {\n        const previousSegmentDuration = getDuration(this._previousSegment);\n\n        if (previousSegmentDuration < minSegmentDuration) {\n          minSegmentDuration = previousSegmentDuration;\n        }\n\n        const lowerLimit = this._view.timeToPixelOffset(\n          this._previousSegment.startTime + minSegmentDuration\n        );\n\n        if (startMarkerX < lowerLimit) {\n          startMarkerX = lowerLimit;\n        }\n\n        segmentMarker.setX(startMarkerX);\n        this._overlay.clipWidth(endMarkerX - startMarkerX);\n\n        this._segment._setStartTime(this._view.pixelOffsetToTime(startMarkerX));\n\n        this._previousSegment.update({\n          endTime: this._view.pixelOffsetToTime(startMarkerX)\n        });\n\n        previousSegmentUpdated = true;\n      }\n    }\n    else {\n      if (startMarkerX < 0) {\n        startMarkerX = 0;\n      }\n\n      segmentMarker.setX(startMarkerX);\n      this._overlay.clipWidth(endMarkerX - startMarkerX);\n\n      this._segment._setStartTime(this._view.pixelOffsetToTime(startMarkerX));\n    }\n  }\n  else {\n    if (startMarkerX < 0) {\n      startMarkerX = 0;\n    }\n\n    segmentMarker.setX(startMarkerX);\n    this._overlay.clipWidth(endMarkerX - startMarkerX);\n\n    this._segment._setStartTime(this._view.pixelOffsetToTime(startMarkerX));\n  }\n\n  this._peaks.emit('segments.dragged', {\n    segment: this._segment,\n    marker: true,\n    startMarker: true,\n    evt: event.evt\n  });\n\n  if (previousSegmentUpdated) {\n    this._peaks.emit('segments.dragged', {\n      segment: this._previousSegment,\n      marker: true,\n      startMarker: false,\n      evt: event.evt\n    });\n  }\n};\n\nSegmentShape.prototype._segmentEndMarkerDragMove = function(segmentMarker, event) {\n  const width = this._view.getWidth();\n\n  const startMarkerX = this._startMarker.getX();\n  let endMarkerX = this._endMarker.getX();\n\n  let minSegmentDuration = this._view.pixelsToTime(50);\n  const minSegmentWidth = this._view.getMinSegmentDragWidth();\n\n  let lowerLimit = this._startMarker.getX() + minSegmentWidth;\n\n  if (lowerLimit < 0) {\n    lowerLimit = 0;\n  }\n\n  let nextSegmentVisible = false;\n  let nextSegmentUpdated = false;\n  let nextSegmentStartX;\n\n  if (this._nextSegment) {\n    nextSegmentStartX = this._view.timeToPixelOffset(this._nextSegment.startTime);\n    nextSegmentVisible = nextSegmentStartX < width;\n  }\n\n  if (endMarkerX < lowerLimit) {\n    segmentMarker.setX(lowerLimit);\n    this._overlay.clipWidth(lowerLimit - startMarkerX);\n\n    if (minSegmentWidth === 0 && lowerLimit > 0) {\n      this._segment._setEndTime(this._segment.startTime);\n    }\n    else {\n      this._segment._setEndTime(this._view.pixelOffsetToTime(lowerLimit));\n    }\n  }\n  else if (this._nextSegment && nextSegmentVisible) {\n    const dragMode = this._view.getSegmentDragMode();\n\n    const fixedNextSegment = dragMode === 'no-overlap' ||\n      (dragMode === 'compress' && !this._nextSegment.editable);\n\n    const compressNextSegment = dragMode === 'compress' && this._nextSegment.editable;\n\n    if (endMarkerX >= nextSegmentStartX) {\n      if (fixedNextSegment) {\n        segmentMarker.setX(nextSegmentStartX);\n        this._overlay.clipWidth(nextSegmentStartX - startMarkerX);\n\n        this._segment._setEndTime(this._nextSegment.startTime);\n      }\n      else if (compressNextSegment) {\n        const nextSegmentDuration = getDuration(this._nextSegment);\n\n        if (nextSegmentDuration < minSegmentDuration) {\n          minSegmentDuration = nextSegmentDuration;\n        }\n\n        const upperLimit = this._view.timeToPixelOffset(\n          this._nextSegment.endTime - minSegmentDuration\n        );\n\n        if (endMarkerX > upperLimit) {\n          endMarkerX = upperLimit;\n        }\n\n        segmentMarker.setX(endMarkerX);\n        this._overlay.clipWidth(endMarkerX - startMarkerX);\n\n        this._segment._setEndTime(this._view.pixelOffsetToTime(endMarkerX));\n\n        this._nextSegment.update({\n          startTime: this._view.pixelOffsetToTime(endMarkerX)\n        });\n\n        nextSegmentUpdated = true;\n      }\n    }\n    else {\n      if (endMarkerX > width) {\n        endMarkerX = width;\n      }\n\n      segmentMarker.setX(endMarkerX);\n      this._overlay.clipWidth(endMarkerX - startMarkerX);\n\n      this._segment._setEndTime(this._view.pixelOffsetToTime(endMarkerX));\n    }\n  }\n  else {\n    if (endMarkerX > width) {\n      endMarkerX = width;\n    }\n\n    segmentMarker.setX(endMarkerX);\n    this._overlay.clipWidth(endMarkerX - startMarkerX);\n\n    this._segment._setEndTime(this._view.pixelOffsetToTime(endMarkerX));\n  }\n\n  this._peaks.emit('segments.dragged', {\n    segment: this._segment,\n    marker: true,\n    startMarker: false,\n    evt: event.evt\n  });\n\n  if (nextSegmentUpdated) {\n    this._peaks.emit('segments.dragged', {\n      segment: this._nextSegment,\n      marker: true,\n      startMarker: true,\n      evt: event.evt\n    });\n  }\n};\n\n/**\n * @param {SegmentMarker} segmentMarker\n */\n\nSegmentShape.prototype._onSegmentMarkerDragEnd = function(segmentMarker, event) {\n  this._nextSegment = null;\n  this._previousSegment = null;\n\n  const startMarker = segmentMarker.isStartMarker();\n\n  this._peaks.emit('segments.dragend', {\n    segment: this._segment,\n    marker: true,\n    startMarker: startMarker,\n    evt: event.evt\n  });\n};\n\nSegmentShape.prototype._segmentMarkerDragBoundFunc = function(segmentMarker, pos) {\n  // Allow the marker to be moved horizontally but not vertically.\n  return {\n    x: pos.x,\n    y: segmentMarker.getAbsolutePosition().y\n  };\n};\n\nSegmentShape.prototype._onSegmentMarkerClick = function() {\n  // Move this segment to the top of the z-order.\n  this._moveToTop();\n};\n\nSegmentShape.prototype.fitToView = function() {\n  if (this._startMarker) {\n    this._startMarker.fitToView();\n  }\n\n  if (this._endMarker) {\n    this._endMarker.fitToView();\n  }\n\n  if (this._overlay) {\n    const height = this._view.getHeight();\n\n    const overlayRectHeight = clamp(0, height - (this._overlayOffset * 2));\n\n    this._overlay.setAttrs({\n      y:          0,\n      height:     height,\n      clipY:      this._overlayOffset,\n      clipHeight: overlayRectHeight\n    });\n\n    this._overlayRect.setAttrs({\n      y:      this._overlayOffset,\n      height: overlayRectHeight\n    });\n\n    if (this._overlayText) {\n      this._overlayText.setAttrs({\n        y:      this._overlayOffset,\n        height: overlayRectHeight\n      });\n    }\n  }\n};\n\nSegmentShape.prototype.destroy = function() {\n  if (this._waveformShape) {\n    this._waveformShape.destroy();\n  }\n\n  if (this._label) {\n    this._label.destroy();\n  }\n\n  if (this._startMarker) {\n    this._startMarker.destroy();\n  }\n\n  if (this._endMarker) {\n    this._endMarker.destroy();\n  }\n\n  if (this._overlay) {\n    this._overlay.destroy();\n  }\n};\n\nexport default SegmentShape;\n","/**\n * @file\n *\n * Defines the {@link SegmentsLayer} class.\n *\n * @module segments-layer\n */\n\nimport SegmentShape from './segment-shape';\nimport { objectHasProperty } from './utils';\nimport Konva from 'konva/lib/Core';\n\n/**\n * Creates a Konva.Layer that displays segment markers against the audio\n * waveform.\n *\n * @class\n * @alias SegmentsLayer\n *\n * @param {Peaks} peaks\n * @param {WaveformOverview|WaveformZoomView} view\n * @param {Boolean} enableEditing\n */\n\nfunction SegmentsLayer(peaks, view, enableEditing) {\n  this._peaks         = peaks;\n  this._view          = view;\n  this._enableEditing = enableEditing;\n  this._segmentShapes = {};\n  this._layer         = new Konva.Layer();\n\n  this._onSegmentsUpdate    = this._onSegmentsUpdate.bind(this);\n  this._onSegmentsAdd       = this._onSegmentsAdd.bind(this);\n  this._onSegmentsRemove    = this._onSegmentsRemove.bind(this);\n  this._onSegmentsRemoveAll = this._onSegmentsRemoveAll.bind(this);\n  this._onSegmentsDragged   = this._onSegmentsDragged.bind(this);\n\n  this._peaks.on('segments.update', this._onSegmentsUpdate);\n  this._peaks.on('segments.add', this._onSegmentsAdd);\n  this._peaks.on('segments.remove', this._onSegmentsRemove);\n  this._peaks.on('segments.remove_all', this._onSegmentsRemoveAll);\n  this._peaks.on('segments.dragged', this._onSegmentsDragged);\n}\n\n/**\n * Adds the layer to the given {Konva.Stage}.\n *\n * @param {Konva.Stage} stage\n */\n\nSegmentsLayer.prototype.addToStage = function(stage) {\n  stage.add(this._layer);\n};\n\nSegmentsLayer.prototype.setListening = function(listening) {\n  this._layer.listening(listening);\n};\n\nSegmentsLayer.prototype.enableEditing = function(enable) {\n  this._enableEditing = enable;\n};\n\nSegmentsLayer.prototype.isEditingEnabled = function() {\n  return this._enableEditing;\n};\n\nSegmentsLayer.prototype.enableSegmentDragging = function(enable) {\n  for (const segmentPid in this._segmentShapes) {\n    if (objectHasProperty(this._segmentShapes, segmentPid)) {\n      this._segmentShapes[segmentPid].enableSegmentDragging(enable);\n    }\n  }\n};\n\nSegmentsLayer.prototype.getSegmentShape = function(segment) {\n  return this._segmentShapes[segment.pid];\n};\n\nSegmentsLayer.prototype.formatTime = function(time) {\n  return this._view.formatTime(time);\n};\n\nSegmentsLayer.prototype._onSegmentsUpdate = function(segment, options) {\n  const frameStartTime = this._view.getStartTime();\n  const frameEndTime = this._view.getEndTime();\n\n  let segmentShape = this.getSegmentShape(segment);\n  const isVisible = segment.isVisible(frameStartTime, frameEndTime);\n\n  if (segmentShape && !isVisible) {\n    // Remove segment shape that is no longer visible.\n\n    if (!segmentShape.isDragging()) {\n      this._removeSegment(segment);\n    }\n  }\n  else if (!segmentShape && isVisible) {\n    // Add segment shape for visible segment.\n    segmentShape = this._updateSegment(segment);\n  }\n  else if (segmentShape && isVisible) {\n    // Update the segment shape with the changed attributes.\n    segmentShape.update(options);\n  }\n};\n\nSegmentsLayer.prototype._onSegmentsAdd = function(event) {\n  const self = this;\n\n  const frameStartTime = self._view.getStartTime();\n  const frameEndTime   = self._view.getEndTime();\n\n  event.segments.forEach(function(segment) {\n    if (segment.isVisible(frameStartTime, frameEndTime)) {\n      const segmentShape = self._addSegmentShape(segment);\n\n      segmentShape.update();\n    }\n  });\n\n  // Ensure segment markers are always draggable.\n  this.moveSegmentMarkersToTop();\n};\n\nSegmentsLayer.prototype._onSegmentsRemove = function(event) {\n  const self = this;\n\n  event.segments.forEach(function(segment) {\n    self._removeSegment(segment);\n  });\n};\n\nSegmentsLayer.prototype._onSegmentsRemoveAll = function() {\n  this._layer.removeChildren();\n  this._segmentShapes = {};\n};\n\nSegmentsLayer.prototype._onSegmentsDragged = function(event) {\n  this._updateSegment(event.segment);\n};\n\n/**\n * Creates the Konva UI objects for a given segment.\n *\n * @private\n * @param {Segment} segment\n * @returns {SegmentShape}\n */\n\nSegmentsLayer.prototype._createSegmentShape = function(segment) {\n  return new SegmentShape(segment, this._peaks, this, this._view);\n};\n\n/**\n * Adds a Konva UI object to the layer for a given segment.\n *\n * @private\n * @param {Segment} segment\n * @returns {SegmentShape}\n */\n\nSegmentsLayer.prototype._addSegmentShape = function(segment) {\n  const segmentShape = this._createSegmentShape(segment);\n\n  segmentShape.addToLayer(this._layer);\n\n  this._segmentShapes[segment.pid] = segmentShape;\n\n  return segmentShape;\n};\n\n/**\n * Updates the positions of all displayed segments in the view.\n *\n * @param {Number} startTime The start of the visible range in the view,\n *   in seconds.\n * @param {Number} endTime The end of the visible range in the view,\n *   in seconds.\n */\n\nSegmentsLayer.prototype.updateSegments = function(startTime, endTime) {\n  // Update segments in visible time range.\n  const segments = this._peaks.segments.find(startTime, endTime);\n\n  segments.forEach(this._updateSegment.bind(this));\n\n  // TODO: In the overview all segments are visible, so no need to do this.\n  this._removeInvisibleSegments(startTime, endTime);\n};\n\n/**\n * @private\n * @param {Segment} segment\n */\n\nSegmentsLayer.prototype._updateSegment = function(segment) {\n  let segmentShape = this.getSegmentShape(segment);\n\n  if (!segmentShape) {\n    segmentShape = this._addSegmentShape(segment);\n  }\n\n  segmentShape.update();\n};\n\n/**\n * Removes any segments that are not visible, i.e., are not within and do not\n * overlap the given time range.\n *\n * @private\n * @param {Number} startTime The start of the visible time range, in seconds.\n * @param {Number} endTime The end of the visible time range, in seconds.\n */\n\nSegmentsLayer.prototype._removeInvisibleSegments = function(startTime, endTime) {\n  for (const segmentPid in this._segmentShapes) {\n    if (objectHasProperty(this._segmentShapes, segmentPid)) {\n      const segment = this._segmentShapes[segmentPid].getSegment();\n\n      if (!segment.isVisible(startTime, endTime)) {\n        this._removeSegment(segment);\n      }\n    }\n  }\n};\n\n/**\n * Removes the given segment from the view.\n *\n * @param {Segment} segment\n */\n\nSegmentsLayer.prototype._removeSegment = function(segment) {\n  const segmentShape = this._segmentShapes[segment.pid];\n\n  if (segmentShape) {\n    segmentShape.destroy();\n    delete this._segmentShapes[segment.pid];\n  }\n};\n\n/**\n * Moves all segment markers to the top of the z-order,\n * so the user can always drag them.\n */\n\nSegmentsLayer.prototype.moveSegmentMarkersToTop = function() {\n  for (const segmentPid in this._segmentShapes) {\n    if (objectHasProperty(this._segmentShapes, segmentPid)) {\n      this._segmentShapes[segmentPid].moveMarkersToTop();\n    }\n  }\n};\n\n/**\n * Toggles visibility of the segments layer.\n *\n * @param {Boolean} visible\n */\n\nSegmentsLayer.prototype.setVisible = function(visible) {\n  this._layer.setVisible(visible);\n};\n\nSegmentsLayer.prototype.segmentClicked = function(eventName, event) {\n  const segmentShape = this._segmentShapes[event.segment.pid];\n\n  if (segmentShape) {\n    segmentShape.segmentClicked(eventName, event);\n  }\n};\n\nSegmentsLayer.prototype.destroy = function() {\n  this._peaks.off('segments.update', this._onSegmentsUpdate);\n  this._peaks.off('segments.add', this._onSegmentsAdd);\n  this._peaks.off('segments.remove', this._onSegmentsRemove);\n  this._peaks.off('segments.remove_all', this._onSegmentsRemoveAll);\n  this._peaks.off('segments.dragged', this._onSegmentsDragged);\n};\n\nSegmentsLayer.prototype.fitToView = function() {\n  for (const segmentPid in this._segmentShapes) {\n    if (objectHasProperty(this._segmentShapes, segmentPid)) {\n      const segmentShape = this._segmentShapes[segmentPid];\n\n      segmentShape.fitToView();\n    }\n  }\n};\n\nSegmentsLayer.prototype.draw = function() {\n  this._layer.draw();\n};\n\nSegmentsLayer.prototype.getHeight = function() {\n  return this._layer.getHeight();\n};\n\nexport default SegmentsLayer;\n","/**\n * @file\n *\n * Defines the {@link WaveformAxis} class.\n *\n * @module waveform-axis\n */\n\nimport { formatTime, objectHasProperty, roundUpToNearest } from './utils';\nimport Konva from 'konva/lib/Core';\n\n/**\n * Creates the waveform axis shapes and adds them to the given view layer.\n *\n * @class\n * @alias WaveformAxis\n *\n * @param {WaveformOverview|WaveformZoomView} view\n * @param {Object} options\n * @param {String} options.axisGridlineColor\n * @param {String} options.axisLabelColor\n * @param {Boolean} options.showAxisLabels\n * @param {Function} options.formatAxisTime\n * @param {String} options.fontFamily\n * @param {Number} options.fontSize\n * @param {String} options.fontStyle\n */\n\nfunction WaveformAxis(view, options) {\n  const self = this;\n\n  self._axisGridlineColor      = options.axisGridlineColor;\n  self._axisLabelColor         = options.axisLabelColor;\n  self._showAxisLabels         = options.showAxisLabels;\n  self._axisTopMarkerHeight    = options.axisTopMarkerHeight;\n  self._axisBottomMarkerHeight = options.axisBottomMarkerHeight;\n\n  if (options.formatAxisTime) {\n    self._formatAxisTime = options.formatAxisTime;\n  }\n  else {\n    self._formatAxisTime = function(time) {\n      // precision = 0, drops the fractional seconds\n      return formatTime(time, 0);\n    };\n  }\n\n  self._axisLabelFont = WaveformAxis._buildFontString(\n    options.fontFamily,\n    options.fontSize,\n    options.fontStyle\n  );\n\n  self._axisShape = new Konva.Shape({\n    sceneFunc: function(context) {\n      self._drawAxis(context, view);\n    }\n  });\n}\n\nWaveformAxis._buildFontString = function(fontFamily, fontSize, fontStyle) {\n  if (!fontSize) {\n    fontSize = 11;\n  }\n\n  if (!fontFamily) {\n    fontFamily = 'sans-serif';\n  }\n\n  if (!fontStyle) {\n    fontStyle = 'normal';\n  }\n\n  return fontStyle + ' ' + fontSize + 'px ' + fontFamily;\n};\n\nWaveformAxis.prototype.addToLayer = function(layer) {\n  layer.add(this._axisShape);\n};\n\nWaveformAxis.prototype.showAxisLabels = function(show, options) {\n  this._showAxisLabels = show;\n\n  if (options) {\n    if (objectHasProperty(options, 'topMarkerHeight')) {\n      this._axisTopMarkerHeight = options.topMarkerHeight;\n    }\n\n    if (objectHasProperty(options, 'bottomMarkerHeight')) {\n      this._axisBottomMarkerHeight = options.bottomMarkerHeight;\n    }\n  }\n};\n\nWaveformAxis.prototype.setAxisLabelColor = function(color) {\n  this._axisLabelColor = color;\n};\n\nWaveformAxis.prototype.setAxisGridlineColor = function(color) {\n  this._axisGridlineColor = color;\n};\n\n/**\n * Returns number of seconds for each x-axis marker, appropriate for the\n * current zoom level, ensuring that markers are not too close together\n * and that markers are placed at intuitive time intervals (i.e., every 1,\n * 2, 5, 10, 20, 30 seconds, then every 1, 2, 5, 10, 20, 30 minutes, then\n * every 1, 2, 5, 10, 20, 30 hours).\n *\n * @param {WaveformOverview|WaveformZoomView} view\n * @returns {Number}\n */\n\nWaveformAxis.prototype._getAxisLabelScale = function(view) {\n  let baseSecs = 1; // seconds\n  const steps = [1, 2, 5, 10, 20, 30];\n  const minSpacing = 60;\n  let index = 0;\n\n  let secs;\n\n  for (;;) {\n    secs = baseSecs * steps[index];\n    const pixels = view.timeToPixels(secs);\n\n    if (pixels < minSpacing) {\n      if (++index === steps.length) {\n        baseSecs *= 60; // seconds -> minutes -> hours\n        index = 0;\n      }\n    }\n    else {\n      break;\n    }\n  }\n\n  return secs;\n};\n\n/**\n * Draws the time axis and labels onto a view.\n *\n * @param {Konva.Context} context The context to draw on.\n * @param {WaveformOverview|WaveformZoomView} view\n */\n\nWaveformAxis.prototype._drawAxis = function(context, view) {\n  const currentFrameStartTime = view.getStartTime();\n\n  // Time interval between axis markers (seconds)\n  const axisLabelIntervalSecs = this._getAxisLabelScale(view);\n\n  // Time of first axis marker (seconds)\n  const firstAxisLabelSecs = roundUpToNearest(currentFrameStartTime, axisLabelIntervalSecs);\n\n  // Distance between waveform start time and first axis marker (seconds)\n  const axisLabelOffsetSecs = firstAxisLabelSecs - currentFrameStartTime;\n\n  // Distance between waveform start time and first axis marker (pixels)\n  const axisLabelOffsetPixels = view.timeToPixels(axisLabelOffsetSecs);\n\n  context.setAttr('strokeStyle', this._axisGridlineColor);\n  context.setAttr('lineWidth', 1);\n\n  // Set text style\n  context.setAttr('font', this._axisLabelFont);\n  context.setAttr('fillStyle', this._axisLabelColor);\n  context.setAttr('textAlign', 'left');\n  context.setAttr('textBaseline', 'bottom');\n\n  const width  = view.getWidth();\n  const height = view.getHeight();\n\n  let secs = firstAxisLabelSecs;\n\n  for (;;) {\n    // Position of axis marker (pixels)\n    const x = axisLabelOffsetPixels + view.timeToPixels(secs - firstAxisLabelSecs);\n\n    if (x >= width) {\n      break;\n    }\n\n    if (this._axisTopMarkerHeight > 0) {\n      context.beginPath();\n      context.moveTo(x + 0.5, 0);\n      context.lineTo(x + 0.5, 0 + this._axisTopMarkerHeight);\n      context.stroke();\n    }\n\n    if (this._axisBottomMarkerHeight > 0) {\n      context.beginPath();\n      context.moveTo(x + 0.5, height);\n      context.lineTo(x + 0.5, height - this._axisBottomMarkerHeight);\n      context.stroke();\n    }\n\n    if (this._showAxisLabels) {\n      const label      = this._formatAxisTime(secs);\n      const labelWidth = context.measureText(label).width;\n      const labelX     = x - labelWidth / 2;\n      const labelY     = height - 1 - this._axisBottomMarkerHeight;\n\n      if (labelX >= 0) {\n        context.fillText(label, labelX, labelY);\n      }\n    }\n\n    secs += axisLabelIntervalSecs;\n  }\n};\n\nexport default WaveformAxis;\n","/**\n * @file\n *\n * Defines the {@link WaveformView} class.\n *\n * @module waveform-view\n */\n\nimport PointsLayer from './points-layer';\nimport PlayheadLayer from './playhead-layer';\nimport SegmentsLayer from './segments-layer';\nimport WaveformAxis from './waveform-axis';\nimport WaveformShape from './waveform-shape';\n\nimport { formatTime, getMarkerObject, isFinite, isNumber } from './utils';\n\nimport Konva from 'konva/lib/Core';\n\nfunction WaveformView(waveformData, container, peaks, viewOptions) {\n  const self = this;\n\n  self._container = container;\n  self._peaks = peaks;\n  self._options = peaks.options;\n  self._viewOptions = viewOptions;\n\n  self._originalWaveformData = waveformData;\n  self._data = waveformData;\n\n  // The pixel offset of the current frame being displayed\n  self._frameOffset = 0;\n  self._width = container.clientWidth;\n  self._height = container.clientHeight;\n\n  self._amplitudeScale = 1.0;\n\n  self._waveformColor = self._viewOptions.waveformColor;\n  self._playedWaveformColor = self._viewOptions.playedWaveformColor;\n\n  self._timeLabelPrecision = self._viewOptions.timeLabelPrecision;\n\n  if (self._viewOptions.formatPlayheadTime) {\n    self._formatPlayheadTime = self._viewOptions.formatPlayheadTime;\n  }\n  else {\n    self._formatPlayheadTime = function(time) {\n      return formatTime(time, self._timeLabelPrecision);\n    };\n  }\n\n  self._enableSeek = true;\n\n  self.initWaveformData();\n\n  // Disable warning: The stage has 6 layers.\n  // Recommended maximum number of layers is 3-5.\n  Konva.showWarnings = false;\n\n  self._stage = new Konva.Stage({\n    container: container,\n    width: self._width,\n    height: self._height\n  });\n\n  self._createWaveform();\n\n  if (self._viewOptions.enableSegments) {\n    self._segmentsLayer = new SegmentsLayer(peaks, self, self._viewOptions.enableEditing);\n    self._segmentsLayer.addToStage(self._stage);\n  }\n\n  if (self._viewOptions.enablePoints) {\n    self._pointsLayer = new PointsLayer(peaks, self, self._viewOptions.enableEditing);\n    self._pointsLayer.addToStage(self._stage);\n  }\n\n  self.initHighlightLayer();\n\n  self._createAxisLabels();\n\n  self._playheadLayer = new PlayheadLayer(\n    self._peaks.player,\n    self,\n    self._viewOptions\n  );\n\n  self._playheadLayer.addToStage(self._stage);\n\n  self._onClick = self._onClick.bind(self);\n  self._onDblClick = self._onDblClick.bind(self);\n  self._onContextMenu = self._onContextMenu.bind(self);\n\n  self._stage.on('click', self._onClick);\n  self._stage.on('dblclick', self._onDblClick);\n  self._stage.on('contextmenu', self._onContextMenu);\n}\n\nWaveformView.prototype.getViewOptions = function() {\n  return this._viewOptions;\n};\n\n/**\n * @returns {WaveformData} The view's waveform data.\n */\n\nWaveformView.prototype.getWaveformData = function() {\n  return this._data;\n};\n\nWaveformView.prototype.setWaveformData = function(waveformData) {\n  this._data = waveformData;\n};\n\n/**\n * Returns the pixel index for a given time, for the current zoom level.\n *\n * @param {Number} time Time, in seconds.\n * @returns {Number} Pixel index.\n */\n\nWaveformView.prototype.timeToPixels = function(time) {\n  return Math.floor(time * this._data.sample_rate / this._data.scale);\n};\n\n/**\n * Returns the time for a given pixel index, for the current zoom level.\n *\n * @param {Number} pixels Pixel index.\n * @returns {Number} Time, in seconds.\n */\n\nWaveformView.prototype.pixelsToTime = function(pixels) {\n  return pixels * this._data.scale / this._data.sample_rate;\n};\n\n/**\n * Returns the time for a given pixel offset (relative to the\n * current scroll position), for the current zoom level.\n *\n * @param {Number} offset Offset from left-visible-edge of view\n * @returns {Number} Time, in seconds.\n */\n\nWaveformView.prototype.pixelOffsetToTime = function(offset) {\n  const pixels = this._frameOffset + offset;\n\n  return pixels * this._data.scale / this._data.sample_rate;\n};\n\nWaveformView.prototype.timeToPixelOffset = function(time) {\n  return Math.floor(time * this._data.sample_rate / this._data.scale) - this._frameOffset;\n};\n\n/**\n * @returns {Number} The start position of the waveform shown in the view,\n *   in pixels.\n */\n\nWaveformView.prototype.getFrameOffset = function() {\n  return this._frameOffset;\n};\n\n/**\n * @returns {Number} The width of the view, in pixels.\n */\n\nWaveformView.prototype.getWidth = function() {\n  return this._width;\n};\n\n/**\n * @returns {Number} The height of the view, in pixels.\n */\n\nWaveformView.prototype.getHeight = function() {\n  return this._height;\n};\n\n/**\n * @returns {Number} The time at the left edge of the waveform view.\n */\n\nWaveformView.prototype.getStartTime = function() {\n  return this.pixelOffsetToTime(0);\n};\n\n/**\n * @returns {Number} The time at the right edge of the waveform view.\n */\n\nWaveformView.prototype.getEndTime = function() {\n  return this.pixelOffsetToTime(this._width);\n};\n\n/**\n * @returns {Number} The media duration, in seconds.\n */\n\nWaveformView.prototype._getDuration = function() {\n  return this._peaks.player.getDuration();\n};\n\nWaveformView.prototype._createWaveform = function() {\n  this._waveformLayer = new Konva.Layer({ listening: false });\n\n  this._createWaveformShapes();\n\n  this._stage.add(this._waveformLayer);\n};\n\nWaveformView.prototype._createWaveformShapes = function() {\n  if (!this._waveformShape) {\n    this._waveformShape = new WaveformShape({\n      color: this._waveformColor,\n      view: this\n    });\n\n    this._waveformShape.addToLayer(this._waveformLayer);\n  }\n\n  if (this._playedWaveformColor && !this._playedWaveformShape) {\n    const time = this._peaks.player.getCurrentTime();\n\n    this._playedSegment = {\n      startTime: 0,\n      endTime: time\n    };\n\n    this._unplayedSegment = {\n      startTime: time,\n      endTime: this._getDuration()\n    };\n\n    this._waveformShape.setSegment(this._unplayedSegment);\n\n    this._playedWaveformShape = new WaveformShape({\n      color: this._playedWaveformColor,\n      view: this,\n      segment: this._playedSegment\n    });\n\n    this._playedWaveformShape.addToLayer(this._waveformLayer);\n  }\n};\n\nWaveformView.prototype.setWaveformColor = function(color) {\n  this._waveformColor = color;\n  this._waveformShape.setWaveformColor(color);\n};\n\nWaveformView.prototype.setPlayedWaveformColor = function(color) {\n  this._playedWaveformColor = color;\n\n  if (color) {\n    if (!this._playedWaveformShape) {\n      this._createWaveformShapes();\n    }\n\n    this._playedWaveformShape.setWaveformColor(color);\n  }\n  else {\n    if (this._playedWaveformShape) {\n      this._destroyPlayedWaveformShape();\n    }\n  }\n};\n\nWaveformView.prototype._destroyPlayedWaveformShape = function() {\n  this._waveformShape.setSegment(null);\n\n  this._playedWaveformShape.destroy();\n  this._playedWaveformShape = null;\n\n  this._playedSegment = null;\n  this._unplayedSegment = null;\n};\n\nWaveformView.prototype._createAxisLabels = function() {\n  this._axisLayer = new Konva.Layer({ listening: false });\n  this._axis = new WaveformAxis(this, this._viewOptions);\n\n  this._axis.addToLayer(this._axisLayer);\n  this._stage.add(this._axisLayer);\n};\n\nWaveformView.prototype.showAxisLabels = function(show, options) {\n  this._axis.showAxisLabels(show, options);\n  this._axisLayer.draw();\n};\n\nWaveformView.prototype.setAxisLabelColor = function(color) {\n  this._axis.setAxisLabelColor(color);\n  this._axisLayer.draw();\n};\n\nWaveformView.prototype.setAxisGridlineColor = function(color) {\n  this._axis.setAxisGridlineColor(color);\n  this._axisLayer.draw();\n};\n\nWaveformView.prototype.showPlayheadTime = function(show) {\n  this._playheadLayer.showPlayheadTime(show);\n};\n\nWaveformView.prototype.setTimeLabelPrecision = function(precision) {\n  this._timeLabelPrecision = precision;\n  this._playheadLayer.updatePlayheadText();\n};\n\nWaveformView.prototype.formatTime = function(time) {\n  return this._formatPlayheadTime(time);\n};\n\n/**\n * Adjusts the amplitude scale of waveform shown in the view, which allows\n * users to zoom the waveform vertically.\n *\n * @param {Number} scale The new amplitude scale factor\n */\n\nWaveformView.prototype.setAmplitudeScale = function(scale) {\n  if (!isNumber(scale) || !isFinite(scale)) {\n    throw new Error('view.setAmplitudeScale(): Scale must be a valid number');\n  }\n\n  this._amplitudeScale = scale;\n\n  this.drawWaveformLayer();\n\n  if (this._segmentsLayer) {\n    this._segmentsLayer.draw();\n  }\n};\n\nWaveformView.prototype.getAmplitudeScale = function() {\n  return this._amplitudeScale;\n};\n\nWaveformView.prototype.enableSeek = function(enable) {\n  this._enableSeek = enable;\n};\n\nWaveformView.prototype.isSeekEnabled = function() {\n  return this._enableSeek;\n};\n\nWaveformView.prototype._onClick = function(event) {\n  this._clickHandler(event, 'click');\n};\n\nWaveformView.prototype._onDblClick = function(event) {\n  this._clickHandler(event, 'dblclick');\n};\n\nWaveformView.prototype._onContextMenu = function(event) {\n  this._clickHandler(event, 'contextmenu');\n};\n\nWaveformView.prototype._clickHandler = function(event, eventName) {\n  let offsetX = event.evt.offsetX;\n\n  if (offsetX < 0) {\n    offsetX = 0;\n  }\n\n  let emitViewEvent = true;\n\n  if (event.target !== this._stage) {\n    const marker = getMarkerObject(event.target);\n\n    if (marker) {\n      if (marker.attrs.name === 'point-marker') {\n        const point = marker.getAttr('point');\n\n        if (point) {\n          this._peaks.emit('points.' + eventName, {\n            point: point,\n            evt: event.evt,\n            preventViewEvent: function() {\n              emitViewEvent = false;\n            }\n          });\n        }\n      }\n      else if (marker.attrs.name === 'segment-overlay') {\n        const segment = marker.getAttr('segment');\n\n        if (segment) {\n          const clickEvent = {\n            segment: segment,\n            evt: event.evt,\n            preventViewEvent: function() {\n              emitViewEvent = false;\n            }\n          };\n\n          if (this._segmentsLayer) {\n            this._segmentsLayer.segmentClicked(eventName, clickEvent);\n          }\n        }\n      }\n    }\n  }\n\n  if (emitViewEvent) {\n    const time = this.pixelOffsetToTime(offsetX);\n    const viewName = this.getName();\n\n    this._peaks.emit(viewName + '.' + eventName, {\n      time: time,\n      evt: event.evt\n    });\n  }\n};\n\nWaveformView.prototype.updatePlayheadTime = function(time) {\n  this._playheadLayer.updatePlayheadTime(time);\n};\n\nWaveformView.prototype.playheadPosChanged = function(time) {\n  if (this._playedWaveformShape) {\n    this._playedSegment.endTime = time;\n    this._unplayedSegment.startTime = time;\n\n    this.drawWaveformLayer();\n  }\n};\n\nWaveformView.prototype.drawWaveformLayer = function() {\n  this._waveformLayer.draw();\n};\n\nWaveformView.prototype.enableMarkerEditing = function(enable) {\n  if (this._segmentsLayer) {\n    this._segmentsLayer.enableEditing(enable);\n  }\n\n  if (this._pointsLayer) {\n    this._pointsLayer.enableEditing(enable);\n  }\n};\n\n/**\n * Called when the user starts or stops dragging the playhead.\n * We use this to disable interaction with the points and segments layers,\n * e.g., so that when the user drags the playhead over a marker, the timestamp\n * labels don't appear.\n */\n\nWaveformView.prototype.dragSeek = function(dragging) {\n  if (this._segmentsLayer) {\n    this._segmentsLayer.setListening(!dragging);\n  }\n\n  if (this._pointsLayer) {\n    this._pointsLayer.setListening(!dragging);\n  }\n};\n\nWaveformView.prototype.fitToContainer = function() {\n  if (this._container.clientWidth === 0 && this._container.clientHeight === 0) {\n    return;\n  }\n\n  let updateWaveform = false;\n\n  if (this._container.clientWidth !== this._width) {\n    this._width = this._container.clientWidth;\n    this._stage.setWidth(this._width);\n\n    updateWaveform = this.containerWidthChange();\n  }\n\n  let heightChanged = false;\n\n  if (this._container.clientHeight !== this._height) {\n    this._height = this._container.clientHeight;\n    this._stage.setHeight(this._height);\n\n    this._waveformShape.fitToView();\n    this._playheadLayer.fitToView();\n\n    this.containerHeightChange();\n\n    heightChanged = true;\n  }\n\n  if (updateWaveform) {\n    this.updateWaveform(this._frameOffset, true);\n  }\n  else if (heightChanged) {\n    if (this._segmentsLayer) {\n      this._segmentsLayer.fitToView();\n    }\n\n    if (this._pointsLayer) {\n      this._pointsLayer.fitToView();\n    }\n  }\n};\n\nWaveformView.prototype.destroy = function() {\n  this._playheadLayer.destroy();\n\n  if (this._segmentsLayer) {\n    this._segmentsLayer.destroy();\n  }\n\n  if (this._pointsLayer) {\n    this._pointsLayer.destroy();\n  }\n\n  if (this._stage) {\n    this._stage.destroy();\n    this._stage = null;\n  }\n};\n\nexport default WaveformView;\n","/**\n * @file\n *\n * Defines the {@link MouseDragHandler} class.\n *\n * @module mouse-drag-handler\n */\n\nimport { getMarkerObject } from './utils';\n\n/**\n * An object to receive callbacks on mouse drag events. Each function is\n * called with the current mouse X position, relative to the stage's\n * container HTML element.\n *\n * @typedef {Object} MouseDragHandlers\n * @global\n * @property {Function} onMouseDown Mouse down event handler.\n * @property {Function} onMouseMove Mouse move event handler.\n * @property {Function} onMouseUp Mouse up event handler.\n */\n\n/**\n * Creates a handler for mouse events to allow interaction with the waveform\n * views by clicking and dragging the mouse.\n *\n * @class\n * @alias MouseDragHandler\n *\n * @param {Konva.Stage} stage\n * @param {MouseDragHandlers} handlers\n */\n\nfunction MouseDragHandler(stage, handlers) {\n  this._stage     = stage;\n  this._handlers  = handlers;\n  this._dragging  = false;\n  this._mouseDown = this._mouseDown.bind(this);\n  this._mouseUp   = this._mouseUp.bind(this);\n  this._mouseMove = this._mouseMove.bind(this);\n\n  this._stage.on('mousedown', this._mouseDown);\n  this._stage.on('touchstart', this._mouseDown);\n\n  this._lastMouseClientX = null;\n}\n\n/**\n * Mouse down event handler.\n *\n * @param {MouseEvent} event\n */\n\nMouseDragHandler.prototype._mouseDown = function(event) {\n  let segment = null;\n\n  if (event.type === 'mousedown' && event.evt.button !== 0) {\n    // Mouse drag only applies to the primary mouse button.\n    // The secondary button may be used to show a context menu\n    // and we don't want to also treat this as a mouse drag operation.\n    return;\n  }\n\n  const marker = getMarkerObject(event.target);\n\n  if (marker) {\n    // Avoid interfering with drag/drop of point and segment markers.\n    if (marker.attrs.name === 'point-marker' ||\n        marker.attrs.name === 'segment-marker') {\n      return;\n    }\n\n    // Check if we're dragging a segment.\n    if (marker.attrs.name === 'segment-overlay') {\n      segment = marker;\n    }\n  }\n\n  this._lastMouseClientX = Math.floor(\n    event.type === 'touchstart' ? event.evt.touches[0].clientX : event.evt.clientX\n  );\n\n  if (this._handlers.onMouseDown) {\n    const mouseDownPosX = this._getMousePosX(this._lastMouseClientX);\n\n    this._handlers.onMouseDown(mouseDownPosX, segment);\n  }\n\n  // Use the window mousemove and mouseup handlers instead of the\n  // Konva.Stage ones so that we still receive events if the user moves the\n  // mouse outside the stage.\n  window.addEventListener('mousemove', this._mouseMove, { capture: false, passive: true });\n  window.addEventListener('touchmove', this._mouseMove, { capture: false, passive: true });\n  window.addEventListener('mouseup', this._mouseUp, { capture: false, passive: true });\n  window.addEventListener('touchend', this._mouseUp, { capture: false /* , passive: true */ });\n  window.addEventListener('blur', this._mouseUp, { capture: false, passive: true });\n};\n\n/**\n * Mouse move event handler.\n *\n * @param {MouseEvent} event\n */\n\nMouseDragHandler.prototype._mouseMove = function(event) {\n  const clientX = Math.floor(\n    event.type === 'touchmove' ? event.changedTouches[0].clientX : event.clientX\n  );\n\n  // Don't update on vertical mouse movement.\n  if (clientX === this._lastMouseClientX) {\n    return;\n  }\n\n  this._lastMouseClientX = clientX;\n\n  this._dragging = true;\n\n  if (this._handlers.onMouseMove) {\n    const mousePosX = this._getMousePosX(clientX);\n\n    this._handlers.onMouseMove(mousePosX);\n  }\n};\n\n/**\n * Mouse up event handler.\n *\n * @param {MouseEvent} event\n */\n\nMouseDragHandler.prototype._mouseUp = function(event) {\n  let clientX;\n\n  if (event.type === 'touchend') {\n    clientX = Math.floor(event.changedTouches[0].clientX);\n\n    if (event.cancelable) {\n      event.preventDefault();\n    }\n  }\n  else {\n    clientX = Math.floor(event.clientX);\n  }\n\n  if (this._handlers.onMouseUp) {\n    const mousePosX = this._getMousePosX(clientX);\n\n    this._handlers.onMouseUp(mousePosX);\n  }\n\n  window.removeEventListener('mousemove', this._mouseMove, { capture: false });\n  window.removeEventListener('touchmove', this._mouseMove, { capture: false });\n  window.removeEventListener('mouseup', this._mouseUp, { capture: false });\n  window.removeEventListener('touchend', this._mouseUp, { capture: false });\n  window.removeEventListener('blur', this._mouseUp, { capture: false });\n\n  this._dragging = false;\n};\n\n/**\n * @returns {Number} The mouse X position, relative to the container that\n * received the mouse down event.\n *\n * @private\n * @param {Number} clientX Mouse client X position.\n */\n\nMouseDragHandler.prototype._getMousePosX = function(clientX) {\n  const containerPos = this._stage.getContainer().getBoundingClientRect();\n\n  return Math.floor(clientX - containerPos.left);\n};\n\n/**\n * Returns <code>true</code> if the mouse is being dragged, i.e., moved with\n * the mouse button held down.\n *\n * @returns {Boolean}\n */\n\nMouseDragHandler.prototype.isDragging = function() {\n  return this._dragging;\n};\n\nMouseDragHandler.prototype.destroy = function() {\n  this._stage.off('mousedown', this._mouseDown);\n  this._stage.off('touchstart', this._mouseDown);\n};\n\nexport default MouseDragHandler;\n","/**\n * @file\n *\n * Defines the {@link SeekMouseDragHandler} class.\n *\n * @module seek-mouse-drag-handler\n */\n\nimport MouseDragHandler from './mouse-drag-handler';\nimport { clamp } from './utils';\n\n/**\n * Creates a handler for mouse events to allow seeking the waveform\n * views by clicking and dragging the mouse.\n *\n * @class\n * @alias SeekMouseDragHandler\n *\n * @param {Peaks} peaks\n * @param {WaveformOverview} view\n */\n\nfunction SeekMouseDragHandler(peaks, view) {\n  this._peaks = peaks;\n  this._view = view;\n  this._firstMove = false;\n\n  this._onMouseDown = this._onMouseDown.bind(this);\n  this._onMouseMove = this._onMouseMove.bind(this);\n  this._onMouseUp = this._onMouseUp.bind(this);\n\n  this._mouseDragHandler = new MouseDragHandler(view._stage, {\n    onMouseDown: this._onMouseDown,\n    onMouseMove: this._onMouseMove,\n    onMouseUp: this._onMouseUp\n  });\n}\n\nSeekMouseDragHandler.prototype._onMouseDown = function(mousePosX) {\n  this._firstMove = true;\n  this._seek(mousePosX);\n};\n\nSeekMouseDragHandler.prototype._onMouseMove = function(mousePosX) {\n  if (this._firstMove) {\n    this._view.dragSeek(true);\n    this._firstMove = false;\n  }\n\n  this._seek(mousePosX);\n};\n\nSeekMouseDragHandler.prototype._onMouseUp = function() {\n  this._view.dragSeek(false);\n};\n\nSeekMouseDragHandler.prototype._seek = function(mousePosX) {\n  if (!this._view.isSeekEnabled()) {\n    return;\n  }\n\n  mousePosX = clamp(mousePosX, 0, this._width);\n\n  let time = this._view.pixelsToTime(mousePosX);\n  const duration = this._peaks.player.getDuration();\n\n  // Prevent the playhead position from jumping by limiting click\n  // handling to the waveform duration.\n  if (time > duration) {\n    time = duration;\n  }\n\n  // Update the playhead position. This gives a smoother visual update\n  // than if we only use the player.timeupdate event.\n  this._view.updatePlayheadTime(time);\n\n  this._peaks.player.seek(time);\n};\n\nSeekMouseDragHandler.prototype.destroy = function() {\n  this._mouseDragHandler.destroy();\n};\n\nexport default SeekMouseDragHandler;\n","/**\n * @file\n *\n * Defines the {@link WaveformOverview} class.\n *\n * @module waveform-overview\n */\n\nimport HighlightLayer from './highlight-layer';\nimport WaveformView from './waveform-view';\nimport SeekMouseDragHandler from './seek-mouse-drag-handler';\n\n/**\n * Creates the overview waveform view.\n *\n * @class\n * @alias WaveformOverview\n *\n * @param {WaveformData} waveformData\n * @param {HTMLElement} container\n * @param {Peaks} peaks\n */\n\nfunction WaveformOverview(waveformData, container, peaks) {\n  const self = this;\n\n  WaveformView.call(self, waveformData, container, peaks, peaks.options.overview);\n\n  // Bind event handlers\n  self._onTimeUpdate = self._onTimeUpdate.bind(self);\n  self._onPlaying = self._onPlaying.bind(self);\n  self._onPause = self._onPause.bind(self);\n  self._onZoomviewUpdate = self._onZoomviewUpdate.bind(self);\n\n  // Register event handlers\n  peaks.on('player.timeupdate', self._onTimeUpdate);\n  peaks.on('player.playing', self._onPlaying);\n  peaks.on('player.pause', self._onPause);\n  peaks.on('zoomview.update', self._onZoomviewUpdate);\n\n  const time = self._peaks.player.getCurrentTime();\n\n  self._playheadLayer.updatePlayheadTime(time);\n\n  self._mouseDragHandler = new SeekMouseDragHandler(peaks, self);\n\n  const zoomview = peaks.views.getView('zoomview');\n\n  if (zoomview) {\n    self._highlightLayer.showHighlight(zoomview.getStartTime(), zoomview.getEndTime());\n  }\n}\n\nWaveformOverview.prototype = Object.create(WaveformView.prototype);\n\nWaveformOverview.prototype.initWaveformData = function() {\n  if (this._width !== 0) {\n    this._resampleAndSetWaveformData(this._originalWaveformData, this._width);\n  }\n};\n\nWaveformOverview.prototype.initHighlightLayer = function() {\n  this._highlightLayer = new HighlightLayer(\n    this,\n    this._viewOptions\n  );\n\n  this._highlightLayer.addToStage(this._stage);\n};\n\nWaveformOverview.prototype.isSegmentDraggingEnabled = function() {\n  return false;\n};\n\nWaveformOverview.prototype.getName = function() {\n  return 'overview';\n};\n\nWaveformOverview.prototype._onTimeUpdate = function(time) {\n  this._playheadLayer.updatePlayheadTime(time);\n};\n\nWaveformOverview.prototype._onPlaying = function(time) {\n  this._playheadLayer.updatePlayheadTime(time);\n};\n\nWaveformOverview.prototype._onPause = function(time) {\n  this._playheadLayer.stop(time);\n};\n\nWaveformOverview.prototype._onZoomviewUpdate = function(event) {\n  this.showHighlight(event.startTime, event.endTime);\n};\n\nWaveformOverview.prototype.showHighlight = function(startTime, endTime) {\n  this._highlightLayer.showHighlight(startTime, endTime);\n};\n\nWaveformOverview.prototype.setWaveformData = function(waveformData) {\n  this._originalWaveformData = waveformData;\n\n  if (this._width !== 0) {\n    this._resampleAndSetWaveformData(waveformData, this._width);\n  }\n  else {\n    this._data = waveformData;\n  }\n\n  this.updateWaveform();\n};\n\nWaveformOverview.prototype._resampleAndSetWaveformData = function(waveformData, width) {\n  try {\n    this._data = waveformData.resample({ width: width });\n    return true;\n  }\n  catch (error) { // eslint-disable-line no-unused-vars\n    // This error usually indicates that the waveform length\n    // is less than the container width. Ignore, and use the\n    // given waveform data\n    this._data = waveformData;\n    return false;\n  }\n};\n\nWaveformOverview.prototype.removeHighlightRect = function() {\n  this._highlightLayer.removeHighlight();\n};\n\nWaveformOverview.prototype.updateWaveform = function(/* frameOffset, forceUpdate */) {\n  this._waveformLayer.draw();\n  this._axisLayer.draw();\n\n  const playheadTime = this._peaks.player.getCurrentTime();\n\n  this._playheadLayer.updatePlayheadTime(playheadTime);\n\n  this._highlightLayer.updateHighlight();\n\n  const frameStartTime = 0;\n  const frameEndTime   = this.pixelsToTime(this._width);\n\n  if (this._pointsLayer) {\n    this._pointsLayer.updatePoints(frameStartTime, frameEndTime);\n  }\n\n  if (this._segmentsLayer) {\n    this._segmentsLayer.updateSegments(frameStartTime, frameEndTime);\n  }\n};\n\nWaveformOverview.prototype.containerWidthChange = function() {\n  return this._resampleAndSetWaveformData(this._originalWaveformData, this._width);\n};\n\nWaveformOverview.prototype.containerHeightChange = function() {\n  this._highlightLayer.fitToView();\n};\n\nWaveformOverview.prototype.destroy = function() {\n  // Unregister event handlers\n  this._peaks.off('player.playing', this._onPlaying);\n  this._peaks.off('player.pause', this._onPause);\n  this._peaks.off('player.timeupdate', this._onTimeUpdate);\n  this._peaks.off('zoomview.update', this._onZoomviewUpdate);\n\n  this._mouseDragHandler.destroy();\n\n  WaveformView.prototype.destroy.call(this);\n};\n\nexport default WaveformOverview;\n","/**\n * @file\n *\n * Defines the {@link InsertSegmentMouseDragHandler} class.\n *\n * @module insert-segment-mouse-drag-handler\n */\n\nimport MouseDragHandler from './mouse-drag-handler';\n\n/**\n * Creates a handler for mouse events to allow inserting new waveform\n * segments by clicking and dragging the mouse.\n *\n * @class\n * @alias InsertSegmentMouseDragHandler\n *\n * @param {Peaks} peaks\n * @param {WaveformZoomView} view\n */\n\nfunction InsertSegmentMouseDragHandler(peaks, view) {\n  this._peaks = peaks;\n  this._view = view;\n\n  this._onMouseDown = this._onMouseDown.bind(this);\n  this._onMouseMove = this._onMouseMove.bind(this);\n  this._onMouseUp = this._onMouseUp.bind(this);\n\n  this._mouseDragHandler = new MouseDragHandler(view._stage, {\n    onMouseDown: this._onMouseDown,\n    onMouseMove: this._onMouseMove,\n    onMouseUp: this._onMouseUp\n  });\n}\n\nInsertSegmentMouseDragHandler.prototype.isDragging = function() {\n  return this._mouseDragHandler.isDragging();\n};\n\nInsertSegmentMouseDragHandler.prototype._reset = function() {\n  this._insertSegment = null;\n  this._insertSegmentShape = null;\n  this._segmentIsDraggable = false;\n  this._peaks.segments.setInserting(false);\n};\n\nInsertSegmentMouseDragHandler.prototype._onMouseDown = function(mousePosX, segment) {\n  this._reset();\n  this._segment = segment;\n\n  if (this._segment) {\n    if (this._view.getSegmentDragMode() !== 'overlap') {\n      return;\n    }\n    else {\n      // The user has clicked within a segment. We want to prevent\n      // the segment from being dragged while the user inserts a new\n      // segment. So we temporarily make the segment non-draggable,\n      // and restore its draggable state in onMouseUp().\n      this._segmentIsDraggable = this._segment.draggable();\n      this._segment.draggable(false);\n    }\n  }\n\n  const time = this._view.pixelsToTime(mousePosX + this._view.getFrameOffset());\n\n  this._peaks.segments.setInserting(true);\n\n  this._insertSegment = this._peaks.segments.add({\n    startTime: time,\n    endTime: time,\n    editable: true\n  });\n\n  this._insertSegmentShape = this._view._segmentsLayer.getSegmentShape(this._insertSegment);\n\n  if (this._insertSegmentShape) {\n    this._insertSegmentShape.moveMarkersToTop();\n    this._insertSegmentShape.startDrag();\n  }\n};\n\nInsertSegmentMouseDragHandler.prototype._onMouseMove = function() {\n};\n\nInsertSegmentMouseDragHandler.prototype._onMouseUp = function() {\n  if (!this._insertSegment) {\n    return;\n  }\n\n  if (this._insertSegmentShape) {\n    this._insertSegmentShape.stopDrag();\n    this._insertSegmentShape = null;\n  }\n\n  // If the user was dragging within an existing segment,\n  // restore the segment's original draggable state.\n  if (this._segment && this._segmentIsDraggable) {\n    this._segment.draggable(true);\n  }\n\n  this._peaks.emit('segments.insert', {\n    segment: this._insertSegment\n  });\n\n  this._peaks.segments.setInserting(false);\n};\n\nInsertSegmentMouseDragHandler.prototype.destroy = function() {\n  this._mouseDragHandler.destroy();\n};\n\nexport default InsertSegmentMouseDragHandler;\n","/**\n * @file\n *\n * Defines the {@link ScrollMouseDragHandler} class.\n *\n * @module scroll-mouse-drag-handler\n */\n\nimport MouseDragHandler from './mouse-drag-handler';\nimport { clamp } from './utils';\n\n/**\n * Creates a handler for mouse events to allow scrolling the zoomable\n * waveform view by clicking and dragging the mouse.\n *\n * @class\n * @alias ScrollMouseDragHandler\n *\n * @param {Peaks} peaks\n * @param {WaveformZoomView} view\n */\n\nfunction ScrollMouseDragHandler(peaks, view) {\n  this._peaks = peaks;\n  this._view = view;\n  this._seeking = false;\n  this._firstMove = false;\n  this._segment = null;\n  this._segmentIsDraggable = false;\n  this._initialFrameOffset = 0;\n  this._mouseDownX = 0;\n\n  this._onMouseDown = this._onMouseDown.bind(this);\n  this._onMouseMove = this._onMouseMove.bind(this);\n  this._onMouseUp = this._onMouseUp.bind(this);\n\n  this._mouseDragHandler = new MouseDragHandler(view._stage, {\n    onMouseDown: this._onMouseDown,\n    onMouseMove: this._onMouseMove,\n    onMouseUp: this._onMouseUp\n  });\n}\n\nScrollMouseDragHandler.prototype.isDragging = function() {\n  return this._mouseDragHandler.isDragging();\n};\n\nScrollMouseDragHandler.prototype._onMouseDown = function(mousePosX, segment) {\n  this._seeking = false;\n  this._firstMove = true;\n\n  if (segment && !segment.attrs.draggable) {\n    this._segment = null;\n  }\n  else {\n    this._segment = segment;\n  }\n\n  const playheadOffset = this._view.getPlayheadOffset();\n\n  if (this._view.isSeekEnabled() &&\n      Math.abs(mousePosX - playheadOffset) <= this._view.getPlayheadClickTolerance()) {\n    this._seeking = true;\n\n    // The user has clicked near the playhead, and the playhead is within\n    // a segment. In this case we want to allow the playhead to move, but\n    // prevent the segment from being dragged. So we temporarily make the\n    // segment non-draggable, and restore its draggable state in onMouseUp().\n    if (this._segment) {\n      this._segmentIsDraggable = this._segment.draggable();\n      this._segment.draggable(false);\n    }\n  }\n\n  if (this._seeking) {\n    mousePosX = clamp(mousePosX, 0, this._view.getWidth());\n\n    const time = this._view.pixelsToTime(mousePosX + this._view.getFrameOffset());\n\n    this._seek(time);\n  }\n  else {\n    this._initialFrameOffset = this._view.getFrameOffset();\n    this._mouseDownX = mousePosX;\n  }\n};\n\nScrollMouseDragHandler.prototype._onMouseMove = function(mousePosX) {\n  // Prevent scrolling the waveform if the user is dragging a segment.\n  if (this._segment && !this._seeking) {\n    return;\n  }\n\n  if (this._seeking) {\n    if (this._firstMove) {\n      this._view.dragSeek(true);\n      this._firstMove = false;\n    }\n\n    mousePosX = clamp(mousePosX, 0, this._view.getWidth());\n\n    const time = this._view.pixelsToTime(mousePosX + this._view.getFrameOffset());\n\n    this._seek(time);\n  }\n  else {\n    // TODO: Prevent scrolling when zoomed to fit the waveform to the\n    // view width. Sometimes the waveform is a few pixels longer.\n    if (!this._view.isAutoZoom()) {\n      // Moving the mouse to the left increases the time position of the\n      // left-hand edge of the visible waveform.\n      const diff = this._mouseDownX - mousePosX;\n      const newFrameOffset = this._initialFrameOffset + diff;\n\n      if (newFrameOffset !== this._initialFrameOffset) {\n        this._view.updateWaveform(newFrameOffset);\n      }\n    }\n  }\n};\n\nScrollMouseDragHandler.prototype._onMouseUp = function() {\n  if (this._seeking) {\n    this._view.dragSeek(false);\n  }\n  else {\n    // Set playhead position only on click release, when not dragging.\n    if (this._view._enableSeek && !this._mouseDragHandler.isDragging()) {\n      const time = this._view.pixelOffsetToTime(this._mouseDownX);\n\n      this._seek(time);\n    }\n  }\n\n  // If the user was dragging within an existing segment,\n  // restore the segment's original draggable state.\n  if (this._segment && this._seeking) {\n    if (this._segmentIsDraggable) {\n      this._segment.draggable(true);\n    }\n  }\n};\n\nScrollMouseDragHandler.prototype._seek = function(time) {\n  const duration = this._peaks.player.getDuration();\n\n  // Prevent the playhead position from jumping by limiting click\n  // handling to the waveform duration.\n  if (time > duration) {\n    time = duration;\n  }\n\n  // Update the playhead position. This gives a smoother visual update\n  // than if we only use the player.timeupdate event.\n  this._view.updatePlayheadTime(time);\n\n  this._peaks.player.seek(time);\n};\n\nScrollMouseDragHandler.prototype.destroy = function() {\n  this._mouseDragHandler.destroy();\n};\n\nexport default ScrollMouseDragHandler;\n","/**\n * @file\n *\n * Defines the {@link WaveformZoomView} class.\n *\n * @module waveform-zoomview\n */\n\nimport WaveformView from './waveform-view';\nimport InsertSegmentMouseDragHandler from './insert-segment-mouse-drag-handler';\nimport ScrollMouseDragHandler from './scroll-mouse-drag-handler';\nimport { clamp, isValidTime, objectHasProperty } from './utils';\n\n/**\n * Creates a zoomable waveform view.\n *\n * @class\n * @alias WaveformZoomView\n *\n * @param {WaveformData} waveformData\n * @param {HTMLElement} container\n * @param {Peaks} peaks\n */\n\nfunction WaveformZoomView(waveformData, container, peaks) {\n  const self = this;\n\n  WaveformView.call(self, waveformData, container, peaks, peaks.options.zoomview);\n\n  // Bind event handlers\n  self._onTimeUpdate = self._onTimeUpdate.bind(self);\n  self._onPlaying = self._onPlaying.bind(self);\n  self._onPause = self._onPause.bind(self);\n  self._onKeyboardLeft = self._onKeyboardLeft.bind(self);\n  self._onKeyboardRight = self._onKeyboardRight.bind(self);\n  self._onKeyboardShiftLeft  = self._onKeyboardShiftLeft.bind(self);\n  self._onKeyboardShiftRight = self._onKeyboardShiftRight.bind(self);\n\n  // Register event handlers\n  self._peaks.on('player.timeupdate', self._onTimeUpdate);\n  self._peaks.on('player.playing', self._onPlaying);\n  self._peaks.on('player.pause', self._onPause);\n  self._peaks.on('keyboard.left', self._onKeyboardLeft);\n  self._peaks.on('keyboard.right', self._onKeyboardRight);\n  self._peaks.on('keyboard.shift_left', self._onKeyboardShiftLeft);\n  self._peaks.on('keyboard.shift_right', self._onKeyboardShiftRight);\n\n  self._autoScroll = self._viewOptions.autoScroll;\n  self._autoScrollOffset = self._viewOptions.autoScrollOffset;\n\n  self._enableSegmentDragging = false;\n  self._segmentDragMode = 'overlap';\n  self._minSegmentDragWidth = 0;\n  self._insertSegmentShape = null;\n\n  self._playheadClickTolerance = self._viewOptions.playheadClickTolerance;\n\n  self._zoomLevelAuto = false;\n  self._zoomLevelSeconds = null;\n\n  const time = self._peaks.player.getCurrentTime();\n\n  self._syncPlayhead(time);\n\n  self._mouseDragHandler = new ScrollMouseDragHandler(peaks, self);\n\n  self._onWheel = self._onWheel.bind(self);\n  self._onWheelCaptureVerticalScroll = self._onWheelCaptureVerticalScroll.bind(self);\n  self.setWheelMode(self._viewOptions.wheelMode);\n\n  self._peaks.emit('zoomview.update', {\n    startTime: 0,\n    endTime: self.getEndTime()\n  });\n}\n\nWaveformZoomView.prototype = Object.create(WaveformView.prototype);\n\nWaveformZoomView.prototype.initWaveformData = function() {\n  this._enableWaveformCache = this._options.waveformCache;\n\n  this._initWaveformCache();\n\n  const initialZoomLevel = this._peaks.zoom.getZoomLevel();\n\n  this._resampleData({ scale: initialZoomLevel });\n};\n\nWaveformZoomView.prototype._initWaveformCache = function() {\n  if (this._enableWaveformCache) {\n    this._waveformData = new Map();\n    this._waveformData.set(this._originalWaveformData.scale, this._originalWaveformData);\n    this._waveformScales = [this._originalWaveformData.scale];\n  }\n};\n\nWaveformZoomView.prototype.initHighlightLayer = function() {\n};\n\nWaveformZoomView.prototype.setWheelMode = function(mode, options) {\n  if (!options) {\n    options = {};\n  }\n\n  if (mode !== this._wheelMode ||\n      options.captureVerticalScroll !== this._captureVerticalScroll) {\n    this._stage.off('wheel');\n\n    this._wheelMode = mode;\n    this._captureVerticalScroll = options.captureVerticalScroll;\n\n    switch (mode) {\n      case 'scroll':\n        if (options.captureVerticalScroll) {\n          this._stage.on('wheel', this._onWheelCaptureVerticalScroll);\n        }\n        else {\n          this._stage.on('wheel', this._onWheel);\n        }\n        break;\n    }\n  }\n};\n\nWaveformZoomView.prototype._onWheel = function(event) {\n  const wheelEvent = event.evt;\n  let delta;\n\n  if (wheelEvent.shiftKey) {\n    if (wheelEvent.deltaY !== 0) {\n      delta = wheelEvent.deltaY;\n    }\n    else if (wheelEvent.deltaX !== 0) {\n      delta = wheelEvent.deltaX;\n    }\n    else {\n      return;\n    }\n  }\n  else {\n    // Ignore the event if it looks like the user is scrolling vertically\n    // down the page\n    if (Math.abs(wheelEvent.deltaX) < Math.abs(wheelEvent.deltaY)) {\n      return;\n    }\n\n    delta = wheelEvent.deltaX;\n  }\n\n  if (wheelEvent.deltaMode === WheelEvent.DOM_DELTA_PAGE) {\n    delta *= this._width;\n  }\n\n  wheelEvent.preventDefault();\n\n  const frameOffset = clamp(\n    this._frameOffset + Math.floor(delta), 0, this._pixelLength - this._width\n  );\n\n  this.updateWaveform(frameOffset, false);\n};\n\nWaveformZoomView.prototype._onWheelCaptureVerticalScroll = function(event) {\n  const wheelEvent = event.evt;\n\n  const delta = Math.abs(wheelEvent.deltaX) < Math.abs(wheelEvent.deltaY) ?\n    wheelEvent.deltaY : wheelEvent.deltaX;\n\n  wheelEvent.preventDefault();\n\n  const frameOffset = clamp(\n    this._frameOffset + Math.floor(delta), 0, this._pixelLength - this._width\n  );\n\n  this.updateWaveform(frameOffset, false);\n};\n\nWaveformZoomView.prototype.setWaveformDragMode = function(mode) {\n  if (this._segmentsLayer) {\n    this._mouseDragHandler.destroy();\n    this.dragSeek(false);\n\n    if (mode === 'insert-segment') {\n      this._mouseDragHandler = new InsertSegmentMouseDragHandler(this._peaks, this);\n    }\n    else {\n      this._mouseDragHandler = new ScrollMouseDragHandler(this._peaks, this);\n    }\n  }\n};\n\nWaveformZoomView.prototype.enableSegmentDragging = function(enable) {\n  this._enableSegmentDragging = enable;\n\n  // Update all existing segments\n  if (this._segmentsLayer) {\n    this._segmentsLayer.enableSegmentDragging(enable);\n  }\n};\n\nWaveformZoomView.prototype.isSegmentDraggingEnabled = function() {\n  return this._enableSegmentDragging;\n};\n\nWaveformZoomView.prototype.setSegmentDragMode = function(mode) {\n  this._segmentDragMode = mode;\n};\n\nWaveformZoomView.prototype.getSegmentDragMode = function() {\n  return this._segmentDragMode;\n};\n\nWaveformZoomView.prototype.getName = function() {\n  return 'zoomview';\n};\n\nWaveformZoomView.prototype._onTimeUpdate = function(time) {\n  if (this._mouseDragHandler.isDragging()) {\n    return;\n  }\n\n  this._syncPlayhead(time);\n};\n\nWaveformZoomView.prototype._onPlaying = function(time) {\n  this._playheadLayer.updatePlayheadTime(time);\n};\n\nWaveformZoomView.prototype._onPause = function(time) {\n  this._playheadLayer.stop(time);\n};\n\nWaveformZoomView.prototype._onKeyboardLeft = function() {\n  this._keyboardScroll(-1, false);\n};\n\nWaveformZoomView.prototype._onKeyboardRight = function() {\n  this._keyboardScroll(1, false);\n};\n\nWaveformZoomView.prototype._onKeyboardShiftLeft = function() {\n  this._keyboardScroll(-1, true);\n};\n\nWaveformZoomView.prototype._onKeyboardShiftRight = function() {\n  this._keyboardScroll(1, true);\n};\n\nWaveformZoomView.prototype._keyboardScroll = function(direction, large) {\n  let increment;\n\n  if (large) {\n    increment = direction * this._width;\n  }\n  else {\n    increment = direction * this.timeToPixels(this._options.nudgeIncrement);\n  }\n\n  this.scrollWaveform({ pixels: increment });\n};\n\nWaveformZoomView.prototype.setWaveformData = function(waveformData) {\n  this._originalWaveformData = waveformData;\n  // Clear cached waveforms\n  this._initWaveformCache();\n\n  // Don't update the UI here, call setZoom().\n};\n\n/**\n * Returns the position of the playhead marker, in pixels relative to the\n * left hand side of the waveform view.\n *\n * @return {Number}\n */\n\nWaveformZoomView.prototype.getPlayheadOffset = function() {\n  return this._playheadLayer.getPlayheadPixel() - this._frameOffset;\n};\n\nWaveformZoomView.prototype.getPlayheadClickTolerance = function() {\n  return this._playheadClickTolerance;\n};\n\nWaveformZoomView.prototype._syncPlayhead = function(time) {\n  this._playheadLayer.updatePlayheadTime(time);\n\n  if (this._autoScroll && !this._zoomLevelAuto) {\n    // Check for the playhead reaching the right-hand side of the window.\n\n    const pixelIndex = this.timeToPixels(time);\n\n    // TODO: move this code to animation function?\n    // TODO: don't scroll if user has positioned view manually (e.g., using\n    // the keyboard)\n    const endThreshold = this._frameOffset + this._width - this._autoScrollOffset;\n\n    let frameOffset = this._frameOffset;\n\n    if (pixelIndex >= endThreshold || pixelIndex < frameOffset) {\n      // Put the playhead at 100 pixels from the left edge\n      frameOffset = pixelIndex - this._autoScrollOffset;\n\n      if (frameOffset < 0) {\n        frameOffset = 0;\n      }\n\n      this.updateWaveform(frameOffset, false);\n    }\n  }\n};\n\nWaveformZoomView.prototype._getScale = function(duration) {\n  return Math.floor(duration * this._data.sample_rate / this._width);\n};\n\nfunction isAutoScale(options) {\n  return ((objectHasProperty(options, 'scale') && options.scale === 'auto') ||\n          (objectHasProperty(options, 'seconds') && options.seconds === 'auto'));\n}\n\n/**\n * Options for [WaveformZoomView.setZoom]{@link WaveformZoomView#setZoom}.\n *\n * @typedef {Object} SetZoomOptions\n * @global\n * @property {Number|String} scale Zoom level, in samples per pixel, or 'auto'\n *   to fit the entire waveform to the view width\n * @property {Number|String} seconds Number of seconds to fit to the view width,\n *   or 'auto' to fit the entire waveform to the view width\n */\n\n/**\n * Changes the zoom level.\n *\n * @param {SetZoomOptions} options\n * @returns {Boolean}\n */\n\nWaveformZoomView.prototype.setZoom = function(options) {\n  let scale;\n\n  if (isAutoScale(options)) {\n    // Use waveform duration, to match WaveformOverview\n    const seconds = this._originalWaveformData.duration;\n\n    this._zoomLevelAuto = true;\n    this._zoomLevelSeconds = null;\n    scale = this._getScale(seconds);\n  }\n  else {\n    if (objectHasProperty(options, 'scale')) {\n      this._zoomLevelSeconds = null;\n      scale = Math.floor(options.scale);\n    }\n    else if (objectHasProperty(options, 'seconds')) {\n      if (!isValidTime(options.seconds)) {\n        return false;\n      }\n\n      this._zoomLevelSeconds = options.seconds;\n      scale = this._getScale(options.seconds);\n    }\n\n    this._zoomLevelAuto = false;\n  }\n\n  if (scale < this._originalWaveformData.scale) {\n    // eslint-disable-next-line @stylistic/js/max-len\n    this._peaks._logger('peaks.zoomview.setZoom(): zoom level must be at least ' + this._originalWaveformData.scale);\n    scale = this._originalWaveformData.scale;\n  }\n\n  const currentTime = this._peaks.player.getCurrentTime();\n  let apexTime;\n  let playheadOffsetPixels = this.getPlayheadOffset();\n\n  if (playheadOffsetPixels >= 0 && playheadOffsetPixels < this._width) {\n    // Playhead is visible. Change the zoom level while keeping the\n    // playhead at the same position in the window.\n    apexTime = currentTime;\n  }\n  else {\n    // Playhead is not visible. Change the zoom level while keeping the\n    // centre of the window at the same position in the waveform.\n    playheadOffsetPixels = Math.floor(this._width / 2);\n    apexTime = this.pixelOffsetToTime(playheadOffsetPixels);\n  }\n\n  const prevScale = this._scale;\n\n  this._resampleData({ scale: scale });\n\n  const apexPixel = this.timeToPixels(apexTime);\n\n  const frameOffset = apexPixel - playheadOffsetPixels;\n\n  this.updateWaveform(frameOffset, true);\n\n  this._playheadLayer.zoomLevelChanged();\n\n  // Update the playhead position after zooming.\n  this._playheadLayer.updatePlayheadTime(currentTime);\n\n  this._peaks.emit('zoom.update', {\n    currentZoom: scale,\n    previousZoom: prevScale\n  });\n\n  return true;\n};\n\nWaveformZoomView.prototype._resampleData = function(options) {\n  const scale = options.scale;\n\n  if (this._enableWaveformCache) {\n    if (!this._waveformData.has(scale)) {\n      let sourceWaveform = this._originalWaveformData;\n\n      // Resample from the next lowest available zoom level\n\n      for (let i = 0; i < this._waveformScales.length; i++) {\n        if (this._waveformScales[i] < scale) {\n          sourceWaveform = this._waveformData.get(this._waveformScales[i]);\n        }\n        else {\n          break;\n        }\n      }\n\n      this._waveformData.set(scale, sourceWaveform.resample(options));\n\n      this._waveformScales.push(scale);\n      this._waveformScales.sort(function(a, b) {\n        return a - b; // Ascending order\n      });\n    }\n\n    this._data = this._waveformData.get(scale);\n  }\n  else {\n    this._data = this._originalWaveformData.resample(options);\n  }\n\n  this._scale = this._data.scale;\n  this._pixelLength = this._data.length;\n};\n\nWaveformZoomView.prototype.isAutoZoom = function() {\n  return this._zoomLevelAuto;\n};\n\nWaveformZoomView.prototype.setStartTime = function(time) {\n  if (time < 0) {\n    time = 0;\n  }\n\n  if (this._zoomLevelAuto) {\n    time = 0;\n  }\n\n  this.updateWaveform(this.timeToPixels(time), false);\n};\n\n/**\n * @returns {Number} The length of the waveform, in pixels.\n */\n\nWaveformZoomView.prototype.getPixelLength = function() {\n  return this._pixelLength;\n};\n\n/**\n * Scrolls the region of waveform shown in the view.\n *\n * @param {Number} scrollAmount How far to scroll, in pixels\n */\n\nWaveformZoomView.prototype.scrollWaveform = function(options) {\n  let scrollAmount;\n\n  if (objectHasProperty(options, 'pixels')) {\n    scrollAmount = Math.floor(options.pixels);\n  }\n  else if (objectHasProperty(options, 'seconds')) {\n    scrollAmount = this.timeToPixels(options.seconds);\n  }\n  else {\n    throw new TypeError('view.scrollWaveform(): Missing umber of pixels or seconds');\n  }\n\n  this.updateWaveform(this._frameOffset + scrollAmount, false);\n};\n\n/**\n * Updates the region of waveform shown in the view.\n *\n * @param {Number} frameOffset The new frame offset, in pixels.\n * @param {Boolean} forceUpdate Forces the waveform view to be redrawn, if the\n *   frameOffset is unchanged.\n */\n\nWaveformZoomView.prototype.updateWaveform = function(frameOffset, forceUpdate) {\n  let upperLimit;\n\n  if (this._pixelLength < this._width) {\n    // Total waveform is shorter than viewport, so reset the offset to 0.\n    frameOffset = 0;\n    upperLimit = this._width;\n  }\n  else {\n    // Calculate the very last possible position.\n    upperLimit = this._pixelLength - this._width;\n  }\n\n  frameOffset = clamp(frameOffset, 0, upperLimit);\n\n  if (!forceUpdate && frameOffset === this._frameOffset) {\n    return;\n  }\n\n  this._frameOffset = frameOffset;\n\n  // Display playhead if it is within the zoom frame width.\n  const playheadPixel = this._playheadLayer.getPlayheadPixel();\n\n  this._playheadLayer.updatePlayheadTime(this.pixelsToTime(playheadPixel));\n\n  this.drawWaveformLayer();\n  this._axisLayer.draw();\n\n  const frameStartTime = this.getStartTime();\n  const frameEndTime   = this.getEndTime();\n\n  if (this._pointsLayer) {\n    this._pointsLayer.updatePoints(frameStartTime, frameEndTime);\n  }\n\n  if (this._segmentsLayer) {\n    this._segmentsLayer.updateSegments(frameStartTime, frameEndTime);\n  }\n\n  this._peaks.emit('zoomview.update', {\n    startTime: frameStartTime,\n    endTime: frameEndTime\n  });\n};\n\nWaveformZoomView.prototype.enableAutoScroll = function(enable, options) {\n  if (!options) {\n    options = {};\n  }\n\n  this._autoScroll = enable;\n\n  if (objectHasProperty(options, 'offset')) {\n    this._autoScrollOffset = options.offset;\n  }\n};\n\nWaveformZoomView.prototype.getMinSegmentDragWidth = function() {\n  return this._insertSegmentShape ? 0 : this._minSegmentDragWidth;\n};\n\nWaveformZoomView.prototype.setMinSegmentDragWidth = function(width) {\n  this._minSegmentDragWidth = width;\n};\n\nWaveformZoomView.prototype.containerWidthChange = function() {\n  let resample = false;\n  let resampleOptions;\n\n  if (this._zoomLevelAuto) {\n    resample = true;\n    resampleOptions = { width: this._width };\n  }\n  else if (this._zoomLevelSeconds !== null) {\n    resample = true;\n    resampleOptions = { scale: this._getScale(this._zoomLevelSeconds) };\n  }\n\n  if (resample) {\n    try {\n      this._resampleData(resampleOptions);\n    }\n    catch (error) { // eslint-disable-line no-unused-vars\n      // Ignore, and leave this._data as it was\n    }\n  }\n\n  return true;\n};\n\nWaveformZoomView.prototype.containerHeightChange = function() {\n  // Nothing\n};\n\nWaveformZoomView.prototype.getStage = function() {\n  return this._stage;\n};\n\nWaveformZoomView.prototype.getSegmentsLayer = function() {\n  return this._segmentsLayer;\n};\n\nWaveformZoomView.prototype.destroy = function() {\n  // Unregister event handlers\n  this._peaks.off('player.playing', this._onPlaying);\n  this._peaks.off('player.pause', this._onPause);\n  this._peaks.off('player.timeupdate', this._onTimeUpdate);\n  this._peaks.off('keyboard.left', this._onKeyboardLeft);\n  this._peaks.off('keyboard.right', this._onKeyboardRight);\n  this._peaks.off('keyboard.shift_left', this._onKeyboardShiftLeft);\n  this._peaks.off('keyboard.shift_right', this._onKeyboardShiftRight);\n\n  if (this._enableWaveformCache) {\n    this._waveformData.clear();\n    delete this._waveformData;\n    delete this._waveformScales;\n  }\n  else {\n    delete this._data;\n  }\n\n  this._mouseDragHandler.destroy();\n\n  WaveformView.prototype.destroy.call(this);\n};\n\nexport default WaveformZoomView;\n","/**\n * @file\n *\n * Defines the {@link Scrollbar} class.\n *\n * @module scrollbar\n */\n\nimport { clamp } from './utils';\n\nimport Konva from 'konva/lib/Core';\nimport { Rect } from 'konva/lib/shapes/Rect';\n\n/**\n * Creates a scrollbar.\n *\n * @class\n * @alias Scrollbar\n *\n * @param {HTMLElement} container\n * @param {Peaks} peaks\n */\n\nfunction Scrollbar(container, peaks) {\n  this._container = container;\n  this._peaks = peaks;\n  this._options = peaks.options.scrollbar;\n  this._zoomview = peaks.views.getView('zoomview');\n\n  this._dragBoundFunc = this._dragBoundFunc.bind(this);\n  this._onScrollboxDragStart = this._onScrollboxDragStart.bind(this);\n  this._onScrollboxDragMove = this._onScrollboxDragMove.bind(this);\n  this._onScrollboxDragEnd = this._onScrollboxDragEnd.bind(this);\n  this._onZoomviewUpdate = this._onZoomviewUpdate.bind(this);\n  this._onScrollbarClick = this._onScrollbarClick.bind(this);\n\n  this._peaks.on('zoomview.update', this._onZoomviewUpdate);\n\n  this._width = container.clientWidth;\n  this._height = container.clientHeight;\n\n  this._stage = new Konva.Stage({\n    container: container,\n    width: this._width,\n    height: this._height\n  });\n\n  this._layer = new Konva.Layer();\n  this._stage.on('click', this._onScrollbarClick);\n\n  this._stage.add(this._layer);\n\n  this._color = this._options.color;\n  this._scrollboxX = 0;\n  this._minScrollboxWidth = this._options.minWidth;\n\n  this._offsetY = 0;\n\n  this._scrollbox = new Konva.Group({\n    draggable:     true,\n    dragBoundFunc: this._dragBoundFunc\n  });\n\n  this._scrollboxRect = new Rect({\n    x:      this._scrollboxX,\n    y:      this._offsetY,\n    width:  0,\n    height: this._height,\n    fill:   this._color\n  });\n\n  this._scrollbox.add(this._scrollboxRect);\n  this._setScrollboxWidth();\n\n  this._scrollbox.on('dragstart', this._onScrollboxDragStart);\n  this._scrollbox.on('dragmove', this._onScrollboxDragMove);\n  this._scrollbox.on('dragend', this._onScrollboxDragEnd);\n\n  this._layer.add(this._scrollbox);\n\n  this._updateScrollbarWidthAndPosition();\n}\n\nScrollbar.prototype.setZoomview = function(zoomview) {\n  this._zoomview = zoomview;\n\n  this._updateScrollbarWidthAndPosition();\n};\n\n/**\n * Sets the width of the scrollbox, based on the visible waveform region\n * in the zoomview and minimum scrollbox width option.\n */\n\nScrollbar.prototype._setScrollboxWidth = function() {\n  if (this._zoomview) {\n    this._scrollboxWidth = Math.floor(\n      this._width * this._zoomview.pixelsToTime(this._zoomview.getWidth()) /\n        this._peaks.player.getDuration()\n    );\n\n    if (this._scrollboxWidth < this._minScrollboxWidth) {\n      this._scrollboxWidth = this._minScrollboxWidth;\n    }\n  }\n  else {\n    this._scrollboxWidth = this._width;\n  }\n\n  this._scrollboxRect.width(this._scrollboxWidth);\n};\n\n/**\n * @returns {Number} The maximum scrollbox position, in pixels.\n */\n\nScrollbar.prototype._getScrollbarRange = function() {\n  return this._width - this._scrollboxWidth;\n};\n\nScrollbar.prototype._dragBoundFunc = function(pos) {\n  // Allow the scrollbar to be moved horizontally but not vertically.\n  return {\n    x: pos.x,\n    y: 0\n  };\n};\n\nScrollbar.prototype._onScrollboxDragStart = function() {\n  this._dragging = true;\n};\n\nScrollbar.prototype._onScrollboxDragEnd = function() {\n  this._dragging = false;\n};\n\nScrollbar.prototype._onScrollboxDragMove = function() {\n  const range = this._getScrollbarRange();\n  const x = clamp(this._scrollbox.x(), 0, range);\n\n  this._scrollbox.x(x);\n\n  if (x !== this._scrollboxX) {\n    this._scrollboxX = x;\n\n    if (this._zoomview) {\n      this._updateWaveform(x);\n    }\n  }\n};\n\nScrollbar.prototype._onZoomviewUpdate = function(/* event */) {\n  if (!this._dragging) {\n    this._updateScrollbarWidthAndPosition();\n  }\n};\n\nScrollbar.prototype._updateScrollbarWidthAndPosition = function() {\n  this._setScrollboxWidth();\n\n  if (this._zoomview) {\n    const startTime = this._zoomview.getStartTime();\n\n    const zoomviewRange = this._zoomview.getPixelLength() - this._zoomview.getWidth();\n\n    const scrollBoxPos = Math.floor(\n      this._zoomview.timeToPixels(startTime) * this._getScrollbarRange() / zoomviewRange\n    );\n\n    this._scrollbox.x(scrollBoxPos);\n    this._layer.draw();\n  }\n};\n\nScrollbar.prototype._onScrollbarClick = function(event) {\n  // Handle clicks on the scrollbar outside the scrollbox.\n  if (event.target === this._stage) {\n    if (this._zoomview) {\n      // Centre the scrollbox where the user clicked.\n      let x = Math.floor(event.evt.offsetX - this._scrollboxWidth / 2);\n\n      if (x < 0) {\n        x = 0;\n      }\n\n      this._updateWaveform(x);\n    }\n  }\n};\n\n/**\n * Sets the zoomview waveform position based on scrollbar position.\n */\n\nScrollbar.prototype._updateWaveform = function(x) {\n  const offset = Math.floor(\n    (this._zoomview.getPixelLength() - this._zoomview.getWidth()) * x / this._getScrollbarRange()\n  );\n\n  this._zoomview.updateWaveform(offset);\n};\n\nScrollbar.prototype.fitToContainer = function() {\n  if (this._container.clientWidth === 0 && this._container.clientHeight === 0) {\n    return;\n  }\n\n  if (this._container.clientWidth !== this._width) {\n    this._width = this._container.clientWidth;\n    this._stage.width(this._width);\n\n    this._updateScrollbarWidthAndPosition();\n  }\n\n  this._height = this._container.clientHeight;\n  this._stage.height(this._height);\n};\n\nScrollbar.prototype.destroy = function() {\n  this._peaks.off('zoomview.update', this._onZoomviewUpdate);\n\n  this._layer.destroy();\n\n  this._stage.destroy();\n  this._stage = null;\n};\n\nexport default Scrollbar;\n","/**\n * @file\n *\n * Defines the {@link ViewController} class.\n *\n * @module view-controller\n */\n\nimport WaveformOverview from './waveform-overview';\nimport WaveformZoomView from './waveform-zoomview';\nimport Scrollbar from './scrollbar';\nimport { isNullOrUndefined } from './utils';\n\n/**\n * Creates an object that allows users to create and manage waveform views.\n *\n * @class\n * @alias ViewController\n *\n * @param {Peaks} peaks\n */\n\nfunction ViewController(peaks) {\n  this._peaks = peaks;\n  this._overview = null;\n  this._zoomview = null;\n  this._scrollbar = null;\n}\n\nViewController.prototype.createOverview = function(container) {\n  if (this._overview) {\n    return this._overview;\n  }\n\n  const waveformData = this._peaks.getWaveformData();\n\n  this._overview = new WaveformOverview(\n    waveformData,\n    container,\n    this._peaks\n  );\n\n  if (this._zoomview) {\n    this._overview.showHighlight(\n      this._zoomview.getStartTime(),\n      this._zoomview.getEndTime()\n    );\n  }\n\n  return this._overview;\n};\n\nViewController.prototype.createZoomview = function(container) {\n  if (this._zoomview) {\n    return this._zoomview;\n  }\n\n  const waveformData = this._peaks.getWaveformData();\n\n  this._zoomview = new WaveformZoomView(\n    waveformData,\n    container,\n    this._peaks\n  );\n\n  if (this._scrollbar) {\n    this._scrollbar.setZoomview(this._zoomview);\n  }\n\n  return this._zoomview;\n};\n\nViewController.prototype.createScrollbar = function(container) {\n  this._scrollbar = new Scrollbar(\n    container,\n    this._peaks\n  );\n\n  return this._scrollbar;\n};\n\nViewController.prototype.destroyOverview = function() {\n  if (!this._overview) {\n    return;\n  }\n\n  if (!this._zoomview) {\n    return;\n  }\n\n  this._overview.destroy();\n  this._overview = null;\n};\n\nViewController.prototype.destroyZoomview = function() {\n  if (!this._zoomview) {\n    return;\n  }\n\n  if (!this._overview) {\n    return;\n  }\n\n  this._zoomview.destroy();\n  this._zoomview = null;\n\n  this._overview.removeHighlightRect();\n};\n\nViewController.prototype.destroy = function() {\n  if (this._overview) {\n    this._overview.destroy();\n    this._overview = null;\n  }\n\n  if (this._zoomview) {\n    this._zoomview.destroy();\n    this._zoomview = null;\n  }\n\n  if (this._scrollbar) {\n    this._scrollbar.destroy();\n    this._scrollbar = null;\n  }\n};\n\nViewController.prototype.getView = function(name) {\n  if (isNullOrUndefined(name)) {\n    if (this._overview && this._zoomview) {\n      return null;\n    }\n    else if (this._overview) {\n      return this._overview;\n    }\n    else if (this._zoomview) {\n      return this._zoomview;\n    }\n    else {\n      return null;\n    }\n  }\n  else {\n    switch (name) {\n      case 'overview':\n        return this._overview;\n\n      case 'zoomview':\n        return this._zoomview;\n\n      default:\n        return null;\n    }\n  }\n};\n\nViewController.prototype.getScrollbar = function() {\n  return this._scrollbar;\n};\n\nexport default ViewController;\n","/**\n * @file\n *\n * Defines the {@link ZoomController} class.\n *\n * @module zoom-controller\n */\n\n/**\n * Creates an object to control zoom levels in a {@link WaveformZoomView}.\n *\n * @class\n * @alias ZoomController\n *\n * @param {Peaks} peaks\n * @param {Array<Integer>} zoomLevels\n */\n\nfunction ZoomController(peaks, zoomLevels) {\n  this._peaks = peaks;\n  this._zoomLevels = zoomLevels;\n  this._zoomLevelIndex = 0;\n}\n\nZoomController.prototype.setZoomLevels = function(zoomLevels) {\n  this._zoomLevels = zoomLevels;\n  this.setZoom(0, true);\n};\n\n/**\n * Zoom in one level.\n */\n\nZoomController.prototype.zoomIn = function() {\n  this.setZoom(this._zoomLevelIndex - 1, false);\n};\n\n/**\n * Zoom out one level.\n */\n\nZoomController.prototype.zoomOut = function() {\n  this.setZoom(this._zoomLevelIndex + 1, false);\n};\n\n/**\n * Given a particular zoom level, triggers a resampling of the data in the\n * zoomed view.\n *\n * @param {number} zoomLevelIndex An index into the options.zoomLevels array.\n */\n\nZoomController.prototype.setZoom = function(zoomLevelIndex, forceUpdate) {\n  if (zoomLevelIndex >= this._zoomLevels.length) {\n    zoomLevelIndex = this._zoomLevels.length - 1;\n  }\n\n  if (zoomLevelIndex < 0) {\n    zoomLevelIndex = 0;\n  }\n\n  if (!forceUpdate && (zoomLevelIndex === this._zoomLevelIndex)) {\n    // Nothing to do.\n    return;\n  }\n\n  this._zoomLevelIndex = zoomLevelIndex;\n\n  const zoomview = this._peaks.views.getView('zoomview');\n\n  if (!zoomview) {\n    return;\n  }\n\n  zoomview.setZoom({ scale: this._zoomLevels[zoomLevelIndex] });\n};\n\n/**\n * Returns the current zoom level index.\n *\n * @returns {Number}\n */\n\nZoomController.prototype.getZoom = function() {\n  return this._zoomLevelIndex;\n};\n\n/**\n * Returns the current zoom level, in samples per pixel.\n *\n * @returns {Number}\n */\n\nZoomController.prototype.getZoomLevel = function() {\n  return this._zoomLevels[this._zoomLevelIndex];\n};\n\nexport default ZoomController;\n","/**\n * @file\n *\n * Defines the {@link WaveformBuilder} class.\n *\n * @module waveform-builder\n */\n\nimport { isArrayBuffer, isObject } from './utils';\nimport WaveformData from 'waveform-data';\n\nconst isXhr2 = ('withCredentials' in new XMLHttpRequest());\n\n/**\n * Creates and returns a WaveformData object, either by requesting the\n * waveform data from the server, or by creating the waveform data using the\n * Web Audio API.\n *\n * @class\n * @alias WaveformBuilder\n *\n * @param {Peaks} peaks\n */\n\nfunction WaveformBuilder(peaks) {\n  this._peaks = peaks;\n}\n\n/**\n * Options for requesting remote waveform data.\n *\n * @typedef {Object} RemoteWaveformDataOptions\n * @global\n * @property {String=} arraybuffer\n * @property {String=} json\n */\n\n/**\n * Options for supplying local waveform data.\n *\n * @typedef {Object} LocalWaveformDataOptions\n * @global\n * @property {ArrayBuffer=} arraybuffer\n * @property {Object=} json\n */\n\n/**\n * Options for the Web Audio waveform builder.\n *\n * @typedef {Object} WaveformBuilderWebAudioOptions\n * @global\n * @property {AudioContext} audioContext\n * @property {AudioBuffer=} audioBuffer\n * @property {Number=} scale\n * @property {Boolean=} multiChannel\n */\n\n/**\n * Options for [WaveformBuilder.init]{@link WaveformBuilder#init}.\n *\n * @typedef {Object} WaveformBuilderInitOptions\n * @global\n * @property {RemoteWaveformDataOptions=} dataUri\n * @property {LocalWaveformDataOptions=} waveformData\n * @property {WaveformBuilderWebAudioOptions=} webAudio\n * @property {Boolean=} withCredentials\n * @property {Array<Number>=} zoomLevels\n */\n\n/**\n * Callback for receiving the waveform data.\n *\n * @callback WaveformBuilderInitCallback\n * @global\n * @param {Error} error\n * @param {WaveformData} waveformData\n */\n\n/**\n * Loads or creates the waveform data.\n *\n * @private\n * @param {WaveformBuilderInitOptions} options\n * @param {WaveformBuilderInitCallback} callback\n */\n\nWaveformBuilder.prototype.init = function(options, callback) {\n  if ((options.dataUri && (options.webAudio || options.audioContext)) ||\n      (options.waveformData && (options.webAudio || options.audioContext)) ||\n      (options.dataUri && options.waveformData)) {\n    // eslint-disable-next-line @stylistic/js/max-len\n    callback(new TypeError('Peaks.init(): You may only pass one source (webAudio, dataUri, or waveformData) to render waveform data.'));\n    return;\n  }\n\n  if (options.audioContext) {\n    // eslint-disable-next-line @stylistic/js/max-len\n    this._peaks._logger('Peaks.init(): The audioContext option is deprecated, please pass a webAudio object instead');\n\n    options.webAudio = {\n      audioContext: options.audioContext\n    };\n  }\n\n  if (options.dataUri) {\n    return this._getRemoteWaveformData(options, callback);\n  }\n  else if (options.waveformData) {\n    return this._buildWaveformFromLocalData(options, callback);\n  }\n  else if (options.webAudio) {\n    if (options.webAudio.audioBuffer) {\n      return this._buildWaveformDataFromAudioBuffer(options, callback);\n    }\n    else {\n      return this._buildWaveformDataUsingWebAudio(options, callback);\n    }\n  }\n  else {\n    // eslint-disable-next-line @stylistic/js/max-len\n    callback(new Error('Peaks.init(): You must pass an audioContext, or dataUri, or waveformData to render waveform data'));\n  }\n};\n\nfunction hasValidContentRangeHeader(xhr) {\n  const contentRange = xhr.getResponseHeader('content-range');\n\n  if (!contentRange) {\n    return false;\n  }\n\n  const matches = contentRange.match(/^bytes (\\d+)-(\\d+)\\/(\\d+)$/);\n\n  if (matches && matches.length === 4) {\n    const firstPos = parseInt(matches[1], 10);\n    const lastPos = parseInt(matches[2], 10);\n    const length = parseInt(matches[3], 10);\n\n    if (firstPos === 0 && (lastPos + 1) === length) {\n      return true;\n    }\n\n    return false;\n  }\n\n  return false;\n}\n\n/* eslint-disable @stylistic/js/max-len */\n\n/**\n * Fetches waveform data, based on the given options.\n *\n * @private\n * @param {Object} options\n * @param {String|Object} options.dataUri\n * @param {String} options.dataUri.arraybuffer Waveform data URL\n *   (binary format)\n * @param {String} options.dataUri.json Waveform data URL (JSON format)\n * @param {String} options.defaultUriFormat Either 'arraybuffer' (for binary\n *   data) or 'json'\n * @param {WaveformBuilderInitCallback} callback\n *\n * @see Refer to the <a href=\"https://codeberg.org/chrisn/audiowaveform/src/branch/master/doc/DataFormat.md\">data format documentation</a>\n *   for details of the binary and JSON waveform data formats.\n */\n\n/* eslint-enable @stylistic/js/max-len */\n\nWaveformBuilder.prototype._getRemoteWaveformData = function(options, callback) {\n  const self = this;\n\n  let dataUri = null;\n  let requestType = null;\n  let url;\n\n  if (isObject(options.dataUri)) {\n    dataUri = options.dataUri;\n  }\n  else {\n    callback(new TypeError('Peaks.init(): The dataUri option must be an object'));\n    return;\n  }\n\n  ['ArrayBuffer', 'JSON'].some(function(connector) {\n    if (window[connector]) {\n      requestType = connector.toLowerCase();\n      url = dataUri[requestType];\n\n      return Boolean(url);\n    }\n  });\n\n  if (!url) {\n    // eslint-disable-next-line @stylistic/js/max-len\n    callback(new Error('Peaks.init(): Unable to determine a compatible dataUri format for this browser'));\n    return;\n  }\n\n  self._xhr = self._createXHR(url, requestType, options.withCredentials, function(event) {\n    if (this.readyState !== 4) {\n      return;\n    }\n\n    // See https://codeberg.org/chrisn/peaks.js/issues/491\n\n    if (this.status !== 200 &&\n        !(this.status === 206 && hasValidContentRangeHeader(this))) {\n      callback(\n        new Error('Unable to fetch remote data. HTTP status ' + this.status)\n      );\n\n      return;\n    }\n\n    self._xhr = null;\n\n    const waveformData = WaveformData.create(event.target.response);\n\n    if (waveformData.channels !== 1 && waveformData.channels !== 2) {\n      callback(new Error('Peaks.init(): Only mono or stereo waveforms are currently supported'));\n      return;\n    }\n    else if (waveformData.bits !== 8) {\n      callback(new Error('Peaks.init(): 16-bit waveform data is not supported'));\n      return;\n    }\n\n    callback(undefined, waveformData);\n  },\n  function() {\n    callback(new Error('XHR failed'));\n  },\n  function() {\n    callback(new Error('XHR aborted'));\n  });\n\n  self._xhr.send();\n};\n\n/* eslint-disable @stylistic/js/max-len */\n\n/**\n * Creates a waveform from given data, based on the given options.\n *\n * @private\n * @param {Object} options\n * @param {Object} options.waveformData\n * @param {ArrayBuffer} options.waveformData.arraybuffer Waveform data (binary format)\n * @param {Object} options.waveformData.json Waveform data (JSON format)\n * @param {WaveformBuilderInitCallback} callback\n *\n * @see Refer to the <a href=\"https://codeberg.org/chrisn/audiowaveform/src/branch/master/doc/DataFormat.md\">data format documentation</a>\n *   for details of the binary and JSON waveform data formats.\n */\n\n/* eslint-enable @stylistic/js/max-len */\n\nWaveformBuilder.prototype._buildWaveformFromLocalData = function(options, callback) {\n  let waveformData = null;\n  let data = null;\n\n  if (isObject(options.waveformData)) {\n    waveformData = options.waveformData;\n  }\n  else {\n    callback(new Error('Peaks.init(): The waveformData option must be an object'));\n    return;\n  }\n\n  if (isObject(waveformData.json)) {\n    data = waveformData.json;\n  }\n  else if (isArrayBuffer(waveformData.arraybuffer)) {\n    data = waveformData.arraybuffer;\n  }\n\n  if (!data) {\n    callback(new Error('Peaks.init(): Unable to determine a compatible waveformData format'));\n    return;\n  }\n\n  try {\n    const createdWaveformData = WaveformData.create(data);\n\n    if (createdWaveformData.channels !== 1 && createdWaveformData.channels !== 2) {\n      callback(new Error('Peaks.init(): Only mono or stereo waveforms are currently supported'));\n      return;\n    }\n    else if (createdWaveformData.bits !== 8) {\n      callback(new Error('Peaks.init(): 16-bit waveform data is not supported'));\n      return;\n    }\n\n    callback(undefined, createdWaveformData);\n  }\n  catch (err) {\n    callback(err);\n  }\n};\n\n/**\n * Creates waveform data using the Web Audio API.\n *\n * @private\n * @param {Object} options\n * @param {AudioContext} options.audioContext\n * @param {HTMLMediaElement} options.mediaElement\n * @param {WaveformBuilderInitCallback} callback\n */\n\nWaveformBuilder.prototype._buildWaveformDataUsingWebAudio = function(options, callback) {\n  const self = this;\n\n  const audioContext = window.AudioContext || window.webkitAudioContext;\n\n  if (!(options.webAudio.audioContext instanceof audioContext)) {\n    // eslint-disable-next-line @stylistic/js/max-len\n    callback(new TypeError('Peaks.init(): The webAudio.audioContext option must be a valid AudioContext'));\n    return;\n  }\n\n  const webAudioOptions = options.webAudio;\n\n  if (webAudioOptions.scale !== options.zoomLevels[0]) {\n    webAudioOptions.scale = options.zoomLevels[0];\n  }\n\n  // If the media element has already selected which source to play, its\n  // currentSrc attribute will contain the source media URL. Otherwise,\n  // we wait for a canplay event to tell us when the media is ready.\n\n  const mediaSourceUrl = self._peaks.options.mediaElement.currentSrc;\n\n  if (mediaSourceUrl) {\n    self._requestAudioAndBuildWaveformData(\n      mediaSourceUrl,\n      webAudioOptions,\n      options.withCredentials,\n      callback\n    );\n  }\n  else {\n    self._peaks.once('player.canplay', function() {\n      self._requestAudioAndBuildWaveformData(\n        self._peaks.options.mediaElement.currentSrc,\n        webAudioOptions,\n        options.withCredentials,\n        callback\n      );\n    });\n  }\n};\n\nWaveformBuilder.prototype._buildWaveformDataFromAudioBuffer = function(options, callback) {\n  const webAudioOptions = options.webAudio;\n\n  if (webAudioOptions.scale !== options.zoomLevels[0]) {\n    webAudioOptions.scale = options.zoomLevels[0];\n  }\n\n  const webAudioBuilderOptions = {\n    audio_buffer: webAudioOptions.audioBuffer,\n    split_channels: webAudioOptions.multiChannel,\n    scale: webAudioOptions.scale,\n    disable_worker: true\n  };\n\n  WaveformData.createFromAudio(webAudioBuilderOptions, callback);\n};\n\n/**\n * Fetches the audio content, based on the given options, and creates waveform\n * data using the Web Audio API.\n *\n * @private\n * @param {url} The media source URL\n * @param {WaveformBuilderWebAudioOptions} webAudio\n * @param {Boolean} withCredentials\n * @param {WaveformBuilderInitCallback} callback\n */\n\nWaveformBuilder.prototype._requestAudioAndBuildWaveformData = function(url,\n    webAudio, withCredentials, callback) {\n  const self = this;\n\n  if (!url) {\n    self._peaks._logger('Peaks.init(): The mediaElement src is invalid');\n    return;\n  }\n\n  self._xhr = self._createXHR(url, 'arraybuffer', withCredentials, function(event) {\n    if (this.readyState !== 4) {\n      return;\n    }\n\n    // See https://codeberg.org/chrisn/peaks.js/issues/491\n\n    if (this.status !== 200 &&\n        !(this.status === 206 && hasValidContentRangeHeader(this))) {\n      callback(\n        new Error('Unable to fetch remote data. HTTP status ' + this.status)\n      );\n\n      return;\n    }\n\n    self._xhr = null;\n\n    const webAudioBuilderOptions = {\n      audio_context: webAudio.audioContext,\n      array_buffer: event.target.response,\n      split_channels: webAudio.multiChannel,\n      scale: webAudio.scale\n    };\n\n    WaveformData.createFromAudio(webAudioBuilderOptions, callback);\n  },\n  function() {\n    callback(new Error('XHR failed'));\n  },\n  function() {\n    callback(new Error('XHR aborted'));\n  });\n\n  self._xhr.send();\n};\n\nWaveformBuilder.prototype.abort = function() {\n  if (this._xhr) {\n    this._xhr.abort();\n  }\n};\n\n/**\n * @private\n * @param {String} url\n * @param {String} requestType\n * @param {Boolean} withCredentials\n * @param {Function} onLoad\n * @param {Function} onError\n *\n * @returns {XMLHttpRequest}\n */\n\nWaveformBuilder.prototype._createXHR = function(url, requestType,\n    withCredentials, onLoad, onError, onAbort) {\n  const xhr = new XMLHttpRequest();\n\n  // open an XHR request to the data source file\n  xhr.open('GET', url, true);\n\n  if (isXhr2) {\n    try {\n      xhr.responseType = requestType;\n    }\n    catch (error) { // eslint-disable-line no-unused-vars\n      // Some browsers like Safari 6 do handle XHR2 but not the json\n      // response type, doing only a try/catch fails in IE9\n    }\n  }\n\n  xhr.onload = onLoad;\n  xhr.onerror = onError;\n\n  if (isXhr2 && withCredentials) {\n    xhr.withCredentials = true;\n  }\n\n  xhr.addEventListener('abort', onAbort);\n\n  return xhr;\n};\n\nexport default WaveformBuilder;\n","/**\n * @file\n *\n * Defines the {@link Peaks} class.\n *\n * @module main\n */\n\nimport EventEmitter from 'eventemitter3';\nimport CueEmitter from './cue-emitter';\nimport WaveformPoints from './waveform-points';\nimport WaveformSegments from './waveform-segments';\nimport KeyboardHandler from './keyboard-handler';\nimport MediaElementPlayer from './mediaelement-player';\nimport Player from './player';\nimport { createPointMarker, createSegmentMarker, createSegmentLabel } from './marker-factories';\nimport ViewController from './view-controller';\nimport ZoomController from './zoom-controller';\nimport WaveformBuilder from './waveform-builder';\nimport {\n  isHTMLElement, isFunction, isInAscendingOrder, isObject,\n  objectHasProperty,\n  extend\n} from './utils';\n\n/**\n * Initialises a new Peaks instance with default option settings.\n *\n * @class\n * @alias Peaks\n *\n * @param {Object} opts Configuration options\n */\n\nfunction Peaks() {\n  EventEmitter.call(this);\n\n  // Set default options\n  this.options = {\n    zoomLevels:          [512, 1024, 2048, 4096],\n    waveformCache:       true,\n\n    mediaElement:        null,\n    mediaUrl:            null,\n\n    dataUri:             null,\n    withCredentials:     false,\n\n    waveformData:        null,\n    webAudio:            null,\n\n    nudgeIncrement:      1.0,\n\n    pointMarkerColor:    '#39cccc',\n\n    createSegmentMarker: createSegmentMarker,\n    createSegmentLabel:  createSegmentLabel,\n    createPointMarker:   createPointMarker,\n\n    // eslint-disable-next-line no-console\n    logger:              console.error.bind(console)\n  };\n\n  return this;\n}\n\nPeaks.prototype = Object.create(EventEmitter.prototype);\n\nconst defaultViewOptions = {\n  playheadColor:           '#111111',\n  playheadTextColor:       '#aaaaaa',\n  playheadBackgroundColor: 'transparent',\n  playheadPadding:         2,\n  playheadWidth:           1,\n  axisGridlineColor:       '#cccccc',\n  showAxisLabels:          true,\n  axisTopMarkerHeight:     10,\n  axisBottomMarkerHeight:  10,\n  axisLabelColor:          '#aaaaaa',\n  fontFamily:              'sans-serif',\n  fontSize:                11,\n  fontStyle:               'normal',\n  timeLabelPrecision:      2,\n  enablePoints:            true,\n  enableSegments:          true\n};\n\nconst defaultZoomviewOptions = {\n  // showPlayheadTime:    true,\n  playheadClickTolerance: 3,\n  waveformColor:          'rgba(0, 225, 128, 1)',\n  wheelMode:              'none',\n  autoScroll:             true,\n  autoScrollOffset:       100,\n  enableEditing:          true\n};\n\nconst defaultOverviewOptions = {\n  // showPlayheadTime:    false,\n  waveformColor:          'rgba(0, 0, 0, 0.2)',\n  highlightColor:         '#aaaaaa',\n  highlightStrokeColor:   'transparent',\n  highlightOpacity:       0.3,\n  highlightOffset:        11,\n  highlightCornerRadius:  2,\n  enableEditing:          false\n};\n\nconst defaultSegmentOptions = {\n  overlay:                   false,\n  markers:                   true,\n  startMarkerColor:          '#aaaaaa',\n  endMarkerColor:            '#aaaaaa',\n  waveformColor:             '#0074d9',\n  overlayColor:              '#ff0000',\n  overlayOpacity:            0.3,\n  overlayBorderColor:        '#ff0000',\n  overlayBorderWidth:        2,\n  overlayCornerRadius:       5,\n  overlayOffset:             25,\n  overlayLabelAlign:         'left',\n  overlayLabelVerticalAlign: 'top',\n  overlayLabelPadding:       8,\n  overlayLabelColor:         '#000000',\n  overlayFontFamily:         'sans-serif',\n  overlayFontSize:           12,\n  overlayFontStyle:          'normal'\n};\n\nconst defaultScrollbarOptions = {\n  color: '#888888',\n  minWidth: 50\n};\n\nfunction getOverviewOptions(opts) {\n  const overviewOptions = {};\n\n  if (opts.overview && opts.overview.showPlayheadTime) {\n    overviewOptions.showPlayheadTime = opts.overview.showPlayheadTime;\n  }\n\n  const optNames = [\n    'container',\n    'waveformColor',\n    'playedWaveformColor',\n    'playheadColor',\n    'playheadTextColor',\n    'playheadBackgroundColor',\n    'playheadPadding',\n    'playheadWidth',\n    'formatPlayheadTime',\n    'timeLabelPrecision',\n    'axisGridlineColor',\n    'showAxisLabels',\n    'axisTopMarkerHeight',\n    'axisBottomMarkerHeight',\n    'axisLabelColor',\n    'formatAxisTime',\n    'fontFamily',\n    'fontSize',\n    'fontStyle',\n    'highlightColor',\n    'highlightStrokeColor',\n    'highlightOpacity',\n    'highlightCornerRadius',\n    'highlightOffset',\n    'enablePoints',\n    'enableSegments',\n    'enableEditing'\n  ];\n\n  optNames.forEach(function(optName) {\n    if (opts.overview && objectHasProperty(opts.overview, optName)) {\n      overviewOptions[optName] = opts.overview[optName];\n    }\n    else if (objectHasProperty(opts, optName)) {\n      overviewOptions[optName] = opts[optName];\n    }\n    else if (!objectHasProperty(overviewOptions, optName)) {\n      if (objectHasProperty(defaultOverviewOptions, optName)) {\n        overviewOptions[optName] = defaultOverviewOptions[optName];\n      }\n      else if (objectHasProperty(defaultViewOptions, optName)) {\n        overviewOptions[optName] = defaultViewOptions[optName];\n      }\n    }\n  });\n\n  return overviewOptions;\n}\n\nfunction getZoomviewOptions(opts) {\n  const zoomviewOptions = {};\n\n  if (opts.showPlayheadTime) {\n    zoomviewOptions.showPlayheadTime = opts.showPlayheadTime;\n  }\n  else if (opts.zoomview && opts.zoomview.showPlayheadTime) {\n    zoomviewOptions.showPlayheadTime = opts.zoomview.showPlayheadTime;\n  }\n\n  const optNames = [\n    'container',\n    'waveformColor',\n    'playedWaveformColor',\n    'playheadColor',\n    'playheadTextColor',\n    'playheadBackgroundColor',\n    'playheadPadding',\n    'playheadWidth',\n    'formatPlayheadTime',\n    'playheadClickTolerance',\n    'timeLabelPrecision',\n    'axisGridlineColor',\n    'showAxisLabels',\n    'axisTopMarkerHeight',\n    'axisBottomMarkerHeight',\n    'axisLabelColor',\n    'formatAxisTime',\n    'fontFamily',\n    'fontSize',\n    'fontStyle',\n    'wheelMode',\n    'autoScroll',\n    'autoScrollOffset',\n    'enablePoints',\n    'enableSegments',\n    'enableEditing'\n  ];\n\n  optNames.forEach(function(optName) {\n    if (opts.zoomview && objectHasProperty(opts.zoomview, optName)) {\n      zoomviewOptions[optName] = opts.zoomview[optName];\n    }\n    else if (objectHasProperty(opts, optName)) {\n      zoomviewOptions[optName] = opts[optName];\n    }\n    else if (!objectHasProperty(zoomviewOptions, optName)) {\n      if (objectHasProperty(defaultZoomviewOptions, optName)) {\n        zoomviewOptions[optName] = defaultZoomviewOptions[optName];\n      }\n      else if (objectHasProperty(defaultViewOptions, optName)) {\n        zoomviewOptions[optName] = defaultViewOptions[optName];\n      }\n    }\n  });\n\n  return zoomviewOptions;\n}\n\nfunction getScrollbarOptions(opts) {\n  if (!objectHasProperty(opts, 'scrollbar')) {\n    return null;\n  }\n\n  const scrollbarOptions = {};\n\n  const optNames = [\n    'container',\n    'color',\n    'minWidth'\n  ];\n\n  optNames.forEach(function(optName) {\n    if (objectHasProperty(opts.scrollbar, optName)) {\n      scrollbarOptions[optName] = opts.scrollbar[optName];\n    }\n    else {\n      scrollbarOptions[optName] = defaultScrollbarOptions[optName];\n    }\n  });\n\n  return scrollbarOptions;\n}\n\nfunction extendOptions(to, from) {\n  for (const key in from) {\n    if (objectHasProperty(from, key) &&\n        objectHasProperty(to, key)) {\n      to[key] = from[key];\n    }\n  }\n\n  return to;\n}\n\nfunction addSegmentOptions(options, opts) {\n  options.segmentOptions = {};\n\n  extend(options.segmentOptions, defaultSegmentOptions);\n\n  if (opts.segmentOptions) {\n    extendOptions(options.segmentOptions, opts.segmentOptions);\n  }\n\n  options.zoomview.segmentOptions = {};\n  extend(options.zoomview.segmentOptions, options.segmentOptions);\n\n  if (opts.zoomview && opts.zoomview.segmentOptions) {\n    extendOptions(options.zoomview.segmentOptions, opts.zoomview.segmentOptions);\n  }\n\n  options.overview.segmentOptions = {};\n  extend(options.overview.segmentOptions, options.segmentOptions);\n\n  if (opts.overview && opts.overview.segmentOptions) {\n    extendOptions(options.overview.segmentOptions, opts.overview.segmentOptions);\n  }\n}\n\nfunction checkContainerElements(options) {\n  const zoomviewContainer = options.zoomview.container;\n  const overviewContainer = options.overview.container;\n\n  if (!isHTMLElement(zoomviewContainer) &&\n      !isHTMLElement(overviewContainer)) {\n    // eslint-disable-next-line @stylistic/js/max-len\n    return new TypeError('Peaks.init(): The zoomview and/or overview container options must be valid HTML elements');\n  }\n\n  if (zoomviewContainer &&\n      (zoomviewContainer.clientWidth  <= 0 ||\n       zoomviewContainer.clientHeight <= 0)) {\n    // eslint-disable-next-line @stylistic/js/max-len\n    return new Error('Peaks.init(): The zoomview container must be visible and have non-zero width and height');\n  }\n\n  if (overviewContainer &&\n      (overviewContainer.clientWidth  <= 0 ||\n       overviewContainer.clientHeight <= 0)) {\n    // eslint-disable-next-line @stylistic/js/max-len\n    return new Error('Peaks.init(): The overview container must be visible and have non-zero width and height');\n  }\n}\n\n/**\n * Creates and initialises a new Peaks instance with the given options.\n *\n * @param {Object} opts Configuration options\n * @param {Function} callback\n *\n * @return {Peaks}\n */\n\nPeaks.init = function(opts, callback) {\n  if (!callback) {\n    throw new Error('Peaks.init(): Missing callback function');\n  }\n\n  const instance = new Peaks();\n\n  let err = instance._setOptions(opts);\n\n  if (!err) {\n    err = checkContainerElements(instance.options);\n  }\n\n  if (err) {\n    callback(err);\n    return;\n  }\n\n  let scrollbarContainer = null;\n\n  if (instance.options.scrollbar) {\n    scrollbarContainer = instance.options.scrollbar.container;\n\n    if (!isHTMLElement(scrollbarContainer)) {\n    // eslint-disable-next-line @stylistic/js/max-len\n      callback(new TypeError('Peaks.init(): The scrollbar container option must be a valid HTML element'));\n      return;\n    }\n\n    if (scrollbarContainer.clientWidth <= 0) {\n    // eslint-disable-next-line @stylistic/js/max-len\n      callback(new TypeError('Peaks.init(): The scrollbar container must be visible and have non-zero width'));\n      return;\n    }\n  }\n\n  if (opts.keyboard) {\n    instance._keyboardHandler = new KeyboardHandler(instance);\n  }\n\n  const player = opts.player ?\n    opts.player :\n    new MediaElementPlayer(instance.options.mediaElement);\n\n  instance.player = new Player(instance, player);\n  instance.segments = new WaveformSegments(instance);\n  instance.points = new WaveformPoints(instance);\n  instance.zoom = new ZoomController(instance, instance.options.zoomLevels);\n  instance.views = new ViewController(instance);\n\n  // Setup the UI components\n  instance._waveformBuilder = new WaveformBuilder(instance);\n\n  instance.player.init(instance)\n    .then(function() {\n      instance._waveformBuilder.init(instance.options, function(err, waveformData) {\n        if (err) {\n          callback(err);\n          return;\n        }\n\n        err = checkContainerElements(instance.options);\n\n        if (err) {\n          callback(err);\n          return;\n        }\n\n        instance._waveformBuilder = null;\n        instance._waveformData = waveformData;\n\n        const zoomviewContainer = instance.options.zoomview.container;\n        const overviewContainer = instance.options.overview.container;\n\n        if (zoomviewContainer) {\n          instance.views.createZoomview(zoomviewContainer);\n        }\n\n        if (overviewContainer) {\n          instance.views.createOverview(overviewContainer);\n        }\n\n        if (scrollbarContainer) {\n          instance.views.createScrollbar(scrollbarContainer);\n        }\n\n        if (opts.segments) {\n          instance.segments.add(opts.segments);\n        }\n\n        if (opts.points) {\n          instance.points.add(opts.points);\n        }\n\n        if (opts.emitCueEvents) {\n          instance._cueEmitter = new CueEmitter(instance);\n        }\n\n        callback(null, instance);\n      });\n    })\n    .catch(function(err) {\n      callback(err);\n    });\n};\n\nPeaks.prototype._setOptions = function(opts) {\n  if (!isObject(opts)) {\n    return new TypeError('Peaks.init(): The options parameter should be an object');\n  }\n\n  if (!opts.player) {\n    if (!opts.mediaElement) {\n      return new Error('Peaks.init(): Missing mediaElement option');\n    }\n\n    if (!(opts.mediaElement instanceof HTMLMediaElement)) {\n      return new TypeError('Peaks.init(): The mediaElement option should be an HTMLMediaElement');\n    }\n  }\n\n  if (opts.logger && !isFunction(opts.logger)) {\n    return new TypeError('Peaks.init(): The logger option should be a function');\n  }\n\n  if (opts.segments && !Array.isArray(opts.segments)) {\n    return new TypeError('Peaks.init(): options.segments must be an array of segment objects');\n  }\n\n  if (opts.points && !Array.isArray(opts.points)) {\n    return new TypeError('Peaks.init(): options.points must be an array of point objects');\n  }\n\n  extendOptions(this.options, opts);\n\n  this.options.overview = getOverviewOptions(opts);\n  this.options.zoomview = getZoomviewOptions(opts);\n  this.options.scrollbar = getScrollbarOptions(opts);\n\n  addSegmentOptions(this.options, opts);\n\n  if (!Array.isArray(this.options.zoomLevels)) {\n    return new TypeError('Peaks.init(): The zoomLevels option should be an array');\n  }\n  else if (this.options.zoomLevels.length === 0) {\n    return new Error('Peaks.init(): The zoomLevels array must not be empty');\n  }\n  else {\n    if (!isInAscendingOrder(this.options.zoomLevels)) {\n      return new Error('Peaks.init(): The zoomLevels array must be sorted in ascending order');\n    }\n  }\n\n  this._logger = this.options.logger;\n};\n\n/**\n * Remote waveform data options for [Peaks.setSource]{@link Peaks#setSource}.\n *\n * @typedef {Object} RemoteWaveformDataOptions\n * @global\n * @property {String=} arraybuffer\n * @property {String=} json\n */\n\n/**\n * Local waveform data options for [Peaks.setSource]{@link Peaks#setSource}.\n *\n * @typedef {Object} LocalWaveformDataOptions\n * @global\n * @property {ArrayBuffer=} arraybuffer\n * @property {Object=} json\n */\n\n/**\n * Web Audio options for [Peaks.setSource]{@link Peaks#setSource}.\n *\n * @typedef {Object} WebAudioOptions\n * @global\n * @property {AudioContext=} audioContext\n * @property {AudioBuffer=} audioBuffer\n * @property {Number=} scale\n * @property {Boolean=} multiChannel\n */\n\n/**\n * Options for [Peaks.setSource]{@link Peaks#setSource}.\n *\n * @typedef {Object} PeaksSetSourceOptions\n * @global\n * @property {String=} mediaUrl\n * @property {RemoteWaveformDataOptions=} dataUri\n * @property {LocalWaveformDataOptions=} waveformData\n * @property {WebAudioOptions=} webAudio\n * @property {Boolean=} withCredentials\n * @property {Array<Number>=} zoomLevels\n */\n\n/**\n * Changes the audio or video media source associated with the {@link Peaks}\n * instance.\n *\n * @see SetSourceHandler\n *\n * @param {PeaksSetSourceOptions} options\n * @param {Function} callback\n */\n\nPeaks.prototype.setSource = function(options, callback) {\n  const self = this;\n\n  self.player._setSource(options)\n    .then(function() {\n      if (!options.zoomLevels) {\n        options.zoomLevels = self.options.zoomLevels;\n      }\n\n      self._waveformBuilder = new WaveformBuilder(self);\n\n      self._waveformBuilder.init(options, function(err, waveformData) {\n        if (err) {\n          callback(err);\n          return;\n        }\n\n        self._waveformBuilder = null;\n        self._waveformData = waveformData;\n\n        ['overview', 'zoomview'].forEach(function(viewName) {\n          const view = self.views.getView(viewName);\n\n          if (view) {\n            view.setWaveformData(waveformData);\n          }\n        });\n\n        self.zoom.setZoomLevels(options.zoomLevels);\n\n        callback();\n      });\n    })\n    .catch(function(err) {\n      callback(err);\n    });\n};\n\nPeaks.prototype.getWaveformData = function() {\n  return this._waveformData;\n};\n\n/**\n * Cleans up a Peaks instance after use.\n */\n\nPeaks.prototype.destroy = function() {\n  if (this._waveformBuilder) {\n    this._waveformBuilder.abort();\n  }\n\n  if (this._keyboardHandler) {\n    this._keyboardHandler.destroy();\n  }\n\n  if (this.views) {\n    this.views.destroy();\n  }\n\n  if (this.player) {\n    this.player.destroy();\n  }\n\n  if (this._cueEmitter) {\n    this._cueEmitter.destroy();\n  }\n};\n\nexport default Peaks;\n"],"names":["has","Object","prototype","hasOwnProperty","prefix","Events","create","__proto__","EE","fn","context","once","addListener","emitter","event","TypeError","listener","evt","_events","_eventsCount","push","clearEvent","EventEmitter","eventNames","names","events","name","call","slice","getOwnPropertySymbols","concat","listeners","handlers","i","l","length","ee","Array","listenerCount","emit","a1","a2","a3","a4","a5","len","arguments","args","removeListener","undefined","apply","j","on","removeAllListeners","off","prefixed","module","Cue","time","type","id","POINT","SEGMENT_START","SEGMENT_END","sorter","a","b","zeroPad","number","precision","toString","formatTime","result","fractionSeconds","Math","floor","pow","seconds","minutes","hours","join","roundUpToNearest","value","multiple","multiplier","roundedUp","ceil","clamp","min","max","objectHasProperty","object","field","extend","to","from","key","isInAscendingOrder","array","isNumber","isFinite","Infinity","isValidTime","Number","isObject","_typeof","isArray","isString","isArrayBuffer","includes","isNullOrUndefined","isFunction","isBoolean","isHTMLElement","HTMLElement","isLinearGradientColor","linearGradientStart","linearGradientEnd","linearGradientColorStops","getMarkerObject","obj","parent","Konva","Layer","isHeadless","test","navigator","userAgent","windowIsVisible","webdriver","document","visibilityState","requestAnimationFrame","window","mozRequestAnimationFrame","webkitRequestAnimationFrame","msRequestAnimationFrame","cancelAnimationFrame","mozCancelAnimationFrame","webkitCancelAnimationFrame","msCancelAnimationFrame","eventTypes","forward","reverse","EVENT_TYPE_POINT","EVENT_TYPE_SEGMENT_ENTER","EVENT_TYPE_SEGMENT_EXIT","eventAttributes","getPointOrSegment","peaks","cue","points","getPoint","segments","getSegment","Error","CueEmitter","_cues","_peaks","_previousTime","_updateCues","bind","_onPlaying","_onSeeked","_onTimeUpdate","_onAnimationFrame","_rAFHandle","_activeSegments","_attachEventHandlers","self","getPoints","getSegments","forEach","point","segment","startTime","endTime","sort","player","getCurrentTime","_updateActiveSegments","_onUpdate","previousTime","isForward","start","end","step","marker","eventType","isPlaying","isSeeking","getSegmentIdComparator","compareSegmentIds","activeSegments","getSegmentsAtTime","find","_detachEventHandlers","destroy","pointOptions","invalidOptions","setDefaultPointOptions","options","peaksOptions","labelText","editable","color","pointMarkerColor","validatePointOptions","updating","RangeError","Point","pid","_pid","_setUserData","indexOf","defineProperties","enumerable","get","_id","_time","_labelText","_color","_editable","update","updatePointId","isVisible","_setTime","WaveformPoints","_points","_pointsById","_pointsByPid","_pointIdCounter","_pointPid","_getNextPointId","_getNextPid","_addPoint","_createPoint","filter","add","arrayArgs","map","newPointId","_findPoint","predicate","indexes","_removeIndexes","removed","index","itemRemoved","splice","_removePoints","remove","p","removeById","pointId","removeByTime","removeAll","segmentOptions","setDefaultSegmentOptions","globalSegmentOptions","overlay","overlayColor","waveformColor","borderColor","overlayBorderColor","markers","validateSegmentOptions","Segment","_startTime","_endTime","_borderColor","_markers","_overlay","updateSegmentId","_setStartTime","_setEndTime","WaveformSegments","_segments","_segmentsById","_segmentsByPid","_segmentIdCounter","_segmentPid","_isInserting","_getNextSegmentId","_addSegment","_createSegment","_getSortedSegments","findPreviousSegment","sortedSegments","findIndex","s","findNextSegment","insert","newSegmentId","_findSegment","_removeSegments","segmentId","setInserting","isInserting","nodes","SPACE","TAB","LEFT_ARROW","RIGHT_ARROW","keys","KeyboardHandler","eventEmitter","_handleKeyEvent","addEventListener","handleKeyEvent","target","nodeName","preventDefault","keyCode","shiftKey","removeEventListener","mediaElementHasSource","mediaElement","src","querySelector","MediaElementPlayer","_mediaElement","_addMediaListener","callback","_listeners","init","_eventEmitter","_duration","getDuration","error","_interval","Promise","resolve","code","MediaError","MEDIA_ERR_SRC_NOT_SUPPORTED","reject","eventHandler","readyState","HTMLMediaElement","HAVE_NOTHING","load","play","pause","paused","seeking","currentTime","duration","seek","SetSourceHandler","_playerCanPlayHandler","_playerErrorHandler","setSource","_options","_callback","_resolve","_reject","setAttribute","mediaUrl","_reset","err","setSourceHandler","getAllPropertiesFrom","adapter","allProperties","getOwnPropertyNames","getPrototypeOf","validateAdapter","publicAdapterMethods","method","Player","_playingSegment","_segment","_loop","_playSegmentTimerCallback","_adapter","_logger","playSegment","loop","_setSource","DefaultPointMarker","_draggable","group","handleWidth","handleHeight","handleX","view","_label","Text","x","y","text","textAlign","fontFamily","fontSize","fontStyle","fill","_handle","Rect","width","height","visible","_line","Line","stroke","strokeWidth","layer","hide","fitToView","bindEventHandlers","setX","getWidth","show","getHeight","setText","DefaultSegmentMarker","xPosition","startMarker","createSegmentMarker","createSegmentLabel","createPointMarker","HighlightLayer","_view","_offset","highlightOffset","highlightColor","_layer","listening","_highlightRect","_strokeColor","highlightStrokeColor","_opacity","highlightOpacity","_cornerRadius","highlightCornerRadius","addToStage","stage","showHighlight","_createHighlightRect","_update","startOffset","timeToPixels","endOffset","setAttrs","opacity","cornerRadius","removeHighlight","updateHighlight","offset","PointMarker","_point","_marker","draggable","_onDragStart","onDragStart","_onDragMove","onDragMove","_onDragEnd","onDragEnd","_dragBoundFunc","dragBoundFunc","_onMouseEnter","onMouseEnter","_onMouseLeave","onMouseLeave","_group","Group","_bindDefaultEventHandlers","addToLayer","getX","getAbsolutePosition","destroyChildren","PointsLayer","enableEditing","_enableEditing","_pointMarkers","_onPointsDrag","_onPointMarkerDragStart","_onPointMarkerDragMove","_onPointMarkerDragEnd","_pointMarkerDragBoundFunc","_onPointMarkerMouseEnter","_onPointMarkerMouseLeave","_onPointsUpdate","_onPointsAdd","_onPointsRemove","_onPointsRemoveAll","setListening","enable","getPointMarker","frameStartTime","getStartTime","frameEndTime","getEndTime","pointMarker","_removePoint","_updatePoint","pointMarkerOffset","pointMarkerX","getFrameOffset","removeChildren","_createPointMarker","viewOptions","getViewOptions","getName","_addPointMarker","_dragPointMarker","markerX","pixelOffsetToTime","pos","updatePoints","_removeInvisiblePoints","pointPid","setVisible","draw","PlayheadLayer","_player","_playheadPixel","_playheadLineAnimation","_playheadVisible","_playheadColor","playheadColor","_playheadTextColor","playheadTextColor","_playheadBackgroundColor","playheadBackgroundColor","_playheadPadding","playheadPadding","_playheadWidth","playheadWidth","_playheadFontFamily","playheadFontFamily","_playheadFontSize","playheadFontSize","_playheadFontStyle","playheadFontStyle","_playheadLayer","_createPlayhead","showPlayheadTime","_createPlayheadText","zoomLevelChanged","pixelsPerSecond","_useAnimation","_start","stop","_playheadLine","_playheadText","_playheadGroup","padding","align","sceneFunc","shape","fillStyle","fillRect","_sceneFunc","updatePlayheadTime","_syncPlayhead","pixelIndex","frameOffset","playheadX","playheadTextWidth","playheadPosChanged","lastPlayheadPosition","Animation","playheadPosition","getPlayheadPixel","updatePlayheadText","OverlaySegmentMarker","body","style","cursor","viewHeight","overlayOffset","overlayRectHeight","SegmentMarker","_segmentShape","segmentShape","_startMarker","_onClick","onClick","moveToTop","isStartMarker","startDrag","stopDrag","WaveformShape","shapeOptions","startY","_height","endY","fillLinearGradientStartPointY","fillLinearGradientEndPointY","fillLinearGradientColorStops","_shape","Shape","setSegment","setWaveformColor","_drawWaveform","getWaveformData","waveformData","startPixels","endPixels","limit","channels","waveformTop","waveformHeight","_drawChannel","channel","top","amplitude","amplitudeScale","getAmplitudeScale","lineX","lineY","beginPath","min_sample","scaleY","lineTo","max_sample","closePath","fillShape","handler","scale","SegmentShape","_endMarker","isSegmentDraggingEnabled","_dragging","_overlayOffset","_waveformShape","_onMouseDown","_onMouseUp","_onSegmentDragStart","_onSegmentDragMove","_onSegmentDragEnd","_onSegmentMarkerClick","_onSegmentMarkerDragStart","_onSegmentMarkerDragMove","_onSegmentMarkerDragEnd","_segmentMarkerDragBoundFunc","segmentStartOffset","timeToPixelOffset","segmentEndOffset","clipX","clipY","clipWidth","clipHeight","overlayBorderWidth","overlayOpacity","overlayCornerRadius","_overlayRect","_overlayText","overlayFontFamily","overlayFontSize","overlayFontStyle","overlayLabelColor","overlayLabelAlign","verticalAlign","overlayLabelVerticalAlign","overlayLabelPadding","_createMarkers","createOverlayMarker","isEditingEnabled","endMarker","startMarkerColor","endMarkerColor","getStartMarker","getEndMarker","bordercolor","isDragging","segmentClicked","eventName","_moveToTop","moveSegmentMarkersToTop","enableSegmentDragging","_setPreviousAndNextSegments","getSegmentDragMode","_nextSegment","_previousSegment","_dragStartX","_dragStartTime","_dragEndTime","offsetX","timeOffset","pixelsToTime","segmentDuration","dragMode","minSegmentWidth","getMinSegmentDragWidth","minSegmentDuration","previousSegmentUpdated","nextSegmentUpdated","previousSegmentEndX","previousSegmentEndTime","minPreviousSegmentEndTime","nextSegmentStartX","nextSegmentStartTime","maxNextSegmentStartTime","moveMarkersToTop","segmentMarker","_startMarkerX","_endMarkerX","_segmentStartMarkerDragMove","_segmentEndMarkerDragMove","startMarkerX","endMarkerX","upperLimit","previousSegmentVisible","fixedPreviousSegment","compressPreviousSegment","previousSegmentDuration","lowerLimit","nextSegmentVisible","fixedNextSegment","compressNextSegment","nextSegmentDuration","SegmentsLayer","_segmentShapes","_onSegmentsUpdate","_onSegmentsAdd","_onSegmentsRemove","_onSegmentsRemoveAll","_onSegmentsDragged","segmentPid","getSegmentShape","_removeSegment","_updateSegment","_addSegmentShape","_createSegmentShape","updateSegments","_removeInvisibleSegments","WaveformAxis","_axisGridlineColor","axisGridlineColor","_axisLabelColor","axisLabelColor","_showAxisLabels","showAxisLabels","_axisTopMarkerHeight","axisTopMarkerHeight","_axisBottomMarkerHeight","axisBottomMarkerHeight","formatAxisTime","_formatAxisTime","_axisLabelFont","_buildFontString","_axisShape","_drawAxis","topMarkerHeight","bottomMarkerHeight","setAxisLabelColor","setAxisGridlineColor","_getAxisLabelScale","baseSecs","steps","minSpacing","secs","pixels","currentFrameStartTime","axisLabelIntervalSecs","firstAxisLabelSecs","axisLabelOffsetSecs","axisLabelOffsetPixels","setAttr","moveTo","label","labelWidth","measureText","labelX","labelY","fillText","WaveformView","container","_container","_viewOptions","_originalWaveformData","_data","_frameOffset","_width","clientWidth","clientHeight","_amplitudeScale","_waveformColor","_playedWaveformColor","playedWaveformColor","_timeLabelPrecision","timeLabelPrecision","formatPlayheadTime","_formatPlayheadTime","_enableSeek","initWaveformData","showWarnings","_stage","Stage","_createWaveform","enableSegments","_segmentsLayer","enablePoints","_pointsLayer","initHighlightLayer","_createAxisLabels","_onDblClick","_onContextMenu","setWaveformData","sample_rate","_getDuration","_waveformLayer","_createWaveformShapes","_playedWaveformShape","_playedSegment","_unplayedSegment","setPlayedWaveformColor","_destroyPlayedWaveformShape","_axisLayer","_axis","setTimeLabelPrecision","setAmplitudeScale","drawWaveformLayer","enableSeek","isSeekEnabled","_clickHandler","emitViewEvent","attrs","getAttr","preventViewEvent","clickEvent","viewName","enableMarkerEditing","dragSeek","dragging","fitToContainer","updateWaveform","setWidth","containerWidthChange","heightChanged","setHeight","containerHeightChange","MouseDragHandler","_handlers","_mouseDown","_mouseUp","_mouseMove","_lastMouseClientX","button","touches","clientX","onMouseDown","mouseDownPosX","_getMousePosX","capture","passive","changedTouches","onMouseMove","mousePosX","cancelable","onMouseUp","containerPos","getContainer","getBoundingClientRect","left","SeekMouseDragHandler","_firstMove","_onMouseMove","_mouseDragHandler","_seek","WaveformOverview","overview","_onPause","_onZoomviewUpdate","zoomview","views","getView","_highlightLayer","_resampleAndSetWaveformData","resample","removeHighlightRect","playheadTime","InsertSegmentMouseDragHandler","_insertSegment","_insertSegmentShape","_segmentIsDraggable","ScrollMouseDragHandler","_seeking","_initialFrameOffset","_mouseDownX","playheadOffset","getPlayheadOffset","abs","getPlayheadClickTolerance","isAutoZoom","diff","newFrameOffset","WaveformZoomView","_onKeyboardLeft","_onKeyboardRight","_onKeyboardShiftLeft","_onKeyboardShiftRight","_autoScroll","autoScroll","_autoScrollOffset","autoScrollOffset","_enableSegmentDragging","_segmentDragMode","_minSegmentDragWidth","_playheadClickTolerance","playheadClickTolerance","_zoomLevelAuto","_zoomLevelSeconds","_onWheel","_onWheelCaptureVerticalScroll","setWheelMode","wheelMode","_enableWaveformCache","waveformCache","_initWaveformCache","initialZoomLevel","zoom","getZoomLevel","_resampleData","_waveformData","Map","set","_waveformScales","mode","_wheelMode","captureVerticalScroll","_captureVerticalScroll","wheelEvent","delta","deltaY","deltaX","deltaMode","WheelEvent","DOM_DELTA_PAGE","_pixelLength","setWaveformDragMode","setSegmentDragMode","_keyboardScroll","direction","large","increment","nudgeIncrement","scrollWaveform","endThreshold","_getScale","isAutoScale","setZoom","apexTime","playheadOffsetPixels","prevScale","_scale","apexPixel","currentZoom","previousZoom","sourceWaveform","setStartTime","getPixelLength","scrollAmount","forceUpdate","playheadPixel","enableAutoScroll","setMinSegmentDragWidth","resampleOptions","getStage","getSegmentsLayer","clear","Scrollbar","scrollbar","_zoomview","_onScrollboxDragStart","_onScrollboxDragMove","_onScrollboxDragEnd","_onScrollbarClick","_scrollboxX","_minScrollboxWidth","minWidth","_offsetY","_scrollbox","_scrollboxRect","_setScrollboxWidth","_updateScrollbarWidthAndPosition","setZoomview","_scrollboxWidth","_getScrollbarRange","range","_updateWaveform","zoomviewRange","scrollBoxPos","ViewController","_overview","_scrollbar","createOverview","createZoomview","createScrollbar","destroyOverview","destroyZoomview","getScrollbar","ZoomController","zoomLevels","_zoomLevels","_zoomLevelIndex","setZoomLevels","zoomIn","zoomOut","zoomLevelIndex","getZoom","isXhr2","XMLHttpRequest","WaveformBuilder","dataUri","webAudio","audioContext","_getRemoteWaveformData","_buildWaveformFromLocalData","audioBuffer","_buildWaveformDataFromAudioBuffer","_buildWaveformDataUsingWebAudio","hasValidContentRangeHeader","xhr","contentRange","getResponseHeader","matches","match","firstPos","parseInt","lastPos","requestType","url","some","connector","toLowerCase","Boolean","_xhr","_createXHR","withCredentials","status","WaveformData","response","bits","send","data","json","arraybuffer","createdWaveformData","AudioContext","webkitAudioContext","webAudioOptions","mediaSourceUrl","currentSrc","_requestAudioAndBuildWaveformData","webAudioBuilderOptions","audio_buffer","split_channels","multiChannel","disable_worker","createFromAudio","audio_context","array_buffer","abort","onLoad","onError","onAbort","open","responseType","onload","onerror","Peaks","logger","console","defaultViewOptions","defaultZoomviewOptions","defaultOverviewOptions","defaultSegmentOptions","defaultScrollbarOptions","getOverviewOptions","opts","overviewOptions","optNames","optName","getZoomviewOptions","zoomviewOptions","getScrollbarOptions","scrollbarOptions","extendOptions","addSegmentOptions","checkContainerElements","zoomviewContainer","overviewContainer","instance","_setOptions","scrollbarContainer","keyboard","_keyboardHandler","_waveformBuilder","then","emitCueEvents","_cueEmitter","catch"],"mappings":"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","x_google_ignoreList":[0]}