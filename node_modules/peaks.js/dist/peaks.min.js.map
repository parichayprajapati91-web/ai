{"version":3,"file":"peaks.min.js","sources":["node_modules/peaks.js/node_modules/eventemitter3/index.js","node_modules/peaks.js/src/cue.js","node_modules/peaks.js/node_modules/konva/lib/Global.js","node_modules/peaks.js/node_modules/konva/lib/Util.js","node_modules/peaks.js/node_modules/konva/lib/Context.js","node_modules/peaks.js/node_modules/konva/lib/Canvas.js","node_modules/peaks.js/node_modules/konva/lib/DragAndDrop.js","node_modules/peaks.js/node_modules/konva/lib/Validators.js","node_modules/peaks.js/node_modules/konva/lib/Factory.js","node_modules/peaks.js/node_modules/konva/lib/Node.js","node_modules/peaks.js/node_modules/konva/lib/Container.js","node_modules/peaks.js/node_modules/konva/lib/PointerEvents.js","node_modules/peaks.js/node_modules/konva/lib/Shape.js","node_modules/peaks.js/node_modules/konva/lib/Layer.js","node_modules/peaks.js/node_modules/konva/lib/Animation.js","node_modules/peaks.js/node_modules/konva/lib/_CoreInternals.js","node_modules/peaks.js/node_modules/konva/lib/Stage.js","node_modules/peaks.js/node_modules/konva/lib/FastLayer.js","node_modules/peaks.js/node_modules/konva/lib/Group.js","node_modules/peaks.js/node_modules/konva/lib/Tween.js","node_modules/peaks.js/node_modules/konva/lib/Core.js","node_modules/peaks.js/src/utils.js","node_modules/peaks.js/src/cue-emitter.js","node_modules/peaks.js/src/point.js","node_modules/peaks.js/src/waveform-points.js","node_modules/peaks.js/src/segment.js","node_modules/peaks.js/src/waveform-segments.js","node_modules/peaks.js/src/keyboard-handler.js","node_modules/peaks.js/src/mediaelement-player.js","node_modules/peaks.js/src/player.js","node_modules/peaks.js/node_modules/konva/lib/shapes/Line.js","node_modules/peaks.js/node_modules/konva/lib/shapes/Rect.js","node_modules/peaks.js/node_modules/konva/lib/shapes/Text.js","node_modules/peaks.js/src/default-point-marker.js","node_modules/peaks.js/src/default-segment-marker.js","node_modules/peaks.js/src/marker-factories.js","node_modules/peaks.js/src/highlight-layer.js","node_modules/peaks.js/src/point-marker.js","node_modules/peaks.js/src/points-layer.js","node_modules/peaks.js/src/playhead-layer.js","node_modules/peaks.js/src/overlay-segment-marker.js","node_modules/peaks.js/src/segment-marker.js","node_modules/peaks.js/src/waveform-shape.js","node_modules/peaks.js/src/segment-shape.js","node_modules/peaks.js/src/segments-layer.js","node_modules/peaks.js/src/waveform-axis.js","node_modules/peaks.js/src/waveform-view.js","node_modules/peaks.js/src/mouse-drag-handler.js","node_modules/peaks.js/src/seek-mouse-drag-handler.js","node_modules/peaks.js/src/waveform-overview.js","node_modules/peaks.js/src/insert-segment-mouse-drag-handler.js","node_modules/peaks.js/src/scroll-mouse-drag-handler.js","node_modules/peaks.js/src/waveform-zoomview.js","node_modules/peaks.js/src/scrollbar.js","node_modules/peaks.js/src/view-controller.js","node_modules/peaks.js/src/zoom-controller.js","node_modules/peaks.js/node_modules/waveform-data/dist/waveform-data.esm.js","node_modules/peaks.js/src/waveform-builder.js","node_modules/peaks.js/src/main.js"],"sourcesContent":["'use strict';\n\nvar has = Object.prototype.hasOwnProperty\n  , prefix = '~';\n\n/**\n * Constructor to create a storage for our `EE` objects.\n * An `Events` instance is a plain object whose properties are event names.\n *\n * @constructor\n * @private\n */\nfunction Events() {}\n\n//\n// We try to not inherit from `Object.prototype`. In some engines creating an\n// instance in this way is faster than calling `Object.create(null)` directly.\n// If `Object.create(null)` is not supported we prefix the event names with a\n// character to make sure that the built-in object properties are not\n// overridden or used as an attack vector.\n//\nif (Object.create) {\n  Events.prototype = Object.create(null);\n\n  //\n  // This hack is needed because the `__proto__` property is still inherited in\n  // some old browsers like Android 4, iPhone 5.1, Opera 11 and Safari 5.\n  //\n  if (!new Events().__proto__) prefix = false;\n}\n\n/**\n * Representation of a single event listener.\n *\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} [once=false] Specify if the listener is a one-time listener.\n * @constructor\n * @private\n */\nfunction EE(fn, context, once) {\n  this.fn = fn;\n  this.context = context;\n  this.once = once || false;\n}\n\n/**\n * Add a listener for a given event.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} once Specify if the listener is a one-time listener.\n * @returns {EventEmitter}\n * @private\n */\nfunction addListener(emitter, event, fn, context, once) {\n  if (typeof fn !== 'function') {\n    throw new TypeError('The listener must be a function');\n  }\n\n  var listener = new EE(fn, context || emitter, once)\n    , evt = prefix ? prefix + event : event;\n\n  if (!emitter._events[evt]) emitter._events[evt] = listener, emitter._eventsCount++;\n  else if (!emitter._events[evt].fn) emitter._events[evt].push(listener);\n  else emitter._events[evt] = [emitter._events[evt], listener];\n\n  return emitter;\n}\n\n/**\n * Clear event by name.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} evt The Event name.\n * @private\n */\nfunction clearEvent(emitter, evt) {\n  if (--emitter._eventsCount === 0) emitter._events = new Events();\n  else delete emitter._events[evt];\n}\n\n/**\n * Minimal `EventEmitter` interface that is molded against the Node.js\n * `EventEmitter` interface.\n *\n * @constructor\n * @public\n */\nfunction EventEmitter() {\n  this._events = new Events();\n  this._eventsCount = 0;\n}\n\n/**\n * Return an array listing the events for which the emitter has registered\n * listeners.\n *\n * @returns {Array}\n * @public\n */\nEventEmitter.prototype.eventNames = function eventNames() {\n  var names = []\n    , events\n    , name;\n\n  if (this._eventsCount === 0) return names;\n\n  for (name in (events = this._events)) {\n    if (has.call(events, name)) names.push(prefix ? name.slice(1) : name);\n  }\n\n  if (Object.getOwnPropertySymbols) {\n    return names.concat(Object.getOwnPropertySymbols(events));\n  }\n\n  return names;\n};\n\n/**\n * Return the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Array} The registered listeners.\n * @public\n */\nEventEmitter.prototype.listeners = function listeners(event) {\n  var evt = prefix ? prefix + event : event\n    , handlers = this._events[evt];\n\n  if (!handlers) return [];\n  if (handlers.fn) return [handlers.fn];\n\n  for (var i = 0, l = handlers.length, ee = new Array(l); i < l; i++) {\n    ee[i] = handlers[i].fn;\n  }\n\n  return ee;\n};\n\n/**\n * Return the number of listeners listening to a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Number} The number of listeners.\n * @public\n */\nEventEmitter.prototype.listenerCount = function listenerCount(event) {\n  var evt = prefix ? prefix + event : event\n    , listeners = this._events[evt];\n\n  if (!listeners) return 0;\n  if (listeners.fn) return 1;\n  return listeners.length;\n};\n\n/**\n * Calls each of the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Boolean} `true` if the event had listeners, else `false`.\n * @public\n */\nEventEmitter.prototype.emit = function emit(event, a1, a2, a3, a4, a5) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return false;\n\n  var listeners = this._events[evt]\n    , len = arguments.length\n    , args\n    , i;\n\n  if (listeners.fn) {\n    if (listeners.once) this.removeListener(event, listeners.fn, undefined, true);\n\n    switch (len) {\n      case 1: return listeners.fn.call(listeners.context), true;\n      case 2: return listeners.fn.call(listeners.context, a1), true;\n      case 3: return listeners.fn.call(listeners.context, a1, a2), true;\n      case 4: return listeners.fn.call(listeners.context, a1, a2, a3), true;\n      case 5: return listeners.fn.call(listeners.context, a1, a2, a3, a4), true;\n      case 6: return listeners.fn.call(listeners.context, a1, a2, a3, a4, a5), true;\n    }\n\n    for (i = 1, args = new Array(len -1); i < len; i++) {\n      args[i - 1] = arguments[i];\n    }\n\n    listeners.fn.apply(listeners.context, args);\n  } else {\n    var length = listeners.length\n      , j;\n\n    for (i = 0; i < length; i++) {\n      if (listeners[i].once) this.removeListener(event, listeners[i].fn, undefined, true);\n\n      switch (len) {\n        case 1: listeners[i].fn.call(listeners[i].context); break;\n        case 2: listeners[i].fn.call(listeners[i].context, a1); break;\n        case 3: listeners[i].fn.call(listeners[i].context, a1, a2); break;\n        case 4: listeners[i].fn.call(listeners[i].context, a1, a2, a3); break;\n        default:\n          if (!args) for (j = 1, args = new Array(len -1); j < len; j++) {\n            args[j - 1] = arguments[j];\n          }\n\n          listeners[i].fn.apply(listeners[i].context, args);\n      }\n    }\n  }\n\n  return true;\n};\n\n/**\n * Add a listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.on = function on(event, fn, context) {\n  return addListener(this, event, fn, context, false);\n};\n\n/**\n * Add a one-time listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.once = function once(event, fn, context) {\n  return addListener(this, event, fn, context, true);\n};\n\n/**\n * Remove the listeners of a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn Only remove the listeners that match this function.\n * @param {*} context Only remove the listeners that have this context.\n * @param {Boolean} once Only remove one-time listeners.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeListener = function removeListener(event, fn, context, once) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return this;\n  if (!fn) {\n    clearEvent(this, evt);\n    return this;\n  }\n\n  var listeners = this._events[evt];\n\n  if (listeners.fn) {\n    if (\n      listeners.fn === fn &&\n      (!once || listeners.once) &&\n      (!context || listeners.context === context)\n    ) {\n      clearEvent(this, evt);\n    }\n  } else {\n    for (var i = 0, events = [], length = listeners.length; i < length; i++) {\n      if (\n        listeners[i].fn !== fn ||\n        (once && !listeners[i].once) ||\n        (context && listeners[i].context !== context)\n      ) {\n        events.push(listeners[i]);\n      }\n    }\n\n    //\n    // Reset the array, or remove it completely if we have no more listeners.\n    //\n    if (events.length) this._events[evt] = events.length === 1 ? events[0] : events;\n    else clearEvent(this, evt);\n  }\n\n  return this;\n};\n\n/**\n * Remove all listeners, or those of the specified event.\n *\n * @param {(String|Symbol)} [event] The event name.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeAllListeners = function removeAllListeners(event) {\n  var evt;\n\n  if (event) {\n    evt = prefix ? prefix + event : event;\n    if (this._events[evt]) clearEvent(this, evt);\n  } else {\n    this._events = new Events();\n    this._eventsCount = 0;\n  }\n\n  return this;\n};\n\n//\n// Alias methods names because people roll like that.\n//\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\nEventEmitter.prototype.addListener = EventEmitter.prototype.on;\n\n//\n// Expose the prefix.\n//\nEventEmitter.prefixed = prefix;\n\n//\n// Allow `EventEmitter` to be imported as module namespace.\n//\nEventEmitter.EventEmitter = EventEmitter;\n\n//\n// Expose the module.\n//\nif ('undefined' !== typeof module) {\n  module.exports = EventEmitter;\n}\n","/**\n * @file\n *\n * Defines the {@link Cue} class.\n *\n * @module cue\n */\n\n/**\n * A cue represents an event to be triggered at some point on the media\n * timeline.\n *\n * @class\n * @alias Cue\n *\n * @param {Number} time Cue time, in seconds.\n * @param {Number} type Cue mark type, either <code>Cue.POINT</code>,\n *   <code>Cue.SEGMENT_START</code>, or <code>Cue.SEGMENT_END</code>.\n * @param {String} id The id of the {@link Point} or {@link Segment}.\n */\n\nfunction Cue(time, type, id) {\n  this.time = time;\n  this.type = type;\n  this.id = id;\n}\n\n/**\n  * @constant\n  * @type {Number}\n  */\n\nCue.POINT = 0;\nCue.SEGMENT_START = 1;\nCue.SEGMENT_END = 2;\n\n/**\n * Callback function for use with Array.prototype.sort().\n *\n * @static\n * @param {Cue} a\n * @param {Cue} b\n * @return {Number}\n */\n\nCue.sorter = function(a, b) {\n  return a.time - b.time;\n};\n\nexport default Cue;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports._registerNode = exports.Konva = exports.glob = void 0;\nconst PI_OVER_180 = Math.PI / 180;\nfunction detectBrowser() {\n    return (typeof window !== 'undefined' &&\n        ({}.toString.call(window) === '[object Window]' ||\n            {}.toString.call(window) === '[object global]'));\n}\nexports.glob = typeof global !== 'undefined'\n    ? global\n    : typeof window !== 'undefined'\n        ? window\n        : typeof WorkerGlobalScope !== 'undefined'\n            ? self\n            : {};\nexports.Konva = {\n    _global: exports.glob,\n    version: '9.3.22',\n    isBrowser: detectBrowser(),\n    isUnminified: /param/.test(function (param) { }.toString()),\n    dblClickWindow: 400,\n    getAngle(angle) {\n        return exports.Konva.angleDeg ? angle * PI_OVER_180 : angle;\n    },\n    enableTrace: false,\n    pointerEventsEnabled: true,\n    autoDrawEnabled: true,\n    hitOnDragEnabled: false,\n    capturePointerEventsEnabled: false,\n    _mouseListenClick: false,\n    _touchListenClick: false,\n    _pointerListenClick: false,\n    _mouseInDblClickWindow: false,\n    _touchInDblClickWindow: false,\n    _pointerInDblClickWindow: false,\n    _mouseDblClickPointerId: null,\n    _touchDblClickPointerId: null,\n    _pointerDblClickPointerId: null,\n    _fixTextRendering: false,\n    pixelRatio: (typeof window !== 'undefined' && window.devicePixelRatio) || 1,\n    dragDistance: 3,\n    angleDeg: true,\n    showWarnings: true,\n    dragButtons: [0, 1],\n    isDragging() {\n        return exports.Konva['DD'].isDragging;\n    },\n    isTransforming() {\n        var _a;\n        return (_a = exports.Konva['Transformer']) === null || _a === void 0 ? void 0 : _a.isTransforming();\n    },\n    isDragReady() {\n        return !!exports.Konva['DD'].node;\n    },\n    releaseCanvasOnDestroy: true,\n    document: exports.glob.document,\n    _injectGlobal(Konva) {\n        exports.glob.Konva = Konva;\n    },\n};\nconst _registerNode = (NodeClass) => {\n    exports.Konva[NodeClass.prototype.getClassName()] = NodeClass;\n};\nexports._registerNode = _registerNode;\nexports.Konva._injectGlobal(exports.Konva);\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Util = exports.Transform = void 0;\nconst Global_1 = require(\"./Global\");\nclass Transform {\n    constructor(m = [1, 0, 0, 1, 0, 0]) {\n        this.dirty = false;\n        this.m = (m && m.slice()) || [1, 0, 0, 1, 0, 0];\n    }\n    reset() {\n        this.m[0] = 1;\n        this.m[1] = 0;\n        this.m[2] = 0;\n        this.m[3] = 1;\n        this.m[4] = 0;\n        this.m[5] = 0;\n    }\n    copy() {\n        return new Transform(this.m);\n    }\n    copyInto(tr) {\n        tr.m[0] = this.m[0];\n        tr.m[1] = this.m[1];\n        tr.m[2] = this.m[2];\n        tr.m[3] = this.m[3];\n        tr.m[4] = this.m[4];\n        tr.m[5] = this.m[5];\n    }\n    point(point) {\n        const m = this.m;\n        return {\n            x: m[0] * point.x + m[2] * point.y + m[4],\n            y: m[1] * point.x + m[3] * point.y + m[5],\n        };\n    }\n    translate(x, y) {\n        this.m[4] += this.m[0] * x + this.m[2] * y;\n        this.m[5] += this.m[1] * x + this.m[3] * y;\n        return this;\n    }\n    scale(sx, sy) {\n        this.m[0] *= sx;\n        this.m[1] *= sx;\n        this.m[2] *= sy;\n        this.m[3] *= sy;\n        return this;\n    }\n    rotate(rad) {\n        const c = Math.cos(rad);\n        const s = Math.sin(rad);\n        const m11 = this.m[0] * c + this.m[2] * s;\n        const m12 = this.m[1] * c + this.m[3] * s;\n        const m21 = this.m[0] * -s + this.m[2] * c;\n        const m22 = this.m[1] * -s + this.m[3] * c;\n        this.m[0] = m11;\n        this.m[1] = m12;\n        this.m[2] = m21;\n        this.m[3] = m22;\n        return this;\n    }\n    getTranslation() {\n        return {\n            x: this.m[4],\n            y: this.m[5],\n        };\n    }\n    skew(sx, sy) {\n        const m11 = this.m[0] + this.m[2] * sy;\n        const m12 = this.m[1] + this.m[3] * sy;\n        const m21 = this.m[2] + this.m[0] * sx;\n        const m22 = this.m[3] + this.m[1] * sx;\n        this.m[0] = m11;\n        this.m[1] = m12;\n        this.m[2] = m21;\n        this.m[3] = m22;\n        return this;\n    }\n    multiply(matrix) {\n        const m11 = this.m[0] * matrix.m[0] + this.m[2] * matrix.m[1];\n        const m12 = this.m[1] * matrix.m[0] + this.m[3] * matrix.m[1];\n        const m21 = this.m[0] * matrix.m[2] + this.m[2] * matrix.m[3];\n        const m22 = this.m[1] * matrix.m[2] + this.m[3] * matrix.m[3];\n        const dx = this.m[0] * matrix.m[4] + this.m[2] * matrix.m[5] + this.m[4];\n        const dy = this.m[1] * matrix.m[4] + this.m[3] * matrix.m[5] + this.m[5];\n        this.m[0] = m11;\n        this.m[1] = m12;\n        this.m[2] = m21;\n        this.m[3] = m22;\n        this.m[4] = dx;\n        this.m[5] = dy;\n        return this;\n    }\n    invert() {\n        const d = 1 / (this.m[0] * this.m[3] - this.m[1] * this.m[2]);\n        const m0 = this.m[3] * d;\n        const m1 = -this.m[1] * d;\n        const m2 = -this.m[2] * d;\n        const m3 = this.m[0] * d;\n        const m4 = d * (this.m[2] * this.m[5] - this.m[3] * this.m[4]);\n        const m5 = d * (this.m[1] * this.m[4] - this.m[0] * this.m[5]);\n        this.m[0] = m0;\n        this.m[1] = m1;\n        this.m[2] = m2;\n        this.m[3] = m3;\n        this.m[4] = m4;\n        this.m[5] = m5;\n        return this;\n    }\n    getMatrix() {\n        return this.m;\n    }\n    decompose() {\n        const a = this.m[0];\n        const b = this.m[1];\n        const c = this.m[2];\n        const d = this.m[3];\n        const e = this.m[4];\n        const f = this.m[5];\n        const delta = a * d - b * c;\n        const result = {\n            x: e,\n            y: f,\n            rotation: 0,\n            scaleX: 0,\n            scaleY: 0,\n            skewX: 0,\n            skewY: 0,\n        };\n        if (a != 0 || b != 0) {\n            const r = Math.sqrt(a * a + b * b);\n            result.rotation = b > 0 ? Math.acos(a / r) : -Math.acos(a / r);\n            result.scaleX = r;\n            result.scaleY = delta / r;\n            result.skewX = (a * c + b * d) / delta;\n            result.skewY = 0;\n        }\n        else if (c != 0 || d != 0) {\n            const s = Math.sqrt(c * c + d * d);\n            result.rotation =\n                Math.PI / 2 - (d > 0 ? Math.acos(-c / s) : -Math.acos(c / s));\n            result.scaleX = delta / s;\n            result.scaleY = s;\n            result.skewX = 0;\n            result.skewY = (a * c + b * d) / delta;\n        }\n        else {\n        }\n        result.rotation = exports.Util._getRotation(result.rotation);\n        return result;\n    }\n}\nexports.Transform = Transform;\nconst OBJECT_ARRAY = '[object Array]', OBJECT_NUMBER = '[object Number]', OBJECT_STRING = '[object String]', OBJECT_BOOLEAN = '[object Boolean]', PI_OVER_DEG180 = Math.PI / 180, DEG180_OVER_PI = 180 / Math.PI, HASH = '#', EMPTY_STRING = '', ZERO = '0', KONVA_WARNING = 'Konva warning: ', KONVA_ERROR = 'Konva error: ', RGB_PAREN = 'rgb(', COLORS = {\n    aliceblue: [240, 248, 255],\n    antiquewhite: [250, 235, 215],\n    aqua: [0, 255, 255],\n    aquamarine: [127, 255, 212],\n    azure: [240, 255, 255],\n    beige: [245, 245, 220],\n    bisque: [255, 228, 196],\n    black: [0, 0, 0],\n    blanchedalmond: [255, 235, 205],\n    blue: [0, 0, 255],\n    blueviolet: [138, 43, 226],\n    brown: [165, 42, 42],\n    burlywood: [222, 184, 135],\n    cadetblue: [95, 158, 160],\n    chartreuse: [127, 255, 0],\n    chocolate: [210, 105, 30],\n    coral: [255, 127, 80],\n    cornflowerblue: [100, 149, 237],\n    cornsilk: [255, 248, 220],\n    crimson: [220, 20, 60],\n    cyan: [0, 255, 255],\n    darkblue: [0, 0, 139],\n    darkcyan: [0, 139, 139],\n    darkgoldenrod: [184, 132, 11],\n    darkgray: [169, 169, 169],\n    darkgreen: [0, 100, 0],\n    darkgrey: [169, 169, 169],\n    darkkhaki: [189, 183, 107],\n    darkmagenta: [139, 0, 139],\n    darkolivegreen: [85, 107, 47],\n    darkorange: [255, 140, 0],\n    darkorchid: [153, 50, 204],\n    darkred: [139, 0, 0],\n    darksalmon: [233, 150, 122],\n    darkseagreen: [143, 188, 143],\n    darkslateblue: [72, 61, 139],\n    darkslategray: [47, 79, 79],\n    darkslategrey: [47, 79, 79],\n    darkturquoise: [0, 206, 209],\n    darkviolet: [148, 0, 211],\n    deeppink: [255, 20, 147],\n    deepskyblue: [0, 191, 255],\n    dimgray: [105, 105, 105],\n    dimgrey: [105, 105, 105],\n    dodgerblue: [30, 144, 255],\n    firebrick: [178, 34, 34],\n    floralwhite: [255, 255, 240],\n    forestgreen: [34, 139, 34],\n    fuchsia: [255, 0, 255],\n    gainsboro: [220, 220, 220],\n    ghostwhite: [248, 248, 255],\n    gold: [255, 215, 0],\n    goldenrod: [218, 165, 32],\n    gray: [128, 128, 128],\n    green: [0, 128, 0],\n    greenyellow: [173, 255, 47],\n    grey: [128, 128, 128],\n    honeydew: [240, 255, 240],\n    hotpink: [255, 105, 180],\n    indianred: [205, 92, 92],\n    indigo: [75, 0, 130],\n    ivory: [255, 255, 240],\n    khaki: [240, 230, 140],\n    lavender: [230, 230, 250],\n    lavenderblush: [255, 240, 245],\n    lawngreen: [124, 252, 0],\n    lemonchiffon: [255, 250, 205],\n    lightblue: [173, 216, 230],\n    lightcoral: [240, 128, 128],\n    lightcyan: [224, 255, 255],\n    lightgoldenrodyellow: [250, 250, 210],\n    lightgray: [211, 211, 211],\n    lightgreen: [144, 238, 144],\n    lightgrey: [211, 211, 211],\n    lightpink: [255, 182, 193],\n    lightsalmon: [255, 160, 122],\n    lightseagreen: [32, 178, 170],\n    lightskyblue: [135, 206, 250],\n    lightslategray: [119, 136, 153],\n    lightslategrey: [119, 136, 153],\n    lightsteelblue: [176, 196, 222],\n    lightyellow: [255, 255, 224],\n    lime: [0, 255, 0],\n    limegreen: [50, 205, 50],\n    linen: [250, 240, 230],\n    magenta: [255, 0, 255],\n    maroon: [128, 0, 0],\n    mediumaquamarine: [102, 205, 170],\n    mediumblue: [0, 0, 205],\n    mediumorchid: [186, 85, 211],\n    mediumpurple: [147, 112, 219],\n    mediumseagreen: [60, 179, 113],\n    mediumslateblue: [123, 104, 238],\n    mediumspringgreen: [0, 250, 154],\n    mediumturquoise: [72, 209, 204],\n    mediumvioletred: [199, 21, 133],\n    midnightblue: [25, 25, 112],\n    mintcream: [245, 255, 250],\n    mistyrose: [255, 228, 225],\n    moccasin: [255, 228, 181],\n    navajowhite: [255, 222, 173],\n    navy: [0, 0, 128],\n    oldlace: [253, 245, 230],\n    olive: [128, 128, 0],\n    olivedrab: [107, 142, 35],\n    orange: [255, 165, 0],\n    orangered: [255, 69, 0],\n    orchid: [218, 112, 214],\n    palegoldenrod: [238, 232, 170],\n    palegreen: [152, 251, 152],\n    paleturquoise: [175, 238, 238],\n    palevioletred: [219, 112, 147],\n    papayawhip: [255, 239, 213],\n    peachpuff: [255, 218, 185],\n    peru: [205, 133, 63],\n    pink: [255, 192, 203],\n    plum: [221, 160, 203],\n    powderblue: [176, 224, 230],\n    purple: [128, 0, 128],\n    rebeccapurple: [102, 51, 153],\n    red: [255, 0, 0],\n    rosybrown: [188, 143, 143],\n    royalblue: [65, 105, 225],\n    saddlebrown: [139, 69, 19],\n    salmon: [250, 128, 114],\n    sandybrown: [244, 164, 96],\n    seagreen: [46, 139, 87],\n    seashell: [255, 245, 238],\n    sienna: [160, 82, 45],\n    silver: [192, 192, 192],\n    skyblue: [135, 206, 235],\n    slateblue: [106, 90, 205],\n    slategray: [119, 128, 144],\n    slategrey: [119, 128, 144],\n    snow: [255, 255, 250],\n    springgreen: [0, 255, 127],\n    steelblue: [70, 130, 180],\n    tan: [210, 180, 140],\n    teal: [0, 128, 128],\n    thistle: [216, 191, 216],\n    transparent: [255, 255, 255, 0],\n    tomato: [255, 99, 71],\n    turquoise: [64, 224, 208],\n    violet: [238, 130, 238],\n    wheat: [245, 222, 179],\n    white: [255, 255, 255],\n    whitesmoke: [245, 245, 245],\n    yellow: [255, 255, 0],\n    yellowgreen: [154, 205, 5],\n}, RGB_REGEX = /rgb\\((\\d{1,3}),(\\d{1,3}),(\\d{1,3})\\)/;\nlet animQueue = [];\nconst req = (typeof requestAnimationFrame !== 'undefined' && requestAnimationFrame) ||\n    function (f) {\n        setTimeout(f, 60);\n    };\nexports.Util = {\n    _isElement(obj) {\n        return !!(obj && obj.nodeType == 1);\n    },\n    _isFunction(obj) {\n        return !!(obj && obj.constructor && obj.call && obj.apply);\n    },\n    _isPlainObject(obj) {\n        return !!obj && obj.constructor === Object;\n    },\n    _isArray(obj) {\n        return Object.prototype.toString.call(obj) === OBJECT_ARRAY;\n    },\n    _isNumber(obj) {\n        return (Object.prototype.toString.call(obj) === OBJECT_NUMBER &&\n            !isNaN(obj) &&\n            isFinite(obj));\n    },\n    _isString(obj) {\n        return Object.prototype.toString.call(obj) === OBJECT_STRING;\n    },\n    _isBoolean(obj) {\n        return Object.prototype.toString.call(obj) === OBJECT_BOOLEAN;\n    },\n    isObject(val) {\n        return val instanceof Object;\n    },\n    isValidSelector(selector) {\n        if (typeof selector !== 'string') {\n            return false;\n        }\n        const firstChar = selector[0];\n        return (firstChar === '#' ||\n            firstChar === '.' ||\n            firstChar === firstChar.toUpperCase());\n    },\n    _sign(number) {\n        if (number === 0) {\n            return 1;\n        }\n        if (number > 0) {\n            return 1;\n        }\n        else {\n            return -1;\n        }\n    },\n    requestAnimFrame(callback) {\n        animQueue.push(callback);\n        if (animQueue.length === 1) {\n            req(function () {\n                const queue = animQueue;\n                animQueue = [];\n                queue.forEach(function (cb) {\n                    cb();\n                });\n            });\n        }\n    },\n    createCanvasElement() {\n        const canvas = document.createElement('canvas');\n        try {\n            canvas.style = canvas.style || {};\n        }\n        catch (e) { }\n        return canvas;\n    },\n    createImageElement() {\n        return document.createElement('img');\n    },\n    _isInDocument(el) {\n        while ((el = el.parentNode)) {\n            if (el == document) {\n                return true;\n            }\n        }\n        return false;\n    },\n    _urlToImage(url, callback) {\n        const imageObj = exports.Util.createImageElement();\n        imageObj.onload = function () {\n            callback(imageObj);\n        };\n        imageObj.src = url;\n    },\n    _rgbToHex(r, g, b) {\n        return ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1);\n    },\n    _hexToRgb(hex) {\n        hex = hex.replace(HASH, EMPTY_STRING);\n        const bigint = parseInt(hex, 16);\n        return {\n            r: (bigint >> 16) & 255,\n            g: (bigint >> 8) & 255,\n            b: bigint & 255,\n        };\n    },\n    getRandomColor() {\n        let randColor = ((Math.random() * 0xffffff) << 0).toString(16);\n        while (randColor.length < 6) {\n            randColor = ZERO + randColor;\n        }\n        return HASH + randColor;\n    },\n    getRGB(color) {\n        let rgb;\n        if (color in COLORS) {\n            rgb = COLORS[color];\n            return {\n                r: rgb[0],\n                g: rgb[1],\n                b: rgb[2],\n            };\n        }\n        else if (color[0] === HASH) {\n            return this._hexToRgb(color.substring(1));\n        }\n        else if (color.substr(0, 4) === RGB_PAREN) {\n            rgb = RGB_REGEX.exec(color.replace(/ /g, ''));\n            return {\n                r: parseInt(rgb[1], 10),\n                g: parseInt(rgb[2], 10),\n                b: parseInt(rgb[3], 10),\n            };\n        }\n        else {\n            return {\n                r: 0,\n                g: 0,\n                b: 0,\n            };\n        }\n    },\n    colorToRGBA(str) {\n        str = str || 'black';\n        return (exports.Util._namedColorToRBA(str) ||\n            exports.Util._hex3ColorToRGBA(str) ||\n            exports.Util._hex4ColorToRGBA(str) ||\n            exports.Util._hex6ColorToRGBA(str) ||\n            exports.Util._hex8ColorToRGBA(str) ||\n            exports.Util._rgbColorToRGBA(str) ||\n            exports.Util._rgbaColorToRGBA(str) ||\n            exports.Util._hslColorToRGBA(str));\n    },\n    _namedColorToRBA(str) {\n        const c = COLORS[str.toLowerCase()];\n        if (!c) {\n            return null;\n        }\n        return {\n            r: c[0],\n            g: c[1],\n            b: c[2],\n            a: 1,\n        };\n    },\n    _rgbColorToRGBA(str) {\n        if (str.indexOf('rgb(') === 0) {\n            str = str.match(/rgb\\(([^)]+)\\)/)[1];\n            const parts = str.split(/ *, */).map(Number);\n            return {\n                r: parts[0],\n                g: parts[1],\n                b: parts[2],\n                a: 1,\n            };\n        }\n    },\n    _rgbaColorToRGBA(str) {\n        if (str.indexOf('rgba(') === 0) {\n            str = str.match(/rgba\\(([^)]+)\\)/)[1];\n            const parts = str.split(/ *, */).map((n, index) => {\n                if (n.slice(-1) === '%') {\n                    return index === 3 ? parseInt(n) / 100 : (parseInt(n) / 100) * 255;\n                }\n                return Number(n);\n            });\n            return {\n                r: parts[0],\n                g: parts[1],\n                b: parts[2],\n                a: parts[3],\n            };\n        }\n    },\n    _hex8ColorToRGBA(str) {\n        if (str[0] === '#' && str.length === 9) {\n            return {\n                r: parseInt(str.slice(1, 3), 16),\n                g: parseInt(str.slice(3, 5), 16),\n                b: parseInt(str.slice(5, 7), 16),\n                a: parseInt(str.slice(7, 9), 16) / 0xff,\n            };\n        }\n    },\n    _hex6ColorToRGBA(str) {\n        if (str[0] === '#' && str.length === 7) {\n            return {\n                r: parseInt(str.slice(1, 3), 16),\n                g: parseInt(str.slice(3, 5), 16),\n                b: parseInt(str.slice(5, 7), 16),\n                a: 1,\n            };\n        }\n    },\n    _hex4ColorToRGBA(str) {\n        if (str[0] === '#' && str.length === 5) {\n            return {\n                r: parseInt(str[1] + str[1], 16),\n                g: parseInt(str[2] + str[2], 16),\n                b: parseInt(str[3] + str[3], 16),\n                a: parseInt(str[4] + str[4], 16) / 0xff,\n            };\n        }\n    },\n    _hex3ColorToRGBA(str) {\n        if (str[0] === '#' && str.length === 4) {\n            return {\n                r: parseInt(str[1] + str[1], 16),\n                g: parseInt(str[2] + str[2], 16),\n                b: parseInt(str[3] + str[3], 16),\n                a: 1,\n            };\n        }\n    },\n    _hslColorToRGBA(str) {\n        if (/hsl\\((\\d+),\\s*([\\d.]+)%,\\s*([\\d.]+)%\\)/g.test(str)) {\n            const [_, ...hsl] = /hsl\\((\\d+),\\s*([\\d.]+)%,\\s*([\\d.]+)%\\)/g.exec(str);\n            const h = Number(hsl[0]) / 360;\n            const s = Number(hsl[1]) / 100;\n            const l = Number(hsl[2]) / 100;\n            let t2;\n            let t3;\n            let val;\n            if (s === 0) {\n                val = l * 255;\n                return {\n                    r: Math.round(val),\n                    g: Math.round(val),\n                    b: Math.round(val),\n                    a: 1,\n                };\n            }\n            if (l < 0.5) {\n                t2 = l * (1 + s);\n            }\n            else {\n                t2 = l + s - l * s;\n            }\n            const t1 = 2 * l - t2;\n            const rgb = [0, 0, 0];\n            for (let i = 0; i < 3; i++) {\n                t3 = h + (1 / 3) * -(i - 1);\n                if (t3 < 0) {\n                    t3++;\n                }\n                if (t3 > 1) {\n                    t3--;\n                }\n                if (6 * t3 < 1) {\n                    val = t1 + (t2 - t1) * 6 * t3;\n                }\n                else if (2 * t3 < 1) {\n                    val = t2;\n                }\n                else if (3 * t3 < 2) {\n                    val = t1 + (t2 - t1) * (2 / 3 - t3) * 6;\n                }\n                else {\n                    val = t1;\n                }\n                rgb[i] = val * 255;\n            }\n            return {\n                r: Math.round(rgb[0]),\n                g: Math.round(rgb[1]),\n                b: Math.round(rgb[2]),\n                a: 1,\n            };\n        }\n    },\n    haveIntersection(r1, r2) {\n        return !(r2.x > r1.x + r1.width ||\n            r2.x + r2.width < r1.x ||\n            r2.y > r1.y + r1.height ||\n            r2.y + r2.height < r1.y);\n    },\n    cloneObject(obj) {\n        const retObj = {};\n        for (const key in obj) {\n            if (this._isPlainObject(obj[key])) {\n                retObj[key] = this.cloneObject(obj[key]);\n            }\n            else if (this._isArray(obj[key])) {\n                retObj[key] = this.cloneArray(obj[key]);\n            }\n            else {\n                retObj[key] = obj[key];\n            }\n        }\n        return retObj;\n    },\n    cloneArray(arr) {\n        return arr.slice(0);\n    },\n    degToRad(deg) {\n        return deg * PI_OVER_DEG180;\n    },\n    radToDeg(rad) {\n        return rad * DEG180_OVER_PI;\n    },\n    _degToRad(deg) {\n        exports.Util.warn('Util._degToRad is removed. Please use public Util.degToRad instead.');\n        return exports.Util.degToRad(deg);\n    },\n    _radToDeg(rad) {\n        exports.Util.warn('Util._radToDeg is removed. Please use public Util.radToDeg instead.');\n        return exports.Util.radToDeg(rad);\n    },\n    _getRotation(radians) {\n        return Global_1.Konva.angleDeg ? exports.Util.radToDeg(radians) : radians;\n    },\n    _capitalize(str) {\n        return str.charAt(0).toUpperCase() + str.slice(1);\n    },\n    throw(str) {\n        throw new Error(KONVA_ERROR + str);\n    },\n    error(str) {\n        console.error(KONVA_ERROR + str);\n    },\n    warn(str) {\n        if (!Global_1.Konva.showWarnings) {\n            return;\n        }\n        console.warn(KONVA_WARNING + str);\n    },\n    each(obj, func) {\n        for (const key in obj) {\n            func(key, obj[key]);\n        }\n    },\n    _inRange(val, left, right) {\n        return left <= val && val < right;\n    },\n    _getProjectionToSegment(x1, y1, x2, y2, x3, y3) {\n        let x, y, dist;\n        const pd2 = (x1 - x2) * (x1 - x2) + (y1 - y2) * (y1 - y2);\n        if (pd2 == 0) {\n            x = x1;\n            y = y1;\n            dist = (x3 - x2) * (x3 - x2) + (y3 - y2) * (y3 - y2);\n        }\n        else {\n            const u = ((x3 - x1) * (x2 - x1) + (y3 - y1) * (y2 - y1)) / pd2;\n            if (u < 0) {\n                x = x1;\n                y = y1;\n                dist = (x1 - x3) * (x1 - x3) + (y1 - y3) * (y1 - y3);\n            }\n            else if (u > 1.0) {\n                x = x2;\n                y = y2;\n                dist = (x2 - x3) * (x2 - x3) + (y2 - y3) * (y2 - y3);\n            }\n            else {\n                x = x1 + u * (x2 - x1);\n                y = y1 + u * (y2 - y1);\n                dist = (x - x3) * (x - x3) + (y - y3) * (y - y3);\n            }\n        }\n        return [x, y, dist];\n    },\n    _getProjectionToLine(pt, line, isClosed) {\n        const pc = exports.Util.cloneObject(pt);\n        let dist = Number.MAX_VALUE;\n        line.forEach(function (p1, i) {\n            if (!isClosed && i === line.length - 1) {\n                return;\n            }\n            const p2 = line[(i + 1) % line.length];\n            const proj = exports.Util._getProjectionToSegment(p1.x, p1.y, p2.x, p2.y, pt.x, pt.y);\n            const px = proj[0], py = proj[1], pdist = proj[2];\n            if (pdist < dist) {\n                pc.x = px;\n                pc.y = py;\n                dist = pdist;\n            }\n        });\n        return pc;\n    },\n    _prepareArrayForTween(startArray, endArray, isClosed) {\n        const start = [], end = [];\n        if (startArray.length > endArray.length) {\n            const temp = endArray;\n            endArray = startArray;\n            startArray = temp;\n        }\n        for (let n = 0; n < startArray.length; n += 2) {\n            start.push({\n                x: startArray[n],\n                y: startArray[n + 1],\n            });\n        }\n        for (let n = 0; n < endArray.length; n += 2) {\n            end.push({\n                x: endArray[n],\n                y: endArray[n + 1],\n            });\n        }\n        const newStart = [];\n        end.forEach(function (point) {\n            const pr = exports.Util._getProjectionToLine(point, start, isClosed);\n            newStart.push(pr.x);\n            newStart.push(pr.y);\n        });\n        return newStart;\n    },\n    _prepareToStringify(obj) {\n        let desc;\n        obj.visitedByCircularReferenceRemoval = true;\n        for (const key in obj) {\n            if (!(obj.hasOwnProperty(key) && obj[key] && typeof obj[key] == 'object')) {\n                continue;\n            }\n            desc = Object.getOwnPropertyDescriptor(obj, key);\n            if (obj[key].visitedByCircularReferenceRemoval ||\n                exports.Util._isElement(obj[key])) {\n                if (desc.configurable) {\n                    delete obj[key];\n                }\n                else {\n                    return null;\n                }\n            }\n            else if (exports.Util._prepareToStringify(obj[key]) === null) {\n                if (desc.configurable) {\n                    delete obj[key];\n                }\n                else {\n                    return null;\n                }\n            }\n        }\n        delete obj.visitedByCircularReferenceRemoval;\n        return obj;\n    },\n    _assign(target, source) {\n        for (const key in source) {\n            target[key] = source[key];\n        }\n        return target;\n    },\n    _getFirstPointerId(evt) {\n        if (!evt.touches) {\n            return evt.pointerId || 999;\n        }\n        else {\n            return evt.changedTouches[0].identifier;\n        }\n    },\n    releaseCanvas(...canvases) {\n        if (!Global_1.Konva.releaseCanvasOnDestroy)\n            return;\n        canvases.forEach((c) => {\n            c.width = 0;\n            c.height = 0;\n        });\n    },\n    drawRoundedRectPath(context, width, height, cornerRadius) {\n        let topLeft = 0;\n        let topRight = 0;\n        let bottomLeft = 0;\n        let bottomRight = 0;\n        if (typeof cornerRadius === 'number') {\n            topLeft =\n                topRight =\n                    bottomLeft =\n                        bottomRight =\n                            Math.min(cornerRadius, width / 2, height / 2);\n        }\n        else {\n            topLeft = Math.min(cornerRadius[0] || 0, width / 2, height / 2);\n            topRight = Math.min(cornerRadius[1] || 0, width / 2, height / 2);\n            bottomRight = Math.min(cornerRadius[2] || 0, width / 2, height / 2);\n            bottomLeft = Math.min(cornerRadius[3] || 0, width / 2, height / 2);\n        }\n        context.moveTo(topLeft, 0);\n        context.lineTo(width - topRight, 0);\n        context.arc(width - topRight, topRight, topRight, (Math.PI * 3) / 2, 0, false);\n        context.lineTo(width, height - bottomRight);\n        context.arc(width - bottomRight, height - bottomRight, bottomRight, 0, Math.PI / 2, false);\n        context.lineTo(bottomLeft, height);\n        context.arc(bottomLeft, height - bottomLeft, bottomLeft, Math.PI / 2, Math.PI, false);\n        context.lineTo(0, topLeft);\n        context.arc(topLeft, topLeft, topLeft, Math.PI, (Math.PI * 3) / 2, false);\n    },\n};\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.HitContext = exports.SceneContext = exports.Context = void 0;\nconst Util_1 = require(\"./Util\");\nconst Global_1 = require(\"./Global\");\nfunction simplifyArray(arr) {\n    const retArr = [], len = arr.length, util = Util_1.Util;\n    for (let n = 0; n < len; n++) {\n        let val = arr[n];\n        if (util._isNumber(val)) {\n            val = Math.round(val * 1000) / 1000;\n        }\n        else if (!util._isString(val)) {\n            val = val + '';\n        }\n        retArr.push(val);\n    }\n    return retArr;\n}\nconst COMMA = ',', OPEN_PAREN = '(', CLOSE_PAREN = ')', OPEN_PAREN_BRACKET = '([', CLOSE_BRACKET_PAREN = '])', SEMICOLON = ';', DOUBLE_PAREN = '()', EQUALS = '=', CONTEXT_METHODS = [\n    'arc',\n    'arcTo',\n    'beginPath',\n    'bezierCurveTo',\n    'clearRect',\n    'clip',\n    'closePath',\n    'createLinearGradient',\n    'createPattern',\n    'createRadialGradient',\n    'drawImage',\n    'ellipse',\n    'fill',\n    'fillText',\n    'getImageData',\n    'createImageData',\n    'lineTo',\n    'moveTo',\n    'putImageData',\n    'quadraticCurveTo',\n    'rect',\n    'roundRect',\n    'restore',\n    'rotate',\n    'save',\n    'scale',\n    'setLineDash',\n    'setTransform',\n    'stroke',\n    'strokeText',\n    'transform',\n    'translate',\n];\nconst CONTEXT_PROPERTIES = [\n    'fillStyle',\n    'strokeStyle',\n    'shadowColor',\n    'shadowBlur',\n    'shadowOffsetX',\n    'shadowOffsetY',\n    'letterSpacing',\n    'lineCap',\n    'lineDashOffset',\n    'lineJoin',\n    'lineWidth',\n    'miterLimit',\n    'direction',\n    'font',\n    'textAlign',\n    'textBaseline',\n    'globalAlpha',\n    'globalCompositeOperation',\n    'imageSmoothingEnabled',\n];\nconst traceArrMax = 100;\nclass Context {\n    constructor(canvas) {\n        this.canvas = canvas;\n        if (Global_1.Konva.enableTrace) {\n            this.traceArr = [];\n            this._enableTrace();\n        }\n    }\n    fillShape(shape) {\n        if (shape.fillEnabled()) {\n            this._fill(shape);\n        }\n    }\n    _fill(shape) {\n    }\n    strokeShape(shape) {\n        if (shape.hasStroke()) {\n            this._stroke(shape);\n        }\n    }\n    _stroke(shape) {\n    }\n    fillStrokeShape(shape) {\n        if (shape.attrs.fillAfterStrokeEnabled) {\n            this.strokeShape(shape);\n            this.fillShape(shape);\n        }\n        else {\n            this.fillShape(shape);\n            this.strokeShape(shape);\n        }\n    }\n    getTrace(relaxed, rounded) {\n        let traceArr = this.traceArr, len = traceArr.length, str = '', n, trace, method, args;\n        for (n = 0; n < len; n++) {\n            trace = traceArr[n];\n            method = trace.method;\n            if (method) {\n                args = trace.args;\n                str += method;\n                if (relaxed) {\n                    str += DOUBLE_PAREN;\n                }\n                else {\n                    if (Util_1.Util._isArray(args[0])) {\n                        str += OPEN_PAREN_BRACKET + args.join(COMMA) + CLOSE_BRACKET_PAREN;\n                    }\n                    else {\n                        if (rounded) {\n                            args = args.map((a) => typeof a === 'number' ? Math.floor(a) : a);\n                        }\n                        str += OPEN_PAREN + args.join(COMMA) + CLOSE_PAREN;\n                    }\n                }\n            }\n            else {\n                str += trace.property;\n                if (!relaxed) {\n                    str += EQUALS + trace.val;\n                }\n            }\n            str += SEMICOLON;\n        }\n        return str;\n    }\n    clearTrace() {\n        this.traceArr = [];\n    }\n    _trace(str) {\n        let traceArr = this.traceArr, len;\n        traceArr.push(str);\n        len = traceArr.length;\n        if (len >= traceArrMax) {\n            traceArr.shift();\n        }\n    }\n    reset() {\n        const pixelRatio = this.getCanvas().getPixelRatio();\n        this.setTransform(1 * pixelRatio, 0, 0, 1 * pixelRatio, 0, 0);\n    }\n    getCanvas() {\n        return this.canvas;\n    }\n    clear(bounds) {\n        const canvas = this.getCanvas();\n        if (bounds) {\n            this.clearRect(bounds.x || 0, bounds.y || 0, bounds.width || 0, bounds.height || 0);\n        }\n        else {\n            this.clearRect(0, 0, canvas.getWidth() / canvas.pixelRatio, canvas.getHeight() / canvas.pixelRatio);\n        }\n    }\n    _applyLineCap(shape) {\n        const lineCap = shape.attrs.lineCap;\n        if (lineCap) {\n            this.setAttr('lineCap', lineCap);\n        }\n    }\n    _applyOpacity(shape) {\n        const absOpacity = shape.getAbsoluteOpacity();\n        if (absOpacity !== 1) {\n            this.setAttr('globalAlpha', absOpacity);\n        }\n    }\n    _applyLineJoin(shape) {\n        const lineJoin = shape.attrs.lineJoin;\n        if (lineJoin) {\n            this.setAttr('lineJoin', lineJoin);\n        }\n    }\n    setAttr(attr, val) {\n        this._context[attr] = val;\n    }\n    arc(x, y, radius, startAngle, endAngle, counterClockwise) {\n        this._context.arc(x, y, radius, startAngle, endAngle, counterClockwise);\n    }\n    arcTo(x1, y1, x2, y2, radius) {\n        this._context.arcTo(x1, y1, x2, y2, radius);\n    }\n    beginPath() {\n        this._context.beginPath();\n    }\n    bezierCurveTo(cp1x, cp1y, cp2x, cp2y, x, y) {\n        this._context.bezierCurveTo(cp1x, cp1y, cp2x, cp2y, x, y);\n    }\n    clearRect(x, y, width, height) {\n        this._context.clearRect(x, y, width, height);\n    }\n    clip(...args) {\n        this._context.clip.apply(this._context, args);\n    }\n    closePath() {\n        this._context.closePath();\n    }\n    createImageData(width, height) {\n        const a = arguments;\n        if (a.length === 2) {\n            return this._context.createImageData(width, height);\n        }\n        else if (a.length === 1) {\n            return this._context.createImageData(width);\n        }\n    }\n    createLinearGradient(x0, y0, x1, y1) {\n        return this._context.createLinearGradient(x0, y0, x1, y1);\n    }\n    createPattern(image, repetition) {\n        return this._context.createPattern(image, repetition);\n    }\n    createRadialGradient(x0, y0, r0, x1, y1, r1) {\n        return this._context.createRadialGradient(x0, y0, r0, x1, y1, r1);\n    }\n    drawImage(image, sx, sy, sWidth, sHeight, dx, dy, dWidth, dHeight) {\n        const a = arguments, _context = this._context;\n        if (a.length === 3) {\n            _context.drawImage(image, sx, sy);\n        }\n        else if (a.length === 5) {\n            _context.drawImage(image, sx, sy, sWidth, sHeight);\n        }\n        else if (a.length === 9) {\n            _context.drawImage(image, sx, sy, sWidth, sHeight, dx, dy, dWidth, dHeight);\n        }\n    }\n    ellipse(x, y, radiusX, radiusY, rotation, startAngle, endAngle, counterclockwise) {\n        this._context.ellipse(x, y, radiusX, radiusY, rotation, startAngle, endAngle, counterclockwise);\n    }\n    isPointInPath(x, y, path, fillRule) {\n        if (path) {\n            return this._context.isPointInPath(path, x, y, fillRule);\n        }\n        return this._context.isPointInPath(x, y, fillRule);\n    }\n    fill(...args) {\n        this._context.fill.apply(this._context, args);\n    }\n    fillRect(x, y, width, height) {\n        this._context.fillRect(x, y, width, height);\n    }\n    strokeRect(x, y, width, height) {\n        this._context.strokeRect(x, y, width, height);\n    }\n    fillText(text, x, y, maxWidth) {\n        if (maxWidth) {\n            this._context.fillText(text, x, y, maxWidth);\n        }\n        else {\n            this._context.fillText(text, x, y);\n        }\n    }\n    measureText(text) {\n        return this._context.measureText(text);\n    }\n    getImageData(sx, sy, sw, sh) {\n        return this._context.getImageData(sx, sy, sw, sh);\n    }\n    lineTo(x, y) {\n        this._context.lineTo(x, y);\n    }\n    moveTo(x, y) {\n        this._context.moveTo(x, y);\n    }\n    rect(x, y, width, height) {\n        this._context.rect(x, y, width, height);\n    }\n    roundRect(x, y, width, height, radii) {\n        this._context.roundRect(x, y, width, height, radii);\n    }\n    putImageData(imageData, dx, dy) {\n        this._context.putImageData(imageData, dx, dy);\n    }\n    quadraticCurveTo(cpx, cpy, x, y) {\n        this._context.quadraticCurveTo(cpx, cpy, x, y);\n    }\n    restore() {\n        this._context.restore();\n    }\n    rotate(angle) {\n        this._context.rotate(angle);\n    }\n    save() {\n        this._context.save();\n    }\n    scale(x, y) {\n        this._context.scale(x, y);\n    }\n    setLineDash(segments) {\n        if (this._context.setLineDash) {\n            this._context.setLineDash(segments);\n        }\n        else if ('mozDash' in this._context) {\n            this._context['mozDash'] = segments;\n        }\n        else if ('webkitLineDash' in this._context) {\n            this._context['webkitLineDash'] = segments;\n        }\n    }\n    getLineDash() {\n        return this._context.getLineDash();\n    }\n    setTransform(a, b, c, d, e, f) {\n        this._context.setTransform(a, b, c, d, e, f);\n    }\n    stroke(path2d) {\n        if (path2d) {\n            this._context.stroke(path2d);\n        }\n        else {\n            this._context.stroke();\n        }\n    }\n    strokeText(text, x, y, maxWidth) {\n        this._context.strokeText(text, x, y, maxWidth);\n    }\n    transform(a, b, c, d, e, f) {\n        this._context.transform(a, b, c, d, e, f);\n    }\n    translate(x, y) {\n        this._context.translate(x, y);\n    }\n    _enableTrace() {\n        let that = this, len = CONTEXT_METHODS.length, origSetter = this.setAttr, n, args;\n        const func = function (methodName) {\n            let origMethod = that[methodName], ret;\n            that[methodName] = function () {\n                args = simplifyArray(Array.prototype.slice.call(arguments, 0));\n                ret = origMethod.apply(that, arguments);\n                that._trace({\n                    method: methodName,\n                    args: args,\n                });\n                return ret;\n            };\n        };\n        for (n = 0; n < len; n++) {\n            func(CONTEXT_METHODS[n]);\n        }\n        that.setAttr = function () {\n            origSetter.apply(that, arguments);\n            const prop = arguments[0];\n            let val = arguments[1];\n            if (prop === 'shadowOffsetX' ||\n                prop === 'shadowOffsetY' ||\n                prop === 'shadowBlur') {\n                val = val / this.canvas.getPixelRatio();\n            }\n            that._trace({\n                property: prop,\n                val: val,\n            });\n        };\n    }\n    _applyGlobalCompositeOperation(node) {\n        const op = node.attrs.globalCompositeOperation;\n        const def = !op || op === 'source-over';\n        if (!def) {\n            this.setAttr('globalCompositeOperation', op);\n        }\n    }\n}\nexports.Context = Context;\nCONTEXT_PROPERTIES.forEach(function (prop) {\n    Object.defineProperty(Context.prototype, prop, {\n        get() {\n            return this._context[prop];\n        },\n        set(val) {\n            this._context[prop] = val;\n        },\n    });\n});\nclass SceneContext extends Context {\n    constructor(canvas, { willReadFrequently = false } = {}) {\n        super(canvas);\n        this._context = canvas._canvas.getContext('2d', {\n            willReadFrequently,\n        });\n    }\n    _fillColor(shape) {\n        const fill = shape.fill();\n        this.setAttr('fillStyle', fill);\n        shape._fillFunc(this);\n    }\n    _fillPattern(shape) {\n        this.setAttr('fillStyle', shape._getFillPattern());\n        shape._fillFunc(this);\n    }\n    _fillLinearGradient(shape) {\n        const grd = shape._getLinearGradient();\n        if (grd) {\n            this.setAttr('fillStyle', grd);\n            shape._fillFunc(this);\n        }\n    }\n    _fillRadialGradient(shape) {\n        const grd = shape._getRadialGradient();\n        if (grd) {\n            this.setAttr('fillStyle', grd);\n            shape._fillFunc(this);\n        }\n    }\n    _fill(shape) {\n        const hasColor = shape.fill(), fillPriority = shape.getFillPriority();\n        if (hasColor && fillPriority === 'color') {\n            this._fillColor(shape);\n            return;\n        }\n        const hasPattern = shape.getFillPatternImage();\n        if (hasPattern && fillPriority === 'pattern') {\n            this._fillPattern(shape);\n            return;\n        }\n        const hasLinearGradient = shape.getFillLinearGradientColorStops();\n        if (hasLinearGradient && fillPriority === 'linear-gradient') {\n            this._fillLinearGradient(shape);\n            return;\n        }\n        const hasRadialGradient = shape.getFillRadialGradientColorStops();\n        if (hasRadialGradient && fillPriority === 'radial-gradient') {\n            this._fillRadialGradient(shape);\n            return;\n        }\n        if (hasColor) {\n            this._fillColor(shape);\n        }\n        else if (hasPattern) {\n            this._fillPattern(shape);\n        }\n        else if (hasLinearGradient) {\n            this._fillLinearGradient(shape);\n        }\n        else if (hasRadialGradient) {\n            this._fillRadialGradient(shape);\n        }\n    }\n    _strokeLinearGradient(shape) {\n        const start = shape.getStrokeLinearGradientStartPoint(), end = shape.getStrokeLinearGradientEndPoint(), colorStops = shape.getStrokeLinearGradientColorStops(), grd = this.createLinearGradient(start.x, start.y, end.x, end.y);\n        if (colorStops) {\n            for (let n = 0; n < colorStops.length; n += 2) {\n                grd.addColorStop(colorStops[n], colorStops[n + 1]);\n            }\n            this.setAttr('strokeStyle', grd);\n        }\n    }\n    _stroke(shape) {\n        const dash = shape.dash(), strokeScaleEnabled = shape.getStrokeScaleEnabled();\n        if (shape.hasStroke()) {\n            if (!strokeScaleEnabled) {\n                this.save();\n                const pixelRatio = this.getCanvas().getPixelRatio();\n                this.setTransform(pixelRatio, 0, 0, pixelRatio, 0, 0);\n            }\n            this._applyLineCap(shape);\n            if (dash && shape.dashEnabled()) {\n                this.setLineDash(dash);\n                this.setAttr('lineDashOffset', shape.dashOffset());\n            }\n            this.setAttr('lineWidth', shape.strokeWidth());\n            if (!shape.getShadowForStrokeEnabled()) {\n                this.setAttr('shadowColor', 'rgba(0,0,0,0)');\n            }\n            const hasLinearGradient = shape.getStrokeLinearGradientColorStops();\n            if (hasLinearGradient) {\n                this._strokeLinearGradient(shape);\n            }\n            else {\n                this.setAttr('strokeStyle', shape.stroke());\n            }\n            shape._strokeFunc(this);\n            if (!strokeScaleEnabled) {\n                this.restore();\n            }\n        }\n    }\n    _applyShadow(shape) {\n        var _a, _b, _c;\n        const color = (_a = shape.getShadowRGBA()) !== null && _a !== void 0 ? _a : 'black', blur = (_b = shape.getShadowBlur()) !== null && _b !== void 0 ? _b : 5, offset = (_c = shape.getShadowOffset()) !== null && _c !== void 0 ? _c : {\n            x: 0,\n            y: 0,\n        }, scale = shape.getAbsoluteScale(), ratio = this.canvas.getPixelRatio(), scaleX = scale.x * ratio, scaleY = scale.y * ratio;\n        this.setAttr('shadowColor', color);\n        this.setAttr('shadowBlur', blur * Math.min(Math.abs(scaleX), Math.abs(scaleY)));\n        this.setAttr('shadowOffsetX', offset.x * scaleX);\n        this.setAttr('shadowOffsetY', offset.y * scaleY);\n    }\n}\nexports.SceneContext = SceneContext;\nclass HitContext extends Context {\n    constructor(canvas) {\n        super(canvas);\n        this._context = canvas._canvas.getContext('2d', {\n            willReadFrequently: true,\n        });\n    }\n    _fill(shape) {\n        this.save();\n        this.setAttr('fillStyle', shape.colorKey);\n        shape._fillFuncHit(this);\n        this.restore();\n    }\n    strokeShape(shape) {\n        if (shape.hasHitStroke()) {\n            this._stroke(shape);\n        }\n    }\n    _stroke(shape) {\n        if (shape.hasHitStroke()) {\n            const strokeScaleEnabled = shape.getStrokeScaleEnabled();\n            if (!strokeScaleEnabled) {\n                this.save();\n                const pixelRatio = this.getCanvas().getPixelRatio();\n                this.setTransform(pixelRatio, 0, 0, pixelRatio, 0, 0);\n            }\n            this._applyLineCap(shape);\n            const hitStrokeWidth = shape.hitStrokeWidth();\n            const strokeWidth = hitStrokeWidth === 'auto' ? shape.strokeWidth() : hitStrokeWidth;\n            this.setAttr('lineWidth', strokeWidth);\n            this.setAttr('strokeStyle', shape.colorKey);\n            shape._strokeFuncHit(this);\n            if (!strokeScaleEnabled) {\n                this.restore();\n            }\n        }\n    }\n}\nexports.HitContext = HitContext;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.HitCanvas = exports.SceneCanvas = exports.Canvas = void 0;\nconst Util_1 = require(\"./Util\");\nconst Context_1 = require(\"./Context\");\nconst Global_1 = require(\"./Global\");\nlet _pixelRatio;\nfunction getDevicePixelRatio() {\n    if (_pixelRatio) {\n        return _pixelRatio;\n    }\n    const canvas = Util_1.Util.createCanvasElement();\n    const context = canvas.getContext('2d');\n    _pixelRatio = (function () {\n        const devicePixelRatio = Global_1.Konva._global.devicePixelRatio || 1, backingStoreRatio = context.webkitBackingStorePixelRatio ||\n            context.mozBackingStorePixelRatio ||\n            context.msBackingStorePixelRatio ||\n            context.oBackingStorePixelRatio ||\n            context.backingStorePixelRatio ||\n            1;\n        return devicePixelRatio / backingStoreRatio;\n    })();\n    Util_1.Util.releaseCanvas(canvas);\n    return _pixelRatio;\n}\nclass Canvas {\n    constructor(config) {\n        this.pixelRatio = 1;\n        this.width = 0;\n        this.height = 0;\n        this.isCache = false;\n        const conf = config || {};\n        const pixelRatio = conf.pixelRatio || Global_1.Konva.pixelRatio || getDevicePixelRatio();\n        this.pixelRatio = pixelRatio;\n        this._canvas = Util_1.Util.createCanvasElement();\n        this._canvas.style.padding = '0';\n        this._canvas.style.margin = '0';\n        this._canvas.style.border = '0';\n        this._canvas.style.background = 'transparent';\n        this._canvas.style.position = 'absolute';\n        this._canvas.style.top = '0';\n        this._canvas.style.left = '0';\n    }\n    getContext() {\n        return this.context;\n    }\n    getPixelRatio() {\n        return this.pixelRatio;\n    }\n    setPixelRatio(pixelRatio) {\n        const previousRatio = this.pixelRatio;\n        this.pixelRatio = pixelRatio;\n        this.setSize(this.getWidth() / previousRatio, this.getHeight() / previousRatio);\n    }\n    setWidth(width) {\n        this.width = this._canvas.width = width * this.pixelRatio;\n        this._canvas.style.width = width + 'px';\n        const pixelRatio = this.pixelRatio, _context = this.getContext()._context;\n        _context.scale(pixelRatio, pixelRatio);\n    }\n    setHeight(height) {\n        this.height = this._canvas.height = height * this.pixelRatio;\n        this._canvas.style.height = height + 'px';\n        const pixelRatio = this.pixelRatio, _context = this.getContext()._context;\n        _context.scale(pixelRatio, pixelRatio);\n    }\n    getWidth() {\n        return this.width;\n    }\n    getHeight() {\n        return this.height;\n    }\n    setSize(width, height) {\n        this.setWidth(width || 0);\n        this.setHeight(height || 0);\n    }\n    toDataURL(mimeType, quality) {\n        try {\n            return this._canvas.toDataURL(mimeType, quality);\n        }\n        catch (e) {\n            try {\n                return this._canvas.toDataURL();\n            }\n            catch (err) {\n                Util_1.Util.error('Unable to get data URL. ' +\n                    err.message +\n                    ' For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html.');\n                return '';\n            }\n        }\n    }\n}\nexports.Canvas = Canvas;\nclass SceneCanvas extends Canvas {\n    constructor(config = { width: 0, height: 0, willReadFrequently: false }) {\n        super(config);\n        this.context = new Context_1.SceneContext(this, {\n            willReadFrequently: config.willReadFrequently,\n        });\n        this.setSize(config.width, config.height);\n    }\n}\nexports.SceneCanvas = SceneCanvas;\nclass HitCanvas extends Canvas {\n    constructor(config = { width: 0, height: 0 }) {\n        super(config);\n        this.hitCanvas = true;\n        this.context = new Context_1.HitContext(this);\n        this.setSize(config.width, config.height);\n    }\n}\nexports.HitCanvas = HitCanvas;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.DD = void 0;\nconst Global_1 = require(\"./Global\");\nconst Util_1 = require(\"./Util\");\nexports.DD = {\n    get isDragging() {\n        let flag = false;\n        exports.DD._dragElements.forEach((elem) => {\n            if (elem.dragStatus === 'dragging') {\n                flag = true;\n            }\n        });\n        return flag;\n    },\n    justDragged: false,\n    get node() {\n        let node;\n        exports.DD._dragElements.forEach((elem) => {\n            node = elem.node;\n        });\n        return node;\n    },\n    _dragElements: new Map(),\n    _drag(evt) {\n        const nodesToFireEvents = [];\n        exports.DD._dragElements.forEach((elem, key) => {\n            const { node } = elem;\n            const stage = node.getStage();\n            stage.setPointersPositions(evt);\n            if (elem.pointerId === undefined) {\n                elem.pointerId = Util_1.Util._getFirstPointerId(evt);\n            }\n            const pos = stage._changedPointerPositions.find((pos) => pos.id === elem.pointerId);\n            if (!pos) {\n                return;\n            }\n            if (elem.dragStatus !== 'dragging') {\n                const dragDistance = node.dragDistance();\n                const distance = Math.max(Math.abs(pos.x - elem.startPointerPos.x), Math.abs(pos.y - elem.startPointerPos.y));\n                if (distance < dragDistance) {\n                    return;\n                }\n                node.startDrag({ evt });\n                if (!node.isDragging()) {\n                    return;\n                }\n            }\n            node._setDragPosition(evt, elem);\n            nodesToFireEvents.push(node);\n        });\n        nodesToFireEvents.forEach((node) => {\n            node.fire('dragmove', {\n                type: 'dragmove',\n                target: node,\n                evt: evt,\n            }, true);\n        });\n    },\n    _endDragBefore(evt) {\n        const drawNodes = [];\n        exports.DD._dragElements.forEach((elem) => {\n            const { node } = elem;\n            const stage = node.getStage();\n            if (evt) {\n                stage.setPointersPositions(evt);\n            }\n            const pos = stage._changedPointerPositions.find((pos) => pos.id === elem.pointerId);\n            if (!pos) {\n                return;\n            }\n            if (elem.dragStatus === 'dragging' || elem.dragStatus === 'stopped') {\n                exports.DD.justDragged = true;\n                Global_1.Konva._mouseListenClick = false;\n                Global_1.Konva._touchListenClick = false;\n                Global_1.Konva._pointerListenClick = false;\n                elem.dragStatus = 'stopped';\n            }\n            const drawNode = elem.node.getLayer() ||\n                (elem.node instanceof Global_1.Konva['Stage'] && elem.node);\n            if (drawNode && drawNodes.indexOf(drawNode) === -1) {\n                drawNodes.push(drawNode);\n            }\n        });\n        drawNodes.forEach((drawNode) => {\n            drawNode.draw();\n        });\n    },\n    _endDragAfter(evt) {\n        exports.DD._dragElements.forEach((elem, key) => {\n            if (elem.dragStatus === 'stopped') {\n                elem.node.fire('dragend', {\n                    type: 'dragend',\n                    target: elem.node,\n                    evt: evt,\n                }, true);\n            }\n            if (elem.dragStatus !== 'dragging') {\n                exports.DD._dragElements.delete(key);\n            }\n        });\n    },\n};\nif (Global_1.Konva.isBrowser) {\n    window.addEventListener('mouseup', exports.DD._endDragBefore, true);\n    window.addEventListener('touchend', exports.DD._endDragBefore, true);\n    window.addEventListener('touchcancel', exports.DD._endDragBefore, true);\n    window.addEventListener('mousemove', exports.DD._drag);\n    window.addEventListener('touchmove', exports.DD._drag);\n    window.addEventListener('mouseup', exports.DD._endDragAfter, false);\n    window.addEventListener('touchend', exports.DD._endDragAfter, false);\n    window.addEventListener('touchcancel', exports.DD._endDragAfter, false);\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.RGBComponent = RGBComponent;\nexports.alphaComponent = alphaComponent;\nexports.getNumberValidator = getNumberValidator;\nexports.getNumberOrArrayOfNumbersValidator = getNumberOrArrayOfNumbersValidator;\nexports.getNumberOrAutoValidator = getNumberOrAutoValidator;\nexports.getStringValidator = getStringValidator;\nexports.getStringOrGradientValidator = getStringOrGradientValidator;\nexports.getFunctionValidator = getFunctionValidator;\nexports.getNumberArrayValidator = getNumberArrayValidator;\nexports.getBooleanValidator = getBooleanValidator;\nexports.getComponentValidator = getComponentValidator;\nconst Global_1 = require(\"./Global\");\nconst Util_1 = require(\"./Util\");\nfunction _formatValue(val) {\n    if (Util_1.Util._isString(val)) {\n        return '\"' + val + '\"';\n    }\n    if (Object.prototype.toString.call(val) === '[object Number]') {\n        return val;\n    }\n    if (Util_1.Util._isBoolean(val)) {\n        return val;\n    }\n    return Object.prototype.toString.call(val);\n}\nfunction RGBComponent(val) {\n    if (val > 255) {\n        return 255;\n    }\n    else if (val < 0) {\n        return 0;\n    }\n    return Math.round(val);\n}\nfunction alphaComponent(val) {\n    if (val > 1) {\n        return 1;\n    }\n    else if (val < 0.0001) {\n        return 0.0001;\n    }\n    return val;\n}\nfunction getNumberValidator() {\n    if (Global_1.Konva.isUnminified) {\n        return function (val, attr) {\n            if (!Util_1.Util._isNumber(val)) {\n                Util_1.Util.warn(_formatValue(val) +\n                    ' is a not valid value for \"' +\n                    attr +\n                    '\" attribute. The value should be a number.');\n            }\n            return val;\n        };\n    }\n}\nfunction getNumberOrArrayOfNumbersValidator(noOfElements) {\n    if (Global_1.Konva.isUnminified) {\n        return function (val, attr) {\n            let isNumber = Util_1.Util._isNumber(val);\n            let isValidArray = Util_1.Util._isArray(val) && val.length == noOfElements;\n            if (!isNumber && !isValidArray) {\n                Util_1.Util.warn(_formatValue(val) +\n                    ' is a not valid value for \"' +\n                    attr +\n                    '\" attribute. The value should be a number or Array<number>(' +\n                    noOfElements +\n                    ')');\n            }\n            return val;\n        };\n    }\n}\nfunction getNumberOrAutoValidator() {\n    if (Global_1.Konva.isUnminified) {\n        return function (val, attr) {\n            const isNumber = Util_1.Util._isNumber(val);\n            const isAuto = val === 'auto';\n            if (!(isNumber || isAuto)) {\n                Util_1.Util.warn(_formatValue(val) +\n                    ' is a not valid value for \"' +\n                    attr +\n                    '\" attribute. The value should be a number or \"auto\".');\n            }\n            return val;\n        };\n    }\n}\nfunction getStringValidator() {\n    if (Global_1.Konva.isUnminified) {\n        return function (val, attr) {\n            if (!Util_1.Util._isString(val)) {\n                Util_1.Util.warn(_formatValue(val) +\n                    ' is a not valid value for \"' +\n                    attr +\n                    '\" attribute. The value should be a string.');\n            }\n            return val;\n        };\n    }\n}\nfunction getStringOrGradientValidator() {\n    if (Global_1.Konva.isUnminified) {\n        return function (val, attr) {\n            const isString = Util_1.Util._isString(val);\n            const isGradient = Object.prototype.toString.call(val) === '[object CanvasGradient]' ||\n                (val && val['addColorStop']);\n            if (!(isString || isGradient)) {\n                Util_1.Util.warn(_formatValue(val) +\n                    ' is a not valid value for \"' +\n                    attr +\n                    '\" attribute. The value should be a string or a native gradient.');\n            }\n            return val;\n        };\n    }\n}\nfunction getFunctionValidator() {\n    if (Global_1.Konva.isUnminified) {\n        return function (val, attr) {\n            if (!Util_1.Util._isFunction(val)) {\n                Util_1.Util.warn(_formatValue(val) +\n                    ' is a not valid value for \"' +\n                    attr +\n                    '\" attribute. The value should be a function.');\n            }\n            return val;\n        };\n    }\n}\nfunction getNumberArrayValidator() {\n    if (Global_1.Konva.isUnminified) {\n        return function (val, attr) {\n            const TypedArray = Int8Array ? Object.getPrototypeOf(Int8Array) : null;\n            if (TypedArray && val instanceof TypedArray) {\n                return val;\n            }\n            if (!Util_1.Util._isArray(val)) {\n                Util_1.Util.warn(_formatValue(val) +\n                    ' is a not valid value for \"' +\n                    attr +\n                    '\" attribute. The value should be a array of numbers.');\n            }\n            else {\n                val.forEach(function (item) {\n                    if (!Util_1.Util._isNumber(item)) {\n                        Util_1.Util.warn('\"' +\n                            attr +\n                            '\" attribute has non numeric element ' +\n                            item +\n                            '. Make sure that all elements are numbers.');\n                    }\n                });\n            }\n            return val;\n        };\n    }\n}\nfunction getBooleanValidator() {\n    if (Global_1.Konva.isUnminified) {\n        return function (val, attr) {\n            const isBool = val === true || val === false;\n            if (!isBool) {\n                Util_1.Util.warn(_formatValue(val) +\n                    ' is a not valid value for \"' +\n                    attr +\n                    '\" attribute. The value should be a boolean.');\n            }\n            return val;\n        };\n    }\n}\nfunction getComponentValidator(components) {\n    if (Global_1.Konva.isUnminified) {\n        return function (val, attr) {\n            if (val === undefined || val === null) {\n                return val;\n            }\n            if (!Util_1.Util.isObject(val)) {\n                Util_1.Util.warn(_formatValue(val) +\n                    ' is a not valid value for \"' +\n                    attr +\n                    '\" attribute. The value should be an object with properties ' +\n                    components);\n            }\n            return val;\n        };\n    }\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Factory = void 0;\nconst Util_1 = require(\"./Util\");\nconst Validators_1 = require(\"./Validators\");\nconst GET = 'get';\nconst SET = 'set';\nexports.Factory = {\n    addGetterSetter(constructor, attr, def, validator, after) {\n        exports.Factory.addGetter(constructor, attr, def);\n        exports.Factory.addSetter(constructor, attr, validator, after);\n        exports.Factory.addOverloadedGetterSetter(constructor, attr);\n    },\n    addGetter(constructor, attr, def) {\n        const method = GET + Util_1.Util._capitalize(attr);\n        constructor.prototype[method] =\n            constructor.prototype[method] ||\n                function () {\n                    const val = this.attrs[attr];\n                    return val === undefined ? def : val;\n                };\n    },\n    addSetter(constructor, attr, validator, after) {\n        const method = SET + Util_1.Util._capitalize(attr);\n        if (!constructor.prototype[method]) {\n            exports.Factory.overWriteSetter(constructor, attr, validator, after);\n        }\n    },\n    overWriteSetter(constructor, attr, validator, after) {\n        const method = SET + Util_1.Util._capitalize(attr);\n        constructor.prototype[method] = function (val) {\n            if (validator && val !== undefined && val !== null) {\n                val = validator.call(this, val, attr);\n            }\n            this._setAttr(attr, val);\n            if (after) {\n                after.call(this);\n            }\n            return this;\n        };\n    },\n    addComponentsGetterSetter(constructor, attr, components, validator, after) {\n        const len = components.length, capitalize = Util_1.Util._capitalize, getter = GET + capitalize(attr), setter = SET + capitalize(attr);\n        constructor.prototype[getter] = function () {\n            const ret = {};\n            for (let n = 0; n < len; n++) {\n                const component = components[n];\n                ret[component] = this.getAttr(attr + capitalize(component));\n            }\n            return ret;\n        };\n        const basicValidator = (0, Validators_1.getComponentValidator)(components);\n        constructor.prototype[setter] = function (val) {\n            const oldVal = this.attrs[attr];\n            if (validator) {\n                val = validator.call(this, val, attr);\n            }\n            if (basicValidator) {\n                basicValidator.call(this, val, attr);\n            }\n            for (const key in val) {\n                if (!val.hasOwnProperty(key)) {\n                    continue;\n                }\n                this._setAttr(attr + capitalize(key), val[key]);\n            }\n            if (!val) {\n                components.forEach((component) => {\n                    this._setAttr(attr + capitalize(component), undefined);\n                });\n            }\n            this._fireChangeEvent(attr, oldVal, val);\n            if (after) {\n                after.call(this);\n            }\n            return this;\n        };\n        exports.Factory.addOverloadedGetterSetter(constructor, attr);\n    },\n    addOverloadedGetterSetter(constructor, attr) {\n        const capitalizedAttr = Util_1.Util._capitalize(attr), setter = SET + capitalizedAttr, getter = GET + capitalizedAttr;\n        constructor.prototype[attr] = function () {\n            if (arguments.length) {\n                this[setter](arguments[0]);\n                return this;\n            }\n            return this[getter]();\n        };\n    },\n    addDeprecatedGetterSetter(constructor, attr, def, validator) {\n        Util_1.Util.error('Adding deprecated ' + attr);\n        const method = GET + Util_1.Util._capitalize(attr);\n        const message = attr +\n            ' property is deprecated and will be removed soon. Look at Konva change log for more information.';\n        constructor.prototype[method] = function () {\n            Util_1.Util.error(message);\n            const val = this.attrs[attr];\n            return val === undefined ? def : val;\n        };\n        exports.Factory.addSetter(constructor, attr, validator, function () {\n            Util_1.Util.error(message);\n        });\n        exports.Factory.addOverloadedGetterSetter(constructor, attr);\n    },\n    backCompat(constructor, methods) {\n        Util_1.Util.each(methods, function (oldMethodName, newMethodName) {\n            const method = constructor.prototype[newMethodName];\n            const oldGetter = GET + Util_1.Util._capitalize(oldMethodName);\n            const oldSetter = SET + Util_1.Util._capitalize(oldMethodName);\n            function deprecated() {\n                method.apply(this, arguments);\n                Util_1.Util.error('\"' +\n                    oldMethodName +\n                    '\" method is deprecated and will be removed soon. Use \"\"' +\n                    newMethodName +\n                    '\" instead.');\n            }\n            constructor.prototype[oldMethodName] = deprecated;\n            constructor.prototype[oldGetter] = deprecated;\n            constructor.prototype[oldSetter] = deprecated;\n        });\n    },\n    afterSetFilter() {\n        this._filterUpToDate = false;\n    },\n};\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Node = void 0;\nconst Canvas_1 = require(\"./Canvas\");\nconst DragAndDrop_1 = require(\"./DragAndDrop\");\nconst Factory_1 = require(\"./Factory\");\nconst Global_1 = require(\"./Global\");\nconst Util_1 = require(\"./Util\");\nconst Validators_1 = require(\"./Validators\");\nconst ABSOLUTE_OPACITY = 'absoluteOpacity', ALL_LISTENERS = 'allEventListeners', ABSOLUTE_TRANSFORM = 'absoluteTransform', ABSOLUTE_SCALE = 'absoluteScale', CANVAS = 'canvas', CHANGE = 'Change', CHILDREN = 'children', KONVA = 'konva', LISTENING = 'listening', MOUSEENTER = 'mouseenter', MOUSELEAVE = 'mouseleave', POINTERENTER = 'pointerenter', POINTERLEAVE = 'pointerleave', TOUCHENTER = 'touchenter', TOUCHLEAVE = 'touchleave', NAME = 'name', SET = 'set', SHAPE = 'Shape', SPACE = ' ', STAGE = 'stage', TRANSFORM = 'transform', UPPER_STAGE = 'Stage', VISIBLE = 'visible', TRANSFORM_CHANGE_STR = [\n    'xChange.konva',\n    'yChange.konva',\n    'scaleXChange.konva',\n    'scaleYChange.konva',\n    'skewXChange.konva',\n    'skewYChange.konva',\n    'rotationChange.konva',\n    'offsetXChange.konva',\n    'offsetYChange.konva',\n    'transformsEnabledChange.konva',\n].join(SPACE);\nlet idCounter = 1;\nclass Node {\n    constructor(config) {\n        this._id = idCounter++;\n        this.eventListeners = {};\n        this.attrs = {};\n        this.index = 0;\n        this._allEventListeners = null;\n        this.parent = null;\n        this._cache = new Map();\n        this._attachedDepsListeners = new Map();\n        this._lastPos = null;\n        this._batchingTransformChange = false;\n        this._needClearTransformCache = false;\n        this._filterUpToDate = false;\n        this._isUnderCache = false;\n        this._dragEventId = null;\n        this._shouldFireChangeEvents = false;\n        this.setAttrs(config);\n        this._shouldFireChangeEvents = true;\n    }\n    hasChildren() {\n        return false;\n    }\n    _clearCache(attr) {\n        if ((attr === TRANSFORM || attr === ABSOLUTE_TRANSFORM) &&\n            this._cache.get(attr)) {\n            this._cache.get(attr).dirty = true;\n        }\n        else if (attr) {\n            this._cache.delete(attr);\n        }\n        else {\n            this._cache.clear();\n        }\n    }\n    _getCache(attr, privateGetter) {\n        let cache = this._cache.get(attr);\n        const isTransform = attr === TRANSFORM || attr === ABSOLUTE_TRANSFORM;\n        const invalid = cache === undefined || (isTransform && cache.dirty === true);\n        if (invalid) {\n            cache = privateGetter.call(this);\n            this._cache.set(attr, cache);\n        }\n        return cache;\n    }\n    _calculate(name, deps, getter) {\n        if (!this._attachedDepsListeners.get(name)) {\n            const depsString = deps.map((dep) => dep + 'Change.konva').join(SPACE);\n            this.on(depsString, () => {\n                this._clearCache(name);\n            });\n            this._attachedDepsListeners.set(name, true);\n        }\n        return this._getCache(name, getter);\n    }\n    _getCanvasCache() {\n        return this._cache.get(CANVAS);\n    }\n    _clearSelfAndDescendantCache(attr) {\n        this._clearCache(attr);\n        if (attr === ABSOLUTE_TRANSFORM) {\n            this.fire('absoluteTransformChange');\n        }\n    }\n    clearCache() {\n        if (this._cache.has(CANVAS)) {\n            const { scene, filter, hit, buffer } = this._cache.get(CANVAS);\n            Util_1.Util.releaseCanvas(scene, filter, hit, buffer);\n            this._cache.delete(CANVAS);\n        }\n        this._clearSelfAndDescendantCache();\n        this._requestDraw();\n        return this;\n    }\n    cache(config) {\n        const conf = config || {};\n        let rect = {};\n        if (conf.x === undefined ||\n            conf.y === undefined ||\n            conf.width === undefined ||\n            conf.height === undefined) {\n            rect = this.getClientRect({\n                skipTransform: true,\n                relativeTo: this.getParent() || undefined,\n            });\n        }\n        let width = Math.ceil(conf.width || rect.width), height = Math.ceil(conf.height || rect.height), pixelRatio = conf.pixelRatio, x = conf.x === undefined ? Math.floor(rect.x) : conf.x, y = conf.y === undefined ? Math.floor(rect.y) : conf.y, offset = conf.offset || 0, drawBorder = conf.drawBorder || false, hitCanvasPixelRatio = conf.hitCanvasPixelRatio || 1;\n        if (!width || !height) {\n            Util_1.Util.error('Can not cache the node. Width or height of the node equals 0. Caching is skipped.');\n            return;\n        }\n        const extraPaddingX = Math.abs(Math.round(rect.x) - x) > 0.5 ? 1 : 0;\n        const extraPaddingY = Math.abs(Math.round(rect.y) - y) > 0.5 ? 1 : 0;\n        width += offset * 2 + extraPaddingX;\n        height += offset * 2 + extraPaddingY;\n        x -= offset;\n        y -= offset;\n        const cachedSceneCanvas = new Canvas_1.SceneCanvas({\n            pixelRatio: pixelRatio,\n            width: width,\n            height: height,\n        }), cachedFilterCanvas = new Canvas_1.SceneCanvas({\n            pixelRatio: pixelRatio,\n            width: 0,\n            height: 0,\n            willReadFrequently: true,\n        }), cachedHitCanvas = new Canvas_1.HitCanvas({\n            pixelRatio: hitCanvasPixelRatio,\n            width: width,\n            height: height,\n        }), sceneContext = cachedSceneCanvas.getContext(), hitContext = cachedHitCanvas.getContext();\n        const bufferCanvas = new Canvas_1.SceneCanvas({\n            width: cachedSceneCanvas.width / cachedSceneCanvas.pixelRatio + Math.abs(x),\n            height: cachedSceneCanvas.height / cachedSceneCanvas.pixelRatio + Math.abs(y),\n            pixelRatio: cachedSceneCanvas.pixelRatio,\n        }), bufferContext = bufferCanvas.getContext();\n        cachedHitCanvas.isCache = true;\n        cachedSceneCanvas.isCache = true;\n        this._cache.delete(CANVAS);\n        this._filterUpToDate = false;\n        if (conf.imageSmoothingEnabled === false) {\n            cachedSceneCanvas.getContext()._context.imageSmoothingEnabled = false;\n            cachedFilterCanvas.getContext()._context.imageSmoothingEnabled = false;\n        }\n        sceneContext.save();\n        hitContext.save();\n        bufferContext.save();\n        sceneContext.translate(-x, -y);\n        hitContext.translate(-x, -y);\n        bufferContext.translate(-x, -y);\n        bufferCanvas.x = x;\n        bufferCanvas.y = y;\n        this._isUnderCache = true;\n        this._clearSelfAndDescendantCache(ABSOLUTE_OPACITY);\n        this._clearSelfAndDescendantCache(ABSOLUTE_SCALE);\n        this.drawScene(cachedSceneCanvas, this, bufferCanvas);\n        this.drawHit(cachedHitCanvas, this);\n        this._isUnderCache = false;\n        sceneContext.restore();\n        hitContext.restore();\n        if (drawBorder) {\n            sceneContext.save();\n            sceneContext.beginPath();\n            sceneContext.rect(0, 0, width, height);\n            sceneContext.closePath();\n            sceneContext.setAttr('strokeStyle', 'red');\n            sceneContext.setAttr('lineWidth', 5);\n            sceneContext.stroke();\n            sceneContext.restore();\n        }\n        this._cache.set(CANVAS, {\n            scene: cachedSceneCanvas,\n            filter: cachedFilterCanvas,\n            hit: cachedHitCanvas,\n            buffer: bufferCanvas,\n            x: x,\n            y: y,\n        });\n        this._requestDraw();\n        return this;\n    }\n    isCached() {\n        return this._cache.has(CANVAS);\n    }\n    getClientRect(config) {\n        throw new Error('abstract \"getClientRect\" method call');\n    }\n    _transformedRect(rect, top) {\n        const points = [\n            { x: rect.x, y: rect.y },\n            { x: rect.x + rect.width, y: rect.y },\n            { x: rect.x + rect.width, y: rect.y + rect.height },\n            { x: rect.x, y: rect.y + rect.height },\n        ];\n        let minX = Infinity, minY = Infinity, maxX = -Infinity, maxY = -Infinity;\n        const trans = this.getAbsoluteTransform(top);\n        points.forEach(function (point) {\n            const transformed = trans.point(point);\n            if (minX === undefined) {\n                minX = maxX = transformed.x;\n                minY = maxY = transformed.y;\n            }\n            minX = Math.min(minX, transformed.x);\n            minY = Math.min(minY, transformed.y);\n            maxX = Math.max(maxX, transformed.x);\n            maxY = Math.max(maxY, transformed.y);\n        });\n        return {\n            x: minX,\n            y: minY,\n            width: maxX - minX,\n            height: maxY - minY,\n        };\n    }\n    _drawCachedSceneCanvas(context) {\n        context.save();\n        context._applyOpacity(this);\n        context._applyGlobalCompositeOperation(this);\n        const canvasCache = this._getCanvasCache();\n        context.translate(canvasCache.x, canvasCache.y);\n        const cacheCanvas = this._getCachedSceneCanvas();\n        const ratio = cacheCanvas.pixelRatio;\n        context.drawImage(cacheCanvas._canvas, 0, 0, cacheCanvas.width / ratio, cacheCanvas.height / ratio);\n        context.restore();\n    }\n    _drawCachedHitCanvas(context) {\n        const canvasCache = this._getCanvasCache(), hitCanvas = canvasCache.hit;\n        context.save();\n        context.translate(canvasCache.x, canvasCache.y);\n        context.drawImage(hitCanvas._canvas, 0, 0, hitCanvas.width / hitCanvas.pixelRatio, hitCanvas.height / hitCanvas.pixelRatio);\n        context.restore();\n    }\n    _getCachedSceneCanvas() {\n        let filters = this.filters(), cachedCanvas = this._getCanvasCache(), sceneCanvas = cachedCanvas.scene, filterCanvas = cachedCanvas.filter, filterContext = filterCanvas.getContext(), len, imageData, n, filter;\n        if (filters) {\n            if (!this._filterUpToDate) {\n                const ratio = sceneCanvas.pixelRatio;\n                filterCanvas.setSize(sceneCanvas.width / sceneCanvas.pixelRatio, sceneCanvas.height / sceneCanvas.pixelRatio);\n                try {\n                    len = filters.length;\n                    filterContext.clear();\n                    filterContext.drawImage(sceneCanvas._canvas, 0, 0, sceneCanvas.getWidth() / ratio, sceneCanvas.getHeight() / ratio);\n                    imageData = filterContext.getImageData(0, 0, filterCanvas.getWidth(), filterCanvas.getHeight());\n                    for (n = 0; n < len; n++) {\n                        filter = filters[n];\n                        if (typeof filter !== 'function') {\n                            Util_1.Util.error('Filter should be type of function, but got ' +\n                                typeof filter +\n                                ' instead. Please check correct filters');\n                            continue;\n                        }\n                        filter.call(this, imageData);\n                        filterContext.putImageData(imageData, 0, 0);\n                    }\n                }\n                catch (e) {\n                    Util_1.Util.error('Unable to apply filter. ' +\n                        e.message +\n                        ' This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.');\n                }\n                this._filterUpToDate = true;\n            }\n            return filterCanvas;\n        }\n        return sceneCanvas;\n    }\n    on(evtStr, handler) {\n        if (this._cache) {\n            this._cache.delete(ALL_LISTENERS);\n        }\n        if (arguments.length === 3) {\n            return this._delegate.apply(this, arguments);\n        }\n        const events = evtStr.split(SPACE);\n        for (let n = 0; n < events.length; n++) {\n            const event = events[n];\n            const parts = event.split('.');\n            const baseEvent = parts[0];\n            const name = parts[1] || '';\n            if (!this.eventListeners[baseEvent]) {\n                this.eventListeners[baseEvent] = [];\n            }\n            this.eventListeners[baseEvent].push({ name, handler });\n        }\n        return this;\n    }\n    off(evtStr, callback) {\n        let events = (evtStr || '').split(SPACE), len = events.length, n, t, event, parts, baseEvent, name;\n        this._cache && this._cache.delete(ALL_LISTENERS);\n        if (!evtStr) {\n            for (t in this.eventListeners) {\n                this._off(t);\n            }\n        }\n        for (n = 0; n < len; n++) {\n            event = events[n];\n            parts = event.split('.');\n            baseEvent = parts[0];\n            name = parts[1];\n            if (baseEvent) {\n                if (this.eventListeners[baseEvent]) {\n                    this._off(baseEvent, name, callback);\n                }\n            }\n            else {\n                for (t in this.eventListeners) {\n                    this._off(t, name, callback);\n                }\n            }\n        }\n        return this;\n    }\n    dispatchEvent(evt) {\n        const e = {\n            target: this,\n            type: evt.type,\n            evt: evt,\n        };\n        this.fire(evt.type, e);\n        return this;\n    }\n    addEventListener(type, handler) {\n        this.on(type, function (evt) {\n            handler.call(this, evt.evt);\n        });\n        return this;\n    }\n    removeEventListener(type) {\n        this.off(type);\n        return this;\n    }\n    _delegate(event, selector, handler) {\n        const stopNode = this;\n        this.on(event, function (evt) {\n            const targets = evt.target.findAncestors(selector, true, stopNode);\n            for (let i = 0; i < targets.length; i++) {\n                evt = Util_1.Util.cloneObject(evt);\n                evt.currentTarget = targets[i];\n                handler.call(targets[i], evt);\n            }\n        });\n    }\n    remove() {\n        if (this.isDragging()) {\n            this.stopDrag();\n        }\n        DragAndDrop_1.DD._dragElements.delete(this._id);\n        this._remove();\n        return this;\n    }\n    _clearCaches() {\n        this._clearSelfAndDescendantCache(ABSOLUTE_TRANSFORM);\n        this._clearSelfAndDescendantCache(ABSOLUTE_OPACITY);\n        this._clearSelfAndDescendantCache(ABSOLUTE_SCALE);\n        this._clearSelfAndDescendantCache(STAGE);\n        this._clearSelfAndDescendantCache(VISIBLE);\n        this._clearSelfAndDescendantCache(LISTENING);\n    }\n    _remove() {\n        this._clearCaches();\n        const parent = this.getParent();\n        if (parent && parent.children) {\n            parent.children.splice(this.index, 1);\n            parent._setChildrenIndices();\n            this.parent = null;\n        }\n    }\n    destroy() {\n        this.remove();\n        this.clearCache();\n        return this;\n    }\n    getAttr(attr) {\n        const method = 'get' + Util_1.Util._capitalize(attr);\n        if (Util_1.Util._isFunction(this[method])) {\n            return this[method]();\n        }\n        return this.attrs[attr];\n    }\n    getAncestors() {\n        let parent = this.getParent(), ancestors = [];\n        while (parent) {\n            ancestors.push(parent);\n            parent = parent.getParent();\n        }\n        return ancestors;\n    }\n    getAttrs() {\n        return (this.attrs || {});\n    }\n    setAttrs(config) {\n        this._batchTransformChanges(() => {\n            let key, method;\n            if (!config) {\n                return this;\n            }\n            for (key in config) {\n                if (key === CHILDREN) {\n                    continue;\n                }\n                method = SET + Util_1.Util._capitalize(key);\n                if (Util_1.Util._isFunction(this[method])) {\n                    this[method](config[key]);\n                }\n                else {\n                    this._setAttr(key, config[key]);\n                }\n            }\n        });\n        return this;\n    }\n    isListening() {\n        return this._getCache(LISTENING, this._isListening);\n    }\n    _isListening(relativeTo) {\n        const listening = this.listening();\n        if (!listening) {\n            return false;\n        }\n        const parent = this.getParent();\n        if (parent && parent !== relativeTo && this !== relativeTo) {\n            return parent._isListening(relativeTo);\n        }\n        else {\n            return true;\n        }\n    }\n    isVisible() {\n        return this._getCache(VISIBLE, this._isVisible);\n    }\n    _isVisible(relativeTo) {\n        const visible = this.visible();\n        if (!visible) {\n            return false;\n        }\n        const parent = this.getParent();\n        if (parent && parent !== relativeTo && this !== relativeTo) {\n            return parent._isVisible(relativeTo);\n        }\n        else {\n            return true;\n        }\n    }\n    shouldDrawHit(top, skipDragCheck = false) {\n        if (top) {\n            return this._isVisible(top) && this._isListening(top);\n        }\n        const layer = this.getLayer();\n        let layerUnderDrag = false;\n        DragAndDrop_1.DD._dragElements.forEach((elem) => {\n            if (elem.dragStatus !== 'dragging') {\n                return;\n            }\n            else if (elem.node.nodeType === 'Stage') {\n                layerUnderDrag = true;\n            }\n            else if (elem.node.getLayer() === layer) {\n                layerUnderDrag = true;\n            }\n        });\n        const dragSkip = !skipDragCheck &&\n            !Global_1.Konva.hitOnDragEnabled &&\n            (layerUnderDrag || Global_1.Konva.isTransforming());\n        return this.isListening() && this.isVisible() && !dragSkip;\n    }\n    show() {\n        this.visible(true);\n        return this;\n    }\n    hide() {\n        this.visible(false);\n        return this;\n    }\n    getZIndex() {\n        return this.index || 0;\n    }\n    getAbsoluteZIndex() {\n        let depth = this.getDepth(), that = this, index = 0, nodes, len, n, child;\n        function addChildren(children) {\n            nodes = [];\n            len = children.length;\n            for (n = 0; n < len; n++) {\n                child = children[n];\n                index++;\n                if (child.nodeType !== SHAPE) {\n                    nodes = nodes.concat(child.getChildren().slice());\n                }\n                if (child._id === that._id) {\n                    n = len;\n                }\n            }\n            if (nodes.length > 0 && nodes[0].getDepth() <= depth) {\n                addChildren(nodes);\n            }\n        }\n        const stage = this.getStage();\n        if (that.nodeType !== UPPER_STAGE && stage) {\n            addChildren(stage.getChildren());\n        }\n        return index;\n    }\n    getDepth() {\n        let depth = 0, parent = this.parent;\n        while (parent) {\n            depth++;\n            parent = parent.parent;\n        }\n        return depth;\n    }\n    _batchTransformChanges(func) {\n        this._batchingTransformChange = true;\n        func();\n        this._batchingTransformChange = false;\n        if (this._needClearTransformCache) {\n            this._clearCache(TRANSFORM);\n            this._clearSelfAndDescendantCache(ABSOLUTE_TRANSFORM);\n        }\n        this._needClearTransformCache = false;\n    }\n    setPosition(pos) {\n        this._batchTransformChanges(() => {\n            this.x(pos.x);\n            this.y(pos.y);\n        });\n        return this;\n    }\n    getPosition() {\n        return {\n            x: this.x(),\n            y: this.y(),\n        };\n    }\n    getRelativePointerPosition() {\n        const stage = this.getStage();\n        if (!stage) {\n            return null;\n        }\n        const pos = stage.getPointerPosition();\n        if (!pos) {\n            return null;\n        }\n        const transform = this.getAbsoluteTransform().copy();\n        transform.invert();\n        return transform.point(pos);\n    }\n    getAbsolutePosition(top) {\n        let haveCachedParent = false;\n        let parent = this.parent;\n        while (parent) {\n            if (parent.isCached()) {\n                haveCachedParent = true;\n                break;\n            }\n            parent = parent.parent;\n        }\n        if (haveCachedParent && !top) {\n            top = true;\n        }\n        const absoluteMatrix = this.getAbsoluteTransform(top).getMatrix(), absoluteTransform = new Util_1.Transform(), offset = this.offset();\n        absoluteTransform.m = absoluteMatrix.slice();\n        absoluteTransform.translate(offset.x, offset.y);\n        return absoluteTransform.getTranslation();\n    }\n    setAbsolutePosition(pos) {\n        const { x, y, ...origTrans } = this._clearTransform();\n        this.attrs.x = x;\n        this.attrs.y = y;\n        this._clearCache(TRANSFORM);\n        const it = this._getAbsoluteTransform().copy();\n        it.invert();\n        it.translate(pos.x, pos.y);\n        pos = {\n            x: this.attrs.x + it.getTranslation().x,\n            y: this.attrs.y + it.getTranslation().y,\n        };\n        this._setTransform(origTrans);\n        this.setPosition({ x: pos.x, y: pos.y });\n        this._clearCache(TRANSFORM);\n        this._clearSelfAndDescendantCache(ABSOLUTE_TRANSFORM);\n        return this;\n    }\n    _setTransform(trans) {\n        let key;\n        for (key in trans) {\n            this.attrs[key] = trans[key];\n        }\n    }\n    _clearTransform() {\n        const trans = {\n            x: this.x(),\n            y: this.y(),\n            rotation: this.rotation(),\n            scaleX: this.scaleX(),\n            scaleY: this.scaleY(),\n            offsetX: this.offsetX(),\n            offsetY: this.offsetY(),\n            skewX: this.skewX(),\n            skewY: this.skewY(),\n        };\n        this.attrs.x = 0;\n        this.attrs.y = 0;\n        this.attrs.rotation = 0;\n        this.attrs.scaleX = 1;\n        this.attrs.scaleY = 1;\n        this.attrs.offsetX = 0;\n        this.attrs.offsetY = 0;\n        this.attrs.skewX = 0;\n        this.attrs.skewY = 0;\n        return trans;\n    }\n    move(change) {\n        let changeX = change.x, changeY = change.y, x = this.x(), y = this.y();\n        if (changeX !== undefined) {\n            x += changeX;\n        }\n        if (changeY !== undefined) {\n            y += changeY;\n        }\n        this.setPosition({ x: x, y: y });\n        return this;\n    }\n    _eachAncestorReverse(func, top) {\n        let family = [], parent = this.getParent(), len, n;\n        if (top && top._id === this._id) {\n            return;\n        }\n        family.unshift(this);\n        while (parent && (!top || parent._id !== top._id)) {\n            family.unshift(parent);\n            parent = parent.parent;\n        }\n        len = family.length;\n        for (n = 0; n < len; n++) {\n            func(family[n]);\n        }\n    }\n    rotate(theta) {\n        this.rotation(this.rotation() + theta);\n        return this;\n    }\n    moveToTop() {\n        if (!this.parent) {\n            Util_1.Util.warn('Node has no parent. moveToTop function is ignored.');\n            return false;\n        }\n        const index = this.index, len = this.parent.getChildren().length;\n        if (index < len - 1) {\n            this.parent.children.splice(index, 1);\n            this.parent.children.push(this);\n            this.parent._setChildrenIndices();\n            return true;\n        }\n        return false;\n    }\n    moveUp() {\n        if (!this.parent) {\n            Util_1.Util.warn('Node has no parent. moveUp function is ignored.');\n            return false;\n        }\n        const index = this.index, len = this.parent.getChildren().length;\n        if (index < len - 1) {\n            this.parent.children.splice(index, 1);\n            this.parent.children.splice(index + 1, 0, this);\n            this.parent._setChildrenIndices();\n            return true;\n        }\n        return false;\n    }\n    moveDown() {\n        if (!this.parent) {\n            Util_1.Util.warn('Node has no parent. moveDown function is ignored.');\n            return false;\n        }\n        const index = this.index;\n        if (index > 0) {\n            this.parent.children.splice(index, 1);\n            this.parent.children.splice(index - 1, 0, this);\n            this.parent._setChildrenIndices();\n            return true;\n        }\n        return false;\n    }\n    moveToBottom() {\n        if (!this.parent) {\n            Util_1.Util.warn('Node has no parent. moveToBottom function is ignored.');\n            return false;\n        }\n        const index = this.index;\n        if (index > 0) {\n            this.parent.children.splice(index, 1);\n            this.parent.children.unshift(this);\n            this.parent._setChildrenIndices();\n            return true;\n        }\n        return false;\n    }\n    setZIndex(zIndex) {\n        if (!this.parent) {\n            Util_1.Util.warn('Node has no parent. zIndex parameter is ignored.');\n            return this;\n        }\n        if (zIndex < 0 || zIndex >= this.parent.children.length) {\n            Util_1.Util.warn('Unexpected value ' +\n                zIndex +\n                ' for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to ' +\n                (this.parent.children.length - 1) +\n                '.');\n        }\n        const index = this.index;\n        this.parent.children.splice(index, 1);\n        this.parent.children.splice(zIndex, 0, this);\n        this.parent._setChildrenIndices();\n        return this;\n    }\n    getAbsoluteOpacity() {\n        return this._getCache(ABSOLUTE_OPACITY, this._getAbsoluteOpacity);\n    }\n    _getAbsoluteOpacity() {\n        let absOpacity = this.opacity();\n        const parent = this.getParent();\n        if (parent && !parent._isUnderCache) {\n            absOpacity *= parent.getAbsoluteOpacity();\n        }\n        return absOpacity;\n    }\n    moveTo(newContainer) {\n        if (this.getParent() !== newContainer) {\n            this._remove();\n            newContainer.add(this);\n        }\n        return this;\n    }\n    toObject() {\n        let attrs = this.getAttrs(), key, val, getter, defaultValue, nonPlainObject;\n        const obj = {\n            attrs: {},\n            className: this.getClassName(),\n        };\n        for (key in attrs) {\n            val = attrs[key];\n            nonPlainObject =\n                Util_1.Util.isObject(val) && !Util_1.Util._isPlainObject(val) && !Util_1.Util._isArray(val);\n            if (nonPlainObject) {\n                continue;\n            }\n            getter = typeof this[key] === 'function' && this[key];\n            delete attrs[key];\n            defaultValue = getter ? getter.call(this) : null;\n            attrs[key] = val;\n            if (defaultValue !== val) {\n                obj.attrs[key] = val;\n            }\n        }\n        return Util_1.Util._prepareToStringify(obj);\n    }\n    toJSON() {\n        return JSON.stringify(this.toObject());\n    }\n    getParent() {\n        return this.parent;\n    }\n    findAncestors(selector, includeSelf, stopNode) {\n        const res = [];\n        if (includeSelf && this._isMatch(selector)) {\n            res.push(this);\n        }\n        let ancestor = this.parent;\n        while (ancestor) {\n            if (ancestor === stopNode) {\n                return res;\n            }\n            if (ancestor._isMatch(selector)) {\n                res.push(ancestor);\n            }\n            ancestor = ancestor.parent;\n        }\n        return res;\n    }\n    isAncestorOf(node) {\n        return false;\n    }\n    findAncestor(selector, includeSelf, stopNode) {\n        return this.findAncestors(selector, includeSelf, stopNode)[0];\n    }\n    _isMatch(selector) {\n        if (!selector) {\n            return false;\n        }\n        if (typeof selector === 'function') {\n            return selector(this);\n        }\n        let selectorArr = selector.replace(/ /g, '').split(','), len = selectorArr.length, n, sel;\n        for (n = 0; n < len; n++) {\n            sel = selectorArr[n];\n            if (!Util_1.Util.isValidSelector(sel)) {\n                Util_1.Util.warn('Selector \"' +\n                    sel +\n                    '\" is invalid. Allowed selectors examples are \"#foo\", \".bar\" or \"Group\".');\n                Util_1.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like \"Triangle\".');\n                Util_1.Util.warn('Konva is awesome, right?');\n            }\n            if (sel.charAt(0) === '#') {\n                if (this.id() === sel.slice(1)) {\n                    return true;\n                }\n            }\n            else if (sel.charAt(0) === '.') {\n                if (this.hasName(sel.slice(1))) {\n                    return true;\n                }\n            }\n            else if (this.className === sel || this.nodeType === sel) {\n                return true;\n            }\n        }\n        return false;\n    }\n    getLayer() {\n        const parent = this.getParent();\n        return parent ? parent.getLayer() : null;\n    }\n    getStage() {\n        return this._getCache(STAGE, this._getStage);\n    }\n    _getStage() {\n        const parent = this.getParent();\n        if (parent) {\n            return parent.getStage();\n        }\n        else {\n            return null;\n        }\n    }\n    fire(eventType, evt = {}, bubble) {\n        evt.target = evt.target || this;\n        if (bubble) {\n            this._fireAndBubble(eventType, evt);\n        }\n        else {\n            this._fire(eventType, evt);\n        }\n        return this;\n    }\n    getAbsoluteTransform(top) {\n        if (top) {\n            return this._getAbsoluteTransform(top);\n        }\n        else {\n            return this._getCache(ABSOLUTE_TRANSFORM, this._getAbsoluteTransform);\n        }\n    }\n    _getAbsoluteTransform(top) {\n        let at;\n        if (top) {\n            at = new Util_1.Transform();\n            this._eachAncestorReverse(function (node) {\n                const transformsEnabled = node.transformsEnabled();\n                if (transformsEnabled === 'all') {\n                    at.multiply(node.getTransform());\n                }\n                else if (transformsEnabled === 'position') {\n                    at.translate(node.x() - node.offsetX(), node.y() - node.offsetY());\n                }\n            }, top);\n            return at;\n        }\n        else {\n            at = this._cache.get(ABSOLUTE_TRANSFORM) || new Util_1.Transform();\n            if (this.parent) {\n                this.parent.getAbsoluteTransform().copyInto(at);\n            }\n            else {\n                at.reset();\n            }\n            const transformsEnabled = this.transformsEnabled();\n            if (transformsEnabled === 'all') {\n                at.multiply(this.getTransform());\n            }\n            else if (transformsEnabled === 'position') {\n                const x = this.attrs.x || 0;\n                const y = this.attrs.y || 0;\n                const offsetX = this.attrs.offsetX || 0;\n                const offsetY = this.attrs.offsetY || 0;\n                at.translate(x - offsetX, y - offsetY);\n            }\n            at.dirty = false;\n            return at;\n        }\n    }\n    getAbsoluteScale(top) {\n        let parent = this;\n        while (parent) {\n            if (parent._isUnderCache) {\n                top = parent;\n            }\n            parent = parent.getParent();\n        }\n        const transform = this.getAbsoluteTransform(top);\n        const attrs = transform.decompose();\n        return {\n            x: attrs.scaleX,\n            y: attrs.scaleY,\n        };\n    }\n    getAbsoluteRotation() {\n        return this.getAbsoluteTransform().decompose().rotation;\n    }\n    getTransform() {\n        return this._getCache(TRANSFORM, this._getTransform);\n    }\n    _getTransform() {\n        var _a, _b;\n        const m = this._cache.get(TRANSFORM) || new Util_1.Transform();\n        m.reset();\n        const x = this.x(), y = this.y(), rotation = Global_1.Konva.getAngle(this.rotation()), scaleX = (_a = this.attrs.scaleX) !== null && _a !== void 0 ? _a : 1, scaleY = (_b = this.attrs.scaleY) !== null && _b !== void 0 ? _b : 1, skewX = this.attrs.skewX || 0, skewY = this.attrs.skewY || 0, offsetX = this.attrs.offsetX || 0, offsetY = this.attrs.offsetY || 0;\n        if (x !== 0 || y !== 0) {\n            m.translate(x, y);\n        }\n        if (rotation !== 0) {\n            m.rotate(rotation);\n        }\n        if (skewX !== 0 || skewY !== 0) {\n            m.skew(skewX, skewY);\n        }\n        if (scaleX !== 1 || scaleY !== 1) {\n            m.scale(scaleX, scaleY);\n        }\n        if (offsetX !== 0 || offsetY !== 0) {\n            m.translate(-1 * offsetX, -1 * offsetY);\n        }\n        m.dirty = false;\n        return m;\n    }\n    clone(obj) {\n        let attrs = Util_1.Util.cloneObject(this.attrs), key, allListeners, len, n, listener;\n        for (key in obj) {\n            attrs[key] = obj[key];\n        }\n        const node = new this.constructor(attrs);\n        for (key in this.eventListeners) {\n            allListeners = this.eventListeners[key];\n            len = allListeners.length;\n            for (n = 0; n < len; n++) {\n                listener = allListeners[n];\n                if (listener.name.indexOf(KONVA) < 0) {\n                    if (!node.eventListeners[key]) {\n                        node.eventListeners[key] = [];\n                    }\n                    node.eventListeners[key].push(listener);\n                }\n            }\n        }\n        return node;\n    }\n    _toKonvaCanvas(config) {\n        config = config || {};\n        const box = this.getClientRect();\n        const stage = this.getStage(), x = config.x !== undefined ? config.x : Math.floor(box.x), y = config.y !== undefined ? config.y : Math.floor(box.y), pixelRatio = config.pixelRatio || 1, canvas = new Canvas_1.SceneCanvas({\n            width: config.width || Math.ceil(box.width) || (stage ? stage.width() : 0),\n            height: config.height ||\n                Math.ceil(box.height) ||\n                (stage ? stage.height() : 0),\n            pixelRatio: pixelRatio,\n        }), context = canvas.getContext();\n        const bufferCanvas = new Canvas_1.SceneCanvas({\n            width: canvas.width / canvas.pixelRatio + Math.abs(x),\n            height: canvas.height / canvas.pixelRatio + Math.abs(y),\n            pixelRatio: canvas.pixelRatio,\n        });\n        if (config.imageSmoothingEnabled === false) {\n            context._context.imageSmoothingEnabled = false;\n        }\n        context.save();\n        if (x || y) {\n            context.translate(-1 * x, -1 * y);\n        }\n        this.drawScene(canvas, undefined, bufferCanvas);\n        context.restore();\n        return canvas;\n    }\n    toCanvas(config) {\n        return this._toKonvaCanvas(config)._canvas;\n    }\n    toDataURL(config) {\n        config = config || {};\n        const mimeType = config.mimeType || null, quality = config.quality || null;\n        const url = this._toKonvaCanvas(config).toDataURL(mimeType, quality);\n        if (config.callback) {\n            config.callback(url);\n        }\n        return url;\n    }\n    toImage(config) {\n        return new Promise((resolve, reject) => {\n            try {\n                const callback = config === null || config === void 0 ? void 0 : config.callback;\n                if (callback)\n                    delete config.callback;\n                Util_1.Util._urlToImage(this.toDataURL(config), function (img) {\n                    resolve(img);\n                    callback === null || callback === void 0 ? void 0 : callback(img);\n                });\n            }\n            catch (err) {\n                reject(err);\n            }\n        });\n    }\n    toBlob(config) {\n        return new Promise((resolve, reject) => {\n            try {\n                const callback = config === null || config === void 0 ? void 0 : config.callback;\n                if (callback)\n                    delete config.callback;\n                this.toCanvas(config).toBlob((blob) => {\n                    resolve(blob);\n                    callback === null || callback === void 0 ? void 0 : callback(blob);\n                }, config === null || config === void 0 ? void 0 : config.mimeType, config === null || config === void 0 ? void 0 : config.quality);\n            }\n            catch (err) {\n                reject(err);\n            }\n        });\n    }\n    setSize(size) {\n        this.width(size.width);\n        this.height(size.height);\n        return this;\n    }\n    getSize() {\n        return {\n            width: this.width(),\n            height: this.height(),\n        };\n    }\n    getClassName() {\n        return this.className || this.nodeType;\n    }\n    getType() {\n        return this.nodeType;\n    }\n    getDragDistance() {\n        if (this.attrs.dragDistance !== undefined) {\n            return this.attrs.dragDistance;\n        }\n        else if (this.parent) {\n            return this.parent.getDragDistance();\n        }\n        else {\n            return Global_1.Konva.dragDistance;\n        }\n    }\n    _off(type, name, callback) {\n        let evtListeners = this.eventListeners[type], i, evtName, handler;\n        for (i = 0; i < evtListeners.length; i++) {\n            evtName = evtListeners[i].name;\n            handler = evtListeners[i].handler;\n            if ((evtName !== 'konva' || name === 'konva') &&\n                (!name || evtName === name) &&\n                (!callback || callback === handler)) {\n                evtListeners.splice(i, 1);\n                if (evtListeners.length === 0) {\n                    delete this.eventListeners[type];\n                    break;\n                }\n                i--;\n            }\n        }\n    }\n    _fireChangeEvent(attr, oldVal, newVal) {\n        this._fire(attr + CHANGE, {\n            oldVal: oldVal,\n            newVal: newVal,\n        });\n    }\n    addName(name) {\n        if (!this.hasName(name)) {\n            const oldName = this.name();\n            const newName = oldName ? oldName + ' ' + name : name;\n            this.name(newName);\n        }\n        return this;\n    }\n    hasName(name) {\n        if (!name) {\n            return false;\n        }\n        const fullName = this.name();\n        if (!fullName) {\n            return false;\n        }\n        const names = (fullName || '').split(/\\s/g);\n        return names.indexOf(name) !== -1;\n    }\n    removeName(name) {\n        const names = (this.name() || '').split(/\\s/g);\n        const index = names.indexOf(name);\n        if (index !== -1) {\n            names.splice(index, 1);\n            this.name(names.join(' '));\n        }\n        return this;\n    }\n    setAttr(attr, val) {\n        const func = this[SET + Util_1.Util._capitalize(attr)];\n        if (Util_1.Util._isFunction(func)) {\n            func.call(this, val);\n        }\n        else {\n            this._setAttr(attr, val);\n        }\n        return this;\n    }\n    _requestDraw() {\n        if (Global_1.Konva.autoDrawEnabled) {\n            const drawNode = this.getLayer() || this.getStage();\n            drawNode === null || drawNode === void 0 ? void 0 : drawNode.batchDraw();\n        }\n    }\n    _setAttr(key, val) {\n        const oldVal = this.attrs[key];\n        if (oldVal === val && !Util_1.Util.isObject(val)) {\n            return;\n        }\n        if (val === undefined || val === null) {\n            delete this.attrs[key];\n        }\n        else {\n            this.attrs[key] = val;\n        }\n        if (this._shouldFireChangeEvents) {\n            this._fireChangeEvent(key, oldVal, val);\n        }\n        this._requestDraw();\n    }\n    _setComponentAttr(key, component, val) {\n        let oldVal;\n        if (val !== undefined) {\n            oldVal = this.attrs[key];\n            if (!oldVal) {\n                this.attrs[key] = this.getAttr(key);\n            }\n            this.attrs[key][component] = val;\n            this._fireChangeEvent(key, oldVal, val);\n        }\n    }\n    _fireAndBubble(eventType, evt, compareShape) {\n        if (evt && this.nodeType === SHAPE) {\n            evt.target = this;\n        }\n        const nonBubbling = [\n            MOUSEENTER,\n            MOUSELEAVE,\n            POINTERENTER,\n            POINTERLEAVE,\n            TOUCHENTER,\n            TOUCHLEAVE,\n        ];\n        const shouldStop = nonBubbling.indexOf(eventType) !== -1 &&\n            ((compareShape &&\n                (this === compareShape ||\n                    (this.isAncestorOf && this.isAncestorOf(compareShape)))) ||\n                (this.nodeType === 'Stage' && !compareShape));\n        if (!shouldStop) {\n            this._fire(eventType, evt);\n            const stopBubble = nonBubbling.indexOf(eventType) !== -1 &&\n                compareShape &&\n                compareShape.isAncestorOf &&\n                compareShape.isAncestorOf(this) &&\n                !compareShape.isAncestorOf(this.parent);\n            if (((evt && !evt.cancelBubble) || !evt) &&\n                this.parent &&\n                this.parent.isListening() &&\n                !stopBubble) {\n                if (compareShape && compareShape.parent) {\n                    this._fireAndBubble.call(this.parent, eventType, evt, compareShape);\n                }\n                else {\n                    this._fireAndBubble.call(this.parent, eventType, evt);\n                }\n            }\n        }\n    }\n    _getProtoListeners(eventType) {\n        var _a, _b, _c;\n        const allListeners = (_a = this._cache.get(ALL_LISTENERS)) !== null && _a !== void 0 ? _a : {};\n        let events = allListeners === null || allListeners === void 0 ? void 0 : allListeners[eventType];\n        if (events === undefined) {\n            events = [];\n            let obj = Object.getPrototypeOf(this);\n            while (obj) {\n                const hierarchyEvents = (_c = (_b = obj.eventListeners) === null || _b === void 0 ? void 0 : _b[eventType]) !== null && _c !== void 0 ? _c : [];\n                events.push(...hierarchyEvents);\n                obj = Object.getPrototypeOf(obj);\n            }\n            allListeners[eventType] = events;\n            this._cache.set(ALL_LISTENERS, allListeners);\n        }\n        return events;\n    }\n    _fire(eventType, evt) {\n        evt = evt || {};\n        evt.currentTarget = this;\n        evt.type = eventType;\n        const topListeners = this._getProtoListeners(eventType);\n        if (topListeners) {\n            for (let i = 0; i < topListeners.length; i++) {\n                topListeners[i].handler.call(this, evt);\n            }\n        }\n        const selfListeners = this.eventListeners[eventType];\n        if (selfListeners) {\n            for (let i = 0; i < selfListeners.length; i++) {\n                selfListeners[i].handler.call(this, evt);\n            }\n        }\n    }\n    draw() {\n        this.drawScene();\n        this.drawHit();\n        return this;\n    }\n    _createDragElement(evt) {\n        const pointerId = evt ? evt.pointerId : undefined;\n        const stage = this.getStage();\n        const ap = this.getAbsolutePosition();\n        if (!stage) {\n            return;\n        }\n        const pos = stage._getPointerById(pointerId) ||\n            stage._changedPointerPositions[0] ||\n            ap;\n        DragAndDrop_1.DD._dragElements.set(this._id, {\n            node: this,\n            startPointerPos: pos,\n            offset: {\n                x: pos.x - ap.x,\n                y: pos.y - ap.y,\n            },\n            dragStatus: 'ready',\n            pointerId,\n        });\n    }\n    startDrag(evt, bubbleEvent = true) {\n        if (!DragAndDrop_1.DD._dragElements.has(this._id)) {\n            this._createDragElement(evt);\n        }\n        const elem = DragAndDrop_1.DD._dragElements.get(this._id);\n        elem.dragStatus = 'dragging';\n        this.fire('dragstart', {\n            type: 'dragstart',\n            target: this,\n            evt: evt && evt.evt,\n        }, bubbleEvent);\n    }\n    _setDragPosition(evt, elem) {\n        const pos = this.getStage()._getPointerById(elem.pointerId);\n        if (!pos) {\n            return;\n        }\n        let newNodePos = {\n            x: pos.x - elem.offset.x,\n            y: pos.y - elem.offset.y,\n        };\n        const dbf = this.dragBoundFunc();\n        if (dbf !== undefined) {\n            const bounded = dbf.call(this, newNodePos, evt);\n            if (!bounded) {\n                Util_1.Util.warn('dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.');\n            }\n            else {\n                newNodePos = bounded;\n            }\n        }\n        if (!this._lastPos ||\n            this._lastPos.x !== newNodePos.x ||\n            this._lastPos.y !== newNodePos.y) {\n            this.setAbsolutePosition(newNodePos);\n            this._requestDraw();\n        }\n        this._lastPos = newNodePos;\n    }\n    stopDrag(evt) {\n        const elem = DragAndDrop_1.DD._dragElements.get(this._id);\n        if (elem) {\n            elem.dragStatus = 'stopped';\n        }\n        DragAndDrop_1.DD._endDragBefore(evt);\n        DragAndDrop_1.DD._endDragAfter(evt);\n    }\n    setDraggable(draggable) {\n        this._setAttr('draggable', draggable);\n        this._dragChange();\n    }\n    isDragging() {\n        const elem = DragAndDrop_1.DD._dragElements.get(this._id);\n        return elem ? elem.dragStatus === 'dragging' : false;\n    }\n    _listenDrag() {\n        this._dragCleanup();\n        this.on('mousedown.konva touchstart.konva', function (evt) {\n            const shouldCheckButton = evt.evt['button'] !== undefined;\n            const canDrag = !shouldCheckButton || Global_1.Konva.dragButtons.indexOf(evt.evt['button']) >= 0;\n            if (!canDrag) {\n                return;\n            }\n            if (this.isDragging()) {\n                return;\n            }\n            let hasDraggingChild = false;\n            DragAndDrop_1.DD._dragElements.forEach((elem) => {\n                if (this.isAncestorOf(elem.node)) {\n                    hasDraggingChild = true;\n                }\n            });\n            if (!hasDraggingChild) {\n                this._createDragElement(evt);\n            }\n        });\n    }\n    _dragChange() {\n        if (this.attrs.draggable) {\n            this._listenDrag();\n        }\n        else {\n            this._dragCleanup();\n            const stage = this.getStage();\n            if (!stage) {\n                return;\n            }\n            const dragElement = DragAndDrop_1.DD._dragElements.get(this._id);\n            const isDragging = dragElement && dragElement.dragStatus === 'dragging';\n            const isReady = dragElement && dragElement.dragStatus === 'ready';\n            if (isDragging) {\n                this.stopDrag();\n            }\n            else if (isReady) {\n                DragAndDrop_1.DD._dragElements.delete(this._id);\n            }\n        }\n    }\n    _dragCleanup() {\n        this.off('mousedown.konva');\n        this.off('touchstart.konva');\n    }\n    isClientRectOnScreen(margin = { x: 0, y: 0 }) {\n        const stage = this.getStage();\n        if (!stage) {\n            return false;\n        }\n        const screenRect = {\n            x: -margin.x,\n            y: -margin.y,\n            width: stage.width() + 2 * margin.x,\n            height: stage.height() + 2 * margin.y,\n        };\n        return Util_1.Util.haveIntersection(screenRect, this.getClientRect());\n    }\n    static create(data, container) {\n        if (Util_1.Util._isString(data)) {\n            data = JSON.parse(data);\n        }\n        return this._createNode(data, container);\n    }\n    static _createNode(obj, container) {\n        let className = Node.prototype.getClassName.call(obj), children = obj.children, no, len, n;\n        if (container) {\n            obj.attrs.container = container;\n        }\n        if (!Global_1.Konva[className]) {\n            Util_1.Util.warn('Can not find a node with class name \"' +\n                className +\n                '\". Fallback to \"Shape\".');\n            className = 'Shape';\n        }\n        const Class = Global_1.Konva[className];\n        no = new Class(obj.attrs);\n        if (children) {\n            len = children.length;\n            for (n = 0; n < len; n++) {\n                no.add(Node._createNode(children[n]));\n            }\n        }\n        return no;\n    }\n}\nexports.Node = Node;\nNode.prototype.nodeType = 'Node';\nNode.prototype._attrsAffectingSize = [];\nNode.prototype.eventListeners = {};\nNode.prototype.on.call(Node.prototype, TRANSFORM_CHANGE_STR, function () {\n    if (this._batchingTransformChange) {\n        this._needClearTransformCache = true;\n        return;\n    }\n    this._clearCache(TRANSFORM);\n    this._clearSelfAndDescendantCache(ABSOLUTE_TRANSFORM);\n});\nNode.prototype.on.call(Node.prototype, 'visibleChange.konva', function () {\n    this._clearSelfAndDescendantCache(VISIBLE);\n});\nNode.prototype.on.call(Node.prototype, 'listeningChange.konva', function () {\n    this._clearSelfAndDescendantCache(LISTENING);\n});\nNode.prototype.on.call(Node.prototype, 'opacityChange.konva', function () {\n    this._clearSelfAndDescendantCache(ABSOLUTE_OPACITY);\n});\nconst addGetterSetter = Factory_1.Factory.addGetterSetter;\naddGetterSetter(Node, 'zIndex');\naddGetterSetter(Node, 'absolutePosition');\naddGetterSetter(Node, 'position');\naddGetterSetter(Node, 'x', 0, (0, Validators_1.getNumberValidator)());\naddGetterSetter(Node, 'y', 0, (0, Validators_1.getNumberValidator)());\naddGetterSetter(Node, 'globalCompositeOperation', 'source-over', (0, Validators_1.getStringValidator)());\naddGetterSetter(Node, 'opacity', 1, (0, Validators_1.getNumberValidator)());\naddGetterSetter(Node, 'name', '', (0, Validators_1.getStringValidator)());\naddGetterSetter(Node, 'id', '', (0, Validators_1.getStringValidator)());\naddGetterSetter(Node, 'rotation', 0, (0, Validators_1.getNumberValidator)());\nFactory_1.Factory.addComponentsGetterSetter(Node, 'scale', ['x', 'y']);\naddGetterSetter(Node, 'scaleX', 1, (0, Validators_1.getNumberValidator)());\naddGetterSetter(Node, 'scaleY', 1, (0, Validators_1.getNumberValidator)());\nFactory_1.Factory.addComponentsGetterSetter(Node, 'skew', ['x', 'y']);\naddGetterSetter(Node, 'skewX', 0, (0, Validators_1.getNumberValidator)());\naddGetterSetter(Node, 'skewY', 0, (0, Validators_1.getNumberValidator)());\nFactory_1.Factory.addComponentsGetterSetter(Node, 'offset', ['x', 'y']);\naddGetterSetter(Node, 'offsetX', 0, (0, Validators_1.getNumberValidator)());\naddGetterSetter(Node, 'offsetY', 0, (0, Validators_1.getNumberValidator)());\naddGetterSetter(Node, 'dragDistance', undefined, (0, Validators_1.getNumberValidator)());\naddGetterSetter(Node, 'width', 0, (0, Validators_1.getNumberValidator)());\naddGetterSetter(Node, 'height', 0, (0, Validators_1.getNumberValidator)());\naddGetterSetter(Node, 'listening', true, (0, Validators_1.getBooleanValidator)());\naddGetterSetter(Node, 'preventDefault', true, (0, Validators_1.getBooleanValidator)());\naddGetterSetter(Node, 'filters', undefined, function (val) {\n    this._filterUpToDate = false;\n    return val;\n});\naddGetterSetter(Node, 'visible', true, (0, Validators_1.getBooleanValidator)());\naddGetterSetter(Node, 'transformsEnabled', 'all', (0, Validators_1.getStringValidator)());\naddGetterSetter(Node, 'size');\naddGetterSetter(Node, 'dragBoundFunc');\naddGetterSetter(Node, 'draggable', false, (0, Validators_1.getBooleanValidator)());\nFactory_1.Factory.backCompat(Node, {\n    rotateDeg: 'rotate',\n    setRotationDeg: 'setRotation',\n    getRotationDeg: 'getRotation',\n});\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Container = void 0;\nconst Factory_1 = require(\"./Factory\");\nconst Node_1 = require(\"./Node\");\nconst Validators_1 = require(\"./Validators\");\nclass Container extends Node_1.Node {\n    constructor() {\n        super(...arguments);\n        this.children = [];\n    }\n    getChildren(filterFunc) {\n        const children = this.children || [];\n        if (filterFunc) {\n            return children.filter(filterFunc);\n        }\n        return children;\n    }\n    hasChildren() {\n        return this.getChildren().length > 0;\n    }\n    removeChildren() {\n        this.getChildren().forEach((child) => {\n            child.parent = null;\n            child.index = 0;\n            child.remove();\n        });\n        this.children = [];\n        this._requestDraw();\n        return this;\n    }\n    destroyChildren() {\n        this.getChildren().forEach((child) => {\n            child.parent = null;\n            child.index = 0;\n            child.destroy();\n        });\n        this.children = [];\n        this._requestDraw();\n        return this;\n    }\n    add(...children) {\n        if (children.length === 0) {\n            return this;\n        }\n        if (children.length > 1) {\n            for (let i = 0; i < children.length; i++) {\n                this.add(children[i]);\n            }\n            return this;\n        }\n        const child = children[0];\n        if (child.getParent()) {\n            child.moveTo(this);\n            return this;\n        }\n        this._validateAdd(child);\n        child.index = this.getChildren().length;\n        child.parent = this;\n        child._clearCaches();\n        this.getChildren().push(child);\n        this._fire('add', {\n            child: child,\n        });\n        this._requestDraw();\n        return this;\n    }\n    destroy() {\n        if (this.hasChildren()) {\n            this.destroyChildren();\n        }\n        super.destroy();\n        return this;\n    }\n    find(selector) {\n        return this._generalFind(selector, false);\n    }\n    findOne(selector) {\n        const result = this._generalFind(selector, true);\n        return result.length > 0 ? result[0] : undefined;\n    }\n    _generalFind(selector, findOne) {\n        const retArr = [];\n        this._descendants((node) => {\n            const valid = node._isMatch(selector);\n            if (valid) {\n                retArr.push(node);\n            }\n            if (valid && findOne) {\n                return true;\n            }\n            return false;\n        });\n        return retArr;\n    }\n    _descendants(fn) {\n        let shouldStop = false;\n        const children = this.getChildren();\n        for (const child of children) {\n            shouldStop = fn(child);\n            if (shouldStop) {\n                return true;\n            }\n            if (!child.hasChildren()) {\n                continue;\n            }\n            shouldStop = child._descendants(fn);\n            if (shouldStop) {\n                return true;\n            }\n        }\n        return false;\n    }\n    toObject() {\n        const obj = Node_1.Node.prototype.toObject.call(this);\n        obj.children = [];\n        this.getChildren().forEach((child) => {\n            obj.children.push(child.toObject());\n        });\n        return obj;\n    }\n    isAncestorOf(node) {\n        let parent = node.getParent();\n        while (parent) {\n            if (parent._id === this._id) {\n                return true;\n            }\n            parent = parent.getParent();\n        }\n        return false;\n    }\n    clone(obj) {\n        const node = Node_1.Node.prototype.clone.call(this, obj);\n        this.getChildren().forEach(function (no) {\n            node.add(no.clone());\n        });\n        return node;\n    }\n    getAllIntersections(pos) {\n        const arr = [];\n        this.find('Shape').forEach((shape) => {\n            if (shape.isVisible() && shape.intersects(pos)) {\n                arr.push(shape);\n            }\n        });\n        return arr;\n    }\n    _clearSelfAndDescendantCache(attr) {\n        var _a;\n        super._clearSelfAndDescendantCache(attr);\n        if (this.isCached()) {\n            return;\n        }\n        (_a = this.children) === null || _a === void 0 ? void 0 : _a.forEach(function (node) {\n            node._clearSelfAndDescendantCache(attr);\n        });\n    }\n    _setChildrenIndices() {\n        var _a;\n        (_a = this.children) === null || _a === void 0 ? void 0 : _a.forEach(function (child, n) {\n            child.index = n;\n        });\n        this._requestDraw();\n    }\n    drawScene(can, top, bufferCanvas) {\n        const layer = this.getLayer(), canvas = can || (layer && layer.getCanvas()), context = canvas && canvas.getContext(), cachedCanvas = this._getCanvasCache(), cachedSceneCanvas = cachedCanvas && cachedCanvas.scene;\n        const caching = canvas && canvas.isCache;\n        if (!this.isVisible() && !caching) {\n            return this;\n        }\n        if (cachedSceneCanvas) {\n            context.save();\n            const m = this.getAbsoluteTransform(top).getMatrix();\n            context.transform(m[0], m[1], m[2], m[3], m[4], m[5]);\n            this._drawCachedSceneCanvas(context);\n            context.restore();\n        }\n        else {\n            this._drawChildren('drawScene', canvas, top, bufferCanvas);\n        }\n        return this;\n    }\n    drawHit(can, top) {\n        if (!this.shouldDrawHit(top)) {\n            return this;\n        }\n        const layer = this.getLayer(), canvas = can || (layer && layer.hitCanvas), context = canvas && canvas.getContext(), cachedCanvas = this._getCanvasCache(), cachedHitCanvas = cachedCanvas && cachedCanvas.hit;\n        if (cachedHitCanvas) {\n            context.save();\n            const m = this.getAbsoluteTransform(top).getMatrix();\n            context.transform(m[0], m[1], m[2], m[3], m[4], m[5]);\n            this._drawCachedHitCanvas(context);\n            context.restore();\n        }\n        else {\n            this._drawChildren('drawHit', canvas, top);\n        }\n        return this;\n    }\n    _drawChildren(drawMethod, canvas, top, bufferCanvas) {\n        var _a;\n        const context = canvas && canvas.getContext(), clipWidth = this.clipWidth(), clipHeight = this.clipHeight(), clipFunc = this.clipFunc(), hasClip = (typeof clipWidth === 'number' && typeof clipHeight === 'number') ||\n            clipFunc;\n        const selfCache = top === this;\n        if (hasClip) {\n            context.save();\n            const transform = this.getAbsoluteTransform(top);\n            let m = transform.getMatrix();\n            context.transform(m[0], m[1], m[2], m[3], m[4], m[5]);\n            context.beginPath();\n            let clipArgs;\n            if (clipFunc) {\n                clipArgs = clipFunc.call(this, context, this);\n            }\n            else {\n                const clipX = this.clipX();\n                const clipY = this.clipY();\n                context.rect(clipX || 0, clipY || 0, clipWidth, clipHeight);\n            }\n            context.clip.apply(context, clipArgs);\n            m = transform.copy().invert().getMatrix();\n            context.transform(m[0], m[1], m[2], m[3], m[4], m[5]);\n        }\n        const hasComposition = !selfCache &&\n            this.globalCompositeOperation() !== 'source-over' &&\n            drawMethod === 'drawScene';\n        if (hasComposition) {\n            context.save();\n            context._applyGlobalCompositeOperation(this);\n        }\n        (_a = this.children) === null || _a === void 0 ? void 0 : _a.forEach(function (child) {\n            child[drawMethod](canvas, top, bufferCanvas);\n        });\n        if (hasComposition) {\n            context.restore();\n        }\n        if (hasClip) {\n            context.restore();\n        }\n    }\n    getClientRect(config = {}) {\n        var _a;\n        const skipTransform = config.skipTransform;\n        const relativeTo = config.relativeTo;\n        let minX, minY, maxX, maxY;\n        let selfRect = {\n            x: Infinity,\n            y: Infinity,\n            width: 0,\n            height: 0,\n        };\n        const that = this;\n        (_a = this.children) === null || _a === void 0 ? void 0 : _a.forEach(function (child) {\n            if (!child.visible()) {\n                return;\n            }\n            const rect = child.getClientRect({\n                relativeTo: that,\n                skipShadow: config.skipShadow,\n                skipStroke: config.skipStroke,\n            });\n            if (rect.width === 0 && rect.height === 0) {\n                return;\n            }\n            if (minX === undefined) {\n                minX = rect.x;\n                minY = rect.y;\n                maxX = rect.x + rect.width;\n                maxY = rect.y + rect.height;\n            }\n            else {\n                minX = Math.min(minX, rect.x);\n                minY = Math.min(minY, rect.y);\n                maxX = Math.max(maxX, rect.x + rect.width);\n                maxY = Math.max(maxY, rect.y + rect.height);\n            }\n        });\n        const shapes = this.find('Shape');\n        let hasVisible = false;\n        for (let i = 0; i < shapes.length; i++) {\n            const shape = shapes[i];\n            if (shape._isVisible(this)) {\n                hasVisible = true;\n                break;\n            }\n        }\n        if (hasVisible && minX !== undefined) {\n            selfRect = {\n                x: minX,\n                y: minY,\n                width: maxX - minX,\n                height: maxY - minY,\n            };\n        }\n        else {\n            selfRect = {\n                x: 0,\n                y: 0,\n                width: 0,\n                height: 0,\n            };\n        }\n        if (!skipTransform) {\n            return this._transformedRect(selfRect, relativeTo);\n        }\n        return selfRect;\n    }\n}\nexports.Container = Container;\nFactory_1.Factory.addComponentsGetterSetter(Container, 'clip', [\n    'x',\n    'y',\n    'width',\n    'height',\n]);\nFactory_1.Factory.addGetterSetter(Container, 'clipX', undefined, (0, Validators_1.getNumberValidator)());\nFactory_1.Factory.addGetterSetter(Container, 'clipY', undefined, (0, Validators_1.getNumberValidator)());\nFactory_1.Factory.addGetterSetter(Container, 'clipWidth', undefined, (0, Validators_1.getNumberValidator)());\nFactory_1.Factory.addGetterSetter(Container, 'clipHeight', undefined, (0, Validators_1.getNumberValidator)());\nFactory_1.Factory.addGetterSetter(Container, 'clipFunc');\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getCapturedShape = getCapturedShape;\nexports.createEvent = createEvent;\nexports.hasPointerCapture = hasPointerCapture;\nexports.setPointerCapture = setPointerCapture;\nexports.releaseCapture = releaseCapture;\nconst Global_1 = require(\"./Global\");\nconst Captures = new Map();\nconst SUPPORT_POINTER_EVENTS = Global_1.Konva._global['PointerEvent'] !== undefined;\nfunction getCapturedShape(pointerId) {\n    return Captures.get(pointerId);\n}\nfunction createEvent(evt) {\n    return {\n        evt,\n        pointerId: evt.pointerId,\n    };\n}\nfunction hasPointerCapture(pointerId, shape) {\n    return Captures.get(pointerId) === shape;\n}\nfunction setPointerCapture(pointerId, shape) {\n    releaseCapture(pointerId);\n    const stage = shape.getStage();\n    if (!stage)\n        return;\n    Captures.set(pointerId, shape);\n    if (SUPPORT_POINTER_EVENTS) {\n        shape._fire('gotpointercapture', createEvent(new PointerEvent('gotpointercapture')));\n    }\n}\nfunction releaseCapture(pointerId, target) {\n    const shape = Captures.get(pointerId);\n    if (!shape)\n        return;\n    const stage = shape.getStage();\n    if (stage && stage.content) {\n    }\n    Captures.delete(pointerId);\n    if (SUPPORT_POINTER_EVENTS) {\n        shape._fire('lostpointercapture', createEvent(new PointerEvent('lostpointercapture')));\n    }\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Shape = exports.shapes = void 0;\nconst Global_1 = require(\"./Global\");\nconst Util_1 = require(\"./Util\");\nconst Factory_1 = require(\"./Factory\");\nconst Node_1 = require(\"./Node\");\nconst Validators_1 = require(\"./Validators\");\nconst Global_2 = require(\"./Global\");\nconst PointerEvents = require(\"./PointerEvents\");\nconst HAS_SHADOW = 'hasShadow';\nconst SHADOW_RGBA = 'shadowRGBA';\nconst patternImage = 'patternImage';\nconst linearGradient = 'linearGradient';\nconst radialGradient = 'radialGradient';\nlet dummyContext;\nfunction getDummyContext() {\n    if (dummyContext) {\n        return dummyContext;\n    }\n    dummyContext = Util_1.Util.createCanvasElement().getContext('2d');\n    return dummyContext;\n}\nexports.shapes = {};\nfunction _fillFunc(context) {\n    const fillRule = this.attrs.fillRule;\n    if (fillRule) {\n        context.fill(fillRule);\n    }\n    else {\n        context.fill();\n    }\n}\nfunction _strokeFunc(context) {\n    context.stroke();\n}\nfunction _fillFuncHit(context) {\n    const fillRule = this.attrs.fillRule;\n    if (fillRule) {\n        context.fill(fillRule);\n    }\n    else {\n        context.fill();\n    }\n}\nfunction _strokeFuncHit(context) {\n    context.stroke();\n}\nfunction _clearHasShadowCache() {\n    this._clearCache(HAS_SHADOW);\n}\nfunction _clearGetShadowRGBACache() {\n    this._clearCache(SHADOW_RGBA);\n}\nfunction _clearFillPatternCache() {\n    this._clearCache(patternImage);\n}\nfunction _clearLinearGradientCache() {\n    this._clearCache(linearGradient);\n}\nfunction _clearRadialGradientCache() {\n    this._clearCache(radialGradient);\n}\nclass Shape extends Node_1.Node {\n    constructor(config) {\n        super(config);\n        let key;\n        while (true) {\n            key = Util_1.Util.getRandomColor();\n            if (key && !(key in exports.shapes)) {\n                break;\n            }\n        }\n        this.colorKey = key;\n        exports.shapes[key] = this;\n    }\n    getContext() {\n        Util_1.Util.warn('shape.getContext() method is deprecated. Please do not use it.');\n        return this.getLayer().getContext();\n    }\n    getCanvas() {\n        Util_1.Util.warn('shape.getCanvas() method is deprecated. Please do not use it.');\n        return this.getLayer().getCanvas();\n    }\n    getSceneFunc() {\n        return this.attrs.sceneFunc || this['_sceneFunc'];\n    }\n    getHitFunc() {\n        return this.attrs.hitFunc || this['_hitFunc'];\n    }\n    hasShadow() {\n        return this._getCache(HAS_SHADOW, this._hasShadow);\n    }\n    _hasShadow() {\n        return (this.shadowEnabled() &&\n            this.shadowOpacity() !== 0 &&\n            !!(this.shadowColor() ||\n                this.shadowBlur() ||\n                this.shadowOffsetX() ||\n                this.shadowOffsetY()));\n    }\n    _getFillPattern() {\n        return this._getCache(patternImage, this.__getFillPattern);\n    }\n    __getFillPattern() {\n        if (this.fillPatternImage()) {\n            const ctx = getDummyContext();\n            const pattern = ctx.createPattern(this.fillPatternImage(), this.fillPatternRepeat() || 'repeat');\n            if (pattern && pattern.setTransform) {\n                const tr = new Util_1.Transform();\n                tr.translate(this.fillPatternX(), this.fillPatternY());\n                tr.rotate(Global_1.Konva.getAngle(this.fillPatternRotation()));\n                tr.scale(this.fillPatternScaleX(), this.fillPatternScaleY());\n                tr.translate(-1 * this.fillPatternOffsetX(), -1 * this.fillPatternOffsetY());\n                const m = tr.getMatrix();\n                const matrix = typeof DOMMatrix === 'undefined'\n                    ? {\n                        a: m[0],\n                        b: m[1],\n                        c: m[2],\n                        d: m[3],\n                        e: m[4],\n                        f: m[5],\n                    }\n                    : new DOMMatrix(m);\n                pattern.setTransform(matrix);\n            }\n            return pattern;\n        }\n    }\n    _getLinearGradient() {\n        return this._getCache(linearGradient, this.__getLinearGradient);\n    }\n    __getLinearGradient() {\n        const colorStops = this.fillLinearGradientColorStops();\n        if (colorStops) {\n            const ctx = getDummyContext();\n            const start = this.fillLinearGradientStartPoint();\n            const end = this.fillLinearGradientEndPoint();\n            const grd = ctx.createLinearGradient(start.x, start.y, end.x, end.y);\n            for (let n = 0; n < colorStops.length; n += 2) {\n                grd.addColorStop(colorStops[n], colorStops[n + 1]);\n            }\n            return grd;\n        }\n    }\n    _getRadialGradient() {\n        return this._getCache(radialGradient, this.__getRadialGradient);\n    }\n    __getRadialGradient() {\n        const colorStops = this.fillRadialGradientColorStops();\n        if (colorStops) {\n            const ctx = getDummyContext();\n            const start = this.fillRadialGradientStartPoint();\n            const end = this.fillRadialGradientEndPoint();\n            const grd = ctx.createRadialGradient(start.x, start.y, this.fillRadialGradientStartRadius(), end.x, end.y, this.fillRadialGradientEndRadius());\n            for (let n = 0; n < colorStops.length; n += 2) {\n                grd.addColorStop(colorStops[n], colorStops[n + 1]);\n            }\n            return grd;\n        }\n    }\n    getShadowRGBA() {\n        return this._getCache(SHADOW_RGBA, this._getShadowRGBA);\n    }\n    _getShadowRGBA() {\n        if (!this.hasShadow()) {\n            return;\n        }\n        const rgba = Util_1.Util.colorToRGBA(this.shadowColor());\n        if (rgba) {\n            return ('rgba(' +\n                rgba.r +\n                ',' +\n                rgba.g +\n                ',' +\n                rgba.b +\n                ',' +\n                rgba.a * (this.shadowOpacity() || 1) +\n                ')');\n        }\n    }\n    hasFill() {\n        return this._calculate('hasFill', [\n            'fillEnabled',\n            'fill',\n            'fillPatternImage',\n            'fillLinearGradientColorStops',\n            'fillRadialGradientColorStops',\n        ], () => {\n            return (this.fillEnabled() &&\n                !!(this.fill() ||\n                    this.fillPatternImage() ||\n                    this.fillLinearGradientColorStops() ||\n                    this.fillRadialGradientColorStops()));\n        });\n    }\n    hasStroke() {\n        return this._calculate('hasStroke', [\n            'strokeEnabled',\n            'strokeWidth',\n            'stroke',\n            'strokeLinearGradientColorStops',\n        ], () => {\n            return (this.strokeEnabled() &&\n                this.strokeWidth() &&\n                !!(this.stroke() || this.strokeLinearGradientColorStops()));\n        });\n    }\n    hasHitStroke() {\n        const width = this.hitStrokeWidth();\n        if (width === 'auto') {\n            return this.hasStroke();\n        }\n        return this.strokeEnabled() && !!width;\n    }\n    intersects(point) {\n        const stage = this.getStage();\n        if (!stage) {\n            return false;\n        }\n        const bufferHitCanvas = stage.bufferHitCanvas;\n        bufferHitCanvas.getContext().clear();\n        this.drawHit(bufferHitCanvas, undefined, true);\n        const p = bufferHitCanvas.context.getImageData(Math.round(point.x), Math.round(point.y), 1, 1).data;\n        return p[3] > 0;\n    }\n    destroy() {\n        Node_1.Node.prototype.destroy.call(this);\n        delete exports.shapes[this.colorKey];\n        delete this.colorKey;\n        return this;\n    }\n    _useBufferCanvas(forceFill) {\n        var _a;\n        const perfectDrawEnabled = (_a = this.attrs.perfectDrawEnabled) !== null && _a !== void 0 ? _a : true;\n        if (!perfectDrawEnabled) {\n            return false;\n        }\n        const hasFill = forceFill || this.hasFill();\n        const hasStroke = this.hasStroke();\n        const isTransparent = this.getAbsoluteOpacity() !== 1;\n        if (hasFill && hasStroke && isTransparent) {\n            return true;\n        }\n        const hasShadow = this.hasShadow();\n        const strokeForShadow = this.shadowForStrokeEnabled();\n        if (hasFill && hasStroke && hasShadow && strokeForShadow) {\n            return true;\n        }\n        return false;\n    }\n    setStrokeHitEnabled(val) {\n        Util_1.Util.warn('strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead.');\n        if (val) {\n            this.hitStrokeWidth('auto');\n        }\n        else {\n            this.hitStrokeWidth(0);\n        }\n    }\n    getStrokeHitEnabled() {\n        if (this.hitStrokeWidth() === 0) {\n            return false;\n        }\n        else {\n            return true;\n        }\n    }\n    getSelfRect() {\n        const size = this.size();\n        return {\n            x: this._centroid ? -size.width / 2 : 0,\n            y: this._centroid ? -size.height / 2 : 0,\n            width: size.width,\n            height: size.height,\n        };\n    }\n    getClientRect(config = {}) {\n        let hasCachedParent = false;\n        let parent = this.getParent();\n        while (parent) {\n            if (parent.isCached()) {\n                hasCachedParent = true;\n                break;\n            }\n            parent = parent.getParent();\n        }\n        const skipTransform = config.skipTransform;\n        const relativeTo = config.relativeTo || (hasCachedParent && this.getStage()) || undefined;\n        const fillRect = this.getSelfRect();\n        const applyStroke = !config.skipStroke && this.hasStroke();\n        const strokeWidth = (applyStroke && this.strokeWidth()) || 0;\n        const fillAndStrokeWidth = fillRect.width + strokeWidth;\n        const fillAndStrokeHeight = fillRect.height + strokeWidth;\n        const applyShadow = !config.skipShadow && this.hasShadow();\n        const shadowOffsetX = applyShadow ? this.shadowOffsetX() : 0;\n        const shadowOffsetY = applyShadow ? this.shadowOffsetY() : 0;\n        const preWidth = fillAndStrokeWidth + Math.abs(shadowOffsetX);\n        const preHeight = fillAndStrokeHeight + Math.abs(shadowOffsetY);\n        const blurRadius = (applyShadow && this.shadowBlur()) || 0;\n        const width = preWidth + blurRadius * 2;\n        const height = preHeight + blurRadius * 2;\n        const rect = {\n            width: width,\n            height: height,\n            x: -(strokeWidth / 2 + blurRadius) +\n                Math.min(shadowOffsetX, 0) +\n                fillRect.x,\n            y: -(strokeWidth / 2 + blurRadius) +\n                Math.min(shadowOffsetY, 0) +\n                fillRect.y,\n        };\n        if (!skipTransform) {\n            return this._transformedRect(rect, relativeTo);\n        }\n        return rect;\n    }\n    drawScene(can, top, bufferCanvas) {\n        const layer = this.getLayer();\n        const canvas = can || layer.getCanvas(), context = canvas.getContext(), cachedCanvas = this._getCanvasCache(), drawFunc = this.getSceneFunc(), hasShadow = this.hasShadow();\n        let stage;\n        const skipBuffer = false;\n        const cachingSelf = top === this;\n        if (!this.isVisible() && !cachingSelf) {\n            return this;\n        }\n        if (cachedCanvas) {\n            context.save();\n            const m = this.getAbsoluteTransform(top).getMatrix();\n            context.transform(m[0], m[1], m[2], m[3], m[4], m[5]);\n            this._drawCachedSceneCanvas(context);\n            context.restore();\n            return this;\n        }\n        if (!drawFunc) {\n            return this;\n        }\n        context.save();\n        if (this._useBufferCanvas() && !skipBuffer) {\n            stage = this.getStage();\n            const bc = bufferCanvas || stage.bufferCanvas;\n            const bufferContext = bc.getContext();\n            bufferContext.clear();\n            bufferContext.save();\n            bufferContext._applyLineJoin(this);\n            const o = this.getAbsoluteTransform(top).getMatrix();\n            bufferContext.transform(o[0], o[1], o[2], o[3], o[4], o[5]);\n            drawFunc.call(this, bufferContext, this);\n            bufferContext.restore();\n            const ratio = bc.pixelRatio;\n            if (hasShadow) {\n                context._applyShadow(this);\n            }\n            context._applyOpacity(this);\n            context._applyGlobalCompositeOperation(this);\n            context.drawImage(bc._canvas, bc.x || 0, bc.y || 0, bc.width / ratio, bc.height / ratio);\n        }\n        else {\n            context._applyLineJoin(this);\n            if (!cachingSelf) {\n                const o = this.getAbsoluteTransform(top).getMatrix();\n                context.transform(o[0], o[1], o[2], o[3], o[4], o[5]);\n                context._applyOpacity(this);\n                context._applyGlobalCompositeOperation(this);\n            }\n            if (hasShadow) {\n                context._applyShadow(this);\n            }\n            drawFunc.call(this, context, this);\n        }\n        context.restore();\n        return this;\n    }\n    drawHit(can, top, skipDragCheck = false) {\n        if (!this.shouldDrawHit(top, skipDragCheck)) {\n            return this;\n        }\n        const layer = this.getLayer(), canvas = can || layer.hitCanvas, context = canvas && canvas.getContext(), drawFunc = this.hitFunc() || this.sceneFunc(), cachedCanvas = this._getCanvasCache(), cachedHitCanvas = cachedCanvas && cachedCanvas.hit;\n        if (!this.colorKey) {\n            Util_1.Util.warn('Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()');\n        }\n        if (cachedHitCanvas) {\n            context.save();\n            const m = this.getAbsoluteTransform(top).getMatrix();\n            context.transform(m[0], m[1], m[2], m[3], m[4], m[5]);\n            this._drawCachedHitCanvas(context);\n            context.restore();\n            return this;\n        }\n        if (!drawFunc) {\n            return this;\n        }\n        context.save();\n        context._applyLineJoin(this);\n        const selfCache = this === top;\n        if (!selfCache) {\n            const o = this.getAbsoluteTransform(top).getMatrix();\n            context.transform(o[0], o[1], o[2], o[3], o[4], o[5]);\n        }\n        drawFunc.call(this, context, this);\n        context.restore();\n        return this;\n    }\n    drawHitFromCache(alphaThreshold = 0) {\n        const cachedCanvas = this._getCanvasCache(), sceneCanvas = this._getCachedSceneCanvas(), hitCanvas = cachedCanvas.hit, hitContext = hitCanvas.getContext(), hitWidth = hitCanvas.getWidth(), hitHeight = hitCanvas.getHeight();\n        hitContext.clear();\n        hitContext.drawImage(sceneCanvas._canvas, 0, 0, hitWidth, hitHeight);\n        try {\n            const hitImageData = hitContext.getImageData(0, 0, hitWidth, hitHeight);\n            const hitData = hitImageData.data;\n            const len = hitData.length;\n            const rgbColorKey = Util_1.Util._hexToRgb(this.colorKey);\n            for (let i = 0; i < len; i += 4) {\n                const alpha = hitData[i + 3];\n                if (alpha > alphaThreshold) {\n                    hitData[i] = rgbColorKey.r;\n                    hitData[i + 1] = rgbColorKey.g;\n                    hitData[i + 2] = rgbColorKey.b;\n                    hitData[i + 3] = 255;\n                }\n                else {\n                    hitData[i + 3] = 0;\n                }\n            }\n            hitContext.putImageData(hitImageData, 0, 0);\n        }\n        catch (e) {\n            Util_1.Util.error('Unable to draw hit graph from cached scene canvas. ' + e.message);\n        }\n        return this;\n    }\n    hasPointerCapture(pointerId) {\n        return PointerEvents.hasPointerCapture(pointerId, this);\n    }\n    setPointerCapture(pointerId) {\n        PointerEvents.setPointerCapture(pointerId, this);\n    }\n    releaseCapture(pointerId) {\n        PointerEvents.releaseCapture(pointerId, this);\n    }\n}\nexports.Shape = Shape;\nShape.prototype._fillFunc = _fillFunc;\nShape.prototype._strokeFunc = _strokeFunc;\nShape.prototype._fillFuncHit = _fillFuncHit;\nShape.prototype._strokeFuncHit = _strokeFuncHit;\nShape.prototype._centroid = false;\nShape.prototype.nodeType = 'Shape';\n(0, Global_2._registerNode)(Shape);\nShape.prototype.eventListeners = {};\nShape.prototype.on.call(Shape.prototype, 'shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva', _clearHasShadowCache);\nShape.prototype.on.call(Shape.prototype, 'shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva', _clearGetShadowRGBACache);\nShape.prototype.on.call(Shape.prototype, 'fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva', _clearFillPatternCache);\nShape.prototype.on.call(Shape.prototype, 'fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva', _clearLinearGradientCache);\nShape.prototype.on.call(Shape.prototype, 'fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva', _clearRadialGradientCache);\nFactory_1.Factory.addGetterSetter(Shape, 'stroke', undefined, (0, Validators_1.getStringOrGradientValidator)());\nFactory_1.Factory.addGetterSetter(Shape, 'strokeWidth', 2, (0, Validators_1.getNumberValidator)());\nFactory_1.Factory.addGetterSetter(Shape, 'fillAfterStrokeEnabled', false);\nFactory_1.Factory.addGetterSetter(Shape, 'hitStrokeWidth', 'auto', (0, Validators_1.getNumberOrAutoValidator)());\nFactory_1.Factory.addGetterSetter(Shape, 'strokeHitEnabled', true, (0, Validators_1.getBooleanValidator)());\nFactory_1.Factory.addGetterSetter(Shape, 'perfectDrawEnabled', true, (0, Validators_1.getBooleanValidator)());\nFactory_1.Factory.addGetterSetter(Shape, 'shadowForStrokeEnabled', true, (0, Validators_1.getBooleanValidator)());\nFactory_1.Factory.addGetterSetter(Shape, 'lineJoin');\nFactory_1.Factory.addGetterSetter(Shape, 'lineCap');\nFactory_1.Factory.addGetterSetter(Shape, 'sceneFunc');\nFactory_1.Factory.addGetterSetter(Shape, 'hitFunc');\nFactory_1.Factory.addGetterSetter(Shape, 'dash');\nFactory_1.Factory.addGetterSetter(Shape, 'dashOffset', 0, (0, Validators_1.getNumberValidator)());\nFactory_1.Factory.addGetterSetter(Shape, 'shadowColor', undefined, (0, Validators_1.getStringValidator)());\nFactory_1.Factory.addGetterSetter(Shape, 'shadowBlur', 0, (0, Validators_1.getNumberValidator)());\nFactory_1.Factory.addGetterSetter(Shape, 'shadowOpacity', 1, (0, Validators_1.getNumberValidator)());\nFactory_1.Factory.addComponentsGetterSetter(Shape, 'shadowOffset', ['x', 'y']);\nFactory_1.Factory.addGetterSetter(Shape, 'shadowOffsetX', 0, (0, Validators_1.getNumberValidator)());\nFactory_1.Factory.addGetterSetter(Shape, 'shadowOffsetY', 0, (0, Validators_1.getNumberValidator)());\nFactory_1.Factory.addGetterSetter(Shape, 'fillPatternImage');\nFactory_1.Factory.addGetterSetter(Shape, 'fill', undefined, (0, Validators_1.getStringOrGradientValidator)());\nFactory_1.Factory.addGetterSetter(Shape, 'fillPatternX', 0, (0, Validators_1.getNumberValidator)());\nFactory_1.Factory.addGetterSetter(Shape, 'fillPatternY', 0, (0, Validators_1.getNumberValidator)());\nFactory_1.Factory.addGetterSetter(Shape, 'fillLinearGradientColorStops');\nFactory_1.Factory.addGetterSetter(Shape, 'strokeLinearGradientColorStops');\nFactory_1.Factory.addGetterSetter(Shape, 'fillRadialGradientStartRadius', 0);\nFactory_1.Factory.addGetterSetter(Shape, 'fillRadialGradientEndRadius', 0);\nFactory_1.Factory.addGetterSetter(Shape, 'fillRadialGradientColorStops');\nFactory_1.Factory.addGetterSetter(Shape, 'fillPatternRepeat', 'repeat');\nFactory_1.Factory.addGetterSetter(Shape, 'fillEnabled', true);\nFactory_1.Factory.addGetterSetter(Shape, 'strokeEnabled', true);\nFactory_1.Factory.addGetterSetter(Shape, 'shadowEnabled', true);\nFactory_1.Factory.addGetterSetter(Shape, 'dashEnabled', true);\nFactory_1.Factory.addGetterSetter(Shape, 'strokeScaleEnabled', true);\nFactory_1.Factory.addGetterSetter(Shape, 'fillPriority', 'color');\nFactory_1.Factory.addComponentsGetterSetter(Shape, 'fillPatternOffset', ['x', 'y']);\nFactory_1.Factory.addGetterSetter(Shape, 'fillPatternOffsetX', 0, (0, Validators_1.getNumberValidator)());\nFactory_1.Factory.addGetterSetter(Shape, 'fillPatternOffsetY', 0, (0, Validators_1.getNumberValidator)());\nFactory_1.Factory.addComponentsGetterSetter(Shape, 'fillPatternScale', ['x', 'y']);\nFactory_1.Factory.addGetterSetter(Shape, 'fillPatternScaleX', 1, (0, Validators_1.getNumberValidator)());\nFactory_1.Factory.addGetterSetter(Shape, 'fillPatternScaleY', 1, (0, Validators_1.getNumberValidator)());\nFactory_1.Factory.addComponentsGetterSetter(Shape, 'fillLinearGradientStartPoint', [\n    'x',\n    'y',\n]);\nFactory_1.Factory.addComponentsGetterSetter(Shape, 'strokeLinearGradientStartPoint', [\n    'x',\n    'y',\n]);\nFactory_1.Factory.addGetterSetter(Shape, 'fillLinearGradientStartPointX', 0);\nFactory_1.Factory.addGetterSetter(Shape, 'strokeLinearGradientStartPointX', 0);\nFactory_1.Factory.addGetterSetter(Shape, 'fillLinearGradientStartPointY', 0);\nFactory_1.Factory.addGetterSetter(Shape, 'strokeLinearGradientStartPointY', 0);\nFactory_1.Factory.addComponentsGetterSetter(Shape, 'fillLinearGradientEndPoint', [\n    'x',\n    'y',\n]);\nFactory_1.Factory.addComponentsGetterSetter(Shape, 'strokeLinearGradientEndPoint', [\n    'x',\n    'y',\n]);\nFactory_1.Factory.addGetterSetter(Shape, 'fillLinearGradientEndPointX', 0);\nFactory_1.Factory.addGetterSetter(Shape, 'strokeLinearGradientEndPointX', 0);\nFactory_1.Factory.addGetterSetter(Shape, 'fillLinearGradientEndPointY', 0);\nFactory_1.Factory.addGetterSetter(Shape, 'strokeLinearGradientEndPointY', 0);\nFactory_1.Factory.addComponentsGetterSetter(Shape, 'fillRadialGradientStartPoint', [\n    'x',\n    'y',\n]);\nFactory_1.Factory.addGetterSetter(Shape, 'fillRadialGradientStartPointX', 0);\nFactory_1.Factory.addGetterSetter(Shape, 'fillRadialGradientStartPointY', 0);\nFactory_1.Factory.addComponentsGetterSetter(Shape, 'fillRadialGradientEndPoint', [\n    'x',\n    'y',\n]);\nFactory_1.Factory.addGetterSetter(Shape, 'fillRadialGradientEndPointX', 0);\nFactory_1.Factory.addGetterSetter(Shape, 'fillRadialGradientEndPointY', 0);\nFactory_1.Factory.addGetterSetter(Shape, 'fillPatternRotation', 0);\nFactory_1.Factory.addGetterSetter(Shape, 'fillRule', undefined, (0, Validators_1.getStringValidator)());\nFactory_1.Factory.backCompat(Shape, {\n    dashArray: 'dash',\n    getDashArray: 'getDash',\n    setDashArray: 'getDash',\n    drawFunc: 'sceneFunc',\n    getDrawFunc: 'getSceneFunc',\n    setDrawFunc: 'setSceneFunc',\n    drawHitFunc: 'hitFunc',\n    getDrawHitFunc: 'getHitFunc',\n    setDrawHitFunc: 'setHitFunc',\n});\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Layer = void 0;\nconst Util_1 = require(\"./Util\");\nconst Container_1 = require(\"./Container\");\nconst Node_1 = require(\"./Node\");\nconst Factory_1 = require(\"./Factory\");\nconst Canvas_1 = require(\"./Canvas\");\nconst Validators_1 = require(\"./Validators\");\nconst Shape_1 = require(\"./Shape\");\nconst Global_1 = require(\"./Global\");\nconst HASH = '#', BEFORE_DRAW = 'beforeDraw', DRAW = 'draw', INTERSECTION_OFFSETS = [\n    { x: 0, y: 0 },\n    { x: -1, y: -1 },\n    { x: 1, y: -1 },\n    { x: 1, y: 1 },\n    { x: -1, y: 1 },\n], INTERSECTION_OFFSETS_LEN = INTERSECTION_OFFSETS.length;\nclass Layer extends Container_1.Container {\n    constructor(config) {\n        super(config);\n        this.canvas = new Canvas_1.SceneCanvas();\n        this.hitCanvas = new Canvas_1.HitCanvas({\n            pixelRatio: 1,\n        });\n        this._waitingForDraw = false;\n        this.on('visibleChange.konva', this._checkVisibility);\n        this._checkVisibility();\n        this.on('imageSmoothingEnabledChange.konva', this._setSmoothEnabled);\n        this._setSmoothEnabled();\n    }\n    createPNGStream() {\n        const c = this.canvas._canvas;\n        return c.createPNGStream();\n    }\n    getCanvas() {\n        return this.canvas;\n    }\n    getNativeCanvasElement() {\n        return this.canvas._canvas;\n    }\n    getHitCanvas() {\n        return this.hitCanvas;\n    }\n    getContext() {\n        return this.getCanvas().getContext();\n    }\n    clear(bounds) {\n        this.getContext().clear(bounds);\n        this.getHitCanvas().getContext().clear(bounds);\n        return this;\n    }\n    setZIndex(index) {\n        super.setZIndex(index);\n        const stage = this.getStage();\n        if (stage && stage.content) {\n            stage.content.removeChild(this.getNativeCanvasElement());\n            if (index < stage.children.length - 1) {\n                stage.content.insertBefore(this.getNativeCanvasElement(), stage.children[index + 1].getCanvas()._canvas);\n            }\n            else {\n                stage.content.appendChild(this.getNativeCanvasElement());\n            }\n        }\n        return this;\n    }\n    moveToTop() {\n        Node_1.Node.prototype.moveToTop.call(this);\n        const stage = this.getStage();\n        if (stage && stage.content) {\n            stage.content.removeChild(this.getNativeCanvasElement());\n            stage.content.appendChild(this.getNativeCanvasElement());\n        }\n        return true;\n    }\n    moveUp() {\n        const moved = Node_1.Node.prototype.moveUp.call(this);\n        if (!moved) {\n            return false;\n        }\n        const stage = this.getStage();\n        if (!stage || !stage.content) {\n            return false;\n        }\n        stage.content.removeChild(this.getNativeCanvasElement());\n        if (this.index < stage.children.length - 1) {\n            stage.content.insertBefore(this.getNativeCanvasElement(), stage.children[this.index + 1].getCanvas()._canvas);\n        }\n        else {\n            stage.content.appendChild(this.getNativeCanvasElement());\n        }\n        return true;\n    }\n    moveDown() {\n        if (Node_1.Node.prototype.moveDown.call(this)) {\n            const stage = this.getStage();\n            if (stage) {\n                const children = stage.children;\n                if (stage.content) {\n                    stage.content.removeChild(this.getNativeCanvasElement());\n                    stage.content.insertBefore(this.getNativeCanvasElement(), children[this.index + 1].getCanvas()._canvas);\n                }\n            }\n            return true;\n        }\n        return false;\n    }\n    moveToBottom() {\n        if (Node_1.Node.prototype.moveToBottom.call(this)) {\n            const stage = this.getStage();\n            if (stage) {\n                const children = stage.children;\n                if (stage.content) {\n                    stage.content.removeChild(this.getNativeCanvasElement());\n                    stage.content.insertBefore(this.getNativeCanvasElement(), children[1].getCanvas()._canvas);\n                }\n            }\n            return true;\n        }\n        return false;\n    }\n    getLayer() {\n        return this;\n    }\n    remove() {\n        const _canvas = this.getNativeCanvasElement();\n        Node_1.Node.prototype.remove.call(this);\n        if (_canvas && _canvas.parentNode && Util_1.Util._isInDocument(_canvas)) {\n            _canvas.parentNode.removeChild(_canvas);\n        }\n        return this;\n    }\n    getStage() {\n        return this.parent;\n    }\n    setSize({ width, height }) {\n        this.canvas.setSize(width, height);\n        this.hitCanvas.setSize(width, height);\n        this._setSmoothEnabled();\n        return this;\n    }\n    _validateAdd(child) {\n        const type = child.getType();\n        if (type !== 'Group' && type !== 'Shape') {\n            Util_1.Util.throw('You may only add groups and shapes to a layer.');\n        }\n    }\n    _toKonvaCanvas(config) {\n        config = config || {};\n        config.width = config.width || this.getWidth();\n        config.height = config.height || this.getHeight();\n        config.x = config.x !== undefined ? config.x : this.x();\n        config.y = config.y !== undefined ? config.y : this.y();\n        return Node_1.Node.prototype._toKonvaCanvas.call(this, config);\n    }\n    _checkVisibility() {\n        const visible = this.visible();\n        if (visible) {\n            this.canvas._canvas.style.display = 'block';\n        }\n        else {\n            this.canvas._canvas.style.display = 'none';\n        }\n    }\n    _setSmoothEnabled() {\n        this.getContext()._context.imageSmoothingEnabled =\n            this.imageSmoothingEnabled();\n    }\n    getWidth() {\n        if (this.parent) {\n            return this.parent.width();\n        }\n    }\n    setWidth() {\n        Util_1.Util.warn('Can not change width of layer. Use \"stage.width(value)\" function instead.');\n    }\n    getHeight() {\n        if (this.parent) {\n            return this.parent.height();\n        }\n    }\n    setHeight() {\n        Util_1.Util.warn('Can not change height of layer. Use \"stage.height(value)\" function instead.');\n    }\n    batchDraw() {\n        if (!this._waitingForDraw) {\n            this._waitingForDraw = true;\n            Util_1.Util.requestAnimFrame(() => {\n                this.draw();\n                this._waitingForDraw = false;\n            });\n        }\n        return this;\n    }\n    getIntersection(pos) {\n        if (!this.isListening() || !this.isVisible()) {\n            return null;\n        }\n        let spiralSearchDistance = 1;\n        let continueSearch = false;\n        while (true) {\n            for (let i = 0; i < INTERSECTION_OFFSETS_LEN; i++) {\n                const intersectionOffset = INTERSECTION_OFFSETS[i];\n                const obj = this._getIntersection({\n                    x: pos.x + intersectionOffset.x * spiralSearchDistance,\n                    y: pos.y + intersectionOffset.y * spiralSearchDistance,\n                });\n                const shape = obj.shape;\n                if (shape) {\n                    return shape;\n                }\n                continueSearch = !!obj.antialiased;\n                if (!obj.antialiased) {\n                    break;\n                }\n            }\n            if (continueSearch) {\n                spiralSearchDistance += 1;\n            }\n            else {\n                return null;\n            }\n        }\n    }\n    _getIntersection(pos) {\n        const ratio = this.hitCanvas.pixelRatio;\n        const p = this.hitCanvas.context.getImageData(Math.round(pos.x * ratio), Math.round(pos.y * ratio), 1, 1).data;\n        const p3 = p[3];\n        if (p3 === 255) {\n            const colorKey = Util_1.Util._rgbToHex(p[0], p[1], p[2]);\n            const shape = Shape_1.shapes[HASH + colorKey];\n            if (shape) {\n                return {\n                    shape: shape,\n                };\n            }\n            return {\n                antialiased: true,\n            };\n        }\n        else if (p3 > 0) {\n            return {\n                antialiased: true,\n            };\n        }\n        return {};\n    }\n    drawScene(can, top, bufferCanvas) {\n        const layer = this.getLayer(), canvas = can || (layer && layer.getCanvas());\n        this._fire(BEFORE_DRAW, {\n            node: this,\n        });\n        if (this.clearBeforeDraw()) {\n            canvas.getContext().clear();\n        }\n        Container_1.Container.prototype.drawScene.call(this, canvas, top, bufferCanvas);\n        this._fire(DRAW, {\n            node: this,\n        });\n        return this;\n    }\n    drawHit(can, top) {\n        const layer = this.getLayer(), canvas = can || (layer && layer.hitCanvas);\n        if (layer && layer.clearBeforeDraw()) {\n            layer.getHitCanvas().getContext().clear();\n        }\n        Container_1.Container.prototype.drawHit.call(this, canvas, top);\n        return this;\n    }\n    enableHitGraph() {\n        this.hitGraphEnabled(true);\n        return this;\n    }\n    disableHitGraph() {\n        this.hitGraphEnabled(false);\n        return this;\n    }\n    setHitGraphEnabled(val) {\n        Util_1.Util.warn('hitGraphEnabled method is deprecated. Please use layer.listening() instead.');\n        this.listening(val);\n    }\n    getHitGraphEnabled(val) {\n        Util_1.Util.warn('hitGraphEnabled method is deprecated. Please use layer.listening() instead.');\n        return this.listening();\n    }\n    toggleHitCanvas() {\n        if (!this.parent || !this.parent['content']) {\n            return;\n        }\n        const parent = this.parent;\n        const added = !!this.hitCanvas._canvas.parentNode;\n        if (added) {\n            parent.content.removeChild(this.hitCanvas._canvas);\n        }\n        else {\n            parent.content.appendChild(this.hitCanvas._canvas);\n        }\n    }\n    destroy() {\n        Util_1.Util.releaseCanvas(this.getNativeCanvasElement(), this.getHitCanvas()._canvas);\n        return super.destroy();\n    }\n}\nexports.Layer = Layer;\nLayer.prototype.nodeType = 'Layer';\n(0, Global_1._registerNode)(Layer);\nFactory_1.Factory.addGetterSetter(Layer, 'imageSmoothingEnabled', true);\nFactory_1.Factory.addGetterSetter(Layer, 'clearBeforeDraw', true);\nFactory_1.Factory.addGetterSetter(Layer, 'hitGraphEnabled', true, (0, Validators_1.getBooleanValidator)());\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Animation = void 0;\nconst Global_1 = require(\"./Global\");\nconst Util_1 = require(\"./Util\");\nconst now = (function () {\n    if (Global_1.glob.performance && Global_1.glob.performance.now) {\n        return function () {\n            return Global_1.glob.performance.now();\n        };\n    }\n    return function () {\n        return new Date().getTime();\n    };\n})();\nclass Animation {\n    constructor(func, layers) {\n        this.id = Animation.animIdCounter++;\n        this.frame = {\n            time: 0,\n            timeDiff: 0,\n            lastTime: now(),\n            frameRate: 0,\n        };\n        this.func = func;\n        this.setLayers(layers);\n    }\n    setLayers(layers) {\n        let lays = [];\n        if (layers) {\n            lays = Array.isArray(layers) ? layers : [layers];\n        }\n        this.layers = lays;\n        return this;\n    }\n    getLayers() {\n        return this.layers;\n    }\n    addLayer(layer) {\n        const layers = this.layers;\n        const len = layers.length;\n        for (let n = 0; n < len; n++) {\n            if (layers[n]._id === layer._id) {\n                return false;\n            }\n        }\n        this.layers.push(layer);\n        return true;\n    }\n    isRunning() {\n        const a = Animation;\n        const animations = a.animations;\n        const len = animations.length;\n        for (let n = 0; n < len; n++) {\n            if (animations[n].id === this.id) {\n                return true;\n            }\n        }\n        return false;\n    }\n    start() {\n        this.stop();\n        this.frame.timeDiff = 0;\n        this.frame.lastTime = now();\n        Animation._addAnimation(this);\n        return this;\n    }\n    stop() {\n        Animation._removeAnimation(this);\n        return this;\n    }\n    _updateFrameObject(time) {\n        this.frame.timeDiff = time - this.frame.lastTime;\n        this.frame.lastTime = time;\n        this.frame.time += this.frame.timeDiff;\n        this.frame.frameRate = 1000 / this.frame.timeDiff;\n    }\n    static _addAnimation(anim) {\n        this.animations.push(anim);\n        this._handleAnimation();\n    }\n    static _removeAnimation(anim) {\n        const id = anim.id;\n        const animations = this.animations;\n        const len = animations.length;\n        for (let n = 0; n < len; n++) {\n            if (animations[n].id === id) {\n                this.animations.splice(n, 1);\n                break;\n            }\n        }\n    }\n    static _runFrames() {\n        const layerHash = {};\n        const animations = this.animations;\n        for (let n = 0; n < animations.length; n++) {\n            const anim = animations[n];\n            const layers = anim.layers;\n            const func = anim.func;\n            anim._updateFrameObject(now());\n            const layersLen = layers.length;\n            let needRedraw;\n            if (func) {\n                needRedraw = func.call(anim, anim.frame) !== false;\n            }\n            else {\n                needRedraw = true;\n            }\n            if (!needRedraw) {\n                continue;\n            }\n            for (let i = 0; i < layersLen; i++) {\n                const layer = layers[i];\n                if (layer._id !== undefined) {\n                    layerHash[layer._id] = layer;\n                }\n            }\n        }\n        for (const key in layerHash) {\n            if (!layerHash.hasOwnProperty(key)) {\n                continue;\n            }\n            layerHash[key].batchDraw();\n        }\n    }\n    static _animationLoop() {\n        const Anim = Animation;\n        if (Anim.animations.length) {\n            Anim._runFrames();\n            Util_1.Util.requestAnimFrame(Anim._animationLoop);\n        }\n        else {\n            Anim.animRunning = false;\n        }\n    }\n    static _handleAnimation() {\n        if (!this.animRunning) {\n            this.animRunning = true;\n            Util_1.Util.requestAnimFrame(this._animationLoop);\n        }\n    }\n}\nexports.Animation = Animation;\nAnimation.animations = [];\nAnimation.animIdCounter = 0;\nAnimation.animRunning = false;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Konva = void 0;\nconst Global_1 = require(\"./Global\");\nconst Util_1 = require(\"./Util\");\nconst Node_1 = require(\"./Node\");\nconst Container_1 = require(\"./Container\");\nconst Stage_1 = require(\"./Stage\");\nconst Layer_1 = require(\"./Layer\");\nconst FastLayer_1 = require(\"./FastLayer\");\nconst Group_1 = require(\"./Group\");\nconst DragAndDrop_1 = require(\"./DragAndDrop\");\nconst Shape_1 = require(\"./Shape\");\nconst Animation_1 = require(\"./Animation\");\nconst Tween_1 = require(\"./Tween\");\nconst Context_1 = require(\"./Context\");\nconst Canvas_1 = require(\"./Canvas\");\nexports.Konva = Util_1.Util._assign(Global_1.Konva, {\n    Util: Util_1.Util,\n    Transform: Util_1.Transform,\n    Node: Node_1.Node,\n    Container: Container_1.Container,\n    Stage: Stage_1.Stage,\n    stages: Stage_1.stages,\n    Layer: Layer_1.Layer,\n    FastLayer: FastLayer_1.FastLayer,\n    Group: Group_1.Group,\n    DD: DragAndDrop_1.DD,\n    Shape: Shape_1.Shape,\n    shapes: Shape_1.shapes,\n    Animation: Animation_1.Animation,\n    Tween: Tween_1.Tween,\n    Easings: Tween_1.Easings,\n    Context: Context_1.Context,\n    Canvas: Canvas_1.Canvas,\n});\nexports.default = exports.Konva;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Stage = exports.stages = void 0;\nconst Util_1 = require(\"./Util\");\nconst Factory_1 = require(\"./Factory\");\nconst Container_1 = require(\"./Container\");\nconst Global_1 = require(\"./Global\");\nconst Canvas_1 = require(\"./Canvas\");\nconst DragAndDrop_1 = require(\"./DragAndDrop\");\nconst Global_2 = require(\"./Global\");\nconst PointerEvents = require(\"./PointerEvents\");\nconst STAGE = 'Stage', STRING = 'string', PX = 'px', MOUSEOUT = 'mouseout', MOUSELEAVE = 'mouseleave', MOUSEOVER = 'mouseover', MOUSEENTER = 'mouseenter', MOUSEMOVE = 'mousemove', MOUSEDOWN = 'mousedown', MOUSEUP = 'mouseup', POINTERMOVE = 'pointermove', POINTERDOWN = 'pointerdown', POINTERUP = 'pointerup', POINTERCANCEL = 'pointercancel', LOSTPOINTERCAPTURE = 'lostpointercapture', POINTEROUT = 'pointerout', POINTERLEAVE = 'pointerleave', POINTEROVER = 'pointerover', POINTERENTER = 'pointerenter', CONTEXTMENU = 'contextmenu', TOUCHSTART = 'touchstart', TOUCHEND = 'touchend', TOUCHMOVE = 'touchmove', TOUCHCANCEL = 'touchcancel', WHEEL = 'wheel', MAX_LAYERS_NUMBER = 5, EVENTS = [\n    [MOUSEENTER, '_pointerenter'],\n    [MOUSEDOWN, '_pointerdown'],\n    [MOUSEMOVE, '_pointermove'],\n    [MOUSEUP, '_pointerup'],\n    [MOUSELEAVE, '_pointerleave'],\n    [TOUCHSTART, '_pointerdown'],\n    [TOUCHMOVE, '_pointermove'],\n    [TOUCHEND, '_pointerup'],\n    [TOUCHCANCEL, '_pointercancel'],\n    [MOUSEOVER, '_pointerover'],\n    [WHEEL, '_wheel'],\n    [CONTEXTMENU, '_contextmenu'],\n    [POINTERDOWN, '_pointerdown'],\n    [POINTERMOVE, '_pointermove'],\n    [POINTERUP, '_pointerup'],\n    [POINTERCANCEL, '_pointercancel'],\n    [POINTERLEAVE, '_pointerleave'],\n    [LOSTPOINTERCAPTURE, '_lostpointercapture'],\n];\nconst EVENTS_MAP = {\n    mouse: {\n        [POINTEROUT]: MOUSEOUT,\n        [POINTERLEAVE]: MOUSELEAVE,\n        [POINTEROVER]: MOUSEOVER,\n        [POINTERENTER]: MOUSEENTER,\n        [POINTERMOVE]: MOUSEMOVE,\n        [POINTERDOWN]: MOUSEDOWN,\n        [POINTERUP]: MOUSEUP,\n        [POINTERCANCEL]: 'mousecancel',\n        pointerclick: 'click',\n        pointerdblclick: 'dblclick',\n    },\n    touch: {\n        [POINTEROUT]: 'touchout',\n        [POINTERLEAVE]: 'touchleave',\n        [POINTEROVER]: 'touchover',\n        [POINTERENTER]: 'touchenter',\n        [POINTERMOVE]: TOUCHMOVE,\n        [POINTERDOWN]: TOUCHSTART,\n        [POINTERUP]: TOUCHEND,\n        [POINTERCANCEL]: TOUCHCANCEL,\n        pointerclick: 'tap',\n        pointerdblclick: 'dbltap',\n    },\n    pointer: {\n        [POINTEROUT]: POINTEROUT,\n        [POINTERLEAVE]: POINTERLEAVE,\n        [POINTEROVER]: POINTEROVER,\n        [POINTERENTER]: POINTERENTER,\n        [POINTERMOVE]: POINTERMOVE,\n        [POINTERDOWN]: POINTERDOWN,\n        [POINTERUP]: POINTERUP,\n        [POINTERCANCEL]: POINTERCANCEL,\n        pointerclick: 'pointerclick',\n        pointerdblclick: 'pointerdblclick',\n    },\n};\nconst getEventType = (type) => {\n    if (type.indexOf('pointer') >= 0) {\n        return 'pointer';\n    }\n    if (type.indexOf('touch') >= 0) {\n        return 'touch';\n    }\n    return 'mouse';\n};\nconst getEventsMap = (eventType) => {\n    const type = getEventType(eventType);\n    if (type === 'pointer') {\n        return Global_1.Konva.pointerEventsEnabled && EVENTS_MAP.pointer;\n    }\n    if (type === 'touch') {\n        return EVENTS_MAP.touch;\n    }\n    if (type === 'mouse') {\n        return EVENTS_MAP.mouse;\n    }\n};\nfunction checkNoClip(attrs = {}) {\n    if (attrs.clipFunc || attrs.clipWidth || attrs.clipHeight) {\n        Util_1.Util.warn('Stage does not support clipping. Please use clip for Layers or Groups.');\n    }\n    return attrs;\n}\nconst NO_POINTERS_MESSAGE = `Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);`;\nexports.stages = [];\nclass Stage extends Container_1.Container {\n    constructor(config) {\n        super(checkNoClip(config));\n        this._pointerPositions = [];\n        this._changedPointerPositions = [];\n        this._buildDOM();\n        this._bindContentEvents();\n        exports.stages.push(this);\n        this.on('widthChange.konva heightChange.konva', this._resizeDOM);\n        this.on('visibleChange.konva', this._checkVisibility);\n        this.on('clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva', () => {\n            checkNoClip(this.attrs);\n        });\n        this._checkVisibility();\n    }\n    _validateAdd(child) {\n        const isLayer = child.getType() === 'Layer';\n        const isFastLayer = child.getType() === 'FastLayer';\n        const valid = isLayer || isFastLayer;\n        if (!valid) {\n            Util_1.Util.throw('You may only add layers to the stage.');\n        }\n    }\n    _checkVisibility() {\n        if (!this.content) {\n            return;\n        }\n        const style = this.visible() ? '' : 'none';\n        this.content.style.display = style;\n    }\n    setContainer(container) {\n        if (typeof container === STRING) {\n            let id;\n            if (container.charAt(0) === '.') {\n                const className = container.slice(1);\n                container = document.getElementsByClassName(className)[0];\n            }\n            else {\n                if (container.charAt(0) !== '#') {\n                    id = container;\n                }\n                else {\n                    id = container.slice(1);\n                }\n                container = document.getElementById(id);\n            }\n            if (!container) {\n                throw 'Can not find container in document with id ' + id;\n            }\n        }\n        this._setAttr('container', container);\n        if (this.content) {\n            if (this.content.parentElement) {\n                this.content.parentElement.removeChild(this.content);\n            }\n            container.appendChild(this.content);\n        }\n        return this;\n    }\n    shouldDrawHit() {\n        return true;\n    }\n    clear() {\n        const layers = this.children, len = layers.length;\n        for (let n = 0; n < len; n++) {\n            layers[n].clear();\n        }\n        return this;\n    }\n    clone(obj) {\n        if (!obj) {\n            obj = {};\n        }\n        obj.container =\n            typeof document !== 'undefined' && document.createElement('div');\n        return Container_1.Container.prototype.clone.call(this, obj);\n    }\n    destroy() {\n        super.destroy();\n        const content = this.content;\n        if (content && Util_1.Util._isInDocument(content)) {\n            this.container().removeChild(content);\n        }\n        const index = exports.stages.indexOf(this);\n        if (index > -1) {\n            exports.stages.splice(index, 1);\n        }\n        Util_1.Util.releaseCanvas(this.bufferCanvas._canvas, this.bufferHitCanvas._canvas);\n        return this;\n    }\n    getPointerPosition() {\n        const pos = this._pointerPositions[0] || this._changedPointerPositions[0];\n        if (!pos) {\n            Util_1.Util.warn(NO_POINTERS_MESSAGE);\n            return null;\n        }\n        return {\n            x: pos.x,\n            y: pos.y,\n        };\n    }\n    _getPointerById(id) {\n        return this._pointerPositions.find((p) => p.id === id);\n    }\n    getPointersPositions() {\n        return this._pointerPositions;\n    }\n    getStage() {\n        return this;\n    }\n    getContent() {\n        return this.content;\n    }\n    _toKonvaCanvas(config) {\n        config = config || {};\n        config.x = config.x || 0;\n        config.y = config.y || 0;\n        config.width = config.width || this.width();\n        config.height = config.height || this.height();\n        const canvas = new Canvas_1.SceneCanvas({\n            width: config.width,\n            height: config.height,\n            pixelRatio: config.pixelRatio || 1,\n        });\n        const _context = canvas.getContext()._context;\n        const layers = this.children;\n        if (config.x || config.y) {\n            _context.translate(-1 * config.x, -1 * config.y);\n        }\n        layers.forEach(function (layer) {\n            if (!layer.isVisible()) {\n                return;\n            }\n            const layerCanvas = layer._toKonvaCanvas(config);\n            _context.drawImage(layerCanvas._canvas, config.x, config.y, layerCanvas.getWidth() / layerCanvas.getPixelRatio(), layerCanvas.getHeight() / layerCanvas.getPixelRatio());\n        });\n        return canvas;\n    }\n    getIntersection(pos) {\n        if (!pos) {\n            return null;\n        }\n        const layers = this.children, len = layers.length, end = len - 1;\n        for (let n = end; n >= 0; n--) {\n            const shape = layers[n].getIntersection(pos);\n            if (shape) {\n                return shape;\n            }\n        }\n        return null;\n    }\n    _resizeDOM() {\n        const width = this.width();\n        const height = this.height();\n        if (this.content) {\n            this.content.style.width = width + PX;\n            this.content.style.height = height + PX;\n        }\n        this.bufferCanvas.setSize(width, height);\n        this.bufferHitCanvas.setSize(width, height);\n        this.children.forEach((layer) => {\n            layer.setSize({ width, height });\n            layer.draw();\n        });\n    }\n    add(layer, ...rest) {\n        if (arguments.length > 1) {\n            for (let i = 0; i < arguments.length; i++) {\n                this.add(arguments[i]);\n            }\n            return this;\n        }\n        super.add(layer);\n        const length = this.children.length;\n        if (length > MAX_LAYERS_NUMBER) {\n            Util_1.Util.warn('The stage has ' +\n                length +\n                ' layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group.');\n        }\n        layer.setSize({ width: this.width(), height: this.height() });\n        layer.draw();\n        if (Global_1.Konva.isBrowser) {\n            this.content.appendChild(layer.canvas._canvas);\n        }\n        return this;\n    }\n    getParent() {\n        return null;\n    }\n    getLayer() {\n        return null;\n    }\n    hasPointerCapture(pointerId) {\n        return PointerEvents.hasPointerCapture(pointerId, this);\n    }\n    setPointerCapture(pointerId) {\n        PointerEvents.setPointerCapture(pointerId, this);\n    }\n    releaseCapture(pointerId) {\n        PointerEvents.releaseCapture(pointerId, this);\n    }\n    getLayers() {\n        return this.children;\n    }\n    _bindContentEvents() {\n        if (!Global_1.Konva.isBrowser) {\n            return;\n        }\n        EVENTS.forEach(([event, methodName]) => {\n            this.content.addEventListener(event, (evt) => {\n                this[methodName](evt);\n            }, { passive: false });\n        });\n    }\n    _pointerenter(evt) {\n        this.setPointersPositions(evt);\n        const events = getEventsMap(evt.type);\n        if (events) {\n            this._fire(events.pointerenter, {\n                evt: evt,\n                target: this,\n                currentTarget: this,\n            });\n        }\n    }\n    _pointerover(evt) {\n        this.setPointersPositions(evt);\n        const events = getEventsMap(evt.type);\n        if (events) {\n            this._fire(events.pointerover, {\n                evt: evt,\n                target: this,\n                currentTarget: this,\n            });\n        }\n    }\n    _getTargetShape(evenType) {\n        let shape = this[evenType + 'targetShape'];\n        if (shape && !shape.getStage()) {\n            shape = null;\n        }\n        return shape;\n    }\n    _pointerleave(evt) {\n        const events = getEventsMap(evt.type);\n        const eventType = getEventType(evt.type);\n        if (!events) {\n            return;\n        }\n        this.setPointersPositions(evt);\n        const targetShape = this._getTargetShape(eventType);\n        const eventsEnabled = !(Global_1.Konva.isDragging() || Global_1.Konva.isTransforming()) || Global_1.Konva.hitOnDragEnabled;\n        if (targetShape && eventsEnabled) {\n            targetShape._fireAndBubble(events.pointerout, { evt: evt });\n            targetShape._fireAndBubble(events.pointerleave, { evt: evt });\n            this._fire(events.pointerleave, {\n                evt: evt,\n                target: this,\n                currentTarget: this,\n            });\n            this[eventType + 'targetShape'] = null;\n        }\n        else if (eventsEnabled) {\n            this._fire(events.pointerleave, {\n                evt: evt,\n                target: this,\n                currentTarget: this,\n            });\n            this._fire(events.pointerout, {\n                evt: evt,\n                target: this,\n                currentTarget: this,\n            });\n        }\n        this.pointerPos = null;\n        this._pointerPositions = [];\n    }\n    _pointerdown(evt) {\n        const events = getEventsMap(evt.type);\n        const eventType = getEventType(evt.type);\n        if (!events) {\n            return;\n        }\n        this.setPointersPositions(evt);\n        let triggeredOnShape = false;\n        this._changedPointerPositions.forEach((pos) => {\n            const shape = this.getIntersection(pos);\n            DragAndDrop_1.DD.justDragged = false;\n            Global_1.Konva['_' + eventType + 'ListenClick'] = true;\n            if (!shape || !shape.isListening()) {\n                this[eventType + 'ClickStartShape'] = undefined;\n                return;\n            }\n            if (Global_1.Konva.capturePointerEventsEnabled) {\n                shape.setPointerCapture(pos.id);\n            }\n            this[eventType + 'ClickStartShape'] = shape;\n            shape._fireAndBubble(events.pointerdown, {\n                evt: evt,\n                pointerId: pos.id,\n            });\n            triggeredOnShape = true;\n            const isTouch = evt.type.indexOf('touch') >= 0;\n            if (shape.preventDefault() && evt.cancelable && isTouch) {\n                evt.preventDefault();\n            }\n        });\n        if (!triggeredOnShape) {\n            this._fire(events.pointerdown, {\n                evt: evt,\n                target: this,\n                currentTarget: this,\n                pointerId: this._pointerPositions[0].id,\n            });\n        }\n    }\n    _pointermove(evt) {\n        const events = getEventsMap(evt.type);\n        const eventType = getEventType(evt.type);\n        if (!events) {\n            return;\n        }\n        if (Global_1.Konva.isDragging() && DragAndDrop_1.DD.node.preventDefault() && evt.cancelable) {\n            evt.preventDefault();\n        }\n        this.setPointersPositions(evt);\n        const eventsEnabled = !(Global_1.Konva.isDragging() || Global_1.Konva.isTransforming()) || Global_1.Konva.hitOnDragEnabled;\n        if (!eventsEnabled) {\n            return;\n        }\n        const processedShapesIds = {};\n        let triggeredOnShape = false;\n        const targetShape = this._getTargetShape(eventType);\n        this._changedPointerPositions.forEach((pos) => {\n            const shape = (PointerEvents.getCapturedShape(pos.id) ||\n                this.getIntersection(pos));\n            const pointerId = pos.id;\n            const event = { evt: evt, pointerId };\n            const differentTarget = targetShape !== shape;\n            if (differentTarget && targetShape) {\n                targetShape._fireAndBubble(events.pointerout, { ...event }, shape);\n                targetShape._fireAndBubble(events.pointerleave, { ...event }, shape);\n            }\n            if (shape) {\n                if (processedShapesIds[shape._id]) {\n                    return;\n                }\n                processedShapesIds[shape._id] = true;\n            }\n            if (shape && shape.isListening()) {\n                triggeredOnShape = true;\n                if (differentTarget) {\n                    shape._fireAndBubble(events.pointerover, { ...event }, targetShape);\n                    shape._fireAndBubble(events.pointerenter, { ...event }, targetShape);\n                    this[eventType + 'targetShape'] = shape;\n                }\n                shape._fireAndBubble(events.pointermove, { ...event });\n            }\n            else {\n                if (targetShape) {\n                    this._fire(events.pointerover, {\n                        evt: evt,\n                        target: this,\n                        currentTarget: this,\n                        pointerId,\n                    });\n                    this[eventType + 'targetShape'] = null;\n                }\n            }\n        });\n        if (!triggeredOnShape) {\n            this._fire(events.pointermove, {\n                evt: evt,\n                target: this,\n                currentTarget: this,\n                pointerId: this._changedPointerPositions[0].id,\n            });\n        }\n    }\n    _pointerup(evt) {\n        const events = getEventsMap(evt.type);\n        const eventType = getEventType(evt.type);\n        if (!events) {\n            return;\n        }\n        this.setPointersPositions(evt);\n        const clickStartShape = this[eventType + 'ClickStartShape'];\n        const clickEndShape = this[eventType + 'ClickEndShape'];\n        const processedShapesIds = {};\n        let triggeredOnShape = false;\n        this._changedPointerPositions.forEach((pos) => {\n            const shape = (PointerEvents.getCapturedShape(pos.id) ||\n                this.getIntersection(pos));\n            if (shape) {\n                shape.releaseCapture(pos.id);\n                if (processedShapesIds[shape._id]) {\n                    return;\n                }\n                processedShapesIds[shape._id] = true;\n            }\n            const pointerId = pos.id;\n            const event = { evt: evt, pointerId };\n            let fireDblClick = false;\n            if (Global_1.Konva['_' + eventType + 'InDblClickWindow']) {\n                fireDblClick = true;\n                clearTimeout(this[eventType + 'DblTimeout']);\n            }\n            else if (!DragAndDrop_1.DD.justDragged) {\n                Global_1.Konva['_' + eventType + 'InDblClickWindow'] = true;\n                clearTimeout(this[eventType + 'DblTimeout']);\n            }\n            this[eventType + 'DblTimeout'] = setTimeout(function () {\n                Global_1.Konva['_' + eventType + 'InDblClickWindow'] = false;\n            }, Global_1.Konva.dblClickWindow);\n            if (shape && shape.isListening()) {\n                triggeredOnShape = true;\n                this[eventType + 'ClickEndShape'] = shape;\n                shape._fireAndBubble(events.pointerup, { ...event });\n                if (Global_1.Konva['_' + eventType + 'ListenClick'] &&\n                    clickStartShape &&\n                    clickStartShape === shape) {\n                    shape._fireAndBubble(events.pointerclick, { ...event });\n                    if (fireDblClick && clickEndShape && clickEndShape === shape) {\n                        shape._fireAndBubble(events.pointerdblclick, { ...event });\n                    }\n                }\n            }\n            else {\n                this[eventType + 'ClickEndShape'] = null;\n                if (Global_1.Konva['_' + eventType + 'ListenClick']) {\n                    this._fire(events.pointerclick, {\n                        evt: evt,\n                        target: this,\n                        currentTarget: this,\n                        pointerId,\n                    });\n                }\n                if (fireDblClick) {\n                    this._fire(events.pointerdblclick, {\n                        evt: evt,\n                        target: this,\n                        currentTarget: this,\n                        pointerId,\n                    });\n                }\n            }\n        });\n        if (!triggeredOnShape) {\n            this._fire(events.pointerup, {\n                evt: evt,\n                target: this,\n                currentTarget: this,\n                pointerId: this._changedPointerPositions[0].id,\n            });\n        }\n        Global_1.Konva['_' + eventType + 'ListenClick'] = false;\n        if (evt.cancelable && eventType !== 'touch' && eventType !== 'pointer') {\n            evt.preventDefault();\n        }\n    }\n    _contextmenu(evt) {\n        this.setPointersPositions(evt);\n        const shape = this.getIntersection(this.getPointerPosition());\n        if (shape && shape.isListening()) {\n            shape._fireAndBubble(CONTEXTMENU, { evt: evt });\n        }\n        else {\n            this._fire(CONTEXTMENU, {\n                evt: evt,\n                target: this,\n                currentTarget: this,\n            });\n        }\n    }\n    _wheel(evt) {\n        this.setPointersPositions(evt);\n        const shape = this.getIntersection(this.getPointerPosition());\n        if (shape && shape.isListening()) {\n            shape._fireAndBubble(WHEEL, { evt: evt });\n        }\n        else {\n            this._fire(WHEEL, {\n                evt: evt,\n                target: this,\n                currentTarget: this,\n            });\n        }\n    }\n    _pointercancel(evt) {\n        this.setPointersPositions(evt);\n        const shape = PointerEvents.getCapturedShape(evt.pointerId) ||\n            this.getIntersection(this.getPointerPosition());\n        if (shape) {\n            shape._fireAndBubble(POINTERUP, PointerEvents.createEvent(evt));\n        }\n        PointerEvents.releaseCapture(evt.pointerId);\n    }\n    _lostpointercapture(evt) {\n        PointerEvents.releaseCapture(evt.pointerId);\n    }\n    setPointersPositions(evt) {\n        const contentPosition = this._getContentPosition();\n        let x = null, y = null;\n        evt = evt ? evt : window.event;\n        if (evt.touches !== undefined) {\n            this._pointerPositions = [];\n            this._changedPointerPositions = [];\n            Array.prototype.forEach.call(evt.touches, (touch) => {\n                this._pointerPositions.push({\n                    id: touch.identifier,\n                    x: (touch.clientX - contentPosition.left) / contentPosition.scaleX,\n                    y: (touch.clientY - contentPosition.top) / contentPosition.scaleY,\n                });\n            });\n            Array.prototype.forEach.call(evt.changedTouches || evt.touches, (touch) => {\n                this._changedPointerPositions.push({\n                    id: touch.identifier,\n                    x: (touch.clientX - contentPosition.left) / contentPosition.scaleX,\n                    y: (touch.clientY - contentPosition.top) / contentPosition.scaleY,\n                });\n            });\n        }\n        else {\n            x = (evt.clientX - contentPosition.left) / contentPosition.scaleX;\n            y = (evt.clientY - contentPosition.top) / contentPosition.scaleY;\n            this.pointerPos = {\n                x: x,\n                y: y,\n            };\n            this._pointerPositions = [{ x, y, id: Util_1.Util._getFirstPointerId(evt) }];\n            this._changedPointerPositions = [\n                { x, y, id: Util_1.Util._getFirstPointerId(evt) },\n            ];\n        }\n    }\n    _setPointerPosition(evt) {\n        Util_1.Util.warn('Method _setPointerPosition is deprecated. Use \"stage.setPointersPositions(event)\" instead.');\n        this.setPointersPositions(evt);\n    }\n    _getContentPosition() {\n        if (!this.content || !this.content.getBoundingClientRect) {\n            return {\n                top: 0,\n                left: 0,\n                scaleX: 1,\n                scaleY: 1,\n            };\n        }\n        const rect = this.content.getBoundingClientRect();\n        return {\n            top: rect.top,\n            left: rect.left,\n            scaleX: rect.width / this.content.clientWidth || 1,\n            scaleY: rect.height / this.content.clientHeight || 1,\n        };\n    }\n    _buildDOM() {\n        this.bufferCanvas = new Canvas_1.SceneCanvas({\n            width: this.width(),\n            height: this.height(),\n        });\n        this.bufferHitCanvas = new Canvas_1.HitCanvas({\n            pixelRatio: 1,\n            width: this.width(),\n            height: this.height(),\n        });\n        if (!Global_1.Konva.isBrowser) {\n            return;\n        }\n        const container = this.container();\n        if (!container) {\n            throw 'Stage has no container. A container is required.';\n        }\n        container.innerHTML = '';\n        this.content = document.createElement('div');\n        this.content.style.position = 'relative';\n        this.content.style.userSelect = 'none';\n        this.content.className = 'konvajs-content';\n        this.content.setAttribute('role', 'presentation');\n        container.appendChild(this.content);\n        this._resizeDOM();\n    }\n    cache() {\n        Util_1.Util.warn('Cache function is not allowed for stage. You may use cache only for layers, groups and shapes.');\n        return this;\n    }\n    clearCache() {\n        return this;\n    }\n    batchDraw() {\n        this.getChildren().forEach(function (layer) {\n            layer.batchDraw();\n        });\n        return this;\n    }\n}\nexports.Stage = Stage;\nStage.prototype.nodeType = STAGE;\n(0, Global_2._registerNode)(Stage);\nFactory_1.Factory.addGetterSetter(Stage, 'container');\nif (Global_1.Konva.isBrowser) {\n    document.addEventListener('visibilitychange', () => {\n        exports.stages.forEach((stage) => {\n            stage.batchDraw();\n        });\n    });\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.FastLayer = void 0;\nconst Util_1 = require(\"./Util\");\nconst Layer_1 = require(\"./Layer\");\nconst Global_1 = require(\"./Global\");\nclass FastLayer extends Layer_1.Layer {\n    constructor(attrs) {\n        super(attrs);\n        this.listening(false);\n        Util_1.Util.warn('Konva.Fast layer is deprecated. Please use \"new Konva.Layer({ listening: false })\" instead.');\n    }\n}\nexports.FastLayer = FastLayer;\nFastLayer.prototype.nodeType = 'FastLayer';\n(0, Global_1._registerNode)(FastLayer);\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Group = void 0;\nconst Util_1 = require(\"./Util\");\nconst Container_1 = require(\"./Container\");\nconst Global_1 = require(\"./Global\");\nclass Group extends Container_1.Container {\n    _validateAdd(child) {\n        const type = child.getType();\n        if (type !== 'Group' && type !== 'Shape') {\n            Util_1.Util.throw('You may only add groups and shapes to groups.');\n        }\n    }\n}\nexports.Group = Group;\nGroup.prototype.nodeType = 'Group';\n(0, Global_1._registerNode)(Group);\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Easings = exports.Tween = void 0;\nconst Util_1 = require(\"./Util\");\nconst Animation_1 = require(\"./Animation\");\nconst Node_1 = require(\"./Node\");\nconst Global_1 = require(\"./Global\");\nconst blacklist = {\n    node: 1,\n    duration: 1,\n    easing: 1,\n    onFinish: 1,\n    yoyo: 1,\n}, PAUSED = 1, PLAYING = 2, REVERSING = 3, colorAttrs = ['fill', 'stroke', 'shadowColor'];\nlet idCounter = 0;\nclass TweenEngine {\n    constructor(prop, propFunc, func, begin, finish, duration, yoyo) {\n        this.prop = prop;\n        this.propFunc = propFunc;\n        this.begin = begin;\n        this._pos = begin;\n        this.duration = duration;\n        this._change = 0;\n        this.prevPos = 0;\n        this.yoyo = yoyo;\n        this._time = 0;\n        this._position = 0;\n        this._startTime = 0;\n        this._finish = 0;\n        this.func = func;\n        this._change = finish - this.begin;\n        this.pause();\n    }\n    fire(str) {\n        const handler = this[str];\n        if (handler) {\n            handler();\n        }\n    }\n    setTime(t) {\n        if (t > this.duration) {\n            if (this.yoyo) {\n                this._time = this.duration;\n                this.reverse();\n            }\n            else {\n                this.finish();\n            }\n        }\n        else if (t < 0) {\n            if (this.yoyo) {\n                this._time = 0;\n                this.play();\n            }\n            else {\n                this.reset();\n            }\n        }\n        else {\n            this._time = t;\n            this.update();\n        }\n    }\n    getTime() {\n        return this._time;\n    }\n    setPosition(p) {\n        this.prevPos = this._pos;\n        this.propFunc(p);\n        this._pos = p;\n    }\n    getPosition(t) {\n        if (t === undefined) {\n            t = this._time;\n        }\n        return this.func(t, this.begin, this._change, this.duration);\n    }\n    play() {\n        this.state = PLAYING;\n        this._startTime = this.getTimer() - this._time;\n        this.onEnterFrame();\n        this.fire('onPlay');\n    }\n    reverse() {\n        this.state = REVERSING;\n        this._time = this.duration - this._time;\n        this._startTime = this.getTimer() - this._time;\n        this.onEnterFrame();\n        this.fire('onReverse');\n    }\n    seek(t) {\n        this.pause();\n        this._time = t;\n        this.update();\n        this.fire('onSeek');\n    }\n    reset() {\n        this.pause();\n        this._time = 0;\n        this.update();\n        this.fire('onReset');\n    }\n    finish() {\n        this.pause();\n        this._time = this.duration;\n        this.update();\n        this.fire('onFinish');\n    }\n    update() {\n        this.setPosition(this.getPosition(this._time));\n        this.fire('onUpdate');\n    }\n    onEnterFrame() {\n        const t = this.getTimer() - this._startTime;\n        if (this.state === PLAYING) {\n            this.setTime(t);\n        }\n        else if (this.state === REVERSING) {\n            this.setTime(this.duration - t);\n        }\n    }\n    pause() {\n        this.state = PAUSED;\n        this.fire('onPause');\n    }\n    getTimer() {\n        return new Date().getTime();\n    }\n}\nclass Tween {\n    constructor(config) {\n        const that = this, node = config.node, nodeId = node._id, easing = config.easing || exports.Easings.Linear, yoyo = !!config.yoyo;\n        let duration, key;\n        if (typeof config.duration === 'undefined') {\n            duration = 0.3;\n        }\n        else if (config.duration === 0) {\n            duration = 0.001;\n        }\n        else {\n            duration = config.duration;\n        }\n        this.node = node;\n        this._id = idCounter++;\n        const layers = node.getLayer() ||\n            (node instanceof Global_1.Konva['Stage'] ? node.getLayers() : null);\n        if (!layers) {\n            Util_1.Util.error('Tween constructor have `node` that is not in a layer. Please add node into layer first.');\n        }\n        this.anim = new Animation_1.Animation(function () {\n            that.tween.onEnterFrame();\n        }, layers);\n        this.tween = new TweenEngine(key, function (i) {\n            that._tweenFunc(i);\n        }, easing, 0, 1, duration * 1000, yoyo);\n        this._addListeners();\n        if (!Tween.attrs[nodeId]) {\n            Tween.attrs[nodeId] = {};\n        }\n        if (!Tween.attrs[nodeId][this._id]) {\n            Tween.attrs[nodeId][this._id] = {};\n        }\n        if (!Tween.tweens[nodeId]) {\n            Tween.tweens[nodeId] = {};\n        }\n        for (key in config) {\n            if (blacklist[key] === undefined) {\n                this._addAttr(key, config[key]);\n            }\n        }\n        this.reset();\n        this.onFinish = config.onFinish;\n        this.onReset = config.onReset;\n        this.onUpdate = config.onUpdate;\n    }\n    _addAttr(key, end) {\n        const node = this.node, nodeId = node._id;\n        let diff, len, trueEnd, trueStart, endRGBA;\n        const tweenId = Tween.tweens[nodeId][key];\n        if (tweenId) {\n            delete Tween.attrs[nodeId][tweenId][key];\n        }\n        let start = node.getAttr(key);\n        if (Util_1.Util._isArray(end)) {\n            diff = [];\n            len = Math.max(end.length, start.length);\n            if (key === 'points' && end.length !== start.length) {\n                if (end.length > start.length) {\n                    trueStart = start;\n                    start = Util_1.Util._prepareArrayForTween(start, end, node.closed());\n                }\n                else {\n                    trueEnd = end;\n                    end = Util_1.Util._prepareArrayForTween(end, start, node.closed());\n                }\n            }\n            if (key.indexOf('fill') === 0) {\n                for (let n = 0; n < len; n++) {\n                    if (n % 2 === 0) {\n                        diff.push(end[n] - start[n]);\n                    }\n                    else {\n                        const startRGBA = Util_1.Util.colorToRGBA(start[n]);\n                        endRGBA = Util_1.Util.colorToRGBA(end[n]);\n                        start[n] = startRGBA;\n                        diff.push({\n                            r: endRGBA.r - startRGBA.r,\n                            g: endRGBA.g - startRGBA.g,\n                            b: endRGBA.b - startRGBA.b,\n                            a: endRGBA.a - startRGBA.a,\n                        });\n                    }\n                }\n            }\n            else {\n                for (let n = 0; n < len; n++) {\n                    diff.push(end[n] - start[n]);\n                }\n            }\n        }\n        else if (colorAttrs.indexOf(key) !== -1) {\n            start = Util_1.Util.colorToRGBA(start);\n            endRGBA = Util_1.Util.colorToRGBA(end);\n            diff = {\n                r: endRGBA.r - start.r,\n                g: endRGBA.g - start.g,\n                b: endRGBA.b - start.b,\n                a: endRGBA.a - start.a,\n            };\n        }\n        else {\n            diff = end - start;\n        }\n        Tween.attrs[nodeId][this._id][key] = {\n            start: start,\n            diff: diff,\n            end: end,\n            trueEnd: trueEnd,\n            trueStart: trueStart,\n        };\n        Tween.tweens[nodeId][key] = this._id;\n    }\n    _tweenFunc(i) {\n        const node = this.node, attrs = Tween.attrs[node._id][this._id];\n        let key, attr, start, diff, newVal, n, len, end;\n        for (key in attrs) {\n            attr = attrs[key];\n            start = attr.start;\n            diff = attr.diff;\n            end = attr.end;\n            if (Util_1.Util._isArray(start)) {\n                newVal = [];\n                len = Math.max(start.length, end.length);\n                if (key.indexOf('fill') === 0) {\n                    for (n = 0; n < len; n++) {\n                        if (n % 2 === 0) {\n                            newVal.push((start[n] || 0) + diff[n] * i);\n                        }\n                        else {\n                            newVal.push('rgba(' +\n                                Math.round(start[n].r + diff[n].r * i) +\n                                ',' +\n                                Math.round(start[n].g + diff[n].g * i) +\n                                ',' +\n                                Math.round(start[n].b + diff[n].b * i) +\n                                ',' +\n                                (start[n].a + diff[n].a * i) +\n                                ')');\n                        }\n                    }\n                }\n                else {\n                    for (n = 0; n < len; n++) {\n                        newVal.push((start[n] || 0) + diff[n] * i);\n                    }\n                }\n            }\n            else if (colorAttrs.indexOf(key) !== -1) {\n                newVal =\n                    'rgba(' +\n                        Math.round(start.r + diff.r * i) +\n                        ',' +\n                        Math.round(start.g + diff.g * i) +\n                        ',' +\n                        Math.round(start.b + diff.b * i) +\n                        ',' +\n                        (start.a + diff.a * i) +\n                        ')';\n            }\n            else {\n                newVal = start + diff * i;\n            }\n            node.setAttr(key, newVal);\n        }\n    }\n    _addListeners() {\n        this.tween.onPlay = () => {\n            this.anim.start();\n        };\n        this.tween.onReverse = () => {\n            this.anim.start();\n        };\n        this.tween.onPause = () => {\n            this.anim.stop();\n        };\n        this.tween.onFinish = () => {\n            const node = this.node;\n            const attrs = Tween.attrs[node._id][this._id];\n            if (attrs.points && attrs.points.trueEnd) {\n                node.setAttr('points', attrs.points.trueEnd);\n            }\n            if (this.onFinish) {\n                this.onFinish.call(this);\n            }\n        };\n        this.tween.onReset = () => {\n            const node = this.node;\n            const attrs = Tween.attrs[node._id][this._id];\n            if (attrs.points && attrs.points.trueStart) {\n                node.points(attrs.points.trueStart);\n            }\n            if (this.onReset) {\n                this.onReset();\n            }\n        };\n        this.tween.onUpdate = () => {\n            if (this.onUpdate) {\n                this.onUpdate.call(this);\n            }\n        };\n    }\n    play() {\n        this.tween.play();\n        return this;\n    }\n    reverse() {\n        this.tween.reverse();\n        return this;\n    }\n    reset() {\n        this.tween.reset();\n        return this;\n    }\n    seek(t) {\n        this.tween.seek(t * 1000);\n        return this;\n    }\n    pause() {\n        this.tween.pause();\n        return this;\n    }\n    finish() {\n        this.tween.finish();\n        return this;\n    }\n    destroy() {\n        const nodeId = this.node._id, thisId = this._id, attrs = Tween.tweens[nodeId];\n        this.pause();\n        if (this.anim) {\n            this.anim.stop();\n        }\n        for (const key in attrs) {\n            delete Tween.tweens[nodeId][key];\n        }\n        delete Tween.attrs[nodeId][thisId];\n        if (Tween.tweens[nodeId]) {\n            if (Object.keys(Tween.tweens[nodeId]).length === 0) {\n                delete Tween.tweens[nodeId];\n            }\n            if (Object.keys(Tween.attrs[nodeId]).length === 0) {\n                delete Tween.attrs[nodeId];\n            }\n        }\n    }\n}\nexports.Tween = Tween;\nTween.attrs = {};\nTween.tweens = {};\nNode_1.Node.prototype.to = function (params) {\n    const onFinish = params.onFinish;\n    params.node = this;\n    params.onFinish = function () {\n        this.destroy();\n        if (onFinish) {\n            onFinish();\n        }\n    };\n    const tween = new Tween(params);\n    tween.play();\n};\nexports.Easings = {\n    BackEaseIn(t, b, c, d) {\n        const s = 1.70158;\n        return c * (t /= d) * t * ((s + 1) * t - s) + b;\n    },\n    BackEaseOut(t, b, c, d) {\n        const s = 1.70158;\n        return c * ((t = t / d - 1) * t * ((s + 1) * t + s) + 1) + b;\n    },\n    BackEaseInOut(t, b, c, d) {\n        let s = 1.70158;\n        if ((t /= d / 2) < 1) {\n            return (c / 2) * (t * t * (((s *= 1.525) + 1) * t - s)) + b;\n        }\n        return (c / 2) * ((t -= 2) * t * (((s *= 1.525) + 1) * t + s) + 2) + b;\n    },\n    ElasticEaseIn(t, b, c, d, a, p) {\n        let s = 0;\n        if (t === 0) {\n            return b;\n        }\n        if ((t /= d) === 1) {\n            return b + c;\n        }\n        if (!p) {\n            p = d * 0.3;\n        }\n        if (!a || a < Math.abs(c)) {\n            a = c;\n            s = p / 4;\n        }\n        else {\n            s = (p / (2 * Math.PI)) * Math.asin(c / a);\n        }\n        return (-(a *\n            Math.pow(2, 10 * (t -= 1)) *\n            Math.sin(((t * d - s) * (2 * Math.PI)) / p)) + b);\n    },\n    ElasticEaseOut(t, b, c, d, a, p) {\n        let s = 0;\n        if (t === 0) {\n            return b;\n        }\n        if ((t /= d) === 1) {\n            return b + c;\n        }\n        if (!p) {\n            p = d * 0.3;\n        }\n        if (!a || a < Math.abs(c)) {\n            a = c;\n            s = p / 4;\n        }\n        else {\n            s = (p / (2 * Math.PI)) * Math.asin(c / a);\n        }\n        return (a * Math.pow(2, -10 * t) * Math.sin(((t * d - s) * (2 * Math.PI)) / p) +\n            c +\n            b);\n    },\n    ElasticEaseInOut(t, b, c, d, a, p) {\n        let s = 0;\n        if (t === 0) {\n            return b;\n        }\n        if ((t /= d / 2) === 2) {\n            return b + c;\n        }\n        if (!p) {\n            p = d * (0.3 * 1.5);\n        }\n        if (!a || a < Math.abs(c)) {\n            a = c;\n            s = p / 4;\n        }\n        else {\n            s = (p / (2 * Math.PI)) * Math.asin(c / a);\n        }\n        if (t < 1) {\n            return (-0.5 *\n                (a *\n                    Math.pow(2, 10 * (t -= 1)) *\n                    Math.sin(((t * d - s) * (2 * Math.PI)) / p)) +\n                b);\n        }\n        return (a *\n            Math.pow(2, -10 * (t -= 1)) *\n            Math.sin(((t * d - s) * (2 * Math.PI)) / p) *\n            0.5 +\n            c +\n            b);\n    },\n    BounceEaseOut(t, b, c, d) {\n        if ((t /= d) < 1 / 2.75) {\n            return c * (7.5625 * t * t) + b;\n        }\n        else if (t < 2 / 2.75) {\n            return c * (7.5625 * (t -= 1.5 / 2.75) * t + 0.75) + b;\n        }\n        else if (t < 2.5 / 2.75) {\n            return c * (7.5625 * (t -= 2.25 / 2.75) * t + 0.9375) + b;\n        }\n        else {\n            return c * (7.5625 * (t -= 2.625 / 2.75) * t + 0.984375) + b;\n        }\n    },\n    BounceEaseIn(t, b, c, d) {\n        return c - exports.Easings.BounceEaseOut(d - t, 0, c, d) + b;\n    },\n    BounceEaseInOut(t, b, c, d) {\n        if (t < d / 2) {\n            return exports.Easings.BounceEaseIn(t * 2, 0, c, d) * 0.5 + b;\n        }\n        else {\n            return exports.Easings.BounceEaseOut(t * 2 - d, 0, c, d) * 0.5 + c * 0.5 + b;\n        }\n    },\n    EaseIn(t, b, c, d) {\n        return c * (t /= d) * t + b;\n    },\n    EaseOut(t, b, c, d) {\n        return -c * (t /= d) * (t - 2) + b;\n    },\n    EaseInOut(t, b, c, d) {\n        if ((t /= d / 2) < 1) {\n            return (c / 2) * t * t + b;\n        }\n        return (-c / 2) * (--t * (t - 2) - 1) + b;\n    },\n    StrongEaseIn(t, b, c, d) {\n        return c * (t /= d) * t * t * t * t + b;\n    },\n    StrongEaseOut(t, b, c, d) {\n        return c * ((t = t / d - 1) * t * t * t * t + 1) + b;\n    },\n    StrongEaseInOut(t, b, c, d) {\n        if ((t /= d / 2) < 1) {\n            return (c / 2) * t * t * t * t * t + b;\n        }\n        return (c / 2) * ((t -= 2) * t * t * t * t + 2) + b;\n    },\n    Linear(t, b, c, d) {\n        return (c * t) / d + b;\n    },\n};\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Konva = void 0;\nvar _CoreInternals_1 = require(\"./_CoreInternals\");\nObject.defineProperty(exports, \"Konva\", { enumerable: true, get: function () { return _CoreInternals_1.Konva; } });\nconst _CoreInternals_2 = require(\"./_CoreInternals\");\nmodule.exports = _CoreInternals_2.Konva;\n","import Konva from 'konva/lib/Core';\n\nfunction zeroPad(number, precision) {\n  number = number.toString();\n\n  while (number.length < precision) {\n    number = '0' + number;\n  }\n\n  return number;\n}\n\n/**\n * Returns a formatted time string.\n *\n * @param {Number} time The time to be formatted, in seconds.\n * @param {Number} precision Decimal places to which time is displayed\n * @returns {String}\n */\n\nexport function formatTime(time, precision) {\n  let result = [];\n\n  const fractionSeconds = Math.floor((time % 1) * Math.pow(10, precision));\n  const seconds = Math.floor(time);\n  const minutes = Math.floor(seconds / 60);\n  const hours = Math.floor(minutes / 60);\n\n  if (hours > 0) {\n    result.push(hours); // Hours\n  }\n  result.push(minutes % 60); // Mins\n  result.push(seconds % 60); // Seconds\n\n  for (let i = 0; i < result.length; i++) {\n    result[i] = zeroPad(result[i], 2);\n  }\n\n  result = result.join(':');\n\n  if (precision > 0) {\n    result += '.' + zeroPad(fractionSeconds, precision);\n  }\n\n  return result;\n}\n\n/**\n * Rounds the given value up to the nearest given multiple.\n *\n * @param {Number} value\n * @param {Number} multiple\n * @returns {Number}\n *\n * @example\n * roundUpToNearest(5.5, 3); // returns 6\n * roundUpToNearest(141.0, 10); // returns 150\n * roundUpToNearest(-5.5, 3); // returns -6\n */\n\nexport function roundUpToNearest(value, multiple) {\n  if (multiple === 0) {\n    return 0;\n  }\n\n  let multiplier = 1;\n\n  if (value < 0.0) {\n    multiplier = -1;\n    value = -value;\n  }\n\n  const roundedUp = Math.ceil(value);\n\n  return multiplier * (((roundedUp + multiple - 1) / multiple) | 0) * multiple;\n}\n\nexport function clamp(value, min, max) {\n  if (value < min) {\n    return min;\n  }\n  else if (value > max) {\n    return max;\n  }\n  else {\n    return value;\n  }\n}\n\nexport function objectHasProperty(object, field) {\n  return Object.prototype.hasOwnProperty.call(object, field);\n}\n\nexport function extend(to, from) {\n  for (const key in from) {\n    if (objectHasProperty(from, key)) {\n      to[key] = from[key];\n    }\n  }\n\n  return to;\n}\n\n/**\n * Checks whether the given array contains values in ascending order.\n *\n * @param {Array<Number>} array The array to test\n * @returns {Boolean}\n */\n\nexport function isInAscendingOrder(array) {\n  if (array.length === 0) {\n    return true;\n  }\n\n  let value = array[0];\n\n  for (let i = 1; i < array.length; i++) {\n    if (value >= array[i]) {\n      return false;\n    }\n\n    value = array[i];\n  }\n\n  return true;\n}\n\n/**\n * Checks whether the given value is a number.\n *\n * @param {Number} value The value to test\n * @returns {Boolean}\n */\n\nexport function isNumber(value) {\n  return typeof value === 'number';\n}\n\n/**\n * Checks whether the given value is a finite number.\n *\n * @param {Number} value The value to test\n * @returns {Boolean}\n */\n\nexport function isFinite(value) {\n  if (typeof value !== 'number') {\n    return false;\n  }\n\n  // Check for NaN and infinity\n  // eslint-disable-next-line no-self-compare\n  if (value !== value || value === Infinity || value === -Infinity) {\n    return false;\n  }\n\n  return true;\n}\n\n/**\n * Checks whether the given value is a valid timestamp.\n *\n * @param {Number} value The value to test\n * @returns {Boolean}\n */\n\nexport function isValidTime(value) {\n  return (typeof value === 'number') && Number.isFinite(value);\n}\n\n/**\n * Checks whether the given value is a valid object.\n *\n * @param {Object|Array} value The value to test\n * @returns {Boolean}\n */\n\nexport function isObject(value) {\n  return (value !== null) && (typeof value === 'object')\n    && !Array.isArray(value);\n}\n\n/**\n * Checks whether the given value is a valid string.\n *\n * @param {String} value The value to test\n * @returns {Boolean}\n */\n\nexport function isString(value) {\n  return typeof value === 'string';\n}\n\n/**\n * Checks whether the given value is a valid ArrayBuffer.\n *\n * @param {ArrayBuffer} value The value to test\n * @returns {Boolean}\n */\n\nexport function isArrayBuffer(value) {\n  return Object.prototype.toString.call(value).includes('ArrayBuffer');\n}\n\n/**\n * Checks whether the given value is null or undefined.\n *\n * @param {Object} value The value to test\n * @returns {Boolean}\n */\n\nexport function isNullOrUndefined(value) {\n  return value === undefined || value === null;\n}\n\n/**\n * Checks whether the given value is a function.\n *\n * @param {Function} value The value to test\n * @returns {Boolean}\n */\n\nexport function isFunction(value) {\n  return typeof value === 'function';\n}\n\n/**\n * Checks whether the given value is a boolean.\n *\n * @param {Function} value The value to test\n * @returns {Boolean}\n */\n\nexport function isBoolean(value) {\n  return value === true || value === false;\n}\n\n/**\n * Checks whether the given value is a valid HTML element.\n *\n * @param {HTMLElement} value The value to test\n * @returns {Boolean}\n */\n\nexport function isHTMLElement(value) {\n  return value instanceof HTMLElement;\n}\n\n/**\n * Checks whether the given value is an array\n *\n * @param {Function} value The value to test\n * @returns {Boolean}\n */\n\nexport function isArray(value) {\n  return Array.isArray(value);\n}\n\n/**\n * Checks whether the given value is a valid linear gradient color\n *\n * @param {Function} value The value to test\n * @returns {Boolean}\n */\n\nexport function isLinearGradientColor(value) {\n  return isObject(value) &&\n    objectHasProperty(value, 'linearGradientStart') &&\n    objectHasProperty(value, 'linearGradientEnd') &&\n    objectHasProperty(value, 'linearGradientColorStops') &&\n    isNumber(value.linearGradientStart) &&\n    isNumber(value.linearGradientEnd) &&\n    isArray(value.linearGradientColorStops) &&\n    value.linearGradientColorStops.length === 2;\n}\n\nexport function getMarkerObject(obj) {\n  while (obj.parent !== null) {\n    if (obj.parent instanceof Konva.Layer) {\n      return obj;\n    }\n\n    obj = obj.parent;\n  }\n\n  return null;\n}\n","/**\n * @file\n *\n * Defines the {@link CueEmitter} class.\n *\n * @module cue-emitter\n */\n\nimport Cue from './cue';\nimport { objectHasProperty } from './utils';\n\nconst isHeadless = /HeadlessChrome/.test(navigator.userAgent);\n\nfunction windowIsVisible() {\n  if (isHeadless || navigator.webdriver) {\n    return false;\n  }\n\n  return (typeof document === 'object') &&\n    ('visibilityState' in document) &&\n    (document.visibilityState === 'visible');\n}\n\nconst requestAnimationFrame =\n  window.requestAnimationFrame ||\n  window.mozRequestAnimationFrame ||\n  window.webkitRequestAnimationFrame ||\n  window.msRequestAnimationFrame;\n\nconst cancelAnimationFrame =\n  window.cancelAnimationFrame ||\n  window.mozCancelAnimationFrame ||\n  window.webkitCancelAnimationFrame ||\n  window.msCancelAnimationFrame;\n\nconst eventTypes = {\n  forward: {},\n  reverse: {}\n};\n\nconst EVENT_TYPE_POINT = 0;\nconst EVENT_TYPE_SEGMENT_ENTER = 1;\nconst EVENT_TYPE_SEGMENT_EXIT = 2;\n\neventTypes.forward[Cue.POINT] = EVENT_TYPE_POINT;\neventTypes.forward[Cue.SEGMENT_START] = EVENT_TYPE_SEGMENT_ENTER;\neventTypes.forward[Cue.SEGMENT_END] = EVENT_TYPE_SEGMENT_EXIT;\n\neventTypes.reverse[Cue.POINT] = EVENT_TYPE_POINT;\neventTypes.reverse[Cue.SEGMENT_START] = EVENT_TYPE_SEGMENT_EXIT;\neventTypes.reverse[Cue.SEGMENT_END] = EVENT_TYPE_SEGMENT_ENTER;\n\nconst eventNames = {};\n\neventNames[EVENT_TYPE_POINT] = 'points.enter';\neventNames[EVENT_TYPE_SEGMENT_ENTER] = 'segments.enter';\neventNames[EVENT_TYPE_SEGMENT_EXIT] = 'segments.exit';\n\nconst eventAttributes = {};\n\neventAttributes[EVENT_TYPE_POINT] = 'point';\neventAttributes[EVENT_TYPE_SEGMENT_ENTER] = 'segment';\neventAttributes[EVENT_TYPE_SEGMENT_EXIT] = 'segment';\n\n/**\n * Given a cue instance, returns the corresponding {@link Point}\n * {@link Segment}.\n *\n * @param {Peaks} peaks\n * @param {Cue} cue\n * @return {Point|Segment}\n * @throws {Error}\n */\n\nfunction getPointOrSegment(peaks, cue) {\n  switch (cue.type) {\n    case Cue.POINT:\n      return peaks.points.getPoint(cue.id);\n\n    case Cue.SEGMENT_START:\n    case Cue.SEGMENT_END:\n      return peaks.segments.getSegment(cue.id);\n\n    default:\n      throw new Error('getPointOrSegment: id not found?');\n  }\n}\n\n/**\n * CueEmitter is responsible for emitting <code>points.enter</code>,\n * <code>segments.enter</code>, and <code>segments.exit</code> events.\n *\n * @class\n * @alias CueEmitter\n *\n * @param {Peaks} peaks Parent {@link Peaks} instance.\n */\n\nfunction CueEmitter(peaks) {\n  this._cues = [];\n  this._peaks = peaks;\n  this._previousTime = -1;\n  this._updateCues = this._updateCues.bind(this);\n  this._onPlaying = this._onPlaying.bind(this);\n  this._onSeeked = this._onSeeked.bind(this);\n  this._onTimeUpdate = this._onTimeUpdate.bind(this);\n  this._onAnimationFrame = this._onAnimationFrame.bind(this);\n  this._rAFHandle = null;\n  this._activeSegments = {};\n  this._attachEventHandlers();\n}\n\n/**\n * This function is bound to all {@link Peaks} events relating to mutated\n * [Points]{@link Point} or [Segments]{@link Segment}, and updates the\n * list of cues accordingly.\n *\n * @private\n */\n\nCueEmitter.prototype._updateCues = function() {\n  const self = this;\n\n  const points = self._peaks.points.getPoints();\n  const segments = self._peaks.segments.getSegments();\n\n  self._cues.length = 0;\n\n  points.forEach(function(point) {\n    self._cues.push(new Cue(point.time, Cue.POINT, point.id));\n  });\n\n  segments.forEach(function(segment) {\n    self._cues.push(new Cue(segment.startTime, Cue.SEGMENT_START, segment.id));\n    self._cues.push(new Cue(segment.endTime, Cue.SEGMENT_END, segment.id));\n  });\n\n  self._cues.sort(Cue.sorter);\n\n  const time = self._peaks.player.getCurrentTime();\n\n  self._updateActiveSegments(time);\n};\n\n/**\n * Emits events for any cues passed through during media playback.\n *\n * @param {Number} time The current time on the media timeline.\n * @param {Number} previousTime The previous time on the media timeline when\n *   this function was called.\n */\n\nCueEmitter.prototype._onUpdate = function(time, previousTime) {\n  const isForward = time > previousTime;\n  let start;\n  let end;\n  let step;\n\n  if (isForward) {\n    start = 0;\n    end = this._cues.length;\n    step = 1;\n  }\n  else {\n    start = this._cues.length - 1;\n    end = -1;\n    step = -1;\n  }\n\n  // Cues are sorted.\n\n  for (let i = start; isForward ? i < end : i > end; i += step) {\n    const cue = this._cues[i];\n\n    if (isForward ? cue.time > previousTime : cue.time < previousTime) {\n      if (isForward ? cue.time > time : cue.time < time) {\n        break;\n      }\n\n      // Cue falls between time and previousTime.\n\n      const marker = getPointOrSegment(this._peaks, cue);\n\n      const eventType = isForward ? eventTypes.forward[cue.type] :\n                                    eventTypes.reverse[cue.type];\n\n      if (eventType === EVENT_TYPE_SEGMENT_ENTER) {\n        this._activeSegments[marker.id] = marker;\n      }\n      else if (eventType === EVENT_TYPE_SEGMENT_EXIT) {\n        delete this._activeSegments[marker.id];\n      }\n\n      const event = {\n        time: time\n      };\n\n      event[eventAttributes[eventType]] = marker;\n\n      this._peaks.emit(eventNames[eventType], event);\n    }\n  }\n};\n\n// The next handler and onAnimationFrame are bound together\n// when the window isn't in focus, rAF is throttled\n// falling back to timeUpdate.\n\nCueEmitter.prototype._onTimeUpdate = function(time) {\n  if (windowIsVisible()) {\n    return;\n  }\n\n  if (this._peaks.player.isPlaying() && !this._peaks.player.isSeeking()) {\n    this._onUpdate(time, this._previousTime);\n  }\n\n  this._previousTime = time;\n};\n\nCueEmitter.prototype._onAnimationFrame = function() {\n  const time = this._peaks.player.getCurrentTime();\n\n  if (!this._peaks.player.isSeeking()) {\n    this._onUpdate(time, this._previousTime);\n  }\n\n  this._previousTime = time;\n\n  if (this._peaks.player.isPlaying()) {\n    this._rAFHandle = requestAnimationFrame(this._onAnimationFrame);\n  }\n};\n\nCueEmitter.prototype._onPlaying = function() {\n  this._previousTime = this._peaks.player.getCurrentTime();\n  this._rAFHandle = requestAnimationFrame(this._onAnimationFrame);\n};\n\nCueEmitter.prototype._onSeeked = function(time) {\n  this._previousTime = time;\n\n  this._updateActiveSegments(time);\n};\n\nfunction getSegmentIdComparator(id) {\n  return function compareSegmentIds(segment) {\n    return segment.id === id;\n  };\n}\n\n/**\n * The active segments is the set of all segments which overlap the current\n * playhead position. This function updates that set and emits\n * <code>segments.enter</code> and <code>segments.exit</code> events.\n */\n\nCueEmitter.prototype._updateActiveSegments = function(time) {\n  const self = this;\n\n  const activeSegments = self._peaks.segments.getSegmentsAtTime(time);\n\n  // Remove any segments no longer active.\n\n  for (const id in self._activeSegments) {\n    if (objectHasProperty(self._activeSegments, id)) {\n      const segment = activeSegments.find(getSegmentIdComparator(id));\n\n      if (!segment) {\n        self._peaks.emit('segments.exit', {\n          segment: self._activeSegments[id],\n          time: time\n        });\n\n        delete self._activeSegments[id];\n      }\n    }\n  }\n\n  // Add new active segments.\n\n  activeSegments.forEach(function(segment) {\n    if (!(segment.id in self._activeSegments)) {\n      self._activeSegments[segment.id] = segment;\n\n      self._peaks.emit('segments.enter', {\n        segment: segment,\n        time: time\n      });\n    }\n  });\n};\n\nconst events = [\n  'points.update',\n  'points.dragmove',\n  'points.add',\n  'points.remove',\n  'points.remove_all',\n  'segments.update',\n  'segments.dragged',\n  'segments.add',\n  'segments.remove',\n  'segments.remove_all'\n];\n\nCueEmitter.prototype._attachEventHandlers = function() {\n  this._peaks.on('player.timeupdate', this._onTimeUpdate);\n  this._peaks.on('player.playing', this._onPlaying);\n  this._peaks.on('player.seeked', this._onSeeked);\n\n  for (let i = 0; i < events.length; i++) {\n    this._peaks.on(events[i], this._updateCues);\n  }\n\n  this._updateCues();\n};\n\nCueEmitter.prototype._detachEventHandlers = function() {\n  this._peaks.off('player.timeupdate', this._onTimeUpdate);\n  this._peaks.off('player.playing', this._onPlaying);\n  this._peaks.off('player.seeked', this._onSeeked);\n\n  for (let i = 0; i < events.length; i++) {\n    this._peaks.off(events[i], this._updateCues);\n  }\n};\n\nCueEmitter.prototype.destroy = function() {\n  if (this._rAFHandle) {\n    cancelAnimationFrame(this._rAFHandle);\n    this._rAFHandle = null;\n  }\n\n  this._detachEventHandlers();\n\n  this._previousTime = -1;\n};\n\nexport default CueEmitter;\n","/**\n * @file\n *\n * Defines the {@link Point} class.\n *\n * @module point\n */\n\nimport {\n  isBoolean, isLinearGradientColor, isNullOrUndefined, isString,\n  isValidTime, objectHasProperty\n} from './utils';\n\nconst pointOptions = [\n  'id', 'pid', 'time', 'labelText', 'color', 'editable'\n];\n\nconst invalidOptions = [\n  'update', 'isVisible', 'peaks', 'pid'\n];\n\nfunction setDefaultPointOptions(options, peaksOptions) {\n  if (isNullOrUndefined(options.labelText)) {\n    options.labelText = '';\n  }\n\n  if (isNullOrUndefined(options.editable)) {\n    options.editable = false;\n  }\n\n  if (isNullOrUndefined(options.color)) {\n    options.color = peaksOptions.pointMarkerColor;\n  }\n}\n\nfunction validatePointOptions(options, updating) {\n  const context = updating ? 'update()' : 'add()';\n\n  if (!updating || (updating && objectHasProperty(options, 'time'))) {\n    if (!isValidTime(options.time)) {\n      throw new TypeError('peaks.points.' + context + ': time should be a numeric value');\n    }\n  }\n\n  if (options.time < 0) {\n    throw new RangeError('peaks.points.' + context + ': time should not be negative');\n  }\n\n  if (objectHasProperty(options, 'labelText') && !isString(options.labelText)) {\n    throw new TypeError('peaks.points.' + context + ': labelText must be a string');\n  }\n\n  if (objectHasProperty(options, 'editable') && !isBoolean(options.editable)) {\n    throw new TypeError('peaks.points.' + context + ': editable must be true or false');\n  }\n\n  if (objectHasProperty(options, 'color') &&\n    !isString(options.color) &&\n    !isLinearGradientColor(options.color)) {\n    // eslint-disable-next-line @stylistic/js/max-len\n    throw new TypeError('peaks.points.' + context + ': color must be a string or a valid linear gradient object');\n  }\n\n  invalidOptions.forEach(function(name) {\n    if (objectHasProperty(options, name)) {\n      throw new Error('peaks.points.' + context + ': invalid option name: ' + name);\n    }\n  });\n\n  pointOptions.forEach(function(name) {\n    if (objectHasProperty(options, '_' + name)) {\n      throw new Error('peaks.points.' + context + ': invalid option name: _' + name);\n    }\n  });\n}\n\n/**\n * A point is a single instant of time, with associated label and color.\n *\n * @class\n * @alias Point\n *\n * @param {Peaks} peaks A reference to the Peaks instance.\n * @param {Number} pid An internal unique identifier for the point.\n * @param {PointOptions} options User specified point attributes.\n */\n\nfunction Point(peaks, pid, options) {\n  this._peaks = peaks;\n  this._pid = pid;\n  this._setUserData(options);\n}\n\nPoint.prototype._setUserData = function(options) {\n  for (const key in options) {\n    if (objectHasProperty(options, key)) {\n      if (pointOptions.indexOf(key) === -1) {\n        this[key] = options[key];\n      }\n      else {\n        this['_' + key] = options[key];\n      }\n    }\n  }\n};\n\nObject.defineProperties(Point.prototype, {\n  id: {\n    enumerable: true,\n    get: function() {\n      return this._id;\n    }\n  },\n  pid: {\n    enumerable: true,\n    get: function() {\n      return this._pid;\n    }\n  },\n  time: {\n    enumerable: true,\n    get: function() {\n      return this._time;\n    }\n  },\n  labelText: {\n    get: function() {\n      return this._labelText;\n    }\n  },\n  color: {\n    enumerable: true,\n    get: function() {\n      return this._color;\n    }\n  },\n  editable: {\n    enumerable: true,\n    get: function() {\n      return this._editable;\n    }\n  }\n});\n\nPoint.prototype.update = function(options) {\n  validatePointOptions(options, true);\n\n  if (objectHasProperty(options, 'id')) {\n    if (isNullOrUndefined(options.id)) {\n      throw new TypeError('point.update(): invalid id');\n    }\n\n    this._peaks.points.updatePointId(this, options.id);\n  }\n\n  this._setUserData(options);\n\n  this._peaks.emit('points.update', this, options);\n};\n\n/**\n * Returns <code>true</code> if the point lies with in a given time range.\n *\n * @param {Number} startTime The start of the time region, in seconds.\n * @param {Number} endTime The end of the time region, in seconds.\n * @returns {Boolean}\n */\n\nPoint.prototype.isVisible = function(startTime, endTime) {\n  return this.time >= startTime && this.time < endTime;\n};\n\nPoint.prototype._setTime = function(time) {\n  this._time = time;\n};\n\nexport { Point, setDefaultPointOptions, validatePointOptions };\n","/**\n * @file\n *\n * Defines the {@link WaveformPoints} class.\n *\n * @module waveform-points\n */\n\nimport { Point, setDefaultPointOptions, validatePointOptions } from './point';\nimport { extend, isNullOrUndefined, objectHasProperty } from './utils';\n\n/**\n * Point parameters.\n *\n * @typedef {Object} PointOptions\n * @global\n * @property {Number} time Point time, in seconds.\n * @property {Boolean=} editable If <code>true</code> the point time can be\n *   adjusted via the user interface.\n *   Default: <code>false</code>.\n * @property {String=} color Point marker color.\n *   Default: a random color.\n * @property {String=} labelText Point label text.\n *   Default: an empty string.\n * @property {String=} id A unique point identifier.\n *   Default: an automatically generated identifier.\n * @property {*} data Optional application-specific data.\n */\n\n/**\n * Handles all functionality related to the adding, removing and manipulation\n * of points. A point is a single instant of time.\n *\n * @class\n * @alias WaveformPoints\n *\n * @param {Peaks} peaks The parent Peaks object.\n */\n\nfunction WaveformPoints(peaks) {\n  this._peaks = peaks;\n  this._points = [];\n  this._pointsById = {};\n  this._pointsByPid = {};\n  this._pointIdCounter = 0;\n  this._pointPid = 0;\n}\n\n/**\n * Returns a new unique point id value.\n *\n * @returns {String}\n */\n\nWaveformPoints.prototype._getNextPointId = function() {\n  return 'peaks.point.' + this._pointIdCounter++;\n};\n\n/**\n * Returns a new unique point id value, for internal use within\n * Peaks.js only.\n *\n * @returns {Number}\n */\n\nWaveformPoints.prototype._getNextPid = function() {\n  return this._pointPid++;\n};\n\n/**\n * Adds a new point object.\n *\n * @private\n * @param {Point} point\n */\n\nWaveformPoints.prototype._addPoint = function(point) {\n  this._points.push(point);\n\n  this._pointsById[point.id] = point;\n  this._pointsByPid[point.pid] = point;\n};\n\n/**\n * Creates a new point object.\n *\n * @private\n * @param {PointOptions} options\n * @returns {Point}\n */\n\nWaveformPoints.prototype._createPoint = function(options) {\n  const pointOptions = {};\n\n  extend(pointOptions, options);\n\n  if (isNullOrUndefined(pointOptions.id)) {\n    pointOptions.id = this._getNextPointId();\n  }\n\n  const pid = this._getNextPid();\n\n  setDefaultPointOptions(pointOptions, this._peaks.options);\n\n  validatePointOptions(pointOptions, false);\n\n  return new Point(this._peaks, pid, pointOptions);\n};\n\n/**\n * Returns all points.\n *\n * @returns {Array<Point>}\n */\n\nWaveformPoints.prototype.getPoints = function() {\n  return this._points;\n};\n\n/**\n * Returns the point with the given id, or <code>undefined</code> if not found.\n *\n * @param {String} id\n * @returns {Point}\n */\n\nWaveformPoints.prototype.getPoint = function(id) {\n  return this._pointsById[id];\n};\n\n/**\n * Returns all points within a given time region.\n *\n * @param {Number} startTime The start of the time region, in seconds.\n * @param {Number} endTime The end of the time region, in seconds.\n * @returns {Array<Point>}\n */\n\nWaveformPoints.prototype.find = function(startTime, endTime) {\n  return this._points.filter(function(point) {\n    return point.isVisible(startTime, endTime);\n  });\n};\n\n/**\n * Adds one or more points to the timeline.\n *\n * @param {PointOptions|Array<PointOptions>} pointOrPoints\n *\n * @returns Point|Array<Point>\n */\n\nWaveformPoints.prototype.add = function(/* pointOrPoints */) {\n  const self = this;\n\n  const arrayArgs = Array.isArray(arguments[0]);\n  let points = arrayArgs ?\n               arguments[0] :\n               Array.prototype.slice.call(arguments);\n\n  points = points.map(function(pointOptions) {\n    const point = self._createPoint(pointOptions);\n\n    if (objectHasProperty(self._pointsById, point.id)) {\n      throw new Error('peaks.points.add(): duplicate id');\n    }\n\n    return point;\n  });\n\n  points.forEach(function(point) {\n    self._addPoint(point);\n  });\n\n  this._peaks.emit('points.add', {\n    points: points\n  });\n\n  return arrayArgs ? points : points[0];\n};\n\nWaveformPoints.prototype.updatePointId = function(point, newPointId) {\n  if (this._pointsById[point.id]) {\n    if (this._pointsById[newPointId]) {\n      throw new Error('point.update(): duplicate id');\n    }\n    else {\n      delete this._pointsById[point.id];\n      this._pointsById[newPointId] = point;\n    }\n  }\n};\n\n/**\n * Returns the indexes of points that match the given predicate.\n *\n * @private\n * @param {Function} predicate Predicate function to find matching points.\n * @returns {Array<Number>} An array of indexes into the points array of\n *   the matching elements.\n */\n\nWaveformPoints.prototype._findPoint = function(predicate) {\n  const indexes = [];\n\n  for (let i = 0, length = this._points.length; i < length; i++) {\n    if (predicate(this._points[i])) {\n      indexes.push(i);\n    }\n  }\n\n  return indexes;\n};\n\n/**\n * Removes the points at the given array indexes.\n *\n * @private\n * @param {Array<Number>} indexes The array indexes to remove.\n * @returns {Array<Point>} The removed {@link Point} objects.\n */\n\nWaveformPoints.prototype._removeIndexes = function(indexes) {\n  const removed = [];\n\n  for (let i = 0; i < indexes.length; i++) {\n    const index = indexes[i] - removed.length;\n\n    const itemRemoved = this._points.splice(index, 1)[0];\n\n    delete this._pointsById[itemRemoved.id];\n    delete this._pointsByPid[itemRemoved.pid];\n\n    removed.push(itemRemoved);\n  }\n\n  return removed;\n};\n\n/**\n * Removes all points that match a given predicate function.\n *\n * After removing the points, this function emits a\n * <code>points.remove</code> event with the removed {@link Point}\n * objects.\n *\n * @private\n * @param {Function} predicate A predicate function that identifies which\n *   points to remove.\n * @returns {Array<Point>} The removed {@link Points} objects.\n */\n\nWaveformPoints.prototype._removePoints = function(predicate) {\n  const indexes = this._findPoint(predicate);\n\n  const removed = this._removeIndexes(indexes);\n\n  this._peaks.emit('points.remove', {\n    points: removed\n  });\n\n  return removed;\n};\n\n/**\n * Removes the given point.\n *\n * @param {Point} point The point to remove.\n * @returns {Array<Point>} The removed points.\n */\n\nWaveformPoints.prototype.remove = function(point) {\n  return this._removePoints(function(p) {\n    return p === point;\n  });\n};\n\n/**\n * Removes any points with the given id.\n *\n * @param {String} id\n * @returns {Array<Point>} The removed {@link Point} objects.\n */\n\nWaveformPoints.prototype.removeById = function(pointId) {\n  return this._removePoints(function(point) {\n    return point.id === pointId;\n  });\n};\n\n/**\n * Removes any points at the given time.\n *\n * @param {Number} time\n * @returns {Array<Point>} The removed {@link Point} objects.\n */\n\nWaveformPoints.prototype.removeByTime = function(time) {\n  return this._removePoints(function(point) {\n    return point.time === time;\n  });\n};\n\n/**\n * Removes all points.\n *\n * After removing the points, this function emits a\n * <code>points.remove_all</code> event.\n */\n\nWaveformPoints.prototype.removeAll = function() {\n  this._points = [];\n  this._pointsById = {};\n  this._pointsByPid = {};\n  this._peaks.emit('points.remove_all');\n};\n\nexport default WaveformPoints;\n","/**\n * @file\n *\n * Defines the {@link Segment} class.\n *\n * @module segment\n */\n\nimport {\n  isBoolean, isNullOrUndefined, isLinearGradientColor,\n  isString, isValidTime, objectHasProperty\n} from './utils';\n\nconst segmentOptions = [\n  'id', 'pid', 'startTime', 'endTime', 'labelText', 'color', 'borderColor',\n  'markers', 'overlay', 'editable'\n];\n\nconst invalidOptions = [\n  'update', 'isVisible', 'peaks', 'pid'\n];\n\nfunction setDefaultSegmentOptions(options, globalSegmentOptions) {\n  if (isNullOrUndefined(options.color)) {\n    if (globalSegmentOptions.overlay) {\n      options.color = globalSegmentOptions.overlayColor;\n    }\n    else {\n      options.color = globalSegmentOptions.waveformColor;\n    }\n  }\n\n  if (isNullOrUndefined(options.borderColor)) {\n    options.borderColor = globalSegmentOptions.overlayBorderColor;\n  }\n\n  if (isNullOrUndefined(options.labelText)) {\n    options.labelText = '';\n  }\n\n  if (isNullOrUndefined(options.markers)) {\n    options.markers = globalSegmentOptions.markers;\n  }\n\n  if (isNullOrUndefined(options.overlay)) {\n    options.overlay = globalSegmentOptions.overlay;\n  }\n\n  if (isNullOrUndefined(options.editable)) {\n    options.editable = false;\n  }\n}\n\nfunction validateSegmentOptions(options, updating) {\n  const context = updating ? 'update()' : 'add()';\n\n  if (objectHasProperty(options, 'startTime') && !isValidTime(options.startTime)) {\n    throw new TypeError('peaks.segments.' + context + ': startTime should be a valid number');\n  }\n\n  if (objectHasProperty(options, 'endTime') && !isValidTime(options.endTime)) {\n    throw new TypeError('peaks.segments.' + context + ': endTime should be a valid number');\n  }\n\n  if (!updating) {\n    if (!objectHasProperty(options, 'startTime') || !objectHasProperty(options, 'endTime')) {\n      throw new TypeError('peaks.segments.' + context + ': missing startTime or endTime');\n    }\n  }\n\n  if (options.startTime < 0) {\n    throw new RangeError('peaks.segments.' + context + ': startTime should not be negative');\n  }\n\n  if (options.endTime < 0) {\n    throw new RangeError('peaks.segments.' + context + ': endTime should not be negative');\n  }\n\n  if (options.endTime < options.startTime) {\n    // eslint-disable-next-line @stylistic/js/max-len\n    throw new RangeError('peaks.segments.' + context + ': endTime should not be less than startTime');\n  }\n\n  if (objectHasProperty(options, 'labelText') && !isString(options.labelText)) {\n    throw new TypeError('peaks.segments.' + context + ': labelText must be a string');\n  }\n\n  if (updating && objectHasProperty(options, 'markers')) {\n    throw new TypeError('peaks.segments.' + context + ': cannot update markers attribute');\n  }\n\n  if (objectHasProperty(options, 'markers') && !isBoolean(options.markers)) {\n    throw new TypeError('peaks.segments.' + context + ': markers must be true or false');\n  }\n\n  if (updating && objectHasProperty(options, 'overlay')) {\n    throw new TypeError('peaks.segments.' + context + ': cannot update overlay attribute');\n  }\n\n  if (objectHasProperty(options, 'overlay') && !isBoolean(options.overlay)) {\n    throw new TypeError('peaks.segments.' + context + ': overlay must be true or false');\n  }\n\n  if (objectHasProperty(options, 'editable') && !isBoolean(options.editable)) {\n    throw new TypeError('peaks.segments.' + context + ': editable must be true or false');\n  }\n\n  if (objectHasProperty(options, 'color') &&\n    !isString(options.color) &&\n    !isLinearGradientColor(options.color)) {\n    // eslint-disable-next-line @stylistic/js/max-len\n    throw new TypeError('peaks.segments.' + context + ': color must be a string or a valid linear gradient object');\n  }\n\n  if (objectHasProperty(options, 'borderColor') && !isString(options.borderColor)) {\n    throw new TypeError('peaks.segments.' + context + ': borderColor must be a string');\n  }\n\n  invalidOptions.forEach(function(name) {\n    if (objectHasProperty(options, name)) {\n      throw new Error('peaks.segments.' + context + ': invalid option name: ' + name);\n    }\n  });\n\n  segmentOptions.forEach(function(name) {\n    if (objectHasProperty(options, '_' + name)) {\n      throw new Error('peaks.segments.' + context + ': invalid option name: _' + name);\n    }\n  });\n}\n\n/**\n * A segment is a region of time, with associated label and color.\n *\n * @class\n * @alias Segment\n *\n * @param {Peaks} peaks A reference to the Peaks instance.\n * @param {Number} pid An internal unique identifier for the segment.\n * @param {SegmentOptions} options User specified segment attributes.\n */\n\nfunction Segment(peaks, pid, options) {\n  this._peaks       = peaks;\n  this._pid         = pid;\n  this._id          = options.id;\n  this._startTime   = options.startTime;\n  this._endTime     = options.endTime;\n  this._labelText   = options.labelText;\n  this._color       = options.color;\n  this._borderColor = options.borderColor;\n  this._editable    = options.editable;\n  this._markers     = options.markers;\n  this._overlay     = options.overlay;\n\n  this._setUserData(options);\n}\n\nSegment.prototype._setUserData = function(options) {\n  for (const key in options) {\n    if (objectHasProperty(options, key)) {\n      if (segmentOptions.indexOf(key) === -1) {\n        this[key] = options[key];\n      }\n      else {\n        this['_' + key] = options[key];\n      }\n    }\n  }\n};\n\nObject.defineProperties(Segment.prototype, {\n  id: {\n    enumerable: true,\n    get: function() {\n      return this._id;\n    }\n  },\n  pid: {\n    enumerable: true,\n    get: function() {\n      return this._pid;\n    }\n  },\n  startTime: {\n    enumerable: true,\n    get: function() {\n      return this._startTime;\n    }\n  },\n  endTime: {\n    enumerable: true,\n    get: function() {\n      return this._endTime;\n    }\n  },\n  labelText: {\n    enumerable: true,\n    get: function() {\n      return this._labelText;\n    }\n  },\n  color: {\n    enumerable: true,\n    get: function() {\n      return this._color;\n    }\n  },\n  borderColor: {\n    enumerable: true,\n    get: function() {\n      return this._borderColor;\n    }\n  },\n  markers: {\n    enumerable: true,\n    get: function() {\n      return this._markers;\n    }\n  },\n  overlay: {\n    enumerable: true,\n    get: function() {\n      return this._overlay;\n    }\n  },\n  editable: {\n    enumerable: true,\n    get: function() {\n      return this._editable;\n    }\n  }\n});\n\nSegment.prototype.update = function(options) {\n  validateSegmentOptions(options, true);\n\n  if (objectHasProperty(options, 'id')) {\n    if (isNullOrUndefined(options.id)) {\n      throw new TypeError('segment.update(): invalid id');\n    }\n\n    this._peaks.segments.updateSegmentId(this, options.id);\n  }\n\n  this._setUserData(options);\n\n  this._peaks.emit('segments.update', this, options);\n};\n\n/**\n * Returns <code>true</code> if the segment overlaps a given time region.\n *\n * @param {Number} startTime The start of the time region, in seconds.\n * @param {Number} endTime The end of the time region, in seconds.\n * @returns {Boolean}\n */\n\nSegment.prototype.isVisible = function(startTime, endTime) {\n  // A special case, where the segment has zero duration\n  // and is at the start of the region.\n  if (this.startTime === this.endTime && this.startTime === startTime) {\n    return true;\n  }\n\n  // Segment ends before start of region.\n  if (this.endTime <= startTime) {\n    return false;\n  }\n\n  // Segment starts after end of region\n  if (this.startTime >= endTime) {\n    return false;\n  }\n\n  return true;\n};\n\nSegment.prototype._setStartTime = function(time) {\n  this._startTime = time;\n};\n\nSegment.prototype._setEndTime = function(time) {\n  this._endTime = time;\n};\n\nexport { Segment, setDefaultSegmentOptions, validateSegmentOptions };\n","/**\n * @file\n *\n * Defines the {@link WaveformSegments} class.\n *\n * @module waveform-segments\n */\n\nimport { Segment, setDefaultSegmentOptions, validateSegmentOptions } from './segment';\nimport { extend, isNullOrUndefined, objectHasProperty } from './utils';\n\n/**\n * Segment parameters.\n *\n * @typedef {Object} SegmentOptions\n * @global\n * @property {Number} startTime Segment start time, in seconds.\n * @property {Number} endTime Segment end time, in seconds.\n * @property {Boolean=} editable If <code>true</code> the segment start and\n *   end times can be adjusted via the user interface.\n *   Default: <code>false</code>.\n * @property {String=} color Segment waveform color.\n *   Default: Set by the <code>segmentOptions.waveformColor</code> option\n *   or the <code>segmentOptions.overlayColor</code> option.\n * @property {String=} borderColor Segment border color.\n *   Default: Set by the <code>segmentOptions.overlayBorderColor</code> option.\n * @property {String=} labelText Segment label text.\n *   Default: an empty string.\n * @property {String=} id A unique segment identifier.\n *   Default: an automatically generated identifier.\n * @property {*} data Optional application specific data.\n */\n\n/**\n * Handles all functionality related to the adding, removing and manipulation\n * of segments.\n *\n * @class\n * @alias WaveformSegments\n *\n * @param {Peaks} peaks The parent Peaks object.\n */\n\nfunction WaveformSegments(peaks) {\n  this._peaks = peaks;\n  this._segments = [];\n  this._segmentsById = {};\n  this._segmentsByPid = {};\n  this._segmentIdCounter = 0;\n  this._segmentPid = 0;\n  this._isInserting = false;\n}\n\n/**\n * Returns a new unique segment id value.\n *\n * @private\n * @returns {String}\n */\n\nWaveformSegments.prototype._getNextSegmentId = function() {\n  return 'peaks.segment.' + this._segmentIdCounter++;\n};\n\n/**\n * Returns a new unique segment id value, for internal use within\n * Peaks.js only.\n *\n * @private\n * @returns {Number}\n */\n\nWaveformSegments.prototype._getNextPid = function() {\n  return this._segmentPid++;\n};\n\n/**\n * Adds a new segment object.\n *\n * @private\n * @param {Segment} segment\n */\n\nWaveformSegments.prototype._addSegment = function(segment) {\n  this._segments.push(segment);\n\n  this._segmentsById[segment.id] = segment;\n  this._segmentsByPid[segment.pid] = segment;\n};\n\n/**\n * Creates a new segment object.\n *\n * @private\n * @param {SegmentOptions} options\n * @return {Segment}\n */\n\nWaveformSegments.prototype._createSegment = function(options) {\n  const segmentOptions = {};\n\n  extend(segmentOptions, options);\n\n  if (isNullOrUndefined(segmentOptions.id)) {\n    segmentOptions.id = this._getNextSegmentId();\n  }\n\n  const pid = this._getNextPid();\n\n  setDefaultSegmentOptions(segmentOptions, this._peaks.options.segmentOptions);\n\n  validateSegmentOptions(segmentOptions, false);\n\n  return new Segment(this._peaks, pid, segmentOptions);\n};\n\n/**\n * Returns all segments.\n *\n * @returns {Array<Segment>}\n */\n\nWaveformSegments.prototype.getSegments = function() {\n  return this._segments;\n};\n\n/**\n * Returns the segment with the given id, or <code>undefined</code> if not found.\n *\n * @param {String} id\n * @returns {Segment}\n */\n\nWaveformSegments.prototype.getSegment = function(id) {\n  return this._segmentsById[id];\n};\n\n/**\n * Returns all segments that overlap a given point in time.\n *\n * @param {Number} time\n * @returns {Array<Segment>}\n */\n\nWaveformSegments.prototype.getSegmentsAtTime = function(time) {\n  return this._segments.filter(function(segment) {\n    return time >= segment.startTime && time < segment.endTime;\n  });\n};\n\n/**\n * Returns all segments that overlap a given time region.\n *\n * @param {Number} startTime The start of the time region, in seconds.\n * @param {Number} endTime The end of the time region, in seconds.\n *\n * @returns {Array<Segment>}\n */\n\nWaveformSegments.prototype.find = function(startTime, endTime) {\n  return this._segments.filter(function(segment) {\n    return segment.isVisible(startTime, endTime);\n  });\n};\n\n/**\n * Returns a copy of the segments array, sorted by ascending segment start time.\n *\n * @returns {Array<Segment>}\n */\n\nWaveformSegments.prototype._getSortedSegments = function() {\n  return this._segments.slice().sort(function(a, b) {\n    return a.startTime - b.startTime;\n  });\n};\n\nWaveformSegments.prototype.findPreviousSegment = function(segment) {\n  const sortedSegments = this._getSortedSegments();\n\n  const index = sortedSegments.findIndex(function(s) {\n    return s.id === segment.id;\n  });\n\n  if (index !== -1) {\n    return sortedSegments[index - 1];\n  }\n\n  return undefined;\n};\n\nWaveformSegments.prototype.findNextSegment = function(segment) {\n  const sortedSegments = this._getSortedSegments();\n\n  const index = sortedSegments.findIndex(function(s) {\n    return s.id === segment.id;\n  });\n\n  if (index !== -1) {\n    return sortedSegments[index + 1];\n  }\n\n  return undefined;\n};\n\n/**\n * Adds one or more segments to the timeline.\n *\n * @param {SegmentOptions|Array<SegmentOptions>} segmentOrSegments\n *\n * @returns Segment|Array<Segment>\n */\n\nWaveformSegments.prototype.add = function(/* segmentOrSegments */) {\n  const self = this;\n\n  const arrayArgs = Array.isArray(arguments[0]);\n  let segments = arrayArgs ?\n                 arguments[0] :\n                 Array.prototype.slice.call(arguments);\n\n  segments = segments.map(function(segmentOptions) {\n    const segment = self._createSegment(segmentOptions);\n\n    if (objectHasProperty(self._segmentsById, segment.id)) {\n      throw new Error('peaks.segments.add(): duplicate id');\n    }\n\n    return segment;\n  });\n\n  segments.forEach(function(segment) {\n    self._addSegment(segment);\n  });\n\n  this._peaks.emit('segments.add', {\n    segments: segments,\n    insert: this._isInserting\n  });\n\n  return arrayArgs ? segments : segments[0];\n};\n\nWaveformSegments.prototype.updateSegmentId = function(segment, newSegmentId) {\n  if (this._segmentsById[segment.id]) {\n    if (this._segmentsById[newSegmentId]) {\n      throw new Error('segment.update(): duplicate id');\n    }\n    else {\n      delete this._segmentsById[segment.id];\n      this._segmentsById[newSegmentId] = segment;\n    }\n  }\n};\n\n/**\n * Returns the indexes of segments that match the given predicate.\n *\n * @private\n * @param {Function} predicate Predicate function to find matching segments.\n * @returns {Array<Number>} An array of indexes into the segments array of\n *   the matching elements.\n */\n\nWaveformSegments.prototype._findSegment = function(predicate) {\n  const indexes = [];\n\n  for (let i = 0, length = this._segments.length; i < length; i++) {\n    if (predicate(this._segments[i])) {\n      indexes.push(i);\n    }\n  }\n\n  return indexes;\n};\n\n/**\n * Removes the segments at the given array indexes.\n *\n * @private\n * @param {Array<Number>} indexes The array indexes to remove.\n * @returns {Array<Segment>} The removed {@link Segment} objects.\n */\n\nWaveformSegments.prototype._removeIndexes = function(indexes) {\n  const removed = [];\n\n  for (let i = 0; i < indexes.length; i++) {\n    const index = indexes[i] - removed.length;\n\n    const itemRemoved = this._segments.splice(index, 1)[0];\n\n    delete this._segmentsById[itemRemoved.id];\n    delete this._segmentsByPid[itemRemoved.pid];\n\n    removed.push(itemRemoved);\n  }\n\n  return removed;\n};\n\n/**\n * Removes all segments that match a given predicate function.\n *\n * After removing the segments, this function also emits a\n * <code>segments.remove</code> event with the removed {@link Segment}\n * objects.\n *\n * @private\n * @param {Function} predicate A predicate function that identifies which\n *   segments to remove.\n * @returns {Array<Segment>} The removed {@link Segment} objects.\n */\n\nWaveformSegments.prototype._removeSegments = function(predicate) {\n  const indexes = this._findSegment(predicate);\n\n  const removed = this._removeIndexes(indexes);\n\n  this._peaks.emit('segments.remove', {\n    segments: removed\n  });\n\n  return removed;\n};\n\n/**\n * Removes the given segment.\n *\n * @param {Segment} segment The segment to remove.\n * @returns {Array<Segment>} The removed segment.\n */\n\nWaveformSegments.prototype.remove = function(segment) {\n  return this._removeSegments(function(s) {\n    return s === segment;\n  });\n};\n\n/**\n * Removes any segments with the given id.\n *\n * @param {String} id\n * @returns {Array<Segment>} The removed {@link Segment} objects.\n */\n\nWaveformSegments.prototype.removeById = function(segmentId) {\n  return this._removeSegments(function(segment) {\n    return segment.id === segmentId;\n  });\n};\n\n/**\n * Removes any segments with the given start time, and optional end time.\n *\n * @param {Number} startTime Segments with this start time are removed.\n * @param {Number?} endTime If present, only segments with both the given\n *   start time and end time are removed.\n * @returns {Array<Segment>} The removed {@link Segment} objects.\n */\n\nWaveformSegments.prototype.removeByTime = function(startTime, endTime) {\n  endTime = (typeof endTime === 'number') ? endTime : 0;\n\n  let filter;\n\n  if (endTime > 0) {\n    filter = function(segment) {\n      return segment.startTime === startTime && segment.endTime === endTime;\n    };\n  }\n  else {\n    filter = function(segment) {\n      return segment.startTime === startTime;\n    };\n  }\n\n  return this._removeSegments(filter);\n};\n\n/**\n * Removes all segments.\n *\n * After removing the segments, this function emits a\n * <code>segments.remove_all</code> event.\n */\n\nWaveformSegments.prototype.removeAll = function() {\n  this._segments = [];\n  this._segmentsById = {};\n  this._segmentsByPid = {};\n  this._peaks.emit('segments.remove_all');\n};\n\nWaveformSegments.prototype.setInserting = function(value) {\n  this._isInserting = value;\n};\n\nWaveformSegments.prototype.isInserting = function() {\n  return this._isInserting;\n};\n\nexport default WaveformSegments;\n","/**\n * @file\n *\n * Defines the {@link KeyboardHandler} class.\n *\n * @module keyboard-handler\n */\n\nconst nodes = ['OBJECT', 'TEXTAREA', 'INPUT', 'SELECT', 'OPTION'];\n\nconst SPACE = 32,\n    TAB = 9,\n    LEFT_ARROW = 37,\n    RIGHT_ARROW = 39;\n\nconst keys = [SPACE, TAB, LEFT_ARROW, RIGHT_ARROW];\n\n/**\n * Configures keyboard event handling.\n *\n * @class\n * @alias KeyboardHandler\n *\n * @param {EventEmitter} eventEmitter\n */\n\nfunction KeyboardHandler(eventEmitter) {\n  this.eventEmitter = eventEmitter;\n\n  this._handleKeyEvent = this._handleKeyEvent.bind(this);\n\n  document.addEventListener('keydown', this._handleKeyEvent);\n  document.addEventListener('keypress', this._handleKeyEvent);\n  document.addEventListener('keyup', this._handleKeyEvent);\n}\n\n/**\n * Keyboard event handler function.\n *\n * @note Arrow keys only triggered on keydown, not keypress.\n *\n * @param {KeyboardEvent} event\n * @private\n */\n\nKeyboardHandler.prototype._handleKeyEvent = function handleKeyEvent(event) {\n  if (nodes.indexOf(event.target.nodeName) === -1) {\n    if (keys.indexOf(event.type) > -1) {\n      event.preventDefault();\n    }\n\n    if (event.type === 'keydown' || event.type === 'keypress') {\n      switch (event.keyCode) {\n        case SPACE:\n          this.eventEmitter.emit('keyboard.space');\n          break;\n\n        case TAB:\n          this.eventEmitter.emit('keyboard.tab');\n          break;\n      }\n    }\n    else if (event.type === 'keyup') {\n      switch (event.keyCode) {\n        case LEFT_ARROW:\n          if (event.shiftKey) {\n            this.eventEmitter.emit('keyboard.shift_left');\n          }\n          else {\n            this.eventEmitter.emit('keyboard.left');\n          }\n          break;\n\n        case RIGHT_ARROW:\n          if (event.shiftKey) {\n            this.eventEmitter.emit('keyboard.shift_right');\n          }\n          else {\n            this.eventEmitter.emit('keyboard.right');\n          }\n          break;\n      }\n    }\n  }\n};\n\nKeyboardHandler.prototype.destroy = function() {\n  document.removeEventListener('keydown', this._handleKeyEvent);\n  document.removeEventListener('keypress', this._handleKeyEvent);\n  document.removeEventListener('keyup', this._handleKeyEvent);\n};\n\nexport default KeyboardHandler;\n","/**\n * @file\n *\n * Implementation of {@link Player} adapter based on an <code>&lt;audio&gt;</code>\n * or <code>&lt;video&gt;</code> HTML element.\n *\n * @module mediaelement-player\n */\n\n/**\n * Checks whether the given HTMLMediaElement has either a src attribute\n * or any child <code>&lt;source&gt;</code> nodes.\n */\n\nfunction mediaElementHasSource(mediaElement) {\n  if (mediaElement.src) {\n    return true;\n  }\n\n  if (mediaElement.querySelector('source')) {\n    return true;\n  }\n\n  return false;\n}\n\n/**\n * A wrapper for interfacing with the HTMLMediaElement API.\n * Initializes the player for a given media element.\n *\n * @class\n * @alias MediaElementPlayer\n * @param {HTMLMediaElement} mediaElement The HTML <code>&lt;audio&gt;</code>\n *   or <code>&lt;video&gt;</code> element to associate with the\n *   {@link Peaks} instance.\n */\n\nfunction MediaElementPlayer(mediaElement) {\n  this._mediaElement = mediaElement;\n}\n\n/**\n * Adds an event listener to the media element.\n *\n * @private\n * @param {String} type The event type to listen for.\n * @param {Function} callback An event handler function.\n */\n\nMediaElementPlayer.prototype._addMediaListener = function(type, callback) {\n  this._listeners.push({ type: type, callback: callback });\n  this._mediaElement.addEventListener(type, callback);\n};\n\nMediaElementPlayer.prototype.init = function(eventEmitter) {\n  const self = this;\n\n  self._eventEmitter = eventEmitter;\n  self._listeners = [];\n  self._duration = self.getDuration();\n\n  self._addMediaListener('timeupdate', function() {\n    self._eventEmitter.emit('player.timeupdate', self.getCurrentTime());\n  });\n\n  self._addMediaListener('playing', function() {\n    self._eventEmitter.emit('player.playing', self.getCurrentTime());\n  });\n\n  self._addMediaListener('pause', function() {\n    self._eventEmitter.emit('player.pause', self.getCurrentTime());\n  });\n\n  self._addMediaListener('ended', function() {\n    self._eventEmitter.emit('player.ended');\n  });\n\n  self._addMediaListener('seeked', function() {\n    self._eventEmitter.emit('player.seeked', self.getCurrentTime());\n  });\n\n  self._addMediaListener('canplay', function() {\n    self._eventEmitter.emit('player.canplay');\n  });\n\n  self._addMediaListener('error', function(event) {\n    self._eventEmitter.emit('player.error', event.target.error);\n  });\n\n  self._interval = null;\n\n  if (!mediaElementHasSource(self._mediaElement)) {\n    return Promise.resolve();\n  }\n  else if (self._mediaElement.error &&\n           self._mediaElement.error.code === MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED) {\n    // The media element has a source, but the format is not supported.\n    return Promise.reject(self._mediaElement.error);\n  }\n\n  return new Promise(function(resolve, reject) {\n    function eventHandler(event) {\n      self._mediaElement.removeEventListener('loadedmetadata', eventHandler);\n      self._mediaElement.removeEventListener('error', eventHandler);\n\n      if (event.type === 'loadedmetadata') {\n        resolve();\n      }\n      else {\n        reject(event.target.error);\n      }\n    }\n\n    // If the media element has preload=\"none\", clicking to seek in the\n    // waveform won't work, so here we force the media to load.\n    if (self._mediaElement.readyState === HTMLMediaElement.HAVE_NOTHING) {\n      // Wait for the readyState to change to HAVE_METADATA so we know the\n      // duration is valid, otherwise it could be NaN.\n      self._mediaElement.addEventListener('loadedmetadata', eventHandler);\n      self._mediaElement.addEventListener('error', eventHandler);\n      self._mediaElement.load();\n    }\n    else {\n      resolve();\n    }\n  });\n};\n\n/**\n * Cleans up the player object, removing all event listeners from the\n * associated media element.\n */\n\nMediaElementPlayer.prototype.destroy = function() {\n  for (let i = 0; i < this._listeners.length; i++) {\n    const listener = this._listeners[i];\n\n    this._mediaElement.removeEventListener(\n      listener.type,\n      listener.callback\n    );\n  }\n\n  this._listeners.length = 0;\n\n  this._mediaElement = null;\n};\n\nMediaElementPlayer.prototype.play = function() {\n  return this._mediaElement.play();\n};\n\nMediaElementPlayer.prototype.pause = function() {\n  this._mediaElement.pause();\n};\n\nMediaElementPlayer.prototype.isPlaying = function() {\n  return !this._mediaElement.paused;\n};\n\nMediaElementPlayer.prototype.isSeeking = function() {\n  return this._mediaElement.seeking;\n};\n\nMediaElementPlayer.prototype.getCurrentTime = function() {\n  return this._mediaElement.currentTime;\n};\n\nMediaElementPlayer.prototype.getDuration = function() {\n  return this._mediaElement.duration;\n};\n\nMediaElementPlayer.prototype.seek = function(time) {\n  this._mediaElement.currentTime = time;\n};\n\nfunction SetSourceHandler(eventEmitter, mediaElement) {\n  this._eventEmitter = eventEmitter;\n  this._mediaElement = mediaElement;\n  this._playerCanPlayHandler = this._playerCanPlayHandler.bind(this);\n  this._playerErrorHandler = this._playerErrorHandler.bind(this);\n}\n\nSetSourceHandler.prototype.setSource = function(options, callback) {\n  const self = this;\n\n  self._options = options;\n  self._callback = callback;\n\n  self._eventEmitter.on('player.canplay', self._playerCanPlayHandler);\n  self._eventEmitter.on('player.error', self._playerErrorHandler);\n\n  return new Promise(function(resolve, reject) {\n    self._resolve = resolve;\n    self._reject = reject;\n\n    self._eventEmitter.on('player.canplay', self._playerCanPlayHandler);\n    self._eventEmitter.on('player.error', self._playerErrorHandler);\n\n    self._mediaElement.setAttribute('src', options.mediaUrl);\n\n    // Force the media element to load, in case the media element\n    // has preload=\"none\".\n    if (self._mediaElement.readyState === HTMLMediaElement.HAVE_NOTHING) {\n      self._mediaElement.load();\n    }\n  });\n};\n\nSetSourceHandler.prototype._reset = function() {\n  this._eventEmitter.removeListener('player.canplay', this._playerCanPlayHandler);\n  this._eventEmitter.removeListener('player.error', this._playerErrorHandler);\n};\n\nSetSourceHandler.prototype._playerCanPlayHandler = function() {\n  this._reset();\n\n  this._resolve();\n};\n\nSetSourceHandler.prototype._playerErrorHandler = function(err) {\n  this._reset();\n\n  // Return the MediaError object from the media element\n  this._reject(err);\n};\n\nMediaElementPlayer.prototype.setSource = function(options) {\n  if (!options.mediaUrl) {\n    // eslint-disable-next-line @stylistic/js/max-len\n    return Promise.reject(new Error('peaks.setSource(): options must contain a mediaUrl when using mediaElement'));\n  }\n\n  const setSourceHandler = new SetSourceHandler(this._eventEmitter, this._mediaElement);\n\n  return setSourceHandler.setSource(options);\n};\n\nexport default MediaElementPlayer;\n","/**\n * @file\n *\n * A general audio player class which interfaces with external audio players.\n * The default audio player in Peaks.js is {@link MediaElementPlayer}.\n *\n * @module player\n */\n\nimport { isValidTime } from './utils';\n\nfunction getAllPropertiesFrom(adapter) {\n  const allProperties = [];\n  let obj = adapter;\n\n  while (obj) {\n    Object.getOwnPropertyNames(obj).forEach(function(p) {\n      allProperties.push(p);\n    });\n\n    obj = Object.getPrototypeOf(obj);\n  }\n\n  return allProperties;\n}\n\nfunction validateAdapter(adapter) {\n  const publicAdapterMethods = [\n    'init',\n    'destroy',\n    'play',\n    'pause',\n    'isPlaying',\n    'isSeeking',\n    'getCurrentTime',\n    'getDuration',\n    'seek'\n  ];\n\n  const allProperties = getAllPropertiesFrom(adapter);\n\n  publicAdapterMethods.forEach(function(method) {\n    if (!allProperties.includes(method)) {\n      throw new TypeError('Peaks.init(): Player method ' + method + ' is undefined');\n    }\n\n    if ((typeof adapter[method]) !== 'function') {\n      throw new TypeError('Peaks.init(): Player method ' + method + ' is not a function');\n    }\n  });\n}\n\n/**\n * A wrapper for interfacing with an external player API.\n *\n * @class\n * @alias Player\n *\n * @param {Peaks} peaks The parent {@link Peaks} object.\n * @param {Adapter} adapter The player adapter.\n */\n\nfunction Player(peaks, adapter) {\n  this._peaks = peaks;\n\n  this._playingSegment = false;\n  this._segment = null;\n  this._loop = false;\n  this._playSegmentTimerCallback = this._playSegmentTimerCallback.bind(this);\n\n  validateAdapter(adapter);\n  this._adapter = adapter;\n}\n\nPlayer.prototype.init = function() {\n  return this._adapter.init(this._peaks);\n};\n\n/**\n * Cleans up the player object.\n */\n\nPlayer.prototype.destroy = function() {\n  this._adapter.destroy();\n};\n\n/**\n * Starts playback.\n * @returns {Promise}\n */\n\nPlayer.prototype.play = function() {\n  return this._adapter.play();\n};\n\n/**\n * Pauses playback.\n */\n\nPlayer.prototype.pause = function() {\n  this._adapter.pause();\n};\n\n/**\n * @returns {Boolean} <code>true</code> if playing, <code>false</code>\n * otherwise.\n */\n\nPlayer.prototype.isPlaying = function() {\n  return this._adapter.isPlaying();\n};\n\n/**\n * @returns {boolean} <code>true</code> if seeking\n */\n\nPlayer.prototype.isSeeking = function() {\n  return this._adapter.isSeeking();\n};\n\n/**\n * Returns the current playback time position, in seconds.\n *\n * @returns {Number}\n */\n\nPlayer.prototype.getCurrentTime = function() {\n  return this._adapter.getCurrentTime();\n};\n\n/**\n * Returns the media duration, in seconds.\n *\n * @returns {Number}\n */\n\nPlayer.prototype.getDuration = function() {\n  return this._adapter.getDuration();\n};\n\n/**\n * Seeks to a given time position within the media.\n *\n * @param {Number} time The time position, in seconds.\n */\n\nPlayer.prototype.seek = function(time) {\n  if (!isValidTime(time)) {\n    this._peaks._logger('peaks.player.seek(): parameter must be a valid time, in seconds');\n    return;\n  }\n\n  this._adapter.seek(time);\n};\n\n/**\n * Plays the given segment.\n *\n * @param {Segment} segment The segment denoting the time region to play.\n * @param {Boolean} loop If true, playback is looped.\n */\n\nPlayer.prototype.playSegment = function(segment, loop) {\n  const self = this;\n\n  if (!segment ||\n    !isValidTime(segment.startTime) ||\n    !isValidTime(segment.endTime)) {\n    return Promise.reject(\n      new Error('peaks.player.playSegment(): parameter must be a segment object')\n    );\n  }\n\n  self._segment = segment;\n  self._loop = loop;\n\n  // Set audio time to segment start time\n  self.seek(segment.startTime);\n\n  self._peaks.once('player.playing', function() {\n    if (!self._playingSegment) {\n      self._playingSegment = true;\n\n      // We need to use requestAnimationFrame here as the timeupdate event\n      // doesn't fire often enough.\n      window.requestAnimationFrame(self._playSegmentTimerCallback);\n    }\n  });\n\n  // Start playing audio\n  return self.play();\n};\n\nPlayer.prototype._playSegmentTimerCallback = function() {\n  if (!this.isPlaying()) {\n    this._playingSegment = false;\n    return;\n  }\n  else if (this.getCurrentTime() >= this._segment.endTime) {\n    if (this._loop) {\n      this.seek(this._segment.startTime);\n    }\n    else {\n      this.pause();\n      this._peaks.emit('player.ended');\n      this._playingSegment = false;\n      return;\n    }\n  }\n\n  window.requestAnimationFrame(this._playSegmentTimerCallback);\n};\n\nPlayer.prototype._setSource = function(options) {\n  return this._adapter.setSource(options);\n};\n\nexport default Player;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Line = void 0;\nconst Factory_1 = require(\"../Factory\");\nconst Global_1 = require(\"../Global\");\nconst Shape_1 = require(\"../Shape\");\nconst Validators_1 = require(\"../Validators\");\nfunction getControlPoints(x0, y0, x1, y1, x2, y2, t) {\n    const d01 = Math.sqrt(Math.pow(x1 - x0, 2) + Math.pow(y1 - y0, 2)), d12 = Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2)), fa = (t * d01) / (d01 + d12), fb = (t * d12) / (d01 + d12), p1x = x1 - fa * (x2 - x0), p1y = y1 - fa * (y2 - y0), p2x = x1 + fb * (x2 - x0), p2y = y1 + fb * (y2 - y0);\n    return [p1x, p1y, p2x, p2y];\n}\nfunction expandPoints(p, tension) {\n    const len = p.length, allPoints = [];\n    for (let n = 2; n < len - 2; n += 2) {\n        const cp = getControlPoints(p[n - 2], p[n - 1], p[n], p[n + 1], p[n + 2], p[n + 3], tension);\n        if (isNaN(cp[0])) {\n            continue;\n        }\n        allPoints.push(cp[0]);\n        allPoints.push(cp[1]);\n        allPoints.push(p[n]);\n        allPoints.push(p[n + 1]);\n        allPoints.push(cp[2]);\n        allPoints.push(cp[3]);\n    }\n    return allPoints;\n}\nclass Line extends Shape_1.Shape {\n    constructor(config) {\n        super(config);\n        this.on('pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva', function () {\n            this._clearCache('tensionPoints');\n        });\n    }\n    _sceneFunc(context) {\n        const points = this.points(), length = points.length, tension = this.tension(), closed = this.closed(), bezier = this.bezier();\n        if (!length) {\n            return;\n        }\n        let n = 0;\n        context.beginPath();\n        context.moveTo(points[0], points[1]);\n        if (tension !== 0 && length > 4) {\n            const tp = this.getTensionPoints();\n            const len = tp.length;\n            n = closed ? 0 : 4;\n            if (!closed) {\n                context.quadraticCurveTo(tp[0], tp[1], tp[2], tp[3]);\n            }\n            while (n < len - 2) {\n                context.bezierCurveTo(tp[n++], tp[n++], tp[n++], tp[n++], tp[n++], tp[n++]);\n            }\n            if (!closed) {\n                context.quadraticCurveTo(tp[len - 2], tp[len - 1], points[length - 2], points[length - 1]);\n            }\n        }\n        else if (bezier) {\n            n = 2;\n            while (n < length) {\n                context.bezierCurveTo(points[n++], points[n++], points[n++], points[n++], points[n++], points[n++]);\n            }\n        }\n        else {\n            for (n = 2; n < length; n += 2) {\n                context.lineTo(points[n], points[n + 1]);\n            }\n        }\n        if (closed) {\n            context.closePath();\n            context.fillStrokeShape(this);\n        }\n        else {\n            context.strokeShape(this);\n        }\n    }\n    getTensionPoints() {\n        return this._getCache('tensionPoints', this._getTensionPoints);\n    }\n    _getTensionPoints() {\n        if (this.closed()) {\n            return this._getTensionPointsClosed();\n        }\n        else {\n            return expandPoints(this.points(), this.tension());\n        }\n    }\n    _getTensionPointsClosed() {\n        const p = this.points(), len = p.length, tension = this.tension(), firstControlPoints = getControlPoints(p[len - 2], p[len - 1], p[0], p[1], p[2], p[3], tension), lastControlPoints = getControlPoints(p[len - 4], p[len - 3], p[len - 2], p[len - 1], p[0], p[1], tension), middle = expandPoints(p, tension), tp = [firstControlPoints[2], firstControlPoints[3]]\n            .concat(middle)\n            .concat([\n            lastControlPoints[0],\n            lastControlPoints[1],\n            p[len - 2],\n            p[len - 1],\n            lastControlPoints[2],\n            lastControlPoints[3],\n            firstControlPoints[0],\n            firstControlPoints[1],\n            p[0],\n            p[1],\n        ]);\n        return tp;\n    }\n    getWidth() {\n        return this.getSelfRect().width;\n    }\n    getHeight() {\n        return this.getSelfRect().height;\n    }\n    getSelfRect() {\n        let points = this.points();\n        if (points.length < 4) {\n            return {\n                x: points[0] || 0,\n                y: points[1] || 0,\n                width: 0,\n                height: 0,\n            };\n        }\n        if (this.tension() !== 0) {\n            points = [\n                points[0],\n                points[1],\n                ...this._getTensionPoints(),\n                points[points.length - 2],\n                points[points.length - 1],\n            ];\n        }\n        else {\n            points = this.points();\n        }\n        let minX = points[0];\n        let maxX = points[0];\n        let minY = points[1];\n        let maxY = points[1];\n        let x, y;\n        for (let i = 0; i < points.length / 2; i++) {\n            x = points[i * 2];\n            y = points[i * 2 + 1];\n            minX = Math.min(minX, x);\n            maxX = Math.max(maxX, x);\n            minY = Math.min(minY, y);\n            maxY = Math.max(maxY, y);\n        }\n        return {\n            x: minX,\n            y: minY,\n            width: maxX - minX,\n            height: maxY - minY,\n        };\n    }\n}\nexports.Line = Line;\nLine.prototype.className = 'Line';\nLine.prototype._attrsAffectingSize = ['points', 'bezier', 'tension'];\n(0, Global_1._registerNode)(Line);\nFactory_1.Factory.addGetterSetter(Line, 'closed', false);\nFactory_1.Factory.addGetterSetter(Line, 'bezier', false);\nFactory_1.Factory.addGetterSetter(Line, 'tension', 0, (0, Validators_1.getNumberValidator)());\nFactory_1.Factory.addGetterSetter(Line, 'points', [], (0, Validators_1.getNumberArrayValidator)());\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Rect = void 0;\nconst Factory_1 = require(\"../Factory\");\nconst Shape_1 = require(\"../Shape\");\nconst Global_1 = require(\"../Global\");\nconst Util_1 = require(\"../Util\");\nconst Validators_1 = require(\"../Validators\");\nclass Rect extends Shape_1.Shape {\n    _sceneFunc(context) {\n        const cornerRadius = this.cornerRadius(), width = this.width(), height = this.height();\n        context.beginPath();\n        if (!cornerRadius) {\n            context.rect(0, 0, width, height);\n        }\n        else {\n            Util_1.Util.drawRoundedRectPath(context, width, height, cornerRadius);\n        }\n        context.closePath();\n        context.fillStrokeShape(this);\n    }\n}\nexports.Rect = Rect;\nRect.prototype.className = 'Rect';\n(0, Global_1._registerNode)(Rect);\nFactory_1.Factory.addGetterSetter(Rect, 'cornerRadius', 0, (0, Validators_1.getNumberOrArrayOfNumbersValidator)(4));\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Text = void 0;\nexports.stringToArray = stringToArray;\nconst Util_1 = require(\"../Util\");\nconst Factory_1 = require(\"../Factory\");\nconst Shape_1 = require(\"../Shape\");\nconst Global_1 = require(\"../Global\");\nconst Validators_1 = require(\"../Validators\");\nconst Global_2 = require(\"../Global\");\nfunction stringToArray(string) {\n    return [...string].reduce((acc, char, index, array) => {\n        if (/\\p{Emoji}/u.test(char)) {\n            const nextChar = array[index + 1];\n            if (nextChar && /\\p{Emoji_Modifier}|\\u200D/u.test(nextChar)) {\n                acc.push(char + nextChar);\n                array[index + 1] = '';\n            }\n            else {\n                acc.push(char);\n            }\n        }\n        else if (/\\p{Regional_Indicator}{2}/u.test(char + (array[index + 1] || ''))) {\n            acc.push(char + array[index + 1]);\n        }\n        else if (index > 0 && /\\p{Mn}|\\p{Me}|\\p{Mc}/u.test(char)) {\n            acc[acc.length - 1] += char;\n        }\n        else if (char) {\n            acc.push(char);\n        }\n        return acc;\n    }, []);\n}\nconst AUTO = 'auto', CENTER = 'center', INHERIT = 'inherit', JUSTIFY = 'justify', CHANGE_KONVA = 'Change.konva', CONTEXT_2D = '2d', DASH = '-', LEFT = 'left', TEXT = 'text', TEXT_UPPER = 'Text', TOP = 'top', BOTTOM = 'bottom', MIDDLE = 'middle', NORMAL = 'normal', PX_SPACE = 'px ', SPACE = ' ', RIGHT = 'right', RTL = 'rtl', WORD = 'word', CHAR = 'char', NONE = 'none', ELLIPSIS = '', ATTR_CHANGE_LIST = [\n    'direction',\n    'fontFamily',\n    'fontSize',\n    'fontStyle',\n    'fontVariant',\n    'padding',\n    'align',\n    'verticalAlign',\n    'lineHeight',\n    'text',\n    'width',\n    'height',\n    'wrap',\n    'ellipsis',\n    'letterSpacing',\n], attrChangeListLen = ATTR_CHANGE_LIST.length;\nfunction normalizeFontFamily(fontFamily) {\n    return fontFamily\n        .split(',')\n        .map((family) => {\n        family = family.trim();\n        const hasSpace = family.indexOf(' ') >= 0;\n        const hasQuotes = family.indexOf('\"') >= 0 || family.indexOf(\"'\") >= 0;\n        if (hasSpace && !hasQuotes) {\n            family = `\"${family}\"`;\n        }\n        return family;\n    })\n        .join(', ');\n}\nlet dummyContext;\nfunction getDummyContext() {\n    if (dummyContext) {\n        return dummyContext;\n    }\n    dummyContext = Util_1.Util.createCanvasElement().getContext(CONTEXT_2D);\n    return dummyContext;\n}\nfunction _fillFunc(context) {\n    context.fillText(this._partialText, this._partialTextX, this._partialTextY);\n}\nfunction _strokeFunc(context) {\n    context.setAttr('miterLimit', 2);\n    context.strokeText(this._partialText, this._partialTextX, this._partialTextY);\n}\nfunction checkDefaultFill(config) {\n    config = config || {};\n    if (!config.fillLinearGradientColorStops &&\n        !config.fillRadialGradientColorStops &&\n        !config.fillPatternImage) {\n        config.fill = config.fill || 'black';\n    }\n    return config;\n}\nclass Text extends Shape_1.Shape {\n    constructor(config) {\n        super(checkDefaultFill(config));\n        this._partialTextX = 0;\n        this._partialTextY = 0;\n        for (let n = 0; n < attrChangeListLen; n++) {\n            this.on(ATTR_CHANGE_LIST[n] + CHANGE_KONVA, this._setTextData);\n        }\n        this._setTextData();\n    }\n    _sceneFunc(context) {\n        const textArr = this.textArr, textArrLen = textArr.length;\n        if (!this.text()) {\n            return;\n        }\n        let padding = this.padding(), fontSize = this.fontSize(), lineHeightPx = this.lineHeight() * fontSize, verticalAlign = this.verticalAlign(), direction = this.direction(), alignY = 0, align = this.align(), totalWidth = this.getWidth(), letterSpacing = this.letterSpacing(), fill = this.fill(), textDecoration = this.textDecoration(), shouldUnderline = textDecoration.indexOf('underline') !== -1, shouldLineThrough = textDecoration.indexOf('line-through') !== -1, n;\n        direction = direction === INHERIT ? context.direction : direction;\n        let translateY = lineHeightPx / 2;\n        let baseline = MIDDLE;\n        if (Global_1.Konva._fixTextRendering) {\n            const metrics = this.measureSize('M');\n            baseline = 'alphabetic';\n            translateY =\n                (metrics.fontBoundingBoxAscent - metrics.fontBoundingBoxDescent) / 2 +\n                    lineHeightPx / 2;\n        }\n        if (direction === RTL) {\n            context.setAttr('direction', direction);\n        }\n        context.setAttr('font', this._getContextFont());\n        context.setAttr('textBaseline', baseline);\n        context.setAttr('textAlign', LEFT);\n        if (verticalAlign === MIDDLE) {\n            alignY = (this.getHeight() - textArrLen * lineHeightPx - padding * 2) / 2;\n        }\n        else if (verticalAlign === BOTTOM) {\n            alignY = this.getHeight() - textArrLen * lineHeightPx - padding * 2;\n        }\n        context.translate(padding, alignY + padding);\n        for (n = 0; n < textArrLen; n++) {\n            let lineTranslateX = 0;\n            let lineTranslateY = 0;\n            const obj = textArr[n], text = obj.text, width = obj.width, lastLine = obj.lastInParagraph;\n            context.save();\n            if (align === RIGHT) {\n                lineTranslateX += totalWidth - width - padding * 2;\n            }\n            else if (align === CENTER) {\n                lineTranslateX += (totalWidth - width - padding * 2) / 2;\n            }\n            if (shouldUnderline) {\n                context.save();\n                context.beginPath();\n                const yOffset = Global_1.Konva._fixTextRendering\n                    ? Math.round(fontSize / 4)\n                    : Math.round(fontSize / 2);\n                const x = lineTranslateX;\n                const y = translateY + lineTranslateY + yOffset;\n                context.moveTo(x, y);\n                const lineWidth = align === JUSTIFY && !lastLine ? totalWidth - padding * 2 : width;\n                context.lineTo(x + Math.round(lineWidth), y);\n                context.lineWidth = fontSize / 15;\n                const gradient = this._getLinearGradient();\n                context.strokeStyle = gradient || fill;\n                context.stroke();\n                context.restore();\n            }\n            if (shouldLineThrough) {\n                context.save();\n                context.beginPath();\n                const yOffset = Global_1.Konva._fixTextRendering ? -Math.round(fontSize / 4) : 0;\n                context.moveTo(lineTranslateX, translateY + lineTranslateY + yOffset);\n                const lineWidth = align === JUSTIFY && !lastLine ? totalWidth - padding * 2 : width;\n                context.lineTo(lineTranslateX + Math.round(lineWidth), translateY + lineTranslateY + yOffset);\n                context.lineWidth = fontSize / 15;\n                const gradient = this._getLinearGradient();\n                context.strokeStyle = gradient || fill;\n                context.stroke();\n                context.restore();\n            }\n            if (direction !== RTL && (letterSpacing !== 0 || align === JUSTIFY)) {\n                const spacesNumber = text.split(' ').length - 1;\n                const array = stringToArray(text);\n                for (let li = 0; li < array.length; li++) {\n                    const letter = array[li];\n                    if (letter === ' ' && !lastLine && align === JUSTIFY) {\n                        lineTranslateX += (totalWidth - padding * 2 - width) / spacesNumber;\n                    }\n                    this._partialTextX = lineTranslateX;\n                    this._partialTextY = translateY + lineTranslateY;\n                    this._partialText = letter;\n                    context.fillStrokeShape(this);\n                    lineTranslateX += this.measureSize(letter).width + letterSpacing;\n                }\n            }\n            else {\n                if (letterSpacing !== 0) {\n                    context.setAttr('letterSpacing', `${letterSpacing}px`);\n                }\n                this._partialTextX = lineTranslateX;\n                this._partialTextY = translateY + lineTranslateY;\n                this._partialText = text;\n                context.fillStrokeShape(this);\n            }\n            context.restore();\n            if (textArrLen > 1) {\n                translateY += lineHeightPx;\n            }\n        }\n    }\n    _hitFunc(context) {\n        const width = this.getWidth(), height = this.getHeight();\n        context.beginPath();\n        context.rect(0, 0, width, height);\n        context.closePath();\n        context.fillStrokeShape(this);\n    }\n    setText(text) {\n        const str = Util_1.Util._isString(text)\n            ? text\n            : text === null || text === undefined\n                ? ''\n                : text + '';\n        this._setAttr(TEXT, str);\n        return this;\n    }\n    getWidth() {\n        const isAuto = this.attrs.width === AUTO || this.attrs.width === undefined;\n        return isAuto ? this.getTextWidth() + this.padding() * 2 : this.attrs.width;\n    }\n    getHeight() {\n        const isAuto = this.attrs.height === AUTO || this.attrs.height === undefined;\n        return isAuto\n            ? this.fontSize() * this.textArr.length * this.lineHeight() +\n                this.padding() * 2\n            : this.attrs.height;\n    }\n    getTextWidth() {\n        return this.textWidth;\n    }\n    getTextHeight() {\n        Util_1.Util.warn('text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height.');\n        return this.textHeight;\n    }\n    measureSize(text) {\n        var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l;\n        let _context = getDummyContext(), fontSize = this.fontSize(), metrics;\n        _context.save();\n        _context.font = this._getContextFont();\n        metrics = _context.measureText(text);\n        _context.restore();\n        const scaleFactor = fontSize / 100;\n        return {\n            actualBoundingBoxAscent: (_a = metrics.actualBoundingBoxAscent) !== null && _a !== void 0 ? _a : 71.58203125 * scaleFactor,\n            actualBoundingBoxDescent: (_b = metrics.actualBoundingBoxDescent) !== null && _b !== void 0 ? _b : 0,\n            actualBoundingBoxLeft: (_c = metrics.actualBoundingBoxLeft) !== null && _c !== void 0 ? _c : -7.421875 * scaleFactor,\n            actualBoundingBoxRight: (_d = metrics.actualBoundingBoxRight) !== null && _d !== void 0 ? _d : 75.732421875 * scaleFactor,\n            alphabeticBaseline: (_e = metrics.alphabeticBaseline) !== null && _e !== void 0 ? _e : 0,\n            emHeightAscent: (_f = metrics.emHeightAscent) !== null && _f !== void 0 ? _f : 100 * scaleFactor,\n            emHeightDescent: (_g = metrics.emHeightDescent) !== null && _g !== void 0 ? _g : -20 * scaleFactor,\n            fontBoundingBoxAscent: (_h = metrics.fontBoundingBoxAscent) !== null && _h !== void 0 ? _h : 91 * scaleFactor,\n            fontBoundingBoxDescent: (_j = metrics.fontBoundingBoxDescent) !== null && _j !== void 0 ? _j : 21 * scaleFactor,\n            hangingBaseline: (_k = metrics.hangingBaseline) !== null && _k !== void 0 ? _k : 72.80000305175781 * scaleFactor,\n            ideographicBaseline: (_l = metrics.ideographicBaseline) !== null && _l !== void 0 ? _l : -21 * scaleFactor,\n            width: metrics.width,\n            height: fontSize,\n        };\n    }\n    _getContextFont() {\n        return (this.fontStyle() +\n            SPACE +\n            this.fontVariant() +\n            SPACE +\n            (this.fontSize() + PX_SPACE) +\n            normalizeFontFamily(this.fontFamily()));\n    }\n    _addTextLine(line) {\n        const align = this.align();\n        if (align === JUSTIFY) {\n            line = line.trim();\n        }\n        const width = this._getTextWidth(line);\n        return this.textArr.push({\n            text: line,\n            width: width,\n            lastInParagraph: false,\n        });\n    }\n    _getTextWidth(text) {\n        const letterSpacing = this.letterSpacing();\n        const length = text.length;\n        return getDummyContext().measureText(text).width + letterSpacing * length;\n    }\n    _setTextData() {\n        let lines = this.text().split('\\n'), fontSize = +this.fontSize(), textWidth = 0, lineHeightPx = this.lineHeight() * fontSize, width = this.attrs.width, height = this.attrs.height, fixedWidth = width !== AUTO && width !== undefined, fixedHeight = height !== AUTO && height !== undefined, padding = this.padding(), maxWidth = width - padding * 2, maxHeightPx = height - padding * 2, currentHeightPx = 0, wrap = this.wrap(), shouldWrap = wrap !== NONE, wrapAtWord = wrap !== CHAR && shouldWrap, shouldAddEllipsis = this.ellipsis();\n        this.textArr = [];\n        getDummyContext().font = this._getContextFont();\n        const additionalWidth = shouldAddEllipsis\n            ? this._getTextWidth(ELLIPSIS)\n            : 0;\n        for (let i = 0, max = lines.length; i < max; ++i) {\n            let line = lines[i];\n            let lineWidth = this._getTextWidth(line);\n            if (fixedWidth && lineWidth > maxWidth) {\n                while (line.length > 0) {\n                    let low = 0, high = stringToArray(line).length, match = '', matchWidth = 0;\n                    while (low < high) {\n                        const mid = (low + high) >>> 1, lineArray = stringToArray(line), substr = lineArray.slice(0, mid + 1).join(''), substrWidth = this._getTextWidth(substr);\n                        const shouldConsiderEllipsis = shouldAddEllipsis &&\n                            fixedHeight &&\n                            currentHeightPx + lineHeightPx > maxHeightPx;\n                        const effectiveWidth = shouldConsiderEllipsis\n                            ? substrWidth + additionalWidth\n                            : substrWidth;\n                        if (effectiveWidth <= maxWidth) {\n                            low = mid + 1;\n                            match = substr;\n                            matchWidth = substrWidth;\n                        }\n                        else {\n                            high = mid;\n                        }\n                    }\n                    if (match) {\n                        if (wrapAtWord) {\n                            const lineArray = stringToArray(line);\n                            const matchArray = stringToArray(match);\n                            const nextChar = lineArray[matchArray.length];\n                            const nextIsSpaceOrDash = nextChar === SPACE || nextChar === DASH;\n                            let wrapIndex;\n                            if (nextIsSpaceOrDash && matchWidth <= maxWidth) {\n                                wrapIndex = matchArray.length;\n                            }\n                            else {\n                                const lastSpaceIndex = matchArray.lastIndexOf(SPACE);\n                                const lastDashIndex = matchArray.lastIndexOf(DASH);\n                                wrapIndex = Math.max(lastSpaceIndex, lastDashIndex) + 1;\n                            }\n                            if (wrapIndex > 0) {\n                                low = wrapIndex;\n                                match = lineArray.slice(0, low).join('');\n                                matchWidth = this._getTextWidth(match);\n                            }\n                        }\n                        match = match.trimRight();\n                        this._addTextLine(match);\n                        textWidth = Math.max(textWidth, matchWidth);\n                        currentHeightPx += lineHeightPx;\n                        const shouldHandleEllipsis = this._shouldHandleEllipsis(currentHeightPx);\n                        if (shouldHandleEllipsis) {\n                            this._tryToAddEllipsisToLastLine();\n                            break;\n                        }\n                        const lineArray = stringToArray(line);\n                        line = lineArray.slice(low).join('').trimLeft();\n                        if (line.length > 0) {\n                            lineWidth = this._getTextWidth(line);\n                            if (lineWidth <= maxWidth) {\n                                this._addTextLine(line);\n                                currentHeightPx += lineHeightPx;\n                                textWidth = Math.max(textWidth, lineWidth);\n                                break;\n                            }\n                        }\n                    }\n                    else {\n                        break;\n                    }\n                }\n            }\n            else {\n                this._addTextLine(line);\n                currentHeightPx += lineHeightPx;\n                textWidth = Math.max(textWidth, lineWidth);\n                if (this._shouldHandleEllipsis(currentHeightPx) && i < max - 1) {\n                    this._tryToAddEllipsisToLastLine();\n                }\n            }\n            if (this.textArr[this.textArr.length - 1]) {\n                this.textArr[this.textArr.length - 1].lastInParagraph = true;\n            }\n            if (fixedHeight && currentHeightPx + lineHeightPx > maxHeightPx) {\n                break;\n            }\n        }\n        this.textHeight = fontSize;\n        this.textWidth = textWidth;\n    }\n    _shouldHandleEllipsis(currentHeightPx) {\n        const fontSize = +this.fontSize(), lineHeightPx = this.lineHeight() * fontSize, height = this.attrs.height, fixedHeight = height !== AUTO && height !== undefined, padding = this.padding(), maxHeightPx = height - padding * 2, wrap = this.wrap(), shouldWrap = wrap !== NONE;\n        return (!shouldWrap ||\n            (fixedHeight && currentHeightPx + lineHeightPx > maxHeightPx));\n    }\n    _tryToAddEllipsisToLastLine() {\n        const width = this.attrs.width, fixedWidth = width !== AUTO && width !== undefined, padding = this.padding(), maxWidth = width - padding * 2, shouldAddEllipsis = this.ellipsis();\n        const lastLine = this.textArr[this.textArr.length - 1];\n        if (!lastLine || !shouldAddEllipsis) {\n            return;\n        }\n        if (fixedWidth) {\n            const haveSpace = this._getTextWidth(lastLine.text + ELLIPSIS) < maxWidth;\n            if (!haveSpace) {\n                lastLine.text = lastLine.text.slice(0, lastLine.text.length - 3);\n            }\n        }\n        this.textArr.splice(this.textArr.length - 1, 1);\n        this._addTextLine(lastLine.text + ELLIPSIS);\n    }\n    getStrokeScaleEnabled() {\n        return true;\n    }\n    _useBufferCanvas() {\n        const hasLine = this.textDecoration().indexOf('underline') !== -1 ||\n            this.textDecoration().indexOf('line-through') !== -1;\n        const hasShadow = this.hasShadow();\n        if (hasLine && hasShadow) {\n            return true;\n        }\n        return super._useBufferCanvas();\n    }\n}\nexports.Text = Text;\nText.prototype._fillFunc = _fillFunc;\nText.prototype._strokeFunc = _strokeFunc;\nText.prototype.className = TEXT_UPPER;\nText.prototype._attrsAffectingSize = [\n    'text',\n    'fontSize',\n    'padding',\n    'wrap',\n    'lineHeight',\n    'letterSpacing',\n];\n(0, Global_2._registerNode)(Text);\nFactory_1.Factory.overWriteSetter(Text, 'width', (0, Validators_1.getNumberOrAutoValidator)());\nFactory_1.Factory.overWriteSetter(Text, 'height', (0, Validators_1.getNumberOrAutoValidator)());\nFactory_1.Factory.addGetterSetter(Text, 'direction', INHERIT);\nFactory_1.Factory.addGetterSetter(Text, 'fontFamily', 'Arial');\nFactory_1.Factory.addGetterSetter(Text, 'fontSize', 12, (0, Validators_1.getNumberValidator)());\nFactory_1.Factory.addGetterSetter(Text, 'fontStyle', NORMAL);\nFactory_1.Factory.addGetterSetter(Text, 'fontVariant', NORMAL);\nFactory_1.Factory.addGetterSetter(Text, 'padding', 0, (0, Validators_1.getNumberValidator)());\nFactory_1.Factory.addGetterSetter(Text, 'align', LEFT);\nFactory_1.Factory.addGetterSetter(Text, 'verticalAlign', TOP);\nFactory_1.Factory.addGetterSetter(Text, 'lineHeight', 1, (0, Validators_1.getNumberValidator)());\nFactory_1.Factory.addGetterSetter(Text, 'wrap', WORD);\nFactory_1.Factory.addGetterSetter(Text, 'ellipsis', false, (0, Validators_1.getBooleanValidator)());\nFactory_1.Factory.addGetterSetter(Text, 'letterSpacing', 0, (0, Validators_1.getNumberValidator)());\nFactory_1.Factory.addGetterSetter(Text, 'text', '', (0, Validators_1.getStringValidator)());\nFactory_1.Factory.addGetterSetter(Text, 'textDecoration', '');\n","/**\n * @file\n *\n * Defines the {@link DefaultPointMarker} class.\n *\n * @module default-point-marker\n */\n\nimport { Line } from 'konva/lib/shapes/Line';\nimport { Rect } from 'konva/lib/shapes/Rect';\nimport { Text } from 'konva/lib/shapes/Text';\n\n/**\n * Creates a point marker handle.\n *\n * @class\n * @alias DefaultPointMarker\n *\n * @param {CreatePointMarkerOptions} options\n */\n\nfunction DefaultPointMarker(options) {\n  this._options = options;\n  this._draggable = options.editable;\n}\n\nDefaultPointMarker.prototype.init = function(group) {\n  const handleWidth  = 10;\n  const handleHeight = 20;\n  const handleX      = -(handleWidth / 2) + 0.5; // Place in the middle of the marker\n\n  // Label\n\n  if (this._options.view === 'zoomview') {\n    // Label - create with default y, the real value is set in fitToView().\n    this._label = new Text({\n      x:          2,\n      y:          0,\n      text:       this._options.point.labelText,\n      textAlign:  'left',\n      fontFamily: this._options.fontFamily || 'sans-serif',\n      fontSize:   this._options.fontSize || 10,\n      fontStyle:  this._options.fontStyle || 'normal',\n      fill:       '#000'\n    });\n  }\n\n  // Handle - create with default y, the real value is set in fitToView().\n\n  this._handle = new Rect({\n    x:       handleX,\n    y:       0,\n    width:   handleWidth,\n    height:  handleHeight,\n    fill:    this._options.color,\n    visible: this._draggable\n  });\n\n  // Line - create with default y and points, the real values\n  // are set in fitToView().\n  this._line = new Line({\n    x:           0,\n    y:           0,\n    stroke:      this._options.color,\n    strokeWidth: 1\n  });\n\n  // Time label - create with default y, the real value is set\n  // in fitToView().\n  this._time = new Text({\n    x:          -24,\n    y:          0,\n    text:       this._options.layer.formatTime(this._options.point.time),\n    fontFamily: this._options.fontFamily,\n    fontSize:   this._options.fontSize,\n    fontStyle:  this._options.fontStyle,\n    fill:       '#000',\n    textAlign:  'center'\n  });\n\n  this._time.hide();\n\n  group.add(this._handle);\n\n  group.add(this._line);\n\n  if (this._label) {\n    group.add(this._label);\n  }\n\n  group.add(this._time);\n\n  this.fitToView();\n\n  this.bindEventHandlers(group);\n};\n\nDefaultPointMarker.prototype.bindEventHandlers = function(group) {\n  const self = this;\n\n  self._handle.on('mouseover touchstart', function() {\n    if (self._draggable) {\n      // Position text to the left of the marker\n      self._time.setX(-24 - self._time.getWidth());\n      self._time.show();\n    }\n  });\n\n  self._handle.on('mouseout touchend', function() {\n    if (self._draggable) {\n      self._time.hide();\n    }\n  });\n\n  group.on('dragstart', function() {\n    self._time.setX(-24 - self._time.getWidth());\n    self._time.show();\n  });\n\n  group.on('dragend', function() {\n    self._time.hide();\n  });\n};\n\nDefaultPointMarker.prototype.fitToView = function() {\n  const height = this._options.layer.getHeight();\n\n  this._line.points([0.5, 0, 0.5, height]);\n\n  if (this._label) {\n    this._label.y(12);\n  }\n\n  if (this._handle) {\n    this._handle.y(height / 2 - 10.5);\n  }\n\n  if (this._time) {\n    this._time.y(height / 2 - 5);\n  }\n};\n\nDefaultPointMarker.prototype.update = function(options) {\n  if (options.time !== undefined) {\n    if (this._time) {\n      this._time.setText(this._options.layer.formatTime(options.time));\n    }\n  }\n\n  if (options.labelText !== undefined) {\n    if (this._label) {\n      this._label.text(options.labelText);\n    }\n  }\n\n  if (options.color !== undefined) {\n    if (this._handle) {\n      this._handle.fill(options.color);\n    }\n\n    this._line.stroke(options.color);\n  }\n\n  if (options.editable !== undefined) {\n    this._draggable = options.editable;\n\n    this._handle.visible(this._draggable);\n  }\n};\n\nexport default DefaultPointMarker;\n","/**\n * @file\n *\n * Defines the {@link DefaultSegmentMarker} class.\n *\n * @module default-segment-marker\n */\n\nimport { Line } from 'konva/lib/shapes/Line';\nimport { Rect } from 'konva/lib/shapes/Rect';\nimport { Text } from 'konva/lib/shapes/Text';\n\n/**\n * Creates a segment marker handle.\n *\n * @class\n * @alias DefaultSegmentMarker\n *\n * @param {CreateSegmentMarkerOptions} options\n */\n\nfunction DefaultSegmentMarker(options) {\n  this._options = options;\n  this._editable = options.editable;\n}\n\nDefaultSegmentMarker.prototype.init = function(group) {\n  const handleWidth  = 10;\n  const handleHeight = 20;\n  const handleX      = -(handleWidth / 2) + 0.5; // Place in the middle of the marker\n\n  const xPosition = this._options.startMarker ? -24 : 24;\n\n  const time = this._options.startMarker ? this._options.segment.startTime :\n                                           this._options.segment.endTime;\n\n  // Label - create with default y, the real value is set in fitToView().\n  this._label = new Text({\n    x:          xPosition,\n    y:          0,\n    text:       this._options.layer.formatTime(time),\n    fontFamily: this._options.fontFamily,\n    fontSize:   this._options.fontSize,\n    fontStyle:  this._options.fontStyle,\n    fill:       '#000',\n    textAlign:  'center',\n    visible:    this._editable\n  });\n\n  this._label.hide();\n\n  // Handle - create with default y, the real value is set in fitToView().\n  this._handle = new Rect({\n    x:           handleX,\n    y:           0,\n    width:       handleWidth,\n    height:      handleHeight,\n    fill:        this._options.color,\n    stroke:      this._options.color,\n    strokeWidth: 1,\n    visible:     this._editable\n  });\n\n  // Vertical Line - create with default y and points, the real values\n  // are set in fitToView().\n  this._line = new Line({\n    x:           0,\n    y:           0,\n    stroke:      this._options.color,\n    strokeWidth: 1,\n    visible:     this._editable\n  });\n\n  group.add(this._label);\n  group.add(this._line);\n  group.add(this._handle);\n\n  this.fitToView();\n\n  this.bindEventHandlers(group);\n};\n\nDefaultSegmentMarker.prototype.bindEventHandlers = function(group) {\n  const self = this;\n\n  const xPosition = self._options.startMarker ? -24 : 24;\n\n  group.on('dragstart', function() {\n    if (self._options.startMarker) {\n      self._label.setX(xPosition - self._label.getWidth());\n    }\n\n    self._label.show();\n  });\n\n  group.on('dragend', function() {\n    self._label.hide();\n  });\n\n  self._handle.on('mouseover touchstart', function() {\n    if (self._options.startMarker) {\n      self._label.setX(xPosition - self._label.getWidth());\n    }\n\n    self._label.show();\n  });\n\n  self._handle.on('mouseout touchend', function() {\n    self._label.hide();\n  });\n};\n\nDefaultSegmentMarker.prototype.fitToView = function() {\n  const height = this._options.layer.getHeight();\n\n  this._label.y(height / 2 - 5);\n  this._handle.y(height / 2 - 10.5);\n  this._line.points([0.5, 0, 0.5, height]);\n};\n\nDefaultSegmentMarker.prototype.update = function(options) {\n  if (options.startTime !== undefined && this._options.startMarker) {\n    this._label.text(this._options.layer.formatTime(options.startTime));\n  }\n\n  if (options.endTime !== undefined && !this._options.startMarker) {\n    this._label.text(this._options.layer.formatTime(options.endTime));\n  }\n\n  if (options.editable !== undefined) {\n    this._editable = options.editable;\n\n    this._label.visible(this._editable);\n    this._handle.visible(this._editable);\n    this._line.visible(this._editable);\n  }\n};\n\nexport default DefaultSegmentMarker;\n","/**\n * @file\n *\n * Factory functions for creating point and segment marker handles.\n *\n * @module marker-factories\n */\n\nimport DefaultPointMarker from './default-point-marker';\nimport DefaultSegmentMarker from './default-segment-marker';\nimport { Text } from 'konva/lib/shapes/Text';\n\n/**\n * Parameters for the {@link createSegmentMarker} function.\n *\n * @typedef {Object} CreateSegmentMarkerOptions\n * @global\n * @property {Segment} segment\n * @property {Boolean} draggable If true, marker is draggable.\n * @property {Boolean} startMarker\n * @property {String} color\n * @property {String} fontFamily\n * @property {Number} fontSize\n * @property {String} fontStyle\n * @property {Layer} layer\n * @property {String} view\n * @property {SegmentDisplayOptions} segmentOptions\n */\n\n/**\n * Creates a left or right side segment marker handle.\n *\n * @param {CreateSegmentMarkerOptions} options\n * @returns {Marker}\n */\n\nexport function createSegmentMarker(options) {\n  if (options.view === 'zoomview') {\n    return new DefaultSegmentMarker(options);\n  }\n\n  return null;\n}\n\n/**\n * Parameters for the {@link createSegmentLabel} function.\n *\n * @typedef {Object} SegmentLabelOptions\n * @global\n * @property {Segment} segment The {@link Segment} object associated with this\n *   label.\n * @property {String} view The name of the view that the label is being\n *   created in, either <code>zoomview</code> or <code>overview</code>.\n * @property {SegmentsLayer} layer\n * @property {String} fontFamily\n * @property {Number} fontSize\n * @property {String} fontStyle\n */\n\n/**\n * Creates a Konva object that renders information about a segment, such as\n * its label text.\n *\n * @param {SegmentLabelOptions} options\n * @returns {Konva.Text}\n */\n\nexport function createSegmentLabel(options) {\n  return new Text({\n    x:          12,\n    y:          12,\n    text:       options.segment.labelText,\n    textAlign:  'center',\n    fontFamily: options.fontFamily || 'sans-serif',\n    fontSize:   options.fontSize || 12,\n    fontStyle:  options.fontStyle || 'normal',\n    fill:       '#000'\n  });\n}\n\n/**\n * Parameters for the {@link createPointMarker} function.\n *\n * @typedef {Object} CreatePointMarkerOptions\n * @global\n * @property {Point} point\n * @property {Boolean} editable If true, marker is draggable.\n * @property {String} color\n * @property {Layer} layer\n * @property {String} view\n * @property {String} fontFamily\n * @property {Number} fontSize\n * @property {String} fontStyle\n */\n\n/**\n * Creates a point marker handle.\n *\n * @param {CreatePointMarkerOptions} options\n * @returns {Marker}\n */\n\nexport function createPointMarker(options) {\n  return new DefaultPointMarker(options);\n}\n","/**\n * @file\n *\n * Defines the {@link HighlightLayer} class.\n *\n * @module highlight-layer\n */\n\nimport Konva from 'konva/lib/Core';\nimport { Rect } from 'konva/lib/shapes/Rect';\n\nimport { clamp } from  './utils';\n\n/**\n * Highlight layer options\n *\n * @typedef {Object} HighlightLayerOptions\n * @global\n * @property {Number} highlightOffset\n * @property {String} highlightColor\n * @property {String} highlightStrokeColor\n * @property {Number} highlightOpacity\n * @property {Number} highlightCornerRadius\n */\n\n/**\n * Creates the highlight region that shows the position of the zoomable\n * waveform view in the overview waveform.\n *\n * @class\n * @alias HighlightLayer\n *\n * @param {WaveformOverview} view\n * @param {HighlightLayerOptions} options\n */\n\nfunction HighlightLayer(view, options) {\n  this._view          = view;\n  this._offset        = options.highlightOffset;\n  this._color         = options.highlightColor;\n  this._layer         = new Konva.Layer({ listening: false });\n  this._highlightRect = null;\n  this._startTime     = null;\n  this._endTime       = null;\n  this._strokeColor   = options.highlightStrokeColor;\n  this._opacity       = options.highlightOpacity;\n  this._cornerRadius  = options.highlightCornerRadius;\n}\n\nHighlightLayer.prototype.addToStage = function(stage) {\n  stage.add(this._layer);\n};\n\nHighlightLayer.prototype.showHighlight = function(startTime, endTime) {\n  if (!this._highlightRect) {\n    this._createHighlightRect(startTime, endTime);\n  }\n\n  this._update(startTime, endTime);\n};\n\n/**\n * Updates the position of the highlight region.\n *\n * @param {Number} startTime The start of the highlight region, in seconds.\n * @param {Number} endTime The end of the highlight region, in seconds.\n */\n\nHighlightLayer.prototype._update = function(startTime, endTime) {\n  this._startTime = startTime;\n  this._endTime = endTime;\n\n  const startOffset = this._view.timeToPixels(startTime);\n  const endOffset   = this._view.timeToPixels(endTime);\n\n  this._highlightRect.setAttrs({\n    x:     startOffset,\n    width: endOffset - startOffset\n  });\n};\n\nHighlightLayer.prototype._createHighlightRect = function(startTime, endTime) {\n  this._startTime = startTime;\n  this._endTime   = endTime;\n\n  const startOffset = this._view.timeToPixels(startTime);\n  const endOffset   = this._view.timeToPixels(endTime);\n\n  // Create with default y and height, the real values are set in fitToView().\n  this._highlightRect = new Rect({\n    x:            startOffset,\n    y:            0,\n    width:        endOffset - startOffset,\n    height:       0,\n    stroke:       this._strokeColor,\n    strokeWidth:  1,\n    fill:         this._color,\n    opacity:      this._opacity,\n    cornerRadius: this._cornerRadius\n  });\n\n  this.fitToView();\n\n  this._layer.add(this._highlightRect);\n};\n\nHighlightLayer.prototype.removeHighlight = function() {\n  if (this._highlightRect) {\n    this._highlightRect.destroy();\n    this._highlightRect = null;\n  }\n};\n\nHighlightLayer.prototype.updateHighlight = function() {\n  if (this._highlightRect) {\n    this._update(this._startTime, this._endTime);\n  }\n};\n\nHighlightLayer.prototype.fitToView = function() {\n  if (this._highlightRect) {\n    const height = this._view.getHeight();\n    const offset = clamp(this._offset, 0, Math.floor(height / 2));\n\n    this._highlightRect.setAttrs({\n      y: offset,\n      height: height - (offset * 2)\n    });\n  }\n};\n\nexport default HighlightLayer;\n","/**\n * @file\n *\n * Defines the {@link PointMarker} class.\n *\n * @module point-marker\n */\n\nimport Konva from 'konva/lib/Core';\n\n/**\n * Parameters for the {@link PointMarker} constructor.\n *\n * @typedef {Object} PointMarkerOptions\n * @global\n * @property {Point} point Point object with timestamp.\n * @property {Boolean} editable If true, marker is draggable.\n * @property {Marker} marker\n * @property {Function} onclick\n * @property {Function} onDblClick\n * @property {Function} onDragStart\n * @property {Function} onDragMove Callback during mouse drag operations.\n * @property {Function} onDragEnd\n * @property {Function} dragBoundFunc\n * @property {Function} onMouseEnter\n * @property {Function} onMouseLeave\n * @property {Function} onContextMenu\n */\n\n/**\n * Creates a point marker handle.\n *\n * @class\n * @alias PointMarker\n *\n * @param {PointMarkerOptions} options\n */\n\nfunction PointMarker(options) {\n  this._point     = options.point;\n  this._marker    = options.marker;\n  this._draggable = options.draggable;\n\n  this._onDragStart   = options.onDragStart;\n  this._onDragMove    = options.onDragMove;\n  this._onDragEnd     = options.onDragEnd;\n  this._dragBoundFunc = options.dragBoundFunc;\n  this._onMouseEnter  = options.onMouseEnter;\n  this._onMouseLeave  = options.onMouseLeave;\n\n  this._group = new Konva.Group({\n    name:          'point-marker',\n    point:         this._point,\n    draggable:     this._draggable,\n    dragBoundFunc: options.dragBoundFunc\n  });\n\n  this._bindDefaultEventHandlers();\n\n  this._marker.init(this._group);\n}\n\nPointMarker.prototype._bindDefaultEventHandlers = function() {\n  const self = this;\n\n  self._group.on('dragstart', function(event) {\n    self._onDragStart(event, self._point);\n  });\n\n  self._group.on('dragmove', function(event) {\n    self._onDragMove(event, self._point);\n  });\n\n  self._group.on('dragend', function(event) {\n    self._onDragEnd(event, self._point);\n  });\n\n  self._group.on('mouseenter', function(event) {\n    self._onMouseEnter(event, self._point);\n  });\n\n  self._group.on('mouseleave', function(event) {\n    self._onMouseLeave(event, self._point);\n  });\n};\n\n/**\n * @param {Konva.Layer} layer\n */\n\nPointMarker.prototype.addToLayer = function(layer) {\n  layer.add(this._group);\n};\n\nPointMarker.prototype.fitToView = function() {\n  this._marker.fitToView();\n};\n\nPointMarker.prototype.getPoint = function() {\n  return this._point;\n};\n\nPointMarker.prototype.getX = function() {\n  return this._group.getX();\n};\n\nPointMarker.prototype.setX = function(x) {\n  this._group.setX(x);\n};\n\nPointMarker.prototype.getWidth = function() {\n  return this._group.getWidth();\n};\n\nPointMarker.prototype.getAbsolutePosition = function() {\n  return this._group.getAbsolutePosition();\n};\n\nPointMarker.prototype.update = function(options) {\n  if (options.editable !== undefined) {\n    this._group.draggable(options.editable);\n  }\n\n  if (this._marker.update) {\n    this._marker.update(options);\n  }\n};\n\nPointMarker.prototype.destroy = function() {\n  if (this._marker.destroy) {\n    this._marker.destroy();\n  }\n\n  this._group.destroyChildren();\n  this._group.destroy();\n};\n\nexport default PointMarker;\n","/**\n * @file\n *\n * Defines the {@link PointsLayer} class.\n *\n * @module points-layer\n */\n\nimport PointMarker from './point-marker';\nimport { clamp, objectHasProperty } from './utils';\nimport Konva from 'konva/lib/Core';\n\n/**\n * Creates a Konva.Layer that displays point markers against the audio\n * waveform.\n *\n * @class\n * @alias PointsLayer\n *\n * @param {Peaks} peaks\n * @param {WaveformOverview|WaveformZoomView} view\n * @param {Boolean} enableEditing\n */\n\nfunction PointsLayer(peaks, view, enableEditing) {\n  this._peaks         = peaks;\n  this._view          = view;\n  this._enableEditing = enableEditing;\n  this._pointMarkers  = {};\n  this._layer         = new Konva.Layer();\n\n  this._onPointsDrag = this._onPointsDrag.bind(this);\n\n  this._onPointMarkerDragStart   = this._onPointMarkerDragStart.bind(this);\n  this._onPointMarkerDragMove    = this._onPointMarkerDragMove.bind(this);\n  this._onPointMarkerDragEnd     = this._onPointMarkerDragEnd.bind(this);\n  this._pointMarkerDragBoundFunc = this._pointMarkerDragBoundFunc.bind(this);\n  this._onPointMarkerMouseEnter  = this._onPointMarkerMouseEnter.bind(this);\n  this._onPointMarkerMouseLeave  = this._onPointMarkerMouseLeave.bind(this);\n\n  this._onPointsUpdate    = this._onPointsUpdate.bind(this);\n  this._onPointsAdd       = this._onPointsAdd.bind(this);\n  this._onPointsRemove    = this._onPointsRemove.bind(this);\n  this._onPointsRemoveAll = this._onPointsRemoveAll.bind(this);\n\n  this._peaks.on('points.update', this._onPointsUpdate);\n  this._peaks.on('points.add', this._onPointsAdd);\n  this._peaks.on('points.remove', this._onPointsRemove);\n  this._peaks.on('points.remove_all', this._onPointsRemoveAll);\n\n  this._peaks.on('points.dragstart', this._onPointsDrag);\n  this._peaks.on('points.dragmove', this._onPointsDrag);\n  this._peaks.on('points.dragend', this._onPointsDrag);\n}\n\n/**\n * Adds the layer to the given {Konva.Stage}.\n *\n * @param {Konva.Stage} stage\n */\n\nPointsLayer.prototype.addToStage = function(stage) {\n  stage.add(this._layer);\n};\n\nPointsLayer.prototype.setListening = function(listening) {\n  this._layer.listening(listening);\n};\n\nPointsLayer.prototype.enableEditing = function(enable) {\n  this._enableEditing = enable;\n};\n\nPointsLayer.prototype.getPointMarker = function(point) {\n  return this._pointMarkers[point.pid];\n};\n\nPointsLayer.prototype.formatTime = function(time) {\n  return this._view.formatTime(time);\n};\n\nPointsLayer.prototype._onPointsUpdate = function(point, options) {\n  const frameStartTime = this._view.getStartTime();\n  const frameEndTime   = this._view.getEndTime();\n\n  const pointMarker = this.getPointMarker(point);\n  const isVisible = point.isVisible(frameStartTime, frameEndTime);\n\n  if (pointMarker && !isVisible) {\n    // Remove point marker that is no longer visible.\n    this._removePoint(point);\n  }\n  else if (!pointMarker && isVisible) {\n    // Add point marker for visible point.\n    this._updatePoint(point);\n  }\n  else if (pointMarker && isVisible) {\n    // Update the point marker with the changed attributes.\n    if (objectHasProperty(options, 'time')) {\n      const pointMarkerOffset = this._view.timeToPixels(point.time);\n\n      const pointMarkerX = pointMarkerOffset - this._view.getFrameOffset();\n\n      pointMarker.setX(pointMarkerX);\n    }\n\n    pointMarker.update(options);\n  }\n};\n\nPointsLayer.prototype._onPointsAdd = function(event) {\n  const self = this;\n\n  const frameStartTime = self._view.getStartTime();\n  const frameEndTime   = self._view.getEndTime();\n\n  event.points.forEach(function(point) {\n    if (point.isVisible(frameStartTime, frameEndTime)) {\n      self._updatePoint(point);\n    }\n  });\n};\n\nPointsLayer.prototype._onPointsRemove = function(event) {\n  const self = this;\n\n  event.points.forEach(function(point) {\n    self._removePoint(point);\n  });\n};\n\nPointsLayer.prototype._onPointsRemoveAll = function() {\n  this._layer.removeChildren();\n  this._pointMarkers = {};\n};\n\n/**\n * Creates the Konva UI objects for a given point.\n *\n * @private\n * @param {Point} point\n * @returns {PointMarker}\n */\n\nPointsLayer.prototype._createPointMarker = function(point) {\n  const editable = this._enableEditing && point.editable;\n  const viewOptions = this._view.getViewOptions();\n\n  const marker = this._peaks.options.createPointMarker({\n    point:      point,\n    editable:   editable,\n    color:      point.color,\n    fontFamily: viewOptions.fontFamily,\n    fontSize:   viewOptions.fontSize,\n    fontStyle:  viewOptions.fontStyle,\n    layer:      this,\n    view:       this._view.getName()\n  });\n\n  return new PointMarker({\n    point:         point,\n    draggable:     editable,\n    marker:        marker,\n    onDragStart:   this._onPointMarkerDragStart,\n    onDragMove:    this._onPointMarkerDragMove,\n    onDragEnd:     this._onPointMarkerDragEnd,\n    dragBoundFunc: this._pointMarkerDragBoundFunc,\n    onMouseEnter:  this._onPointMarkerMouseEnter,\n    onMouseLeave:  this._onPointMarkerMouseLeave\n  });\n};\n\nPointsLayer.prototype.getHeight = function() {\n  return this._view.getHeight();\n};\n\n/**\n * Adds a Konva UI object to the layer for a given point.\n *\n * @private\n * @param {Point} point\n * @returns {PointMarker}\n */\n\nPointsLayer.prototype._addPointMarker = function(point) {\n  const pointMarker = this._createPointMarker(point);\n\n  this._pointMarkers[point.pid] = pointMarker;\n\n  pointMarker.addToLayer(this._layer);\n\n  return pointMarker;\n};\n\nPointsLayer.prototype._onPointsDrag = function(event) {\n  const pointMarker = this._updatePoint(event.point);\n\n  pointMarker.update({ time: event.point.time });\n};\n\n/**\n * @param {KonvaEventObject} event\n * @param {Point} point\n */\n\nPointsLayer.prototype._onPointMarkerMouseEnter = function(event, point) {\n  this._peaks.emit('points.mouseenter', {\n    point: point,\n    evt: event.evt\n  });\n};\n\n/**\n * @param {KonvaEventObject} event\n * @param {Point} point\n */\n\nPointsLayer.prototype._onPointMarkerMouseLeave = function(event, point) {\n  this._peaks.emit('points.mouseleave', {\n    point: point,\n    evt: event.evt\n  });\n};\n\n/**\n * @param {KonvaEventObject} event\n * @param {Point} point\n */\n\nPointsLayer.prototype._onPointMarkerDragStart = function(event, point) {\n  this._dragPointMarker = this.getPointMarker(point);\n\n  this._peaks.emit('points.dragstart', {\n    point: point,\n    evt: event.evt\n  });\n};\n\n/**\n * @param {KonvaEventObject} event\n * @param {Point} point\n */\n\nPointsLayer.prototype._onPointMarkerDragMove = function(event, point) {\n  const pointMarker = this._pointMarkers[point.pid];\n\n  const markerX = pointMarker.getX();\n\n  const offset = markerX + pointMarker.getWidth();\n\n  point._setTime(this._view.pixelOffsetToTime(offset));\n\n  this._peaks.emit('points.dragmove', {\n    point: point,\n    evt: event.evt\n  });\n};\n\n/**\n * @param {KonvaEventObject} event\n * @param {Point} point\n */\n\nPointsLayer.prototype._onPointMarkerDragEnd = function(event, point) {\n  this._dragPointMarker = null;\n\n  this._peaks.emit('points.dragend', {\n    point: point,\n    evt: event.evt\n  });\n};\n\nPointsLayer.prototype._pointMarkerDragBoundFunc = function(pos) {\n  // Allow the marker to be moved horizontally but not vertically.\n  return {\n    x: clamp(pos.x, 0, this._view.getWidth()),\n    y: this._dragPointMarker.getAbsolutePosition().y\n  };\n};\n\n/**\n * Updates the positions of all displayed points in the view.\n *\n * @param {Number} startTime The start of the visible range in the view,\n *   in seconds.\n * @param {Number} endTime The end of the visible range in the view,\n *   in seconds.\n */\n\nPointsLayer.prototype.updatePoints = function(startTime, endTime) {\n  // Update all points in the visible time range.\n  const points = this._peaks.points.find(startTime, endTime);\n\n  points.forEach(this._updatePoint.bind(this));\n\n  // TODO: In the overview all points are visible, so no need to do this.\n  this._removeInvisiblePoints(startTime, endTime);\n};\n\n/**\n * @private\n * @param {Point} point\n */\n\nPointsLayer.prototype._updatePoint = function(point) {\n  let pointMarker = this.getPointMarker(point);\n\n  if (!pointMarker) {\n    pointMarker = this._addPointMarker(point);\n  }\n\n  const pointMarkerOffset = this._view.timeToPixels(point.time);\n  const pointMarkerX = pointMarkerOffset - this._view.getFrameOffset();\n\n  pointMarker.setX(pointMarkerX);\n\n  return pointMarker;\n};\n\n/**\n * Remove any points that are not visible, i.e., are outside the given time\n * range.\n *\n * @private\n * @param {Number} startTime The start of the visible time range, in seconds.\n * @param {Number} endTime The end of the visible time range, in seconds.\n */\n\nPointsLayer.prototype._removeInvisiblePoints = function(startTime, endTime) {\n  for (const pointPid in this._pointMarkers) {\n    if (objectHasProperty(this._pointMarkers, pointPid)) {\n      const point = this._pointMarkers[pointPid].getPoint();\n\n      if (!point.isVisible(startTime, endTime)) {\n        this._removePoint(point);\n      }\n    }\n  }\n};\n\n/**\n * Removes the UI object for a given point.\n *\n * @private\n * @param {Point} point\n */\n\nPointsLayer.prototype._removePoint = function(point) {\n  const pointMarker = this.getPointMarker(point);\n\n  if (pointMarker) {\n    pointMarker.destroy();\n    delete this._pointMarkers[point.pid];\n  }\n};\n\n/**\n * Toggles visibility of the points layer.\n *\n * @param {Boolean} visible\n */\n\nPointsLayer.prototype.setVisible = function(visible) {\n  this._layer.setVisible(visible);\n};\n\nPointsLayer.prototype.destroy = function() {\n  this._peaks.off('points.update', this._onPointsUpdate);\n  this._peaks.off('points.add', this._onPointsAdd);\n  this._peaks.off('points.remove', this._onPointsRemove);\n  this._peaks.off('points.remove_all', this._onPointsRemoveAll);\n  this._peaks.off('points.dragstart', this._onPointsDrag);\n  this._peaks.off('points.dragmove', this._onPointsDrag);\n  this._peaks.off('points.dragend', this._onPointsDrag);\n};\n\nPointsLayer.prototype.fitToView = function() {\n  for (const pointPid in this._pointMarkers) {\n    if (objectHasProperty(this._pointMarkers, pointPid)) {\n      const pointMarker = this._pointMarkers[pointPid];\n\n      pointMarker.fitToView();\n    }\n  }\n};\n\nPointsLayer.prototype.draw = function() {\n  this._layer.draw();\n};\n\nexport default PointsLayer;\n","/**\n * @file\n *\n * Defines the {@link PlayheadLayer} class.\n *\n * @module playhead-layer\n */\n\nimport Konva from 'konva/lib/Core';\nimport { Animation } from 'konva/lib/Animation';\nimport { Line } from 'konva/lib/shapes/Line';\nimport { Text } from 'konva/lib/shapes/Text';\n\n/**\n * Creates a Konva.Layer that displays a playhead marker.\n *\n * @class\n * @alias PlayheadLayer\n *\n * @param {Player} player\n * @param {WaveformOverview|WaveformZoomView} view\n * @param {Object} options\n * @param {Boolean} options.showPlayheadTime If <code>true</code> The playback time position\n *   is shown next to the playhead.\n * @param {String} options.playheadColor\n * @param {String} options.playheadTextColor\n * @param {String} options.playheadBackgroundColor\n * @param {Number} options.playheadPadding\n * @param {Number} options.playheadWidth\n * @param {String} options.playheadFontFamily\n * @param {Number} options.playheadFontSize\n * @param {String} options.playheadFontStyle\n */\n\nfunction PlayheadLayer(player, view, options) {\n  this._player = player;\n  this._view = view;\n  this._playheadPixel = 0;\n  this._playheadLineAnimation = null;\n  this._playheadVisible = false;\n  this._playheadColor = options.playheadColor;\n  this._playheadTextColor = options.playheadTextColor;\n  this._playheadBackgroundColor = options.playheadBackgroundColor;\n  this._playheadPadding = options.playheadPadding;\n  this._playheadWidth = options.playheadWidth;\n\n  this._playheadFontFamily = options.playheadFontFamily;\n  this._playheadFontSize = options.playheadFontSize;\n  this._playheadFontStyle = options.playheadFontStyle;\n\n  this._playheadLayer = new Konva.Layer({ listening: false });\n\n  this._createPlayhead();\n\n  if (options.showPlayheadTime) {\n    this._createPlayheadText();\n  }\n\n  this.fitToView();\n\n  this.zoomLevelChanged();\n}\n\n/**\n * Adds the layer to the given {Konva.Stage}.\n *\n * @param {Konva.Stage} stage\n */\n\nPlayheadLayer.prototype.addToStage = function(stage) {\n  stage.add(this._playheadLayer);\n};\n\n/**\n * Decides whether to use an animation to update the playhead position.\n *\n * If the zoom level is such that the number of pixels per second of audio is\n * low, we can use timeupdate events from the HTMLMediaElement to\n * set the playhead position. Otherwise, we use an animation to update the\n * playhead position more smoothly. The animation is CPU intensive, so we\n * avoid using it where possible.\n */\n\nPlayheadLayer.prototype.zoomLevelChanged = function() {\n  const pixelsPerSecond = this._view.timeToPixels(1.0);\n\n  this._useAnimation = pixelsPerSecond >= 5;\n\n  if (this._useAnimation) {\n    if (this._player.isPlaying() && !this._playheadLineAnimation) {\n      // Start the animation\n      this._start();\n    }\n  }\n  else {\n    if (this._playheadLineAnimation) {\n      // Stop the animation\n      const time = this._player.getCurrentTime();\n\n      this.stop(time);\n    }\n  }\n};\n\n/**\n * Resizes the playhead UI objects to fit the available space in the\n * view.\n */\n\nPlayheadLayer.prototype.fitToView = function() {\n  const height = this._view.getHeight();\n\n  this._playheadLine.points([0.5, 0, 0.5, height]);\n\n  if (this._playheadText) {\n    this._playheadText.y(12);\n  }\n};\n\n/**\n * Creates the playhead UI objects.\n *\n * @private\n * @param {String} color\n */\n\nPlayheadLayer.prototype._createPlayhead = function() {\n  // Create with default points, the real values are set in fitToView().\n  this._playheadLine = new Line({\n    stroke:      this._playheadColor,\n    strokeWidth: this._playheadWidth\n  });\n\n  this._playheadGroup = new Konva.Group({\n    x: 0,\n    y: 0\n  });\n\n  this._playheadGroup.add(this._playheadLine);\n  this._playheadLayer.add(this._playheadGroup);\n};\n\nPlayheadLayer.prototype._createPlayheadText = function() {\n  const self = this;\n\n  const time = self._player.getCurrentTime();\n  const text = self._view.formatTime(time);\n\n  // Create with default y, the real value is set in fitToView().\n  self._playheadText = new Text({\n    x: 0,\n    y: 0,\n    padding: self._playheadPadding,\n    text: text,\n    fontSize: self._playheadFontSize,\n    fontFamily: self._playheadFontFamily,\n    fontStyle: self._playheadFontStyle,\n    fill: self._playheadTextColor,\n    align: 'right',\n    sceneFunc: function(context, shape) {\n      const width = shape.width();\n      const height = shape.height() + 2 * self._playheadPadding;\n\n      context.fillStyle = self._playheadBackgroundColor;\n      context.fillRect(0, -self._playheadPadding, width, height);\n      shape._sceneFunc(context);\n    }\n  });\n\n  self._playheadGroup.add(self._playheadText);\n};\n\n/**\n * Updates the playhead position.\n *\n * @param {Number} time Current playhead position, in seconds.\n */\n\nPlayheadLayer.prototype.updatePlayheadTime = function(time) {\n  this._syncPlayhead(time);\n\n  if (this._player.isPlaying()) {\n    this._start();\n  }\n};\n\n/**\n * Updates the playhead position.\n *\n * @private\n * @param {Number} time Current playhead position, in seconds.\n */\n\nPlayheadLayer.prototype._syncPlayhead = function(time) {\n  const pixelIndex = this._view.timeToPixels(time);\n\n  const frameOffset = this._view.getFrameOffset();\n  const width = this._view.getWidth();\n\n  const isVisible = (pixelIndex >= frameOffset) &&\n                    (pixelIndex <= frameOffset + width);\n\n  this._playheadPixel = pixelIndex;\n\n  if (isVisible) {\n    const playheadX = this._playheadPixel - frameOffset;\n\n    if (!this._playheadVisible) {\n      this._playheadVisible = true;\n      this._playheadGroup.show();\n    }\n\n    this._playheadGroup.setX(playheadX);\n\n    if (this._playheadText) {\n      const text = this._view.formatTime(time);\n      const playheadTextWidth = this._playheadText.width();\n\n      this._playheadText.setText(text);\n\n      if (playheadTextWidth + playheadX > width - 2) {\n        this._playheadText.setX(-playheadTextWidth);\n      }\n      else if (playheadTextWidth + playheadX < width) {\n        this._playheadText.setX(0);\n      }\n    }\n  }\n  else {\n    if (this._playheadVisible) {\n      this._playheadVisible = false;\n      this._playheadGroup.hide();\n    }\n  }\n\n  if (this._view.playheadPosChanged) {\n    this._view.playheadPosChanged(time);\n  }\n};\n\n/**\n * Starts a playhead animation in sync with the media playback.\n *\n * @private\n */\n\nPlayheadLayer.prototype._start = function() {\n  const self = this;\n\n  if (self._playheadLineAnimation) {\n    self._playheadLineAnimation.stop();\n    self._playheadLineAnimation = null;\n  }\n\n  if (!self._useAnimation) {\n    return;\n  }\n\n  let lastPlayheadPosition = null;\n\n  self._playheadLineAnimation = new Animation(function() {\n    const time = self._player.getCurrentTime();\n    const playheadPosition = self._view.timeToPixels(time);\n\n    if (playheadPosition !== lastPlayheadPosition) {\n      self._syncPlayhead(time);\n      lastPlayheadPosition = playheadPosition;\n    }\n  }, self._playheadLayer);\n\n  self._playheadLineAnimation.start();\n};\n\nPlayheadLayer.prototype.stop = function(time) {\n  if (this._playheadLineAnimation) {\n    this._playheadLineAnimation.stop();\n    this._playheadLineAnimation = null;\n  }\n\n  this._syncPlayhead(time);\n};\n\nPlayheadLayer.prototype.getPlayheadPixel = function() {\n  return this._playheadPixel;\n};\n\nPlayheadLayer.prototype.showPlayheadTime = function(show) {\n  if (show) {\n    if (!this._playheadText) {\n      // Create it\n      this._createPlayheadText(this._playheadTextColor,\n        this._playheadBackgroundColor, this._playheadPadding);\n      this.fitToView();\n    }\n  }\n  else {\n    if (this._playheadText) {\n      this._playheadText.remove();\n      this._playheadText.destroy();\n      this._playheadText = null;\n    }\n  }\n};\n\nPlayheadLayer.prototype.updatePlayheadText = function() {\n  if (this._playheadText) {\n    const time = this._player.getCurrentTime();\n    const text = this._view.formatTime(time);\n\n    this._playheadText.setText(text);\n  }\n};\n\nPlayheadLayer.prototype.destroy = function() {\n  if (this._playheadLineAnimation) {\n    this._playheadLineAnimation.stop();\n    this._playheadLineAnimation = null;\n  }\n};\n\nexport default PlayheadLayer;\n","/**\n * @file\n *\n * Defines the {@link OverlaySegmentMarker} class.\n *\n * @module overlay-segment-marker\n */\n\nimport { Rect } from 'konva/lib/shapes/Rect';\nimport { Text } from 'konva/lib/shapes/Text';\n\nimport { clamp } from './utils';\n\n/**\n * Creates a segment marker handle.\n *\n * @class\n * @alias OverlaySegmentMarker\n *\n * @param {CreateSegmentMarkerOptions} options\n */\n\nfunction OverlaySegmentMarker(options) {\n  this._options = options;\n}\n\nOverlaySegmentMarker.prototype.init = function(group) {\n  const handleWidth  = 10;\n  const handleHeight = 20;\n  const handleX      = -(handleWidth / 2) + 0.5; // Place in the middle of the marker\n\n  const xPosition = this._options.startMarker ? -24 : 24;\n\n  const time = this._options.startMarker ? this._options.segment.startTime :\n                                           this._options.segment.endTime;\n\n  // Label - create with default y, the real value is set in fitToView().\n  this._label = new Text({\n    x:          xPosition,\n    y:          0,\n    text:       this._options.layer.formatTime(time),\n    fontFamily: this._options.fontFamily,\n    fontSize:   this._options.fontSize,\n    fontStyle:  this._options.fontStyle,\n    fill:       '#000',\n    textAlign:  'center',\n    visible:    false\n  });\n\n  // Handle - create with default y, the real value is set in fitToView().\n  this._handle = new Rect({\n    x:       handleX,\n    y:       0,\n    width:   handleWidth,\n    height:  handleHeight\n  });\n\n  group.add(this._label);\n  group.add(this._handle);\n\n  this.fitToView();\n\n  this.bindEventHandlers(group);\n};\n\nOverlaySegmentMarker.prototype.bindEventHandlers = function(group) {\n  const self = this;\n\n  const xPosition = self._options.startMarker ? -24 : 24;\n\n  group.on('dragstart', function() {\n    if (self._options.startMarker) {\n      self._label.setX(xPosition - self._label.getWidth());\n    }\n\n    self._label.show();\n  });\n\n  group.on('dragend', function() {\n    self._label.hide();\n  });\n\n  self._handle.on('mouseover touchstart', function() {\n    if (self._options.startMarker) {\n      self._label.setX(xPosition - self._label.getWidth());\n    }\n\n    self._label.show();\n\n    document.body.style.cursor = 'ew-resize';\n  });\n\n  self._handle.on('mouseout touchend', function() {\n    self._label.hide();\n\n    document.body.style.cursor = 'default';\n  });\n};\n\nOverlaySegmentMarker.prototype.fitToView = function() {\n  const viewHeight = this._options.layer.getHeight();\n\n  const overlayOffset = this._options.segmentOptions.overlayOffset;\n  const overlayRectHeight = clamp(0, viewHeight - 2 * overlayOffset);\n\n  this._label.y(viewHeight / 2 - 5);\n  this._handle.y(overlayOffset);\n  this._handle.height(overlayRectHeight);\n};\n\nOverlaySegmentMarker.prototype.update = function(options) {\n  if (options.startTime !== undefined && this._options.startMarker) {\n    this._label.text(this._options.layer.formatTime(options.startTime));\n  }\n\n  if (options.endTime !== undefined && !this._options.startMarker) {\n    this._label.text(this._options.layer.formatTime(options.endTime));\n  }\n};\n\nexport default OverlaySegmentMarker;\n","/**\n * @file\n *\n * Defines the {@link SegmentMarker} class.\n *\n * @module segment-marker\n */\n\nimport Konva from 'konva/lib/Core';\n\n/**\n * Parameters for the {@link SegmentMarker} constructor.\n *\n * @typedef {Object} SegmentMarkerOptions\n * @global\n * @property {Segment} segment\n * @property {SegmentShape} segmentShape\n * @property {Boolean} editable If true, marker is draggable.\n * @property {Boolean} startMarker If <code>true</code>, the marker indicates\n *   the start time of the segment. If <code>false</code>, the marker\n *   indicates the end time of the segment.\n * @property {Function} onDragStart\n * @property {Function} onDragMove\n * @property {Function} onDragEnd\n * @property {Function} dragBoundFunc\n */\n\n/**\n * Creates a segment handle marker for the start or end of a segment.\n *\n * @class\n * @alias SegmentMarker\n *\n * @param {SegmentMarkerOptions} options\n */\n\nfunction SegmentMarker(options) {\n  const self = this;\n\n  self._segment      = options.segment;\n  self._marker       = options.marker;\n  self._segmentShape = options.segmentShape;\n  self._editable     = options.editable;\n  self._startMarker  = options.startMarker;\n\n  self._onClick      = options.onClick;\n  self._onDragStart  = options.onDragStart;\n  self._onDragMove   = options.onDragMove;\n  self._onDragEnd    = options.onDragEnd;\n\n  self._group = new Konva.Group({\n    name:          'segment-marker',\n    segment:       self._segment,\n    draggable:     self._editable,\n    visible:       self._editable,\n    dragBoundFunc: function(pos) {\n      return options.dragBoundFunc(self, pos);\n    }\n  });\n\n  self._bindDefaultEventHandlers();\n\n  self._marker.init(self._group);\n}\n\nSegmentMarker.prototype._bindDefaultEventHandlers = function() {\n  const self = this;\n\n  self._group.on('click', function(event) {\n    self._onClick(self, event);\n  });\n\n  self._group.on('dragstart', function(event) {\n    self._onDragStart(self, event);\n  });\n\n  self._group.on('dragmove', function(event) {\n    self._onDragMove(self, event);\n  });\n\n  self._group.on('dragend', function(event) {\n    self._onDragEnd(self, event);\n  });\n};\n\nSegmentMarker.prototype.addToLayer = function(layer) {\n  layer.add(this._group);\n};\n\nSegmentMarker.prototype.moveToTop = function() {\n  this._group.moveToTop();\n};\n\nSegmentMarker.prototype.fitToView = function() {\n  this._marker.fitToView();\n};\n\nSegmentMarker.prototype.getSegment = function() {\n  return this._segment;\n};\n\nSegmentMarker.prototype.getX = function() {\n  return this._group.getX();\n};\n\nSegmentMarker.prototype.setX = function(x) {\n  this._group.setX(x);\n};\n\nSegmentMarker.prototype.getWidth = function() {\n  return this._group.getWidth();\n};\n\nSegmentMarker.prototype.getAbsolutePosition = function() {\n  return this._group.getAbsolutePosition();\n};\n\nSegmentMarker.prototype.isStartMarker = function() {\n  return this._startMarker;\n};\n\nSegmentMarker.prototype.update = function(options) {\n  if (options.editable !== undefined) {\n    this._group.visible(options.editable);\n    this._group.draggable(options.editable);\n  }\n\n  if (this._marker.update) {\n    this._marker.update(options);\n  }\n};\n\nSegmentMarker.prototype.destroy = function() {\n  if (this._marker.destroy) {\n    this._marker.destroy();\n  }\n\n  this._group.destroyChildren();\n  this._group.destroy();\n};\n\nSegmentMarker.prototype.startDrag = function() {\n  this._group.startDrag();\n};\n\nSegmentMarker.prototype.stopDrag = function() {\n  this._group.stopDrag();\n};\n\nexport default SegmentMarker;\n","/**\n * @file\n *\n * Defines the {@link WaveformShape} class.\n *\n * @module waveform-shape\n */\n\nimport { clamp, isLinearGradientColor, isString } from './utils';\nimport Konva from 'konva/lib/Core';\n\n/**\n * Waveform shape options.\n *\n * @typedef {Object} WaveformShapeOptions\n * @global\n * @property {String | LinearGradientColor} color Waveform color.\n * @property {WaveformOverview|WaveformZoomView} view The view object\n *   that contains the waveform shape.\n * @property {Segment?} segment If given, render a waveform image\n *   covering the segment's time range. Otherwise, render the entire\n *   waveform duration.\n */\n\n/**\n * Creates a Konva.Shape object that renders a waveform image.\n *\n * @class\n * @alias WaveformShape\n *\n * @param {WaveformShapeOptions} options\n */\n\nfunction WaveformShape(options) {\n  this._color = options.color;\n\n  const shapeOptions = {};\n\n  if (isString(options.color)) {\n    shapeOptions.fill = options.color;\n  }\n  else if (isLinearGradientColor(options.color)) {\n    const startY = options.view._height * (options.color.linearGradientStart / 100);\n    const endY = options.view._height * (options.color.linearGradientEnd / 100);\n\n    shapeOptions.fillLinearGradientStartPointY = startY;\n    shapeOptions.fillLinearGradientEndPointY = endY;\n    shapeOptions.fillLinearGradientColorStops = [\n      0, options.color.linearGradientColorStops[0],\n      1, options.color.linearGradientColorStops[1]\n    ];\n  }\n  else {\n    throw new TypeError('Unknown type for color property');\n  }\n\n  this._shape = new Konva.Shape(shapeOptions);\n  this._view = options.view;\n  this._segment = options.segment;\n\n  this._shape.sceneFunc(this._sceneFunc.bind(this));\n}\n\nWaveformShape.prototype.getX = function() {\n  return this._shape.getX();\n};\n\nWaveformShape.prototype.setX = function(x) {\n  return this._shape.setX(x);\n};\n\nWaveformShape.prototype.setSegment = function(segment) {\n  this._segment = segment;\n};\n\nWaveformShape.prototype.setWaveformColor = function(color) {\n  if (isString(color)) {\n    this._shape.fill(color);\n\n    this._shape.fillLinearGradientStartPointY(null);\n    this._shape.fillLinearGradientEndPointY(null);\n    this._shape.fillLinearGradientColorStops(null);\n  }\n  else if (isLinearGradientColor(color)) {\n    this._shape.fill(null);\n\n    const startY = this._view._height * (color.linearGradientStart / 100);\n    const endY = this._view._height * (color.linearGradientEnd / 100);\n\n    this._shape.fillLinearGradientStartPointY(startY);\n    this._shape.fillLinearGradientEndPointY(endY);\n    this._shape.fillLinearGradientColorStops([\n      0, color.linearGradientColorStops[0],\n      1, color.linearGradientColorStops[1]\n    ]);\n  }\n  else {\n    throw new TypeError('Unknown type for color property');\n  }\n};\n\nWaveformShape.prototype.fitToView = function() {\n  this.setWaveformColor(this._color);\n};\n\nWaveformShape.prototype._sceneFunc = function(context) {\n  const frameOffset = this._view.getFrameOffset();\n  const width = this._view.getWidth();\n  const height = this._view.getHeight();\n\n  this._drawWaveform(\n    context,\n    this._view.getWaveformData(),\n    frameOffset,\n    this._segment ? this._view.timeToPixels(this._segment.startTime) : frameOffset,\n    this._segment ? this._view.timeToPixels(this._segment.endTime)   : frameOffset + width,\n    width,\n    height\n  );\n};\n\n/**\n * Draws a waveform on a canvas context.\n *\n * @param {Konva.Context} context The canvas context to draw on.\n * @param {WaveformData} waveformData The waveform data to draw.\n * @param {Number} frameOffset The start position of the waveform shown\n *   in the view, in pixels.\n * @param {Number} startPixels The start position of the waveform to draw,\n *   in pixels.\n * @param {Number} endPixels The end position of the waveform to draw,\n *   in pixels.\n * @param {Number} width The width of the waveform area, in pixels.\n * @param {Number} height The height of the waveform area, in pixels.\n */\n\nWaveformShape.prototype._drawWaveform = function(context, waveformData,\n    frameOffset, startPixels, endPixels, width, height) {\n  if (startPixels < frameOffset) {\n    startPixels = frameOffset;\n  }\n\n  const limit = frameOffset + width;\n\n  if (endPixels > limit) {\n    endPixels = limit;\n  }\n\n  if (endPixels > waveformData.length - 1) {\n    endPixels = waveformData.length - 1;\n  }\n\n  const channels = waveformData.channels;\n\n  let waveformTop = 0;\n  let waveformHeight = Math.floor(height / channels);\n\n  for (let i = 0; i < channels; i++) {\n    if (i === channels - 1) {\n      waveformHeight = height - (channels - 1) * waveformHeight;\n    }\n\n    this._drawChannel(\n      context,\n      waveformData.channel(i),\n      frameOffset,\n      startPixels,\n      endPixels,\n      waveformTop,\n      waveformHeight\n    );\n\n    waveformTop += waveformHeight;\n  }\n};\n\n/**\n * Draws a single waveform channel on a canvas context.\n *\n * @param {Konva.Context} context The canvas context to draw on.\n * @param {WaveformDataChannel} channel The waveform data to draw.\n * @param {Number} frameOffset The start position of the waveform shown\n *   in the view, in pixels.\n * @param {Number} startPixels The start position of the waveform to draw,\n *   in pixels.\n * @param {Number} endPixels The end position of the waveform to draw,\n *   in pixels.\n * @param {Number} top The top of the waveform channel area, in pixels.\n * @param {Number} height The height of the waveform channel area, in pixels.\n */\n\nWaveformShape.prototype._drawChannel = function(context, channel,\n    frameOffset, startPixels, endPixels, top, height) {\n  let x, amplitude;\n\n  const amplitudeScale = this._view.getAmplitudeScale();\n\n  let lineX, lineY;\n\n  context.beginPath();\n\n  for (x = startPixels; x <= endPixels; x++) {\n    amplitude = channel.min_sample(x);\n\n    lineX = x - frameOffset + 0.5;\n    lineY = top + WaveformShape.scaleY(amplitude, height, amplitudeScale) + 0.5;\n\n    context.lineTo(lineX, lineY);\n  }\n\n  for (x = endPixels; x >= startPixels; x--) {\n    amplitude = channel.max_sample(x);\n\n    lineX = x - frameOffset + 0.5;\n    lineY = top + WaveformShape.scaleY(amplitude, height, amplitudeScale) + 1.0;\n\n    context.lineTo(lineX, lineY);\n  }\n\n  context.closePath();\n\n  context.fillShape(this._shape);\n};\n\nWaveformShape.prototype.addToLayer = function(layer) {\n  layer.add(this._shape);\n};\n\nWaveformShape.prototype.destroy = function() {\n  this._shape.destroy();\n  this._shape = null;\n};\n\nWaveformShape.prototype.on = function(event, handler) {\n  this._shape.on(event, handler);\n};\n\nWaveformShape.prototype.off = function(event, handler) {\n  this._shape.off(event, handler);\n};\n\n/**\n * Scales the waveform data for drawing on a canvas context.\n *\n * @see {@link https://stats.stackexchange.com/questions/281162}\n *\n * @todo Assumes 8-bit waveform data (-128 to 127 range)\n *\n * @param {Number} amplitude The waveform data point amplitude.\n * @param {Number} height The height of the waveform, in pixels.\n * @param {Number} scale Amplitude scaling factor.\n * @returns {Number} The scaled waveform data point.\n */\n\nWaveformShape.scaleY = function(amplitude, height, scale) {\n  const y = -(height - 1) * (amplitude * scale + 128) / 255 + (height - 1);\n\n  return clamp(Math.floor(y), 0, height - 1);\n};\n\nexport default WaveformShape;\n","/**\n * @file\n *\n * Defines the {@link SegmentShape} class.\n *\n * @module segment-shape\n */\n\nimport Konva from 'konva/lib/Core';\n\nimport OverlaySegmentMarker from './overlay-segment-marker';\nimport SegmentMarker from './segment-marker';\nimport WaveformShape from './waveform-shape';\nimport { clamp } from './utils';\n\n/**\n * Options that control segments' visual appearance\n *\n * @typedef {Object} SegmentDisplayOptions\n * @global\n * @property {Boolean} markers\n * @property {Boolean} overlay\n * @property {String} startMarkerColor\n * @property {String} endMarkerColor\n * @property {String} waveformColor\n * @property {String} overlayColor\n * @property {Number} overlayOpacity\n * @property {String} overlayBorderColor\n * @property {Number} overlayBorderWidth\n * @property {Number} overlayCornerRadius\n * @property {Number} overlayOffset\n * @property {String} overlayLabelAlign\n * @property {String} overlayLabelVerticalAlign\n * @property {Number} overlayLabelPadding\n * @property {String} overlayLabelColor\n * @property {String} overlayFontFamily\n * @property {Number} overlayFontSize\n * @property {String} overlayFontStyle\n */\n\n/**\n * Creates a waveform segment shape with optional start and end markers.\n *\n * @class\n * @alias SegmentShape\n *\n * @param {Segment} segment\n * @param {Peaks} peaks\n * @param {SegmentsLayer} layer\n * @param {WaveformOverview|WaveformZoomView} view\n */\n\nfunction SegmentShape(segment, peaks, layer, view) {\n  this._segment     = segment;\n  this._peaks       = peaks;\n  this._layer       = layer;\n  this._view        = view;\n  this._label       = null;\n  this._startMarker = null;\n  this._endMarker   = null;\n  this._color       = segment.color;\n  this._borderColor = segment.borderColor;\n  this._draggable   = this._segment.editable && this._view.isSegmentDraggingEnabled();\n  this._dragging    = false;\n\n  const viewOptions = view.getViewOptions();\n  const segmentOptions = viewOptions.segmentOptions;\n\n  this._overlayOffset = segmentOptions.overlayOffset;\n\n  if (!segment.overlay) {\n    this._waveformShape = new WaveformShape({\n      color:   segment.color,\n      view:    view,\n      segment: segment\n    });\n  }\n\n  this._onMouseEnter = this._onMouseEnter.bind(this);\n  this._onMouseLeave = this._onMouseLeave.bind(this);\n  this._onMouseDown  = this._onMouseDown.bind(this);\n  this._onMouseUp    = this._onMouseUp.bind(this);\n\n  this._dragBoundFunc      = this._dragBoundFunc.bind(this);\n  this._onSegmentDragStart = this._onSegmentDragStart.bind(this);\n  this._onSegmentDragMove  = this._onSegmentDragMove.bind(this);\n  this._onSegmentDragEnd   = this._onSegmentDragEnd.bind(this);\n\n  // Event handlers for markers\n  this._onSegmentMarkerClick       = this._onSegmentMarkerClick.bind(this);\n  this._onSegmentMarkerDragStart   = this._onSegmentMarkerDragStart.bind(this);\n  this._onSegmentMarkerDragMove    = this._onSegmentMarkerDragMove.bind(this);\n  this._onSegmentMarkerDragEnd     = this._onSegmentMarkerDragEnd.bind(this);\n  this._segmentMarkerDragBoundFunc = this._segmentMarkerDragBoundFunc.bind(this);\n\n  this._label = this._peaks.options.createSegmentLabel({\n    segment:    segment,\n    view:       this._view.getName(),\n    layer:      this._layer,\n    fontFamily: viewOptions.fontFamily,\n    fontSize:   viewOptions.fontSize,\n    fontStyle:  viewOptions.fontStyle\n  });\n\n  if (this._label) {\n    this._label.hide();\n  }\n\n  // Create with default y and height, the real values are set in fitToView().\n  const segmentStartOffset = this._view.timeToPixelOffset(this._segment.startTime);\n  const segmentEndOffset   = this._view.timeToPixelOffset(this._segment.endTime);\n\n  const overlayRectHeight = clamp(0, this._view.getHeight() - 2 * this._overlayOffset);\n\n  // The clip rectangle prevents text in the overlay from appearing\n  // outside the overlay.\n\n  this._overlay = new Konva.Group({\n    name:          'segment-overlay',\n    segment:       this._segment,\n    x:             segmentStartOffset,\n    y:             0,\n    width:         segmentEndOffset - segmentStartOffset,\n    height:        this._view.getHeight(),\n    clipX:         0,\n    clipY:         this._overlayOffset,\n    clipWidth:     segmentEndOffset - segmentStartOffset,\n    clipHeight:    overlayRectHeight,\n    draggable:     this._draggable,\n    dragBoundFunc: this._dragBoundFunc\n  });\n\n  let overlayBorderColor, overlayBorderWidth, overlayColor, overlayOpacity, overlayCornerRadius;\n\n  if (segment.overlay) {\n    overlayBorderColor  = this._borderColor || segmentOptions.overlayBorderColor;\n    overlayBorderWidth  = segmentOptions.overlayBorderWidth;\n    overlayColor        = this._color || segmentOptions.overlayColor;\n    overlayOpacity      = segmentOptions.overlayOpacity;\n    overlayCornerRadius = segmentOptions.overlayCornerRadius;\n  }\n\n  this._overlayRect = new Konva.Rect({\n    x:            0,\n    y:            this._overlayOffset,\n    width:        segmentEndOffset - segmentStartOffset,\n    stroke:       overlayBorderColor,\n    strokeWidth:  overlayBorderWidth,\n    height:       overlayRectHeight,\n    fill:         overlayColor,\n    opacity:      overlayOpacity,\n    cornerRadius: overlayCornerRadius\n  });\n\n  this._overlay.add(this._overlayRect);\n\n  if (segment.overlay) {\n    this._overlayText = new Konva.Text({\n      x:             0,\n      y:             this._overlayOffset,\n      text:          this._segment.labelText,\n      fontFamily:    segmentOptions.overlayFontFamily,\n      fontSize:      segmentOptions.overlayFontSize,\n      fontStyle:     segmentOptions.overlayFontStyle,\n      fill:          segmentOptions.overlayLabelColor,\n      listening:     false,\n      align:         segmentOptions.overlayLabelAlign,\n      width:         segmentEndOffset - segmentStartOffset,\n      verticalAlign: segmentOptions.overlayLabelVerticalAlign,\n      height:        overlayRectHeight,\n      padding:       segmentOptions.overlayLabelPadding\n    });\n\n    this._overlay.add(this._overlayText);\n  }\n\n  // Set up event handlers to show/hide the segment label text when the user\n  // hovers the mouse over the segment.\n  this._overlay.on('mouseenter', this._onMouseEnter);\n  this._overlay.on('mouseleave', this._onMouseLeave);\n\n  this._overlay.on('mousedown', this._onMouseDown);\n  this._overlay.on('mouseup', this._onMouseUp);\n\n  if (this._draggable) {\n    this._overlay.on('dragstart', this._onSegmentDragStart);\n    this._overlay.on('dragmove', this._onSegmentDragMove);\n    this._overlay.on('dragend', this._onSegmentDragEnd);\n  }\n\n  this._createMarkers();\n}\n\nfunction createOverlayMarker(options) {\n  return new OverlaySegmentMarker(options);\n}\n\nSegmentShape.prototype._createMarkers = function() {\n  const editable = this._layer.isEditingEnabled() && this._segment.editable;\n  const viewOptions = this._view.getViewOptions();\n  const segmentOptions = viewOptions.segmentOptions;\n\n  let createSegmentMarker, startMarker, endMarker;\n\n  if (this._segment.markers) {\n    createSegmentMarker = this._peaks.options.createSegmentMarker;\n  }\n  else if (this._segment.overlay) {\n    createSegmentMarker = createOverlayMarker;\n  }\n\n  if (createSegmentMarker) {\n    startMarker = createSegmentMarker({\n      segment:        this._segment,\n      editable:       editable,\n      startMarker:    true,\n      color:          segmentOptions.startMarkerColor,\n      fontFamily:     viewOptions.fontFamily,\n      fontSize:       viewOptions.fontSize,\n      fontStyle:      viewOptions.fontStyle,\n      layer:          this._layer,\n      view:           this._view.getName(),\n      segmentOptions: this._view.getViewOptions().segmentOptions\n    });\n  }\n\n  if (startMarker) {\n    this._startMarker = new SegmentMarker({\n      segment:       this._segment,\n      segmentShape:  this,\n      editable:      editable,\n      startMarker:   true,\n      marker:        startMarker,\n      onClick:       this._onSegmentMarkerClick,\n      onDragStart:   this._onSegmentMarkerDragStart,\n      onDragMove:    this._onSegmentMarkerDragMove,\n      onDragEnd:     this._onSegmentMarkerDragEnd,\n      dragBoundFunc: this._segmentMarkerDragBoundFunc\n    });\n  }\n\n  if (createSegmentMarker) {\n    endMarker = createSegmentMarker({\n      segment:        this._segment,\n      editable:       editable,\n      startMarker:    false,\n      color:          segmentOptions.endMarkerColor,\n      fontFamily:     viewOptions.fontFamily,\n      fontSize:       viewOptions.fontSize,\n      fontStyle:      viewOptions.fontStyle,\n      layer:          this._layer,\n      view:           this._view.getName(),\n      segmentOptions: this._view.getViewOptions().segmentOptions\n    });\n  }\n\n  if (endMarker) {\n    this._endMarker = new SegmentMarker({\n      segment:       this._segment,\n      segmentShape:  this,\n      editable:      editable,\n      startMarker:   false,\n      marker:        endMarker,\n      onClick:       this._onSegmentMarkerClick,\n      onDragStart:   this._onSegmentMarkerDragStart,\n      onDragMove:    this._onSegmentMarkerDragMove,\n      onDragEnd:     this._onSegmentMarkerDragEnd,\n      dragBoundFunc: this._segmentMarkerDragBoundFunc\n    });\n  }\n};\n\nSegmentShape.prototype._dragBoundFunc = function(pos) {\n  // Allow the segment to be moved horizontally but not vertically.\n  return {\n    x: pos.x,\n    y: 0\n  };\n};\n\n/**\n * Update the segment shape after the segment's attributes have changed.\n */\n\nSegmentShape.prototype.update = function(options) {\n  const segmentStartOffset = this._view.timeToPixelOffset(this._segment.startTime);\n  const segmentEndOffset   = this._view.timeToPixelOffset(this._segment.endTime);\n  const width = segmentEndOffset - segmentStartOffset;\n  let marker;\n\n  if ((marker = this.getStartMarker())) {\n    marker.setX(segmentStartOffset - marker.getWidth());\n\n    if (options) {\n      marker.update(options);\n    }\n  }\n\n  if ((marker = this.getEndMarker())) {\n    marker.setX(segmentEndOffset);\n\n    if (options) {\n      marker.update(options);\n    }\n  }\n\n  this._color = this._segment.color;\n  this._borderColor = this._segment.bordercolor;\n\n  if (this._label) {\n    this._label.text(this._segment.labelText);\n  }\n\n  if (this._overlayText) {\n    this._overlayText.text(this._segment.labelText);\n  }\n\n  if (this._segment.overlay) {\n    if (this._color) {\n      this._overlayRect.fill(this._color);\n    }\n\n    if (this._borderColor) {\n      this._overlayRect.stroke(this._borderColor);\n    }\n  }\n  else {\n    this._waveformShape.setWaveformColor(this._segment.color);\n  }\n\n  // While dragging, the overlay position is controlled in _onSegmentDragMove().\n\n  if (!this._dragging) {\n    if (this._overlay) {\n      this._overlay.setAttrs({\n        x:         segmentStartOffset,\n        width:     width,\n        clipWidth: width < 1 ? 1 : width\n      });\n\n      this._overlayRect.setAttrs({\n        x:     0,\n        width: width\n      });\n\n      if (this._overlayText) {\n        this._overlayText.setAttrs({\n          width: width\n        });\n      }\n    }\n  }\n};\n\nSegmentShape.prototype.getSegment = function() {\n  return this._segment;\n};\n\nSegmentShape.prototype.getStartMarker = function() {\n  return this._startMarker;\n};\n\nSegmentShape.prototype.getEndMarker = function() {\n  return this._endMarker;\n};\n\nSegmentShape.prototype.addToLayer = function(layer) {\n  if (this._waveformShape) {\n    this._waveformShape.addToLayer(layer);\n  }\n\n  if (this._label) {\n    layer.add(this._label);\n  }\n\n  if (this._overlay) {\n    layer.add(this._overlay);\n  }\n\n  if (this._startMarker) {\n    this._startMarker.addToLayer(layer);\n  }\n\n  if (this._endMarker) {\n    this._endMarker.addToLayer(layer);\n  }\n};\n\nSegmentShape.prototype.isDragging = function() {\n  return this._dragging;\n};\n\nSegmentShape.prototype._onMouseEnter = function(event) {\n  if (this._label) {\n    this._label.moveToTop();\n    this._label.show();\n  }\n\n  this._peaks.emit('segments.mouseenter', {\n    segment: this._segment,\n    evt: event.evt\n  });\n};\n\nSegmentShape.prototype._onMouseLeave = function(event) {\n  if (this._label) {\n    this._label.hide();\n  }\n\n  this._peaks.emit('segments.mouseleave', {\n    segment: this._segment,\n    evt: event.evt\n  });\n};\n\nSegmentShape.prototype._onMouseDown = function(event) {\n  this._peaks.emit('segments.mousedown', {\n    segment: this._segment,\n    evt: event.evt\n  });\n};\n\nSegmentShape.prototype._onMouseUp = function(event) {\n  this._peaks.emit('segments.mouseup', {\n    segment: this._segment,\n    evt: event.evt\n  });\n};\n\nSegmentShape.prototype.segmentClicked = function(eventName, event) {\n  this._moveToTop();\n\n  this._peaks.emit('segments.' + eventName, event);\n};\n\nSegmentShape.prototype._moveToTop = function() {\n  this._overlay.moveToTop();\n\n  this._layer.moveSegmentMarkersToTop();\n};\n\nSegmentShape.prototype.enableSegmentDragging = function(enable) {\n  if (!this._segment.editable) {\n    return;\n  }\n\n  if (!this._draggable && enable) {\n    this._overlay.on('dragstart', this._onSegmentDragStart);\n    this._overlay.on('dragmove', this._onSegmentDragMove);\n    this._overlay.on('dragend', this._onSegmentDragEnd);\n  }\n  else if (this._draggable && !enable) {\n    this._overlay.off('dragstart', this._onSegmentDragStart);\n    this._overlay.off('dragmove', this._onSegmentDragMove);\n    this._overlay.off('dragend', this._onSegmentDragEnd);\n  }\n\n  this._overlay.draggable(enable);\n  this._draggable = enable;\n};\n\nSegmentShape.prototype._setPreviousAndNextSegments = function() {\n  if (this._view.getSegmentDragMode() !== 'overlap') {\n    this._nextSegment = this._peaks.segments.findNextSegment(this._segment);\n    this._previousSegment = this._peaks.segments.findPreviousSegment(this._segment);\n  }\n  else {\n    this._nextSegment = null;\n    this._previousSegment = null;\n  }\n};\n\nSegmentShape.prototype._onSegmentDragStart = function(event) {\n  this._setPreviousAndNextSegments();\n\n  this._dragging = true;\n  this._dragStartX = this._overlay.getX();\n  this._dragStartTime = this._segment.startTime;\n  this._dragEndTime = this._segment.endTime;\n\n  this._peaks.emit('segments.dragstart', {\n    segment: this._segment,\n    marker: false,\n    startMarker: false,\n    evt: event.evt\n  });\n};\n\nSegmentShape.prototype._onSegmentDragMove = function(event) {\n  const x = this._overlay.getX();\n  const offsetX = x - this._dragStartX;\n  const timeOffset = this._view.pixelsToTime(offsetX);\n\n  // The WaveformShape for a segment fills the canvas width\n  // but only draws a subset of the horizontal range. When dragged\n  // we need to keep the shape object in its position but\n  // update the segment start and end time so that the right\n  // subset is drawn.\n\n  // Calculate new segment start/end time based on drag position. We'll\n  // correct this later based on the drag mode, to prevent overlapping\n  // segments or to compress the adjacent segment.\n\n  let startTime = this._dragStartTime + timeOffset;\n  let endTime = this._dragEndTime + timeOffset;\n  const segmentDuration = this._segment.endTime - this._segment.startTime;\n  let dragMode;\n  const minSegmentWidth = this._view.getMinSegmentDragWidth();\n  const minSegmentDuration = this._view.pixelsToTime(minSegmentWidth);\n  let previousSegmentUpdated = false;\n  let nextSegmentUpdated = false;\n\n  // Prevent the segment from being dragged beyond the start of the waveform.\n\n  if (startTime < 0) {\n    startTime = 0;\n    endTime = segmentDuration;\n    this._overlay.setX(this._view.timeToPixelOffset(startTime));\n  }\n\n  // Adjust segment position if it now overlaps the previous segment?\n\n  if (this._previousSegment) {\n    let previousSegmentEndX = this._view.timeToPixelOffset(this._previousSegment.endTime);\n\n    if (startTime < this._previousSegment.endTime) {\n      dragMode = this._view.getSegmentDragMode();\n\n      if (dragMode === 'no-overlap' ||\n          (dragMode === 'compress' && !this._previousSegment.editable)) {\n        startTime = this._previousSegment.endTime;\n        endTime = startTime + segmentDuration;\n        this._overlay.setX(previousSegmentEndX);\n      }\n      else if (dragMode === 'compress') {\n        let previousSegmentEndTime = startTime;\n\n        const minPreviousSegmentEndTime = this._previousSegment.startTime + minSegmentDuration;\n\n        if (previousSegmentEndTime < minPreviousSegmentEndTime) {\n          previousSegmentEndTime = minPreviousSegmentEndTime;\n\n          previousSegmentEndX = this._view.timeToPixelOffset(previousSegmentEndTime);\n\n          this._overlay.setX(previousSegmentEndX);\n\n          startTime = previousSegmentEndTime;\n          endTime = startTime + segmentDuration;\n        }\n\n        this._previousSegment.update({ endTime: previousSegmentEndTime });\n\n        previousSegmentUpdated = true;\n      }\n    }\n  }\n\n  // Adjust segment position if it now overlaps the following segment?\n\n  if (this._nextSegment) {\n    let nextSegmentStartX = this._view.timeToPixelOffset(this._nextSegment.startTime);\n\n    if (endTime > this._nextSegment.startTime) {\n      dragMode = this._view.getSegmentDragMode();\n\n      if (dragMode === 'no-overlap' ||\n          (dragMode === 'compress' && !this._nextSegment.editable)) {\n        endTime = this._nextSegment.startTime;\n        startTime = endTime - segmentDuration;\n        this._overlay.setX(nextSegmentStartX - this._overlay.getWidth());\n      }\n      else if (dragMode === 'compress') {\n        let nextSegmentStartTime = endTime;\n\n        const maxNextSegmentStartTime = this._nextSegment.endTime - minSegmentDuration;\n\n        if (nextSegmentStartTime > maxNextSegmentStartTime) {\n          nextSegmentStartTime = maxNextSegmentStartTime;\n\n          nextSegmentStartX = this._view.timeToPixelOffset(nextSegmentStartTime);\n\n          this._overlay.setX(nextSegmentStartX - this._overlay.getWidth());\n\n          endTime = nextSegmentStartTime;\n          startTime = endTime - segmentDuration;\n        }\n\n        this._nextSegment.update({ startTime: nextSegmentStartTime });\n\n        nextSegmentUpdated = true;\n      }\n    }\n  }\n\n  this._segment._setStartTime(startTime);\n  this._segment._setEndTime(endTime);\n\n  this._peaks.emit('segments.dragged', {\n    segment: this._segment,\n    marker: false,\n    startMarker: false,\n    evt: event.evt\n  });\n\n  if (previousSegmentUpdated) {\n    this._peaks.emit('segments.dragged', {\n      segment: this._previousSegment,\n      marker: false,\n      startMarker: false,\n      evt: event.evt\n    });\n  }\n  else if (nextSegmentUpdated) {\n    this._peaks.emit('segments.dragged', {\n      segment: this._nextSegment,\n      marker: false,\n      startMarker: false,\n      evt: event.evt\n    });\n  }\n};\n\nSegmentShape.prototype._onSegmentDragEnd = function(event) {\n  this._dragging = false;\n\n  this._peaks.emit('segments.dragend', {\n    segment: this._segment,\n    marker: false,\n    startMarker: false,\n    evt: event.evt\n  });\n};\n\nSegmentShape.prototype.moveMarkersToTop = function() {\n  if (this._startMarker) {\n    this._startMarker.moveToTop();\n  }\n\n  if (this._endMarker) {\n    this._endMarker.moveToTop();\n  }\n};\n\nSegmentShape.prototype.startDrag = function() {\n  if (this._endMarker) {\n    this._endMarker.startDrag();\n  }\n};\n\nSegmentShape.prototype.stopDrag = function() {\n  if (this._endMarker) {\n    this._endMarker.stopDrag();\n  }\n};\n\n/**\n * @param {SegmentMarker} segmentMarker\n */\n\nSegmentShape.prototype._onSegmentMarkerDragStart = function(segmentMarker, event) {\n  this._setPreviousAndNextSegments();\n\n  // Move this segment to the top of the z-order, so that it remains on top\n  // of any adjacent segments that the marker is dragged over.\n  this._moveToTop();\n\n  this._startMarkerX = this._startMarker.getX();\n  this._endMarkerX = this._endMarker.getX();\n\n  this._peaks.emit('segments.dragstart', {\n    segment: this._segment,\n    marker: true,\n    startMarker: segmentMarker.isStartMarker(),\n    evt: event.evt\n  });\n};\n\n/**\n * @param {SegmentMarker} segmentMarker\n */\n\nSegmentShape.prototype._onSegmentMarkerDragMove = function(segmentMarker, event) {\n  if (segmentMarker.isStartMarker()) {\n    this._segmentStartMarkerDragMove(segmentMarker, event);\n    segmentMarker.update({ startTime: this._segment.startTime });\n  }\n  else {\n    this._segmentEndMarkerDragMove(segmentMarker, event);\n    segmentMarker.update({ endTime: this._segment.endTime });\n  }\n};\n\nfunction getDuration(segment) {\n  return segment.endTime - segment.startTime;\n}\n\nSegmentShape.prototype._segmentStartMarkerDragMove = function(segmentMarker, event) {\n  const width = this._view.getWidth();\n\n  let startMarkerX = this._startMarker.getX();\n  const endMarkerX = this._endMarker.getX();\n\n  let minSegmentDuration = this._view.pixelsToTime(50);\n  const minSegmentWidth = this._view.getMinSegmentDragWidth();\n\n  let upperLimit = this._endMarker.getX() - minSegmentWidth;\n\n  if (upperLimit > width) {\n    upperLimit = width;\n  }\n\n  let previousSegmentVisible = false;\n  let previousSegmentUpdated = false;\n  let previousSegmentEndX;\n\n  if (this._previousSegment) {\n    previousSegmentEndX = this._view.timeToPixelOffset(this._previousSegment.endTime);\n    previousSegmentVisible = previousSegmentEndX >= 0;\n  }\n\n  if (startMarkerX > upperLimit) {\n    segmentMarker.setX(upperLimit);\n    this._overlay.clipWidth(upperLimit - endMarkerX);\n\n    if (minSegmentWidth === 0 && upperLimit < width) {\n      this._segment._setStartTime(this._segment.endTime);\n    }\n    else {\n      this._segment._setStartTime(this._view.pixelOffsetToTime(upperLimit));\n    }\n  }\n  else if (this._previousSegment && previousSegmentVisible) {\n    const dragMode = this._view.getSegmentDragMode();\n\n    const fixedPreviousSegment = dragMode === 'no-overlap' ||\n      (dragMode === 'compress' && !this._previousSegment.editable);\n\n    const compressPreviousSegment = dragMode === 'compress' && this._previousSegment.editable;\n\n    if (startMarkerX <= previousSegmentEndX) {\n      if (fixedPreviousSegment) {\n        segmentMarker.setX(previousSegmentEndX);\n        this._overlay.clipWidth(previousSegmentEndX - endMarkerX);\n\n        this._segment._setStartTime(this._previousSegment.endTime);\n      }\n      else if (compressPreviousSegment) {\n        const previousSegmentDuration = getDuration(this._previousSegment);\n\n        if (previousSegmentDuration < minSegmentDuration) {\n          minSegmentDuration = previousSegmentDuration;\n        }\n\n        const lowerLimit = this._view.timeToPixelOffset(\n          this._previousSegment.startTime + minSegmentDuration\n        );\n\n        if (startMarkerX < lowerLimit) {\n          startMarkerX = lowerLimit;\n        }\n\n        segmentMarker.setX(startMarkerX);\n        this._overlay.clipWidth(endMarkerX - startMarkerX);\n\n        this._segment._setStartTime(this._view.pixelOffsetToTime(startMarkerX));\n\n        this._previousSegment.update({\n          endTime: this._view.pixelOffsetToTime(startMarkerX)\n        });\n\n        previousSegmentUpdated = true;\n      }\n    }\n    else {\n      if (startMarkerX < 0) {\n        startMarkerX = 0;\n      }\n\n      segmentMarker.setX(startMarkerX);\n      this._overlay.clipWidth(endMarkerX - startMarkerX);\n\n      this._segment._setStartTime(this._view.pixelOffsetToTime(startMarkerX));\n    }\n  }\n  else {\n    if (startMarkerX < 0) {\n      startMarkerX = 0;\n    }\n\n    segmentMarker.setX(startMarkerX);\n    this._overlay.clipWidth(endMarkerX - startMarkerX);\n\n    this._segment._setStartTime(this._view.pixelOffsetToTime(startMarkerX));\n  }\n\n  this._peaks.emit('segments.dragged', {\n    segment: this._segment,\n    marker: true,\n    startMarker: true,\n    evt: event.evt\n  });\n\n  if (previousSegmentUpdated) {\n    this._peaks.emit('segments.dragged', {\n      segment: this._previousSegment,\n      marker: true,\n      startMarker: false,\n      evt: event.evt\n    });\n  }\n};\n\nSegmentShape.prototype._segmentEndMarkerDragMove = function(segmentMarker, event) {\n  const width = this._view.getWidth();\n\n  const startMarkerX = this._startMarker.getX();\n  let endMarkerX = this._endMarker.getX();\n\n  let minSegmentDuration = this._view.pixelsToTime(50);\n  const minSegmentWidth = this._view.getMinSegmentDragWidth();\n\n  let lowerLimit = this._startMarker.getX() + minSegmentWidth;\n\n  if (lowerLimit < 0) {\n    lowerLimit = 0;\n  }\n\n  let nextSegmentVisible = false;\n  let nextSegmentUpdated = false;\n  let nextSegmentStartX;\n\n  if (this._nextSegment) {\n    nextSegmentStartX = this._view.timeToPixelOffset(this._nextSegment.startTime);\n    nextSegmentVisible = nextSegmentStartX < width;\n  }\n\n  if (endMarkerX < lowerLimit) {\n    segmentMarker.setX(lowerLimit);\n    this._overlay.clipWidth(lowerLimit - startMarkerX);\n\n    if (minSegmentWidth === 0 && lowerLimit > 0) {\n      this._segment._setEndTime(this._segment.startTime);\n    }\n    else {\n      this._segment._setEndTime(this._view.pixelOffsetToTime(lowerLimit));\n    }\n  }\n  else if (this._nextSegment && nextSegmentVisible) {\n    const dragMode = this._view.getSegmentDragMode();\n\n    const fixedNextSegment = dragMode === 'no-overlap' ||\n      (dragMode === 'compress' && !this._nextSegment.editable);\n\n    const compressNextSegment = dragMode === 'compress' && this._nextSegment.editable;\n\n    if (endMarkerX >= nextSegmentStartX) {\n      if (fixedNextSegment) {\n        segmentMarker.setX(nextSegmentStartX);\n        this._overlay.clipWidth(nextSegmentStartX - startMarkerX);\n\n        this._segment._setEndTime(this._nextSegment.startTime);\n      }\n      else if (compressNextSegment) {\n        const nextSegmentDuration = getDuration(this._nextSegment);\n\n        if (nextSegmentDuration < minSegmentDuration) {\n          minSegmentDuration = nextSegmentDuration;\n        }\n\n        const upperLimit = this._view.timeToPixelOffset(\n          this._nextSegment.endTime - minSegmentDuration\n        );\n\n        if (endMarkerX > upperLimit) {\n          endMarkerX = upperLimit;\n        }\n\n        segmentMarker.setX(endMarkerX);\n        this._overlay.clipWidth(endMarkerX - startMarkerX);\n\n        this._segment._setEndTime(this._view.pixelOffsetToTime(endMarkerX));\n\n        this._nextSegment.update({\n          startTime: this._view.pixelOffsetToTime(endMarkerX)\n        });\n\n        nextSegmentUpdated = true;\n      }\n    }\n    else {\n      if (endMarkerX > width) {\n        endMarkerX = width;\n      }\n\n      segmentMarker.setX(endMarkerX);\n      this._overlay.clipWidth(endMarkerX - startMarkerX);\n\n      this._segment._setEndTime(this._view.pixelOffsetToTime(endMarkerX));\n    }\n  }\n  else {\n    if (endMarkerX > width) {\n      endMarkerX = width;\n    }\n\n    segmentMarker.setX(endMarkerX);\n    this._overlay.clipWidth(endMarkerX - startMarkerX);\n\n    this._segment._setEndTime(this._view.pixelOffsetToTime(endMarkerX));\n  }\n\n  this._peaks.emit('segments.dragged', {\n    segment: this._segment,\n    marker: true,\n    startMarker: false,\n    evt: event.evt\n  });\n\n  if (nextSegmentUpdated) {\n    this._peaks.emit('segments.dragged', {\n      segment: this._nextSegment,\n      marker: true,\n      startMarker: true,\n      evt: event.evt\n    });\n  }\n};\n\n/**\n * @param {SegmentMarker} segmentMarker\n */\n\nSegmentShape.prototype._onSegmentMarkerDragEnd = function(segmentMarker, event) {\n  this._nextSegment = null;\n  this._previousSegment = null;\n\n  const startMarker = segmentMarker.isStartMarker();\n\n  this._peaks.emit('segments.dragend', {\n    segment: this._segment,\n    marker: true,\n    startMarker: startMarker,\n    evt: event.evt\n  });\n};\n\nSegmentShape.prototype._segmentMarkerDragBoundFunc = function(segmentMarker, pos) {\n  // Allow the marker to be moved horizontally but not vertically.\n  return {\n    x: pos.x,\n    y: segmentMarker.getAbsolutePosition().y\n  };\n};\n\nSegmentShape.prototype._onSegmentMarkerClick = function() {\n  // Move this segment to the top of the z-order.\n  this._moveToTop();\n};\n\nSegmentShape.prototype.fitToView = function() {\n  if (this._startMarker) {\n    this._startMarker.fitToView();\n  }\n\n  if (this._endMarker) {\n    this._endMarker.fitToView();\n  }\n\n  if (this._overlay) {\n    const height = this._view.getHeight();\n\n    const overlayRectHeight = clamp(0, height - (this._overlayOffset * 2));\n\n    this._overlay.setAttrs({\n      y:          0,\n      height:     height,\n      clipY:      this._overlayOffset,\n      clipHeight: overlayRectHeight\n    });\n\n    this._overlayRect.setAttrs({\n      y:      this._overlayOffset,\n      height: overlayRectHeight\n    });\n\n    if (this._overlayText) {\n      this._overlayText.setAttrs({\n        y:      this._overlayOffset,\n        height: overlayRectHeight\n      });\n    }\n  }\n};\n\nSegmentShape.prototype.destroy = function() {\n  if (this._waveformShape) {\n    this._waveformShape.destroy();\n  }\n\n  if (this._label) {\n    this._label.destroy();\n  }\n\n  if (this._startMarker) {\n    this._startMarker.destroy();\n  }\n\n  if (this._endMarker) {\n    this._endMarker.destroy();\n  }\n\n  if (this._overlay) {\n    this._overlay.destroy();\n  }\n};\n\nexport default SegmentShape;\n","/**\n * @file\n *\n * Defines the {@link SegmentsLayer} class.\n *\n * @module segments-layer\n */\n\nimport SegmentShape from './segment-shape';\nimport { objectHasProperty } from './utils';\nimport Konva from 'konva/lib/Core';\n\n/**\n * Creates a Konva.Layer that displays segment markers against the audio\n * waveform.\n *\n * @class\n * @alias SegmentsLayer\n *\n * @param {Peaks} peaks\n * @param {WaveformOverview|WaveformZoomView} view\n * @param {Boolean} enableEditing\n */\n\nfunction SegmentsLayer(peaks, view, enableEditing) {\n  this._peaks         = peaks;\n  this._view          = view;\n  this._enableEditing = enableEditing;\n  this._segmentShapes = {};\n  this._layer         = new Konva.Layer();\n\n  this._onSegmentsUpdate    = this._onSegmentsUpdate.bind(this);\n  this._onSegmentsAdd       = this._onSegmentsAdd.bind(this);\n  this._onSegmentsRemove    = this._onSegmentsRemove.bind(this);\n  this._onSegmentsRemoveAll = this._onSegmentsRemoveAll.bind(this);\n  this._onSegmentsDragged   = this._onSegmentsDragged.bind(this);\n\n  this._peaks.on('segments.update', this._onSegmentsUpdate);\n  this._peaks.on('segments.add', this._onSegmentsAdd);\n  this._peaks.on('segments.remove', this._onSegmentsRemove);\n  this._peaks.on('segments.remove_all', this._onSegmentsRemoveAll);\n  this._peaks.on('segments.dragged', this._onSegmentsDragged);\n}\n\n/**\n * Adds the layer to the given {Konva.Stage}.\n *\n * @param {Konva.Stage} stage\n */\n\nSegmentsLayer.prototype.addToStage = function(stage) {\n  stage.add(this._layer);\n};\n\nSegmentsLayer.prototype.setListening = function(listening) {\n  this._layer.listening(listening);\n};\n\nSegmentsLayer.prototype.enableEditing = function(enable) {\n  this._enableEditing = enable;\n};\n\nSegmentsLayer.prototype.isEditingEnabled = function() {\n  return this._enableEditing;\n};\n\nSegmentsLayer.prototype.enableSegmentDragging = function(enable) {\n  for (const segmentPid in this._segmentShapes) {\n    if (objectHasProperty(this._segmentShapes, segmentPid)) {\n      this._segmentShapes[segmentPid].enableSegmentDragging(enable);\n    }\n  }\n};\n\nSegmentsLayer.prototype.getSegmentShape = function(segment) {\n  return this._segmentShapes[segment.pid];\n};\n\nSegmentsLayer.prototype.formatTime = function(time) {\n  return this._view.formatTime(time);\n};\n\nSegmentsLayer.prototype._onSegmentsUpdate = function(segment, options) {\n  const frameStartTime = this._view.getStartTime();\n  const frameEndTime = this._view.getEndTime();\n\n  let segmentShape = this.getSegmentShape(segment);\n  const isVisible = segment.isVisible(frameStartTime, frameEndTime);\n\n  if (segmentShape && !isVisible) {\n    // Remove segment shape that is no longer visible.\n\n    if (!segmentShape.isDragging()) {\n      this._removeSegment(segment);\n    }\n  }\n  else if (!segmentShape && isVisible) {\n    // Add segment shape for visible segment.\n    segmentShape = this._updateSegment(segment);\n  }\n  else if (segmentShape && isVisible) {\n    // Update the segment shape with the changed attributes.\n    segmentShape.update(options);\n  }\n};\n\nSegmentsLayer.prototype._onSegmentsAdd = function(event) {\n  const self = this;\n\n  const frameStartTime = self._view.getStartTime();\n  const frameEndTime   = self._view.getEndTime();\n\n  event.segments.forEach(function(segment) {\n    if (segment.isVisible(frameStartTime, frameEndTime)) {\n      const segmentShape = self._addSegmentShape(segment);\n\n      segmentShape.update();\n    }\n  });\n\n  // Ensure segment markers are always draggable.\n  this.moveSegmentMarkersToTop();\n};\n\nSegmentsLayer.prototype._onSegmentsRemove = function(event) {\n  const self = this;\n\n  event.segments.forEach(function(segment) {\n    self._removeSegment(segment);\n  });\n};\n\nSegmentsLayer.prototype._onSegmentsRemoveAll = function() {\n  this._layer.removeChildren();\n  this._segmentShapes = {};\n};\n\nSegmentsLayer.prototype._onSegmentsDragged = function(event) {\n  this._updateSegment(event.segment);\n};\n\n/**\n * Creates the Konva UI objects for a given segment.\n *\n * @private\n * @param {Segment} segment\n * @returns {SegmentShape}\n */\n\nSegmentsLayer.prototype._createSegmentShape = function(segment) {\n  return new SegmentShape(segment, this._peaks, this, this._view);\n};\n\n/**\n * Adds a Konva UI object to the layer for a given segment.\n *\n * @private\n * @param {Segment} segment\n * @returns {SegmentShape}\n */\n\nSegmentsLayer.prototype._addSegmentShape = function(segment) {\n  const segmentShape = this._createSegmentShape(segment);\n\n  segmentShape.addToLayer(this._layer);\n\n  this._segmentShapes[segment.pid] = segmentShape;\n\n  return segmentShape;\n};\n\n/**\n * Updates the positions of all displayed segments in the view.\n *\n * @param {Number} startTime The start of the visible range in the view,\n *   in seconds.\n * @param {Number} endTime The end of the visible range in the view,\n *   in seconds.\n */\n\nSegmentsLayer.prototype.updateSegments = function(startTime, endTime) {\n  // Update segments in visible time range.\n  const segments = this._peaks.segments.find(startTime, endTime);\n\n  segments.forEach(this._updateSegment.bind(this));\n\n  // TODO: In the overview all segments are visible, so no need to do this.\n  this._removeInvisibleSegments(startTime, endTime);\n};\n\n/**\n * @private\n * @param {Segment} segment\n */\n\nSegmentsLayer.prototype._updateSegment = function(segment) {\n  let segmentShape = this.getSegmentShape(segment);\n\n  if (!segmentShape) {\n    segmentShape = this._addSegmentShape(segment);\n  }\n\n  segmentShape.update();\n};\n\n/**\n * Removes any segments that are not visible, i.e., are not within and do not\n * overlap the given time range.\n *\n * @private\n * @param {Number} startTime The start of the visible time range, in seconds.\n * @param {Number} endTime The end of the visible time range, in seconds.\n */\n\nSegmentsLayer.prototype._removeInvisibleSegments = function(startTime, endTime) {\n  for (const segmentPid in this._segmentShapes) {\n    if (objectHasProperty(this._segmentShapes, segmentPid)) {\n      const segment = this._segmentShapes[segmentPid].getSegment();\n\n      if (!segment.isVisible(startTime, endTime)) {\n        this._removeSegment(segment);\n      }\n    }\n  }\n};\n\n/**\n * Removes the given segment from the view.\n *\n * @param {Segment} segment\n */\n\nSegmentsLayer.prototype._removeSegment = function(segment) {\n  const segmentShape = this._segmentShapes[segment.pid];\n\n  if (segmentShape) {\n    segmentShape.destroy();\n    delete this._segmentShapes[segment.pid];\n  }\n};\n\n/**\n * Moves all segment markers to the top of the z-order,\n * so the user can always drag them.\n */\n\nSegmentsLayer.prototype.moveSegmentMarkersToTop = function() {\n  for (const segmentPid in this._segmentShapes) {\n    if (objectHasProperty(this._segmentShapes, segmentPid)) {\n      this._segmentShapes[segmentPid].moveMarkersToTop();\n    }\n  }\n};\n\n/**\n * Toggles visibility of the segments layer.\n *\n * @param {Boolean} visible\n */\n\nSegmentsLayer.prototype.setVisible = function(visible) {\n  this._layer.setVisible(visible);\n};\n\nSegmentsLayer.prototype.segmentClicked = function(eventName, event) {\n  const segmentShape = this._segmentShapes[event.segment.pid];\n\n  if (segmentShape) {\n    segmentShape.segmentClicked(eventName, event);\n  }\n};\n\nSegmentsLayer.prototype.destroy = function() {\n  this._peaks.off('segments.update', this._onSegmentsUpdate);\n  this._peaks.off('segments.add', this._onSegmentsAdd);\n  this._peaks.off('segments.remove', this._onSegmentsRemove);\n  this._peaks.off('segments.remove_all', this._onSegmentsRemoveAll);\n  this._peaks.off('segments.dragged', this._onSegmentsDragged);\n};\n\nSegmentsLayer.prototype.fitToView = function() {\n  for (const segmentPid in this._segmentShapes) {\n    if (objectHasProperty(this._segmentShapes, segmentPid)) {\n      const segmentShape = this._segmentShapes[segmentPid];\n\n      segmentShape.fitToView();\n    }\n  }\n};\n\nSegmentsLayer.prototype.draw = function() {\n  this._layer.draw();\n};\n\nSegmentsLayer.prototype.getHeight = function() {\n  return this._layer.getHeight();\n};\n\nexport default SegmentsLayer;\n","/**\n * @file\n *\n * Defines the {@link WaveformAxis} class.\n *\n * @module waveform-axis\n */\n\nimport { formatTime, objectHasProperty, roundUpToNearest } from './utils';\nimport Konva from 'konva/lib/Core';\n\n/**\n * Creates the waveform axis shapes and adds them to the given view layer.\n *\n * @class\n * @alias WaveformAxis\n *\n * @param {WaveformOverview|WaveformZoomView} view\n * @param {Object} options\n * @param {String} options.axisGridlineColor\n * @param {String} options.axisLabelColor\n * @param {Boolean} options.showAxisLabels\n * @param {Function} options.formatAxisTime\n * @param {String} options.fontFamily\n * @param {Number} options.fontSize\n * @param {String} options.fontStyle\n */\n\nfunction WaveformAxis(view, options) {\n  const self = this;\n\n  self._axisGridlineColor      = options.axisGridlineColor;\n  self._axisLabelColor         = options.axisLabelColor;\n  self._showAxisLabels         = options.showAxisLabels;\n  self._axisTopMarkerHeight    = options.axisTopMarkerHeight;\n  self._axisBottomMarkerHeight = options.axisBottomMarkerHeight;\n\n  if (options.formatAxisTime) {\n    self._formatAxisTime = options.formatAxisTime;\n  }\n  else {\n    self._formatAxisTime = function(time) {\n      // precision = 0, drops the fractional seconds\n      return formatTime(time, 0);\n    };\n  }\n\n  self._axisLabelFont = WaveformAxis._buildFontString(\n    options.fontFamily,\n    options.fontSize,\n    options.fontStyle\n  );\n\n  self._axisShape = new Konva.Shape({\n    sceneFunc: function(context) {\n      self._drawAxis(context, view);\n    }\n  });\n}\n\nWaveformAxis._buildFontString = function(fontFamily, fontSize, fontStyle) {\n  if (!fontSize) {\n    fontSize = 11;\n  }\n\n  if (!fontFamily) {\n    fontFamily = 'sans-serif';\n  }\n\n  if (!fontStyle) {\n    fontStyle = 'normal';\n  }\n\n  return fontStyle + ' ' + fontSize + 'px ' + fontFamily;\n};\n\nWaveformAxis.prototype.addToLayer = function(layer) {\n  layer.add(this._axisShape);\n};\n\nWaveformAxis.prototype.showAxisLabels = function(show, options) {\n  this._showAxisLabels = show;\n\n  if (options) {\n    if (objectHasProperty(options, 'topMarkerHeight')) {\n      this._axisTopMarkerHeight = options.topMarkerHeight;\n    }\n\n    if (objectHasProperty(options, 'bottomMarkerHeight')) {\n      this._axisBottomMarkerHeight = options.bottomMarkerHeight;\n    }\n  }\n};\n\nWaveformAxis.prototype.setAxisLabelColor = function(color) {\n  this._axisLabelColor = color;\n};\n\nWaveformAxis.prototype.setAxisGridlineColor = function(color) {\n  this._axisGridlineColor = color;\n};\n\n/**\n * Returns number of seconds for each x-axis marker, appropriate for the\n * current zoom level, ensuring that markers are not too close together\n * and that markers are placed at intuitive time intervals (i.e., every 1,\n * 2, 5, 10, 20, 30 seconds, then every 1, 2, 5, 10, 20, 30 minutes, then\n * every 1, 2, 5, 10, 20, 30 hours).\n *\n * @param {WaveformOverview|WaveformZoomView} view\n * @returns {Number}\n */\n\nWaveformAxis.prototype._getAxisLabelScale = function(view) {\n  let baseSecs = 1; // seconds\n  const steps = [1, 2, 5, 10, 20, 30];\n  const minSpacing = 60;\n  let index = 0;\n\n  let secs;\n\n  for (;;) {\n    secs = baseSecs * steps[index];\n    const pixels = view.timeToPixels(secs);\n\n    if (pixels < minSpacing) {\n      if (++index === steps.length) {\n        baseSecs *= 60; // seconds -> minutes -> hours\n        index = 0;\n      }\n    }\n    else {\n      break;\n    }\n  }\n\n  return secs;\n};\n\n/**\n * Draws the time axis and labels onto a view.\n *\n * @param {Konva.Context} context The context to draw on.\n * @param {WaveformOverview|WaveformZoomView} view\n */\n\nWaveformAxis.prototype._drawAxis = function(context, view) {\n  const currentFrameStartTime = view.getStartTime();\n\n  // Time interval between axis markers (seconds)\n  const axisLabelIntervalSecs = this._getAxisLabelScale(view);\n\n  // Time of first axis marker (seconds)\n  const firstAxisLabelSecs = roundUpToNearest(currentFrameStartTime, axisLabelIntervalSecs);\n\n  // Distance between waveform start time and first axis marker (seconds)\n  const axisLabelOffsetSecs = firstAxisLabelSecs - currentFrameStartTime;\n\n  // Distance between waveform start time and first axis marker (pixels)\n  const axisLabelOffsetPixels = view.timeToPixels(axisLabelOffsetSecs);\n\n  context.setAttr('strokeStyle', this._axisGridlineColor);\n  context.setAttr('lineWidth', 1);\n\n  // Set text style\n  context.setAttr('font', this._axisLabelFont);\n  context.setAttr('fillStyle', this._axisLabelColor);\n  context.setAttr('textAlign', 'left');\n  context.setAttr('textBaseline', 'bottom');\n\n  const width  = view.getWidth();\n  const height = view.getHeight();\n\n  let secs = firstAxisLabelSecs;\n\n  for (;;) {\n    // Position of axis marker (pixels)\n    const x = axisLabelOffsetPixels + view.timeToPixels(secs - firstAxisLabelSecs);\n\n    if (x >= width) {\n      break;\n    }\n\n    if (this._axisTopMarkerHeight > 0) {\n      context.beginPath();\n      context.moveTo(x + 0.5, 0);\n      context.lineTo(x + 0.5, 0 + this._axisTopMarkerHeight);\n      context.stroke();\n    }\n\n    if (this._axisBottomMarkerHeight > 0) {\n      context.beginPath();\n      context.moveTo(x + 0.5, height);\n      context.lineTo(x + 0.5, height - this._axisBottomMarkerHeight);\n      context.stroke();\n    }\n\n    if (this._showAxisLabels) {\n      const label      = this._formatAxisTime(secs);\n      const labelWidth = context.measureText(label).width;\n      const labelX     = x - labelWidth / 2;\n      const labelY     = height - 1 - this._axisBottomMarkerHeight;\n\n      if (labelX >= 0) {\n        context.fillText(label, labelX, labelY);\n      }\n    }\n\n    secs += axisLabelIntervalSecs;\n  }\n};\n\nexport default WaveformAxis;\n","/**\n * @file\n *\n * Defines the {@link WaveformView} class.\n *\n * @module waveform-view\n */\n\nimport PointsLayer from './points-layer';\nimport PlayheadLayer from './playhead-layer';\nimport SegmentsLayer from './segments-layer';\nimport WaveformAxis from './waveform-axis';\nimport WaveformShape from './waveform-shape';\n\nimport { formatTime, getMarkerObject, isFinite, isNumber } from './utils';\n\nimport Konva from 'konva/lib/Core';\n\nfunction WaveformView(waveformData, container, peaks, viewOptions) {\n  const self = this;\n\n  self._container = container;\n  self._peaks = peaks;\n  self._options = peaks.options;\n  self._viewOptions = viewOptions;\n\n  self._originalWaveformData = waveformData;\n  self._data = waveformData;\n\n  // The pixel offset of the current frame being displayed\n  self._frameOffset = 0;\n  self._width = container.clientWidth;\n  self._height = container.clientHeight;\n\n  self._amplitudeScale = 1.0;\n\n  self._waveformColor = self._viewOptions.waveformColor;\n  self._playedWaveformColor = self._viewOptions.playedWaveformColor;\n\n  self._timeLabelPrecision = self._viewOptions.timeLabelPrecision;\n\n  if (self._viewOptions.formatPlayheadTime) {\n    self._formatPlayheadTime = self._viewOptions.formatPlayheadTime;\n  }\n  else {\n    self._formatPlayheadTime = function(time) {\n      return formatTime(time, self._timeLabelPrecision);\n    };\n  }\n\n  self._enableSeek = true;\n\n  self.initWaveformData();\n\n  // Disable warning: The stage has 6 layers.\n  // Recommended maximum number of layers is 3-5.\n  Konva.showWarnings = false;\n\n  self._stage = new Konva.Stage({\n    container: container,\n    width: self._width,\n    height: self._height\n  });\n\n  self._createWaveform();\n\n  if (self._viewOptions.enableSegments) {\n    self._segmentsLayer = new SegmentsLayer(peaks, self, self._viewOptions.enableEditing);\n    self._segmentsLayer.addToStage(self._stage);\n  }\n\n  if (self._viewOptions.enablePoints) {\n    self._pointsLayer = new PointsLayer(peaks, self, self._viewOptions.enableEditing);\n    self._pointsLayer.addToStage(self._stage);\n  }\n\n  self.initHighlightLayer();\n\n  self._createAxisLabels();\n\n  self._playheadLayer = new PlayheadLayer(\n    self._peaks.player,\n    self,\n    self._viewOptions\n  );\n\n  self._playheadLayer.addToStage(self._stage);\n\n  self._onClick = self._onClick.bind(self);\n  self._onDblClick = self._onDblClick.bind(self);\n  self._onContextMenu = self._onContextMenu.bind(self);\n\n  self._stage.on('click', self._onClick);\n  self._stage.on('dblclick', self._onDblClick);\n  self._stage.on('contextmenu', self._onContextMenu);\n}\n\nWaveformView.prototype.getViewOptions = function() {\n  return this._viewOptions;\n};\n\n/**\n * @returns {WaveformData} The view's waveform data.\n */\n\nWaveformView.prototype.getWaveformData = function() {\n  return this._data;\n};\n\nWaveformView.prototype.setWaveformData = function(waveformData) {\n  this._data = waveformData;\n};\n\n/**\n * Returns the pixel index for a given time, for the current zoom level.\n *\n * @param {Number} time Time, in seconds.\n * @returns {Number} Pixel index.\n */\n\nWaveformView.prototype.timeToPixels = function(time) {\n  return Math.floor(time * this._data.sample_rate / this._data.scale);\n};\n\n/**\n * Returns the time for a given pixel index, for the current zoom level.\n *\n * @param {Number} pixels Pixel index.\n * @returns {Number} Time, in seconds.\n */\n\nWaveformView.prototype.pixelsToTime = function(pixels) {\n  return pixels * this._data.scale / this._data.sample_rate;\n};\n\n/**\n * Returns the time for a given pixel offset (relative to the\n * current scroll position), for the current zoom level.\n *\n * @param {Number} offset Offset from left-visible-edge of view\n * @returns {Number} Time, in seconds.\n */\n\nWaveformView.prototype.pixelOffsetToTime = function(offset) {\n  const pixels = this._frameOffset + offset;\n\n  return pixels * this._data.scale / this._data.sample_rate;\n};\n\nWaveformView.prototype.timeToPixelOffset = function(time) {\n  return Math.floor(time * this._data.sample_rate / this._data.scale) - this._frameOffset;\n};\n\n/**\n * @returns {Number} The start position of the waveform shown in the view,\n *   in pixels.\n */\n\nWaveformView.prototype.getFrameOffset = function() {\n  return this._frameOffset;\n};\n\n/**\n * @returns {Number} The width of the view, in pixels.\n */\n\nWaveformView.prototype.getWidth = function() {\n  return this._width;\n};\n\n/**\n * @returns {Number} The height of the view, in pixels.\n */\n\nWaveformView.prototype.getHeight = function() {\n  return this._height;\n};\n\n/**\n * @returns {Number} The time at the left edge of the waveform view.\n */\n\nWaveformView.prototype.getStartTime = function() {\n  return this.pixelOffsetToTime(0);\n};\n\n/**\n * @returns {Number} The time at the right edge of the waveform view.\n */\n\nWaveformView.prototype.getEndTime = function() {\n  return this.pixelOffsetToTime(this._width);\n};\n\n/**\n * @returns {Number} The media duration, in seconds.\n */\n\nWaveformView.prototype._getDuration = function() {\n  return this._peaks.player.getDuration();\n};\n\nWaveformView.prototype._createWaveform = function() {\n  this._waveformLayer = new Konva.Layer({ listening: false });\n\n  this._createWaveformShapes();\n\n  this._stage.add(this._waveformLayer);\n};\n\nWaveformView.prototype._createWaveformShapes = function() {\n  if (!this._waveformShape) {\n    this._waveformShape = new WaveformShape({\n      color: this._waveformColor,\n      view: this\n    });\n\n    this._waveformShape.addToLayer(this._waveformLayer);\n  }\n\n  if (this._playedWaveformColor && !this._playedWaveformShape) {\n    const time = this._peaks.player.getCurrentTime();\n\n    this._playedSegment = {\n      startTime: 0,\n      endTime: time\n    };\n\n    this._unplayedSegment = {\n      startTime: time,\n      endTime: this._getDuration()\n    };\n\n    this._waveformShape.setSegment(this._unplayedSegment);\n\n    this._playedWaveformShape = new WaveformShape({\n      color: this._playedWaveformColor,\n      view: this,\n      segment: this._playedSegment\n    });\n\n    this._playedWaveformShape.addToLayer(this._waveformLayer);\n  }\n};\n\nWaveformView.prototype.setWaveformColor = function(color) {\n  this._waveformColor = color;\n  this._waveformShape.setWaveformColor(color);\n};\n\nWaveformView.prototype.setPlayedWaveformColor = function(color) {\n  this._playedWaveformColor = color;\n\n  if (color) {\n    if (!this._playedWaveformShape) {\n      this._createWaveformShapes();\n    }\n\n    this._playedWaveformShape.setWaveformColor(color);\n  }\n  else {\n    if (this._playedWaveformShape) {\n      this._destroyPlayedWaveformShape();\n    }\n  }\n};\n\nWaveformView.prototype._destroyPlayedWaveformShape = function() {\n  this._waveformShape.setSegment(null);\n\n  this._playedWaveformShape.destroy();\n  this._playedWaveformShape = null;\n\n  this._playedSegment = null;\n  this._unplayedSegment = null;\n};\n\nWaveformView.prototype._createAxisLabels = function() {\n  this._axisLayer = new Konva.Layer({ listening: false });\n  this._axis = new WaveformAxis(this, this._viewOptions);\n\n  this._axis.addToLayer(this._axisLayer);\n  this._stage.add(this._axisLayer);\n};\n\nWaveformView.prototype.showAxisLabels = function(show, options) {\n  this._axis.showAxisLabels(show, options);\n  this._axisLayer.draw();\n};\n\nWaveformView.prototype.setAxisLabelColor = function(color) {\n  this._axis.setAxisLabelColor(color);\n  this._axisLayer.draw();\n};\n\nWaveformView.prototype.setAxisGridlineColor = function(color) {\n  this._axis.setAxisGridlineColor(color);\n  this._axisLayer.draw();\n};\n\nWaveformView.prototype.showPlayheadTime = function(show) {\n  this._playheadLayer.showPlayheadTime(show);\n};\n\nWaveformView.prototype.setTimeLabelPrecision = function(precision) {\n  this._timeLabelPrecision = precision;\n  this._playheadLayer.updatePlayheadText();\n};\n\nWaveformView.prototype.formatTime = function(time) {\n  return this._formatPlayheadTime(time);\n};\n\n/**\n * Adjusts the amplitude scale of waveform shown in the view, which allows\n * users to zoom the waveform vertically.\n *\n * @param {Number} scale The new amplitude scale factor\n */\n\nWaveformView.prototype.setAmplitudeScale = function(scale) {\n  if (!isNumber(scale) || !isFinite(scale)) {\n    throw new Error('view.setAmplitudeScale(): Scale must be a valid number');\n  }\n\n  this._amplitudeScale = scale;\n\n  this.drawWaveformLayer();\n\n  if (this._segmentsLayer) {\n    this._segmentsLayer.draw();\n  }\n};\n\nWaveformView.prototype.getAmplitudeScale = function() {\n  return this._amplitudeScale;\n};\n\nWaveformView.prototype.enableSeek = function(enable) {\n  this._enableSeek = enable;\n};\n\nWaveformView.prototype.isSeekEnabled = function() {\n  return this._enableSeek;\n};\n\nWaveformView.prototype._onClick = function(event) {\n  this._clickHandler(event, 'click');\n};\n\nWaveformView.prototype._onDblClick = function(event) {\n  this._clickHandler(event, 'dblclick');\n};\n\nWaveformView.prototype._onContextMenu = function(event) {\n  this._clickHandler(event, 'contextmenu');\n};\n\nWaveformView.prototype._clickHandler = function(event, eventName) {\n  let offsetX = event.evt.offsetX;\n\n  if (offsetX < 0) {\n    offsetX = 0;\n  }\n\n  let emitViewEvent = true;\n\n  if (event.target !== this._stage) {\n    const marker = getMarkerObject(event.target);\n\n    if (marker) {\n      if (marker.attrs.name === 'point-marker') {\n        const point = marker.getAttr('point');\n\n        if (point) {\n          this._peaks.emit('points.' + eventName, {\n            point: point,\n            evt: event.evt,\n            preventViewEvent: function() {\n              emitViewEvent = false;\n            }\n          });\n        }\n      }\n      else if (marker.attrs.name === 'segment-overlay') {\n        const segment = marker.getAttr('segment');\n\n        if (segment) {\n          const clickEvent = {\n            segment: segment,\n            evt: event.evt,\n            preventViewEvent: function() {\n              emitViewEvent = false;\n            }\n          };\n\n          if (this._segmentsLayer) {\n            this._segmentsLayer.segmentClicked(eventName, clickEvent);\n          }\n        }\n      }\n    }\n  }\n\n  if (emitViewEvent) {\n    const time = this.pixelOffsetToTime(offsetX);\n    const viewName = this.getName();\n\n    this._peaks.emit(viewName + '.' + eventName, {\n      time: time,\n      evt: event.evt\n    });\n  }\n};\n\nWaveformView.prototype.updatePlayheadTime = function(time) {\n  this._playheadLayer.updatePlayheadTime(time);\n};\n\nWaveformView.prototype.playheadPosChanged = function(time) {\n  if (this._playedWaveformShape) {\n    this._playedSegment.endTime = time;\n    this._unplayedSegment.startTime = time;\n\n    this.drawWaveformLayer();\n  }\n};\n\nWaveformView.prototype.drawWaveformLayer = function() {\n  this._waveformLayer.draw();\n};\n\nWaveformView.prototype.enableMarkerEditing = function(enable) {\n  if (this._segmentsLayer) {\n    this._segmentsLayer.enableEditing(enable);\n  }\n\n  if (this._pointsLayer) {\n    this._pointsLayer.enableEditing(enable);\n  }\n};\n\n/**\n * Called when the user starts or stops dragging the playhead.\n * We use this to disable interaction with the points and segments layers,\n * e.g., so that when the user drags the playhead over a marker, the timestamp\n * labels don't appear.\n */\n\nWaveformView.prototype.dragSeek = function(dragging) {\n  if (this._segmentsLayer) {\n    this._segmentsLayer.setListening(!dragging);\n  }\n\n  if (this._pointsLayer) {\n    this._pointsLayer.setListening(!dragging);\n  }\n};\n\nWaveformView.prototype.fitToContainer = function() {\n  if (this._container.clientWidth === 0 && this._container.clientHeight === 0) {\n    return;\n  }\n\n  let updateWaveform = false;\n\n  if (this._container.clientWidth !== this._width) {\n    this._width = this._container.clientWidth;\n    this._stage.setWidth(this._width);\n\n    updateWaveform = this.containerWidthChange();\n  }\n\n  let heightChanged = false;\n\n  if (this._container.clientHeight !== this._height) {\n    this._height = this._container.clientHeight;\n    this._stage.setHeight(this._height);\n\n    this._waveformShape.fitToView();\n    this._playheadLayer.fitToView();\n\n    this.containerHeightChange();\n\n    heightChanged = true;\n  }\n\n  if (updateWaveform) {\n    this.updateWaveform(this._frameOffset, true);\n  }\n  else if (heightChanged) {\n    if (this._segmentsLayer) {\n      this._segmentsLayer.fitToView();\n    }\n\n    if (this._pointsLayer) {\n      this._pointsLayer.fitToView();\n    }\n  }\n};\n\nWaveformView.prototype.destroy = function() {\n  this._playheadLayer.destroy();\n\n  if (this._segmentsLayer) {\n    this._segmentsLayer.destroy();\n  }\n\n  if (this._pointsLayer) {\n    this._pointsLayer.destroy();\n  }\n\n  if (this._stage) {\n    this._stage.destroy();\n    this._stage = null;\n  }\n};\n\nexport default WaveformView;\n","/**\n * @file\n *\n * Defines the {@link MouseDragHandler} class.\n *\n * @module mouse-drag-handler\n */\n\nimport { getMarkerObject } from './utils';\n\n/**\n * An object to receive callbacks on mouse drag events. Each function is\n * called with the current mouse X position, relative to the stage's\n * container HTML element.\n *\n * @typedef {Object} MouseDragHandlers\n * @global\n * @property {Function} onMouseDown Mouse down event handler.\n * @property {Function} onMouseMove Mouse move event handler.\n * @property {Function} onMouseUp Mouse up event handler.\n */\n\n/**\n * Creates a handler for mouse events to allow interaction with the waveform\n * views by clicking and dragging the mouse.\n *\n * @class\n * @alias MouseDragHandler\n *\n * @param {Konva.Stage} stage\n * @param {MouseDragHandlers} handlers\n */\n\nfunction MouseDragHandler(stage, handlers) {\n  this._stage     = stage;\n  this._handlers  = handlers;\n  this._dragging  = false;\n  this._mouseDown = this._mouseDown.bind(this);\n  this._mouseUp   = this._mouseUp.bind(this);\n  this._mouseMove = this._mouseMove.bind(this);\n\n  this._stage.on('mousedown', this._mouseDown);\n  this._stage.on('touchstart', this._mouseDown);\n\n  this._lastMouseClientX = null;\n}\n\n/**\n * Mouse down event handler.\n *\n * @param {MouseEvent} event\n */\n\nMouseDragHandler.prototype._mouseDown = function(event) {\n  let segment = null;\n\n  if (event.type === 'mousedown' && event.evt.button !== 0) {\n    // Mouse drag only applies to the primary mouse button.\n    // The secondary button may be used to show a context menu\n    // and we don't want to also treat this as a mouse drag operation.\n    return;\n  }\n\n  const marker = getMarkerObject(event.target);\n\n  if (marker) {\n    // Avoid interfering with drag/drop of point and segment markers.\n    if (marker.attrs.name === 'point-marker' ||\n        marker.attrs.name === 'segment-marker') {\n      return;\n    }\n\n    // Check if we're dragging a segment.\n    if (marker.attrs.name === 'segment-overlay') {\n      segment = marker;\n    }\n  }\n\n  this._lastMouseClientX = Math.floor(\n    event.type === 'touchstart' ? event.evt.touches[0].clientX : event.evt.clientX\n  );\n\n  if (this._handlers.onMouseDown) {\n    const mouseDownPosX = this._getMousePosX(this._lastMouseClientX);\n\n    this._handlers.onMouseDown(mouseDownPosX, segment);\n  }\n\n  // Use the window mousemove and mouseup handlers instead of the\n  // Konva.Stage ones so that we still receive events if the user moves the\n  // mouse outside the stage.\n  window.addEventListener('mousemove', this._mouseMove, { capture: false, passive: true });\n  window.addEventListener('touchmove', this._mouseMove, { capture: false, passive: true });\n  window.addEventListener('mouseup', this._mouseUp, { capture: false, passive: true });\n  window.addEventListener('touchend', this._mouseUp, { capture: false /* , passive: true */ });\n  window.addEventListener('blur', this._mouseUp, { capture: false, passive: true });\n};\n\n/**\n * Mouse move event handler.\n *\n * @param {MouseEvent} event\n */\n\nMouseDragHandler.prototype._mouseMove = function(event) {\n  const clientX = Math.floor(\n    event.type === 'touchmove' ? event.changedTouches[0].clientX : event.clientX\n  );\n\n  // Don't update on vertical mouse movement.\n  if (clientX === this._lastMouseClientX) {\n    return;\n  }\n\n  this._lastMouseClientX = clientX;\n\n  this._dragging = true;\n\n  if (this._handlers.onMouseMove) {\n    const mousePosX = this._getMousePosX(clientX);\n\n    this._handlers.onMouseMove(mousePosX);\n  }\n};\n\n/**\n * Mouse up event handler.\n *\n * @param {MouseEvent} event\n */\n\nMouseDragHandler.prototype._mouseUp = function(event) {\n  let clientX;\n\n  if (event.type === 'touchend') {\n    clientX = Math.floor(event.changedTouches[0].clientX);\n\n    if (event.cancelable) {\n      event.preventDefault();\n    }\n  }\n  else {\n    clientX = Math.floor(event.clientX);\n  }\n\n  if (this._handlers.onMouseUp) {\n    const mousePosX = this._getMousePosX(clientX);\n\n    this._handlers.onMouseUp(mousePosX);\n  }\n\n  window.removeEventListener('mousemove', this._mouseMove, { capture: false });\n  window.removeEventListener('touchmove', this._mouseMove, { capture: false });\n  window.removeEventListener('mouseup', this._mouseUp, { capture: false });\n  window.removeEventListener('touchend', this._mouseUp, { capture: false });\n  window.removeEventListener('blur', this._mouseUp, { capture: false });\n\n  this._dragging = false;\n};\n\n/**\n * @returns {Number} The mouse X position, relative to the container that\n * received the mouse down event.\n *\n * @private\n * @param {Number} clientX Mouse client X position.\n */\n\nMouseDragHandler.prototype._getMousePosX = function(clientX) {\n  const containerPos = this._stage.getContainer().getBoundingClientRect();\n\n  return Math.floor(clientX - containerPos.left);\n};\n\n/**\n * Returns <code>true</code> if the mouse is being dragged, i.e., moved with\n * the mouse button held down.\n *\n * @returns {Boolean}\n */\n\nMouseDragHandler.prototype.isDragging = function() {\n  return this._dragging;\n};\n\nMouseDragHandler.prototype.destroy = function() {\n  this._stage.off('mousedown', this._mouseDown);\n  this._stage.off('touchstart', this._mouseDown);\n};\n\nexport default MouseDragHandler;\n","/**\n * @file\n *\n * Defines the {@link SeekMouseDragHandler} class.\n *\n * @module seek-mouse-drag-handler\n */\n\nimport MouseDragHandler from './mouse-drag-handler';\nimport { clamp } from './utils';\n\n/**\n * Creates a handler for mouse events to allow seeking the waveform\n * views by clicking and dragging the mouse.\n *\n * @class\n * @alias SeekMouseDragHandler\n *\n * @param {Peaks} peaks\n * @param {WaveformOverview} view\n */\n\nfunction SeekMouseDragHandler(peaks, view) {\n  this._peaks = peaks;\n  this._view = view;\n  this._firstMove = false;\n\n  this._onMouseDown = this._onMouseDown.bind(this);\n  this._onMouseMove = this._onMouseMove.bind(this);\n  this._onMouseUp = this._onMouseUp.bind(this);\n\n  this._mouseDragHandler = new MouseDragHandler(view._stage, {\n    onMouseDown: this._onMouseDown,\n    onMouseMove: this._onMouseMove,\n    onMouseUp: this._onMouseUp\n  });\n}\n\nSeekMouseDragHandler.prototype._onMouseDown = function(mousePosX) {\n  this._firstMove = true;\n  this._seek(mousePosX);\n};\n\nSeekMouseDragHandler.prototype._onMouseMove = function(mousePosX) {\n  if (this._firstMove) {\n    this._view.dragSeek(true);\n    this._firstMove = false;\n  }\n\n  this._seek(mousePosX);\n};\n\nSeekMouseDragHandler.prototype._onMouseUp = function() {\n  this._view.dragSeek(false);\n};\n\nSeekMouseDragHandler.prototype._seek = function(mousePosX) {\n  if (!this._view.isSeekEnabled()) {\n    return;\n  }\n\n  mousePosX = clamp(mousePosX, 0, this._width);\n\n  let time = this._view.pixelsToTime(mousePosX);\n  const duration = this._peaks.player.getDuration();\n\n  // Prevent the playhead position from jumping by limiting click\n  // handling to the waveform duration.\n  if (time > duration) {\n    time = duration;\n  }\n\n  // Update the playhead position. This gives a smoother visual update\n  // than if we only use the player.timeupdate event.\n  this._view.updatePlayheadTime(time);\n\n  this._peaks.player.seek(time);\n};\n\nSeekMouseDragHandler.prototype.destroy = function() {\n  this._mouseDragHandler.destroy();\n};\n\nexport default SeekMouseDragHandler;\n","/**\n * @file\n *\n * Defines the {@link WaveformOverview} class.\n *\n * @module waveform-overview\n */\n\nimport HighlightLayer from './highlight-layer';\nimport WaveformView from './waveform-view';\nimport SeekMouseDragHandler from './seek-mouse-drag-handler';\n\n/**\n * Creates the overview waveform view.\n *\n * @class\n * @alias WaveformOverview\n *\n * @param {WaveformData} waveformData\n * @param {HTMLElement} container\n * @param {Peaks} peaks\n */\n\nfunction WaveformOverview(waveformData, container, peaks) {\n  const self = this;\n\n  WaveformView.call(self, waveformData, container, peaks, peaks.options.overview);\n\n  // Bind event handlers\n  self._onTimeUpdate = self._onTimeUpdate.bind(self);\n  self._onPlaying = self._onPlaying.bind(self);\n  self._onPause = self._onPause.bind(self);\n  self._onZoomviewUpdate = self._onZoomviewUpdate.bind(self);\n\n  // Register event handlers\n  peaks.on('player.timeupdate', self._onTimeUpdate);\n  peaks.on('player.playing', self._onPlaying);\n  peaks.on('player.pause', self._onPause);\n  peaks.on('zoomview.update', self._onZoomviewUpdate);\n\n  const time = self._peaks.player.getCurrentTime();\n\n  self._playheadLayer.updatePlayheadTime(time);\n\n  self._mouseDragHandler = new SeekMouseDragHandler(peaks, self);\n\n  const zoomview = peaks.views.getView('zoomview');\n\n  if (zoomview) {\n    self._highlightLayer.showHighlight(zoomview.getStartTime(), zoomview.getEndTime());\n  }\n}\n\nWaveformOverview.prototype = Object.create(WaveformView.prototype);\n\nWaveformOverview.prototype.initWaveformData = function() {\n  if (this._width !== 0) {\n    this._resampleAndSetWaveformData(this._originalWaveformData, this._width);\n  }\n};\n\nWaveformOverview.prototype.initHighlightLayer = function() {\n  this._highlightLayer = new HighlightLayer(\n    this,\n    this._viewOptions\n  );\n\n  this._highlightLayer.addToStage(this._stage);\n};\n\nWaveformOverview.prototype.isSegmentDraggingEnabled = function() {\n  return false;\n};\n\nWaveformOverview.prototype.getName = function() {\n  return 'overview';\n};\n\nWaveformOverview.prototype._onTimeUpdate = function(time) {\n  this._playheadLayer.updatePlayheadTime(time);\n};\n\nWaveformOverview.prototype._onPlaying = function(time) {\n  this._playheadLayer.updatePlayheadTime(time);\n};\n\nWaveformOverview.prototype._onPause = function(time) {\n  this._playheadLayer.stop(time);\n};\n\nWaveformOverview.prototype._onZoomviewUpdate = function(event) {\n  this.showHighlight(event.startTime, event.endTime);\n};\n\nWaveformOverview.prototype.showHighlight = function(startTime, endTime) {\n  this._highlightLayer.showHighlight(startTime, endTime);\n};\n\nWaveformOverview.prototype.setWaveformData = function(waveformData) {\n  this._originalWaveformData = waveformData;\n\n  if (this._width !== 0) {\n    this._resampleAndSetWaveformData(waveformData, this._width);\n  }\n  else {\n    this._data = waveformData;\n  }\n\n  this.updateWaveform();\n};\n\nWaveformOverview.prototype._resampleAndSetWaveformData = function(waveformData, width) {\n  try {\n    this._data = waveformData.resample({ width: width });\n    return true;\n  }\n  catch (error) { // eslint-disable-line no-unused-vars\n    // This error usually indicates that the waveform length\n    // is less than the container width. Ignore, and use the\n    // given waveform data\n    this._data = waveformData;\n    return false;\n  }\n};\n\nWaveformOverview.prototype.removeHighlightRect = function() {\n  this._highlightLayer.removeHighlight();\n};\n\nWaveformOverview.prototype.updateWaveform = function(/* frameOffset, forceUpdate */) {\n  this._waveformLayer.draw();\n  this._axisLayer.draw();\n\n  const playheadTime = this._peaks.player.getCurrentTime();\n\n  this._playheadLayer.updatePlayheadTime(playheadTime);\n\n  this._highlightLayer.updateHighlight();\n\n  const frameStartTime = 0;\n  const frameEndTime   = this.pixelsToTime(this._width);\n\n  if (this._pointsLayer) {\n    this._pointsLayer.updatePoints(frameStartTime, frameEndTime);\n  }\n\n  if (this._segmentsLayer) {\n    this._segmentsLayer.updateSegments(frameStartTime, frameEndTime);\n  }\n};\n\nWaveformOverview.prototype.containerWidthChange = function() {\n  return this._resampleAndSetWaveformData(this._originalWaveformData, this._width);\n};\n\nWaveformOverview.prototype.containerHeightChange = function() {\n  this._highlightLayer.fitToView();\n};\n\nWaveformOverview.prototype.destroy = function() {\n  // Unregister event handlers\n  this._peaks.off('player.playing', this._onPlaying);\n  this._peaks.off('player.pause', this._onPause);\n  this._peaks.off('player.timeupdate', this._onTimeUpdate);\n  this._peaks.off('zoomview.update', this._onZoomviewUpdate);\n\n  this._mouseDragHandler.destroy();\n\n  WaveformView.prototype.destroy.call(this);\n};\n\nexport default WaveformOverview;\n","/**\n * @file\n *\n * Defines the {@link InsertSegmentMouseDragHandler} class.\n *\n * @module insert-segment-mouse-drag-handler\n */\n\nimport MouseDragHandler from './mouse-drag-handler';\n\n/**\n * Creates a handler for mouse events to allow inserting new waveform\n * segments by clicking and dragging the mouse.\n *\n * @class\n * @alias InsertSegmentMouseDragHandler\n *\n * @param {Peaks} peaks\n * @param {WaveformZoomView} view\n */\n\nfunction InsertSegmentMouseDragHandler(peaks, view) {\n  this._peaks = peaks;\n  this._view = view;\n\n  this._onMouseDown = this._onMouseDown.bind(this);\n  this._onMouseMove = this._onMouseMove.bind(this);\n  this._onMouseUp = this._onMouseUp.bind(this);\n\n  this._mouseDragHandler = new MouseDragHandler(view._stage, {\n    onMouseDown: this._onMouseDown,\n    onMouseMove: this._onMouseMove,\n    onMouseUp: this._onMouseUp\n  });\n}\n\nInsertSegmentMouseDragHandler.prototype.isDragging = function() {\n  return this._mouseDragHandler.isDragging();\n};\n\nInsertSegmentMouseDragHandler.prototype._reset = function() {\n  this._insertSegment = null;\n  this._insertSegmentShape = null;\n  this._segmentIsDraggable = false;\n  this._peaks.segments.setInserting(false);\n};\n\nInsertSegmentMouseDragHandler.prototype._onMouseDown = function(mousePosX, segment) {\n  this._reset();\n  this._segment = segment;\n\n  if (this._segment) {\n    if (this._view.getSegmentDragMode() !== 'overlap') {\n      return;\n    }\n    else {\n      // The user has clicked within a segment. We want to prevent\n      // the segment from being dragged while the user inserts a new\n      // segment. So we temporarily make the segment non-draggable,\n      // and restore its draggable state in onMouseUp().\n      this._segmentIsDraggable = this._segment.draggable();\n      this._segment.draggable(false);\n    }\n  }\n\n  const time = this._view.pixelsToTime(mousePosX + this._view.getFrameOffset());\n\n  this._peaks.segments.setInserting(true);\n\n  this._insertSegment = this._peaks.segments.add({\n    startTime: time,\n    endTime: time,\n    editable: true\n  });\n\n  this._insertSegmentShape = this._view._segmentsLayer.getSegmentShape(this._insertSegment);\n\n  if (this._insertSegmentShape) {\n    this._insertSegmentShape.moveMarkersToTop();\n    this._insertSegmentShape.startDrag();\n  }\n};\n\nInsertSegmentMouseDragHandler.prototype._onMouseMove = function() {\n};\n\nInsertSegmentMouseDragHandler.prototype._onMouseUp = function() {\n  if (!this._insertSegment) {\n    return;\n  }\n\n  if (this._insertSegmentShape) {\n    this._insertSegmentShape.stopDrag();\n    this._insertSegmentShape = null;\n  }\n\n  // If the user was dragging within an existing segment,\n  // restore the segment's original draggable state.\n  if (this._segment && this._segmentIsDraggable) {\n    this._segment.draggable(true);\n  }\n\n  this._peaks.emit('segments.insert', {\n    segment: this._insertSegment\n  });\n\n  this._peaks.segments.setInserting(false);\n};\n\nInsertSegmentMouseDragHandler.prototype.destroy = function() {\n  this._mouseDragHandler.destroy();\n};\n\nexport default InsertSegmentMouseDragHandler;\n","/**\n * @file\n *\n * Defines the {@link ScrollMouseDragHandler} class.\n *\n * @module scroll-mouse-drag-handler\n */\n\nimport MouseDragHandler from './mouse-drag-handler';\nimport { clamp } from './utils';\n\n/**\n * Creates a handler for mouse events to allow scrolling the zoomable\n * waveform view by clicking and dragging the mouse.\n *\n * @class\n * @alias ScrollMouseDragHandler\n *\n * @param {Peaks} peaks\n * @param {WaveformZoomView} view\n */\n\nfunction ScrollMouseDragHandler(peaks, view) {\n  this._peaks = peaks;\n  this._view = view;\n  this._seeking = false;\n  this._firstMove = false;\n  this._segment = null;\n  this._segmentIsDraggable = false;\n  this._initialFrameOffset = 0;\n  this._mouseDownX = 0;\n\n  this._onMouseDown = this._onMouseDown.bind(this);\n  this._onMouseMove = this._onMouseMove.bind(this);\n  this._onMouseUp = this._onMouseUp.bind(this);\n\n  this._mouseDragHandler = new MouseDragHandler(view._stage, {\n    onMouseDown: this._onMouseDown,\n    onMouseMove: this._onMouseMove,\n    onMouseUp: this._onMouseUp\n  });\n}\n\nScrollMouseDragHandler.prototype.isDragging = function() {\n  return this._mouseDragHandler.isDragging();\n};\n\nScrollMouseDragHandler.prototype._onMouseDown = function(mousePosX, segment) {\n  this._seeking = false;\n  this._firstMove = true;\n\n  if (segment && !segment.attrs.draggable) {\n    this._segment = null;\n  }\n  else {\n    this._segment = segment;\n  }\n\n  const playheadOffset = this._view.getPlayheadOffset();\n\n  if (this._view.isSeekEnabled() &&\n      Math.abs(mousePosX - playheadOffset) <= this._view.getPlayheadClickTolerance()) {\n    this._seeking = true;\n\n    // The user has clicked near the playhead, and the playhead is within\n    // a segment. In this case we want to allow the playhead to move, but\n    // prevent the segment from being dragged. So we temporarily make the\n    // segment non-draggable, and restore its draggable state in onMouseUp().\n    if (this._segment) {\n      this._segmentIsDraggable = this._segment.draggable();\n      this._segment.draggable(false);\n    }\n  }\n\n  if (this._seeking) {\n    mousePosX = clamp(mousePosX, 0, this._view.getWidth());\n\n    const time = this._view.pixelsToTime(mousePosX + this._view.getFrameOffset());\n\n    this._seek(time);\n  }\n  else {\n    this._initialFrameOffset = this._view.getFrameOffset();\n    this._mouseDownX = mousePosX;\n  }\n};\n\nScrollMouseDragHandler.prototype._onMouseMove = function(mousePosX) {\n  // Prevent scrolling the waveform if the user is dragging a segment.\n  if (this._segment && !this._seeking) {\n    return;\n  }\n\n  if (this._seeking) {\n    if (this._firstMove) {\n      this._view.dragSeek(true);\n      this._firstMove = false;\n    }\n\n    mousePosX = clamp(mousePosX, 0, this._view.getWidth());\n\n    const time = this._view.pixelsToTime(mousePosX + this._view.getFrameOffset());\n\n    this._seek(time);\n  }\n  else {\n    // TODO: Prevent scrolling when zoomed to fit the waveform to the\n    // view width. Sometimes the waveform is a few pixels longer.\n    if (!this._view.isAutoZoom()) {\n      // Moving the mouse to the left increases the time position of the\n      // left-hand edge of the visible waveform.\n      const diff = this._mouseDownX - mousePosX;\n      const newFrameOffset = this._initialFrameOffset + diff;\n\n      if (newFrameOffset !== this._initialFrameOffset) {\n        this._view.updateWaveform(newFrameOffset);\n      }\n    }\n  }\n};\n\nScrollMouseDragHandler.prototype._onMouseUp = function() {\n  if (this._seeking) {\n    this._view.dragSeek(false);\n  }\n  else {\n    // Set playhead position only on click release, when not dragging.\n    if (this._view._enableSeek && !this._mouseDragHandler.isDragging()) {\n      const time = this._view.pixelOffsetToTime(this._mouseDownX);\n\n      this._seek(time);\n    }\n  }\n\n  // If the user was dragging within an existing segment,\n  // restore the segment's original draggable state.\n  if (this._segment && this._seeking) {\n    if (this._segmentIsDraggable) {\n      this._segment.draggable(true);\n    }\n  }\n};\n\nScrollMouseDragHandler.prototype._seek = function(time) {\n  const duration = this._peaks.player.getDuration();\n\n  // Prevent the playhead position from jumping by limiting click\n  // handling to the waveform duration.\n  if (time > duration) {\n    time = duration;\n  }\n\n  // Update the playhead position. This gives a smoother visual update\n  // than if we only use the player.timeupdate event.\n  this._view.updatePlayheadTime(time);\n\n  this._peaks.player.seek(time);\n};\n\nScrollMouseDragHandler.prototype.destroy = function() {\n  this._mouseDragHandler.destroy();\n};\n\nexport default ScrollMouseDragHandler;\n","/**\n * @file\n *\n * Defines the {@link WaveformZoomView} class.\n *\n * @module waveform-zoomview\n */\n\nimport WaveformView from './waveform-view';\nimport InsertSegmentMouseDragHandler from './insert-segment-mouse-drag-handler';\nimport ScrollMouseDragHandler from './scroll-mouse-drag-handler';\nimport { clamp, isValidTime, objectHasProperty } from './utils';\n\n/**\n * Creates a zoomable waveform view.\n *\n * @class\n * @alias WaveformZoomView\n *\n * @param {WaveformData} waveformData\n * @param {HTMLElement} container\n * @param {Peaks} peaks\n */\n\nfunction WaveformZoomView(waveformData, container, peaks) {\n  const self = this;\n\n  WaveformView.call(self, waveformData, container, peaks, peaks.options.zoomview);\n\n  // Bind event handlers\n  self._onTimeUpdate = self._onTimeUpdate.bind(self);\n  self._onPlaying = self._onPlaying.bind(self);\n  self._onPause = self._onPause.bind(self);\n  self._onKeyboardLeft = self._onKeyboardLeft.bind(self);\n  self._onKeyboardRight = self._onKeyboardRight.bind(self);\n  self._onKeyboardShiftLeft  = self._onKeyboardShiftLeft.bind(self);\n  self._onKeyboardShiftRight = self._onKeyboardShiftRight.bind(self);\n\n  // Register event handlers\n  self._peaks.on('player.timeupdate', self._onTimeUpdate);\n  self._peaks.on('player.playing', self._onPlaying);\n  self._peaks.on('player.pause', self._onPause);\n  self._peaks.on('keyboard.left', self._onKeyboardLeft);\n  self._peaks.on('keyboard.right', self._onKeyboardRight);\n  self._peaks.on('keyboard.shift_left', self._onKeyboardShiftLeft);\n  self._peaks.on('keyboard.shift_right', self._onKeyboardShiftRight);\n\n  self._autoScroll = self._viewOptions.autoScroll;\n  self._autoScrollOffset = self._viewOptions.autoScrollOffset;\n\n  self._enableSegmentDragging = false;\n  self._segmentDragMode = 'overlap';\n  self._minSegmentDragWidth = 0;\n  self._insertSegmentShape = null;\n\n  self._playheadClickTolerance = self._viewOptions.playheadClickTolerance;\n\n  self._zoomLevelAuto = false;\n  self._zoomLevelSeconds = null;\n\n  const time = self._peaks.player.getCurrentTime();\n\n  self._syncPlayhead(time);\n\n  self._mouseDragHandler = new ScrollMouseDragHandler(peaks, self);\n\n  self._onWheel = self._onWheel.bind(self);\n  self._onWheelCaptureVerticalScroll = self._onWheelCaptureVerticalScroll.bind(self);\n  self.setWheelMode(self._viewOptions.wheelMode);\n\n  self._peaks.emit('zoomview.update', {\n    startTime: 0,\n    endTime: self.getEndTime()\n  });\n}\n\nWaveformZoomView.prototype = Object.create(WaveformView.prototype);\n\nWaveformZoomView.prototype.initWaveformData = function() {\n  this._enableWaveformCache = this._options.waveformCache;\n\n  this._initWaveformCache();\n\n  const initialZoomLevel = this._peaks.zoom.getZoomLevel();\n\n  this._resampleData({ scale: initialZoomLevel });\n};\n\nWaveformZoomView.prototype._initWaveformCache = function() {\n  if (this._enableWaveformCache) {\n    this._waveformData = new Map();\n    this._waveformData.set(this._originalWaveformData.scale, this._originalWaveformData);\n    this._waveformScales = [this._originalWaveformData.scale];\n  }\n};\n\nWaveformZoomView.prototype.initHighlightLayer = function() {\n};\n\nWaveformZoomView.prototype.setWheelMode = function(mode, options) {\n  if (!options) {\n    options = {};\n  }\n\n  if (mode !== this._wheelMode ||\n      options.captureVerticalScroll !== this._captureVerticalScroll) {\n    this._stage.off('wheel');\n\n    this._wheelMode = mode;\n    this._captureVerticalScroll = options.captureVerticalScroll;\n\n    switch (mode) {\n      case 'scroll':\n        if (options.captureVerticalScroll) {\n          this._stage.on('wheel', this._onWheelCaptureVerticalScroll);\n        }\n        else {\n          this._stage.on('wheel', this._onWheel);\n        }\n        break;\n    }\n  }\n};\n\nWaveformZoomView.prototype._onWheel = function(event) {\n  const wheelEvent = event.evt;\n  let delta;\n\n  if (wheelEvent.shiftKey) {\n    if (wheelEvent.deltaY !== 0) {\n      delta = wheelEvent.deltaY;\n    }\n    else if (wheelEvent.deltaX !== 0) {\n      delta = wheelEvent.deltaX;\n    }\n    else {\n      return;\n    }\n  }\n  else {\n    // Ignore the event if it looks like the user is scrolling vertically\n    // down the page\n    if (Math.abs(wheelEvent.deltaX) < Math.abs(wheelEvent.deltaY)) {\n      return;\n    }\n\n    delta = wheelEvent.deltaX;\n  }\n\n  if (wheelEvent.deltaMode === WheelEvent.DOM_DELTA_PAGE) {\n    delta *= this._width;\n  }\n\n  wheelEvent.preventDefault();\n\n  const frameOffset = clamp(\n    this._frameOffset + Math.floor(delta), 0, this._pixelLength - this._width\n  );\n\n  this.updateWaveform(frameOffset, false);\n};\n\nWaveformZoomView.prototype._onWheelCaptureVerticalScroll = function(event) {\n  const wheelEvent = event.evt;\n\n  const delta = Math.abs(wheelEvent.deltaX) < Math.abs(wheelEvent.deltaY) ?\n    wheelEvent.deltaY : wheelEvent.deltaX;\n\n  wheelEvent.preventDefault();\n\n  const frameOffset = clamp(\n    this._frameOffset + Math.floor(delta), 0, this._pixelLength - this._width\n  );\n\n  this.updateWaveform(frameOffset, false);\n};\n\nWaveformZoomView.prototype.setWaveformDragMode = function(mode) {\n  if (this._segmentsLayer) {\n    this._mouseDragHandler.destroy();\n    this.dragSeek(false);\n\n    if (mode === 'insert-segment') {\n      this._mouseDragHandler = new InsertSegmentMouseDragHandler(this._peaks, this);\n    }\n    else {\n      this._mouseDragHandler = new ScrollMouseDragHandler(this._peaks, this);\n    }\n  }\n};\n\nWaveformZoomView.prototype.enableSegmentDragging = function(enable) {\n  this._enableSegmentDragging = enable;\n\n  // Update all existing segments\n  if (this._segmentsLayer) {\n    this._segmentsLayer.enableSegmentDragging(enable);\n  }\n};\n\nWaveformZoomView.prototype.isSegmentDraggingEnabled = function() {\n  return this._enableSegmentDragging;\n};\n\nWaveformZoomView.prototype.setSegmentDragMode = function(mode) {\n  this._segmentDragMode = mode;\n};\n\nWaveformZoomView.prototype.getSegmentDragMode = function() {\n  return this._segmentDragMode;\n};\n\nWaveformZoomView.prototype.getName = function() {\n  return 'zoomview';\n};\n\nWaveformZoomView.prototype._onTimeUpdate = function(time) {\n  if (this._mouseDragHandler.isDragging()) {\n    return;\n  }\n\n  this._syncPlayhead(time);\n};\n\nWaveformZoomView.prototype._onPlaying = function(time) {\n  this._playheadLayer.updatePlayheadTime(time);\n};\n\nWaveformZoomView.prototype._onPause = function(time) {\n  this._playheadLayer.stop(time);\n};\n\nWaveformZoomView.prototype._onKeyboardLeft = function() {\n  this._keyboardScroll(-1, false);\n};\n\nWaveformZoomView.prototype._onKeyboardRight = function() {\n  this._keyboardScroll(1, false);\n};\n\nWaveformZoomView.prototype._onKeyboardShiftLeft = function() {\n  this._keyboardScroll(-1, true);\n};\n\nWaveformZoomView.prototype._onKeyboardShiftRight = function() {\n  this._keyboardScroll(1, true);\n};\n\nWaveformZoomView.prototype._keyboardScroll = function(direction, large) {\n  let increment;\n\n  if (large) {\n    increment = direction * this._width;\n  }\n  else {\n    increment = direction * this.timeToPixels(this._options.nudgeIncrement);\n  }\n\n  this.scrollWaveform({ pixels: increment });\n};\n\nWaveformZoomView.prototype.setWaveformData = function(waveformData) {\n  this._originalWaveformData = waveformData;\n  // Clear cached waveforms\n  this._initWaveformCache();\n\n  // Don't update the UI here, call setZoom().\n};\n\n/**\n * Returns the position of the playhead marker, in pixels relative to the\n * left hand side of the waveform view.\n *\n * @return {Number}\n */\n\nWaveformZoomView.prototype.getPlayheadOffset = function() {\n  return this._playheadLayer.getPlayheadPixel() - this._frameOffset;\n};\n\nWaveformZoomView.prototype.getPlayheadClickTolerance = function() {\n  return this._playheadClickTolerance;\n};\n\nWaveformZoomView.prototype._syncPlayhead = function(time) {\n  this._playheadLayer.updatePlayheadTime(time);\n\n  if (this._autoScroll && !this._zoomLevelAuto) {\n    // Check for the playhead reaching the right-hand side of the window.\n\n    const pixelIndex = this.timeToPixels(time);\n\n    // TODO: move this code to animation function?\n    // TODO: don't scroll if user has positioned view manually (e.g., using\n    // the keyboard)\n    const endThreshold = this._frameOffset + this._width - this._autoScrollOffset;\n\n    let frameOffset = this._frameOffset;\n\n    if (pixelIndex >= endThreshold || pixelIndex < frameOffset) {\n      // Put the playhead at 100 pixels from the left edge\n      frameOffset = pixelIndex - this._autoScrollOffset;\n\n      if (frameOffset < 0) {\n        frameOffset = 0;\n      }\n\n      this.updateWaveform(frameOffset, false);\n    }\n  }\n};\n\nWaveformZoomView.prototype._getScale = function(duration) {\n  return Math.floor(duration * this._data.sample_rate / this._width);\n};\n\nfunction isAutoScale(options) {\n  return ((objectHasProperty(options, 'scale') && options.scale === 'auto') ||\n          (objectHasProperty(options, 'seconds') && options.seconds === 'auto'));\n}\n\n/**\n * Options for [WaveformZoomView.setZoom]{@link WaveformZoomView#setZoom}.\n *\n * @typedef {Object} SetZoomOptions\n * @global\n * @property {Number|String} scale Zoom level, in samples per pixel, or 'auto'\n *   to fit the entire waveform to the view width\n * @property {Number|String} seconds Number of seconds to fit to the view width,\n *   or 'auto' to fit the entire waveform to the view width\n */\n\n/**\n * Changes the zoom level.\n *\n * @param {SetZoomOptions} options\n * @returns {Boolean}\n */\n\nWaveformZoomView.prototype.setZoom = function(options) {\n  let scale;\n\n  if (isAutoScale(options)) {\n    // Use waveform duration, to match WaveformOverview\n    const seconds = this._originalWaveformData.duration;\n\n    this._zoomLevelAuto = true;\n    this._zoomLevelSeconds = null;\n    scale = this._getScale(seconds);\n  }\n  else {\n    if (objectHasProperty(options, 'scale')) {\n      this._zoomLevelSeconds = null;\n      scale = Math.floor(options.scale);\n    }\n    else if (objectHasProperty(options, 'seconds')) {\n      if (!isValidTime(options.seconds)) {\n        return false;\n      }\n\n      this._zoomLevelSeconds = options.seconds;\n      scale = this._getScale(options.seconds);\n    }\n\n    this._zoomLevelAuto = false;\n  }\n\n  if (scale < this._originalWaveformData.scale) {\n    // eslint-disable-next-line @stylistic/js/max-len\n    this._peaks._logger('peaks.zoomview.setZoom(): zoom level must be at least ' + this._originalWaveformData.scale);\n    scale = this._originalWaveformData.scale;\n  }\n\n  const currentTime = this._peaks.player.getCurrentTime();\n  let apexTime;\n  let playheadOffsetPixels = this.getPlayheadOffset();\n\n  if (playheadOffsetPixels >= 0 && playheadOffsetPixels < this._width) {\n    // Playhead is visible. Change the zoom level while keeping the\n    // playhead at the same position in the window.\n    apexTime = currentTime;\n  }\n  else {\n    // Playhead is not visible. Change the zoom level while keeping the\n    // centre of the window at the same position in the waveform.\n    playheadOffsetPixels = Math.floor(this._width / 2);\n    apexTime = this.pixelOffsetToTime(playheadOffsetPixels);\n  }\n\n  const prevScale = this._scale;\n\n  this._resampleData({ scale: scale });\n\n  const apexPixel = this.timeToPixels(apexTime);\n\n  const frameOffset = apexPixel - playheadOffsetPixels;\n\n  this.updateWaveform(frameOffset, true);\n\n  this._playheadLayer.zoomLevelChanged();\n\n  // Update the playhead position after zooming.\n  this._playheadLayer.updatePlayheadTime(currentTime);\n\n  this._peaks.emit('zoom.update', {\n    currentZoom: scale,\n    previousZoom: prevScale\n  });\n\n  return true;\n};\n\nWaveformZoomView.prototype._resampleData = function(options) {\n  const scale = options.scale;\n\n  if (this._enableWaveformCache) {\n    if (!this._waveformData.has(scale)) {\n      let sourceWaveform = this._originalWaveformData;\n\n      // Resample from the next lowest available zoom level\n\n      for (let i = 0; i < this._waveformScales.length; i++) {\n        if (this._waveformScales[i] < scale) {\n          sourceWaveform = this._waveformData.get(this._waveformScales[i]);\n        }\n        else {\n          break;\n        }\n      }\n\n      this._waveformData.set(scale, sourceWaveform.resample(options));\n\n      this._waveformScales.push(scale);\n      this._waveformScales.sort(function(a, b) {\n        return a - b; // Ascending order\n      });\n    }\n\n    this._data = this._waveformData.get(scale);\n  }\n  else {\n    this._data = this._originalWaveformData.resample(options);\n  }\n\n  this._scale = this._data.scale;\n  this._pixelLength = this._data.length;\n};\n\nWaveformZoomView.prototype.isAutoZoom = function() {\n  return this._zoomLevelAuto;\n};\n\nWaveformZoomView.prototype.setStartTime = function(time) {\n  if (time < 0) {\n    time = 0;\n  }\n\n  if (this._zoomLevelAuto) {\n    time = 0;\n  }\n\n  this.updateWaveform(this.timeToPixels(time), false);\n};\n\n/**\n * @returns {Number} The length of the waveform, in pixels.\n */\n\nWaveformZoomView.prototype.getPixelLength = function() {\n  return this._pixelLength;\n};\n\n/**\n * Scrolls the region of waveform shown in the view.\n *\n * @param {Number} scrollAmount How far to scroll, in pixels\n */\n\nWaveformZoomView.prototype.scrollWaveform = function(options) {\n  let scrollAmount;\n\n  if (objectHasProperty(options, 'pixels')) {\n    scrollAmount = Math.floor(options.pixels);\n  }\n  else if (objectHasProperty(options, 'seconds')) {\n    scrollAmount = this.timeToPixels(options.seconds);\n  }\n  else {\n    throw new TypeError('view.scrollWaveform(): Missing umber of pixels or seconds');\n  }\n\n  this.updateWaveform(this._frameOffset + scrollAmount, false);\n};\n\n/**\n * Updates the region of waveform shown in the view.\n *\n * @param {Number} frameOffset The new frame offset, in pixels.\n * @param {Boolean} forceUpdate Forces the waveform view to be redrawn, if the\n *   frameOffset is unchanged.\n */\n\nWaveformZoomView.prototype.updateWaveform = function(frameOffset, forceUpdate) {\n  let upperLimit;\n\n  if (this._pixelLength < this._width) {\n    // Total waveform is shorter than viewport, so reset the offset to 0.\n    frameOffset = 0;\n    upperLimit = this._width;\n  }\n  else {\n    // Calculate the very last possible position.\n    upperLimit = this._pixelLength - this._width;\n  }\n\n  frameOffset = clamp(frameOffset, 0, upperLimit);\n\n  if (!forceUpdate && frameOffset === this._frameOffset) {\n    return;\n  }\n\n  this._frameOffset = frameOffset;\n\n  // Display playhead if it is within the zoom frame width.\n  const playheadPixel = this._playheadLayer.getPlayheadPixel();\n\n  this._playheadLayer.updatePlayheadTime(this.pixelsToTime(playheadPixel));\n\n  this.drawWaveformLayer();\n  this._axisLayer.draw();\n\n  const frameStartTime = this.getStartTime();\n  const frameEndTime   = this.getEndTime();\n\n  if (this._pointsLayer) {\n    this._pointsLayer.updatePoints(frameStartTime, frameEndTime);\n  }\n\n  if (this._segmentsLayer) {\n    this._segmentsLayer.updateSegments(frameStartTime, frameEndTime);\n  }\n\n  this._peaks.emit('zoomview.update', {\n    startTime: frameStartTime,\n    endTime: frameEndTime\n  });\n};\n\nWaveformZoomView.prototype.enableAutoScroll = function(enable, options) {\n  if (!options) {\n    options = {};\n  }\n\n  this._autoScroll = enable;\n\n  if (objectHasProperty(options, 'offset')) {\n    this._autoScrollOffset = options.offset;\n  }\n};\n\nWaveformZoomView.prototype.getMinSegmentDragWidth = function() {\n  return this._insertSegmentShape ? 0 : this._minSegmentDragWidth;\n};\n\nWaveformZoomView.prototype.setMinSegmentDragWidth = function(width) {\n  this._minSegmentDragWidth = width;\n};\n\nWaveformZoomView.prototype.containerWidthChange = function() {\n  let resample = false;\n  let resampleOptions;\n\n  if (this._zoomLevelAuto) {\n    resample = true;\n    resampleOptions = { width: this._width };\n  }\n  else if (this._zoomLevelSeconds !== null) {\n    resample = true;\n    resampleOptions = { scale: this._getScale(this._zoomLevelSeconds) };\n  }\n\n  if (resample) {\n    try {\n      this._resampleData(resampleOptions);\n    }\n    catch (error) { // eslint-disable-line no-unused-vars\n      // Ignore, and leave this._data as it was\n    }\n  }\n\n  return true;\n};\n\nWaveformZoomView.prototype.containerHeightChange = function() {\n  // Nothing\n};\n\nWaveformZoomView.prototype.getStage = function() {\n  return this._stage;\n};\n\nWaveformZoomView.prototype.getSegmentsLayer = function() {\n  return this._segmentsLayer;\n};\n\nWaveformZoomView.prototype.destroy = function() {\n  // Unregister event handlers\n  this._peaks.off('player.playing', this._onPlaying);\n  this._peaks.off('player.pause', this._onPause);\n  this._peaks.off('player.timeupdate', this._onTimeUpdate);\n  this._peaks.off('keyboard.left', this._onKeyboardLeft);\n  this._peaks.off('keyboard.right', this._onKeyboardRight);\n  this._peaks.off('keyboard.shift_left', this._onKeyboardShiftLeft);\n  this._peaks.off('keyboard.shift_right', this._onKeyboardShiftRight);\n\n  if (this._enableWaveformCache) {\n    this._waveformData.clear();\n    delete this._waveformData;\n    delete this._waveformScales;\n  }\n  else {\n    delete this._data;\n  }\n\n  this._mouseDragHandler.destroy();\n\n  WaveformView.prototype.destroy.call(this);\n};\n\nexport default WaveformZoomView;\n","/**\n * @file\n *\n * Defines the {@link Scrollbar} class.\n *\n * @module scrollbar\n */\n\nimport { clamp } from './utils';\n\nimport Konva from 'konva/lib/Core';\nimport { Rect } from 'konva/lib/shapes/Rect';\n\n/**\n * Creates a scrollbar.\n *\n * @class\n * @alias Scrollbar\n *\n * @param {HTMLElement} container\n * @param {Peaks} peaks\n */\n\nfunction Scrollbar(container, peaks) {\n  this._container = container;\n  this._peaks = peaks;\n  this._options = peaks.options.scrollbar;\n  this._zoomview = peaks.views.getView('zoomview');\n\n  this._dragBoundFunc = this._dragBoundFunc.bind(this);\n  this._onScrollboxDragStart = this._onScrollboxDragStart.bind(this);\n  this._onScrollboxDragMove = this._onScrollboxDragMove.bind(this);\n  this._onScrollboxDragEnd = this._onScrollboxDragEnd.bind(this);\n  this._onZoomviewUpdate = this._onZoomviewUpdate.bind(this);\n  this._onScrollbarClick = this._onScrollbarClick.bind(this);\n\n  this._peaks.on('zoomview.update', this._onZoomviewUpdate);\n\n  this._width = container.clientWidth;\n  this._height = container.clientHeight;\n\n  this._stage = new Konva.Stage({\n    container: container,\n    width: this._width,\n    height: this._height\n  });\n\n  this._layer = new Konva.Layer();\n  this._stage.on('click', this._onScrollbarClick);\n\n  this._stage.add(this._layer);\n\n  this._color = this._options.color;\n  this._scrollboxX = 0;\n  this._minScrollboxWidth = this._options.minWidth;\n\n  this._offsetY = 0;\n\n  this._scrollbox = new Konva.Group({\n    draggable:     true,\n    dragBoundFunc: this._dragBoundFunc\n  });\n\n  this._scrollboxRect = new Rect({\n    x:      this._scrollboxX,\n    y:      this._offsetY,\n    width:  0,\n    height: this._height,\n    fill:   this._color\n  });\n\n  this._scrollbox.add(this._scrollboxRect);\n  this._setScrollboxWidth();\n\n  this._scrollbox.on('dragstart', this._onScrollboxDragStart);\n  this._scrollbox.on('dragmove', this._onScrollboxDragMove);\n  this._scrollbox.on('dragend', this._onScrollboxDragEnd);\n\n  this._layer.add(this._scrollbox);\n\n  this._updateScrollbarWidthAndPosition();\n}\n\nScrollbar.prototype.setZoomview = function(zoomview) {\n  this._zoomview = zoomview;\n\n  this._updateScrollbarWidthAndPosition();\n};\n\n/**\n * Sets the width of the scrollbox, based on the visible waveform region\n * in the zoomview and minimum scrollbox width option.\n */\n\nScrollbar.prototype._setScrollboxWidth = function() {\n  if (this._zoomview) {\n    this._scrollboxWidth = Math.floor(\n      this._width * this._zoomview.pixelsToTime(this._zoomview.getWidth()) /\n        this._peaks.player.getDuration()\n    );\n\n    if (this._scrollboxWidth < this._minScrollboxWidth) {\n      this._scrollboxWidth = this._minScrollboxWidth;\n    }\n  }\n  else {\n    this._scrollboxWidth = this._width;\n  }\n\n  this._scrollboxRect.width(this._scrollboxWidth);\n};\n\n/**\n * @returns {Number} The maximum scrollbox position, in pixels.\n */\n\nScrollbar.prototype._getScrollbarRange = function() {\n  return this._width - this._scrollboxWidth;\n};\n\nScrollbar.prototype._dragBoundFunc = function(pos) {\n  // Allow the scrollbar to be moved horizontally but not vertically.\n  return {\n    x: pos.x,\n    y: 0\n  };\n};\n\nScrollbar.prototype._onScrollboxDragStart = function() {\n  this._dragging = true;\n};\n\nScrollbar.prototype._onScrollboxDragEnd = function() {\n  this._dragging = false;\n};\n\nScrollbar.prototype._onScrollboxDragMove = function() {\n  const range = this._getScrollbarRange();\n  const x = clamp(this._scrollbox.x(), 0, range);\n\n  this._scrollbox.x(x);\n\n  if (x !== this._scrollboxX) {\n    this._scrollboxX = x;\n\n    if (this._zoomview) {\n      this._updateWaveform(x);\n    }\n  }\n};\n\nScrollbar.prototype._onZoomviewUpdate = function(/* event */) {\n  if (!this._dragging) {\n    this._updateScrollbarWidthAndPosition();\n  }\n};\n\nScrollbar.prototype._updateScrollbarWidthAndPosition = function() {\n  this._setScrollboxWidth();\n\n  if (this._zoomview) {\n    const startTime = this._zoomview.getStartTime();\n\n    const zoomviewRange = this._zoomview.getPixelLength() - this._zoomview.getWidth();\n\n    const scrollBoxPos = Math.floor(\n      this._zoomview.timeToPixels(startTime) * this._getScrollbarRange() / zoomviewRange\n    );\n\n    this._scrollbox.x(scrollBoxPos);\n    this._layer.draw();\n  }\n};\n\nScrollbar.prototype._onScrollbarClick = function(event) {\n  // Handle clicks on the scrollbar outside the scrollbox.\n  if (event.target === this._stage) {\n    if (this._zoomview) {\n      // Centre the scrollbox where the user clicked.\n      let x = Math.floor(event.evt.offsetX - this._scrollboxWidth / 2);\n\n      if (x < 0) {\n        x = 0;\n      }\n\n      this._updateWaveform(x);\n    }\n  }\n};\n\n/**\n * Sets the zoomview waveform position based on scrollbar position.\n */\n\nScrollbar.prototype._updateWaveform = function(x) {\n  const offset = Math.floor(\n    (this._zoomview.getPixelLength() - this._zoomview.getWidth()) * x / this._getScrollbarRange()\n  );\n\n  this._zoomview.updateWaveform(offset);\n};\n\nScrollbar.prototype.fitToContainer = function() {\n  if (this._container.clientWidth === 0 && this._container.clientHeight === 0) {\n    return;\n  }\n\n  if (this._container.clientWidth !== this._width) {\n    this._width = this._container.clientWidth;\n    this._stage.width(this._width);\n\n    this._updateScrollbarWidthAndPosition();\n  }\n\n  this._height = this._container.clientHeight;\n  this._stage.height(this._height);\n};\n\nScrollbar.prototype.destroy = function() {\n  this._peaks.off('zoomview.update', this._onZoomviewUpdate);\n\n  this._layer.destroy();\n\n  this._stage.destroy();\n  this._stage = null;\n};\n\nexport default Scrollbar;\n","/**\n * @file\n *\n * Defines the {@link ViewController} class.\n *\n * @module view-controller\n */\n\nimport WaveformOverview from './waveform-overview';\nimport WaveformZoomView from './waveform-zoomview';\nimport Scrollbar from './scrollbar';\nimport { isNullOrUndefined } from './utils';\n\n/**\n * Creates an object that allows users to create and manage waveform views.\n *\n * @class\n * @alias ViewController\n *\n * @param {Peaks} peaks\n */\n\nfunction ViewController(peaks) {\n  this._peaks = peaks;\n  this._overview = null;\n  this._zoomview = null;\n  this._scrollbar = null;\n}\n\nViewController.prototype.createOverview = function(container) {\n  if (this._overview) {\n    return this._overview;\n  }\n\n  const waveformData = this._peaks.getWaveformData();\n\n  this._overview = new WaveformOverview(\n    waveformData,\n    container,\n    this._peaks\n  );\n\n  if (this._zoomview) {\n    this._overview.showHighlight(\n      this._zoomview.getStartTime(),\n      this._zoomview.getEndTime()\n    );\n  }\n\n  return this._overview;\n};\n\nViewController.prototype.createZoomview = function(container) {\n  if (this._zoomview) {\n    return this._zoomview;\n  }\n\n  const waveformData = this._peaks.getWaveformData();\n\n  this._zoomview = new WaveformZoomView(\n    waveformData,\n    container,\n    this._peaks\n  );\n\n  if (this._scrollbar) {\n    this._scrollbar.setZoomview(this._zoomview);\n  }\n\n  return this._zoomview;\n};\n\nViewController.prototype.createScrollbar = function(container) {\n  this._scrollbar = new Scrollbar(\n    container,\n    this._peaks\n  );\n\n  return this._scrollbar;\n};\n\nViewController.prototype.destroyOverview = function() {\n  if (!this._overview) {\n    return;\n  }\n\n  if (!this._zoomview) {\n    return;\n  }\n\n  this._overview.destroy();\n  this._overview = null;\n};\n\nViewController.prototype.destroyZoomview = function() {\n  if (!this._zoomview) {\n    return;\n  }\n\n  if (!this._overview) {\n    return;\n  }\n\n  this._zoomview.destroy();\n  this._zoomview = null;\n\n  this._overview.removeHighlightRect();\n};\n\nViewController.prototype.destroy = function() {\n  if (this._overview) {\n    this._overview.destroy();\n    this._overview = null;\n  }\n\n  if (this._zoomview) {\n    this._zoomview.destroy();\n    this._zoomview = null;\n  }\n\n  if (this._scrollbar) {\n    this._scrollbar.destroy();\n    this._scrollbar = null;\n  }\n};\n\nViewController.prototype.getView = function(name) {\n  if (isNullOrUndefined(name)) {\n    if (this._overview && this._zoomview) {\n      return null;\n    }\n    else if (this._overview) {\n      return this._overview;\n    }\n    else if (this._zoomview) {\n      return this._zoomview;\n    }\n    else {\n      return null;\n    }\n  }\n  else {\n    switch (name) {\n      case 'overview':\n        return this._overview;\n\n      case 'zoomview':\n        return this._zoomview;\n\n      default:\n        return null;\n    }\n  }\n};\n\nViewController.prototype.getScrollbar = function() {\n  return this._scrollbar;\n};\n\nexport default ViewController;\n","/**\n * @file\n *\n * Defines the {@link ZoomController} class.\n *\n * @module zoom-controller\n */\n\n/**\n * Creates an object to control zoom levels in a {@link WaveformZoomView}.\n *\n * @class\n * @alias ZoomController\n *\n * @param {Peaks} peaks\n * @param {Array<Integer>} zoomLevels\n */\n\nfunction ZoomController(peaks, zoomLevels) {\n  this._peaks = peaks;\n  this._zoomLevels = zoomLevels;\n  this._zoomLevelIndex = 0;\n}\n\nZoomController.prototype.setZoomLevels = function(zoomLevels) {\n  this._zoomLevels = zoomLevels;\n  this.setZoom(0, true);\n};\n\n/**\n * Zoom in one level.\n */\n\nZoomController.prototype.zoomIn = function() {\n  this.setZoom(this._zoomLevelIndex - 1, false);\n};\n\n/**\n * Zoom out one level.\n */\n\nZoomController.prototype.zoomOut = function() {\n  this.setZoom(this._zoomLevelIndex + 1, false);\n};\n\n/**\n * Given a particular zoom level, triggers a resampling of the data in the\n * zoomed view.\n *\n * @param {number} zoomLevelIndex An index into the options.zoomLevels array.\n */\n\nZoomController.prototype.setZoom = function(zoomLevelIndex, forceUpdate) {\n  if (zoomLevelIndex >= this._zoomLevels.length) {\n    zoomLevelIndex = this._zoomLevels.length - 1;\n  }\n\n  if (zoomLevelIndex < 0) {\n    zoomLevelIndex = 0;\n  }\n\n  if (!forceUpdate && (zoomLevelIndex === this._zoomLevelIndex)) {\n    // Nothing to do.\n    return;\n  }\n\n  this._zoomLevelIndex = zoomLevelIndex;\n\n  const zoomview = this._peaks.views.getView('zoomview');\n\n  if (!zoomview) {\n    return;\n  }\n\n  zoomview.setZoom({ scale: this._zoomLevels[zoomLevelIndex] });\n};\n\n/**\n * Returns the current zoom level index.\n *\n * @returns {Number}\n */\n\nZoomController.prototype.getZoom = function() {\n  return this._zoomLevelIndex;\n};\n\n/**\n * Returns the current zoom level, in samples per pixel.\n *\n * @returns {Number}\n */\n\nZoomController.prototype.getZoomLevel = function() {\n  return this._zoomLevels[this._zoomLevelIndex];\n};\n\nexport default ZoomController;\n","/**\n * Provides access to the waveform data for a single audio channel.\n */\n\nfunction WaveformDataChannel(waveformData, channelIndex) {\n  this._waveformData = waveformData;\n  this._channelIndex = channelIndex;\n}\n\n/**\n * Returns the waveform minimum at the given index position.\n */\n\nWaveformDataChannel.prototype.min_sample = function (index) {\n  var offset = (index * this._waveformData.channels + this._channelIndex) * 2;\n  return this._waveformData._at(offset);\n};\n\n/**\n * Returns the waveform maximum at the given index position.\n */\n\nWaveformDataChannel.prototype.max_sample = function (index) {\n  var offset = (index * this._waveformData.channels + this._channelIndex) * 2 + 1;\n  return this._waveformData._at(offset);\n};\n\n/**\n * Sets the waveform minimum at the given index position.\n */\n\nWaveformDataChannel.prototype.set_min_sample = function (index, sample) {\n  var offset = (index * this._waveformData.channels + this._channelIndex) * 2;\n  return this._waveformData._set_at(offset, sample);\n};\n\n/**\n * Sets the waveform maximum at the given index position.\n */\n\nWaveformDataChannel.prototype.set_max_sample = function (index, sample) {\n  var offset = (index * this._waveformData.channels + this._channelIndex) * 2 + 1;\n  return this._waveformData._set_at(offset, sample);\n};\n\n/**\n * Returns all the waveform minimum values as an array.\n */\n\nWaveformDataChannel.prototype.min_array = function () {\n  var length = this._waveformData.length;\n  var values = [];\n  for (var i = 0; i < length; i++) {\n    values.push(this.min_sample(i));\n  }\n  return values;\n};\n\n/**\n * Returns all the waveform maximum values as an array.\n */\n\nWaveformDataChannel.prototype.max_array = function () {\n  var length = this._waveformData.length;\n  var values = [];\n  for (var i = 0; i < length; i++) {\n    values.push(this.max_sample(i));\n  }\n  return values;\n};\n\n/**\n * AudioBuffer-based WaveformData generator\n *\n * Adapted from BlockFile::CalcSummary in Audacity, with permission.\n * See https://github.com/audacity/audacity/blob/\n *   1108c1376c09166162335fab4743008cba57c4ee/src/BlockFile.cpp#L198\n */\n\nvar INT8_MAX = 127;\nvar INT8_MIN = -128;\nvar INT16_MAX = 32767;\nvar INT16_MIN = -32768;\nfunction calculateWaveformDataLength(audio_sample_count, scale) {\n  var data_length = Math.floor(audio_sample_count / scale);\n  var samples_remaining = audio_sample_count - data_length * scale;\n  if (samples_remaining > 0) {\n    data_length++;\n  }\n  return data_length;\n}\nfunction generateWaveformData(options) {\n  var scale = options.scale;\n  var amplitude_scale = options.amplitude_scale;\n  var split_channels = options.split_channels;\n  var length = options.length;\n  var sample_rate = options.sample_rate;\n  var channels = options.channels.map(function (channel) {\n    return new Float32Array(channel);\n  });\n  var output_channels = split_channels ? channels.length : 1;\n  var header_size = 24;\n  var data_length = calculateWaveformDataLength(length, scale);\n  var bytes_per_sample = options.bits === 8 ? 1 : 2;\n  var total_size = header_size + data_length * 2 * bytes_per_sample * output_channels;\n  var buffer = new ArrayBuffer(total_size);\n  var data_view = new DataView(buffer);\n  var scale_counter = 0;\n  var offset = header_size;\n  var min_value = new Array(output_channels);\n  var max_value = new Array(output_channels);\n  for (var channel = 0; channel < output_channels; channel++) {\n    min_value[channel] = Infinity;\n    max_value[channel] = -Infinity;\n  }\n  var range_min = options.bits === 8 ? INT8_MIN : INT16_MIN;\n  var range_max = options.bits === 8 ? INT8_MAX : INT16_MAX;\n  data_view.setInt32(0, 2, true); // Version\n  data_view.setUint32(4, options.bits === 8, true); // Is 8 bit?\n  data_view.setInt32(8, sample_rate, true); // Sample rate\n  data_view.setInt32(12, scale, true); // Scale\n  data_view.setInt32(16, data_length, true); // Length\n  data_view.setInt32(20, output_channels, true);\n  for (var i = 0; i < length; i++) {\n    var sample = 0;\n    if (output_channels === 1) {\n      for (var _channel = 0; _channel < channels.length; ++_channel) {\n        sample += channels[_channel][i];\n      }\n      sample = Math.floor(range_max * sample * amplitude_scale / channels.length);\n      if (sample < min_value[0]) {\n        min_value[0] = sample;\n        if (min_value[0] < range_min) {\n          min_value[0] = range_min;\n        }\n      }\n      if (sample > max_value[0]) {\n        max_value[0] = sample;\n        if (max_value[0] > range_max) {\n          max_value[0] = range_max;\n        }\n      }\n    } else {\n      for (var _channel2 = 0; _channel2 < output_channels; ++_channel2) {\n        sample = Math.floor(range_max * channels[_channel2][i] * amplitude_scale);\n        if (sample < min_value[_channel2]) {\n          min_value[_channel2] = sample;\n          if (min_value[_channel2] < range_min) {\n            min_value[_channel2] = range_min;\n          }\n        }\n        if (sample > max_value[_channel2]) {\n          max_value[_channel2] = sample;\n          if (max_value[_channel2] > range_max) {\n            max_value[_channel2] = range_max;\n          }\n        }\n      }\n    }\n    if (++scale_counter === scale) {\n      for (var _channel3 = 0; _channel3 < output_channels; _channel3++) {\n        if (options.bits === 8) {\n          data_view.setInt8(offset++, min_value[_channel3]);\n          data_view.setInt8(offset++, max_value[_channel3]);\n        } else {\n          data_view.setInt16(offset, min_value[_channel3], true);\n          data_view.setInt16(offset + 2, max_value[_channel3], true);\n          offset += 4;\n        }\n        min_value[_channel3] = Infinity;\n        max_value[_channel3] = -Infinity;\n      }\n      scale_counter = 0;\n    }\n  }\n  if (scale_counter > 0) {\n    for (var _channel4 = 0; _channel4 < output_channels; _channel4++) {\n      if (options.bits === 8) {\n        data_view.setInt8(offset++, min_value[_channel4]);\n        data_view.setInt8(offset++, max_value[_channel4]);\n      } else {\n        data_view.setInt16(offset, min_value[_channel4], true);\n        data_view.setInt16(offset + 2, max_value[_channel4], true);\n      }\n    }\n  }\n  return buffer;\n}\n\nfunction _typeof(o) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) {\n    return typeof o;\n  } : function (o) {\n    return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o;\n  }, _typeof(o);\n}\n\nfunction isJsonWaveformData(data) {\n  return data && _typeof(data) === 'object' && 'sample_rate' in data && 'samples_per_pixel' in data && 'bits' in data && 'length' in data && 'data' in data;\n}\nfunction isBinaryWaveformData(data) {\n  var isCompatible = data && _typeof(data) === 'object' && 'byteLength' in data;\n  if (isCompatible) {\n    var view = new DataView(data);\n    var version = view.getInt32(0, true);\n    if (version !== 1 && version !== 2) {\n      throw new TypeError('WaveformData.create(): This waveform data version not supported');\n    }\n  }\n  return isCompatible;\n}\nfunction convertJsonToBinary(data) {\n  var waveformData = data.data;\n  var channels = data.channels || 1;\n  var header_size = 24; // version 2\n  var bytes_per_sample = data.bits === 8 ? 1 : 2;\n  var expected_length = data.length * 2 * channels;\n  if (waveformData.length !== expected_length) {\n    throw new Error('WaveformData.create(): Length mismatch in JSON waveform data');\n  }\n  var total_size = header_size + waveformData.length * bytes_per_sample;\n  var array_buffer = new ArrayBuffer(total_size);\n  var data_object = new DataView(array_buffer);\n  data_object.setInt32(0, 2, true); // Version\n  data_object.setUint32(4, data.bits === 8, true);\n  data_object.setInt32(8, data.sample_rate, true);\n  data_object.setInt32(12, data.samples_per_pixel, true);\n  data_object.setInt32(16, data.length, true);\n  data_object.setInt32(20, channels, true);\n  var index = header_size;\n  if (data.bits === 8) {\n    for (var i = 0; i < waveformData.length; i++) {\n      data_object.setInt8(index++, waveformData[i], true);\n    }\n  } else {\n    for (var _i = 0; _i < waveformData.length; _i++) {\n      data_object.setInt16(index, waveformData[_i], true);\n      index += 2;\n    }\n  }\n  return array_buffer;\n}\n\nfunction isNullOrUndefined(value) {\n  return value === undefined || value === null;\n}\n\nfunction decodeBase64(base64, enableUnicode) {\n    var binaryString = atob(base64);\n    if (enableUnicode) {\n        var binaryView = new Uint8Array(binaryString.length);\n        for (var i = 0, n = binaryString.length; i < n; ++i) {\n            binaryView[i] = binaryString.charCodeAt(i);\n        }\n        return String.fromCharCode.apply(null, new Uint16Array(binaryView.buffer));\n    }\n    return binaryString;\n}\n\nfunction createURL(base64, sourcemapArg, enableUnicodeArg) {\n    var sourcemap = sourcemapArg === undefined ? null : sourcemapArg;\n    var enableUnicode = enableUnicodeArg === undefined ? false : enableUnicodeArg;\n    var source = decodeBase64(base64, enableUnicode);\n    var start = source.indexOf('\\n', 10) + 1;\n    var body = source.substring(start) + (sourcemap ? '\\/\\/# sourceMappingURL=' + sourcemap : '');\n    var blob = new Blob([body], { type: 'application/javascript' });\n    return URL.createObjectURL(blob);\n}\n\nfunction createBase64WorkerFactory(base64, sourcemapArg, enableUnicodeArg) {\n    var url;\n    return function WorkerFactory(options) {\n        url = url || createURL(base64, sourcemapArg, enableUnicodeArg);\n        return new Worker(url, options);\n    };\n}\n\nvar WorkerFactory = /*#__PURE__*/createBase64WorkerFactory('Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwooZnVuY3Rpb24gKCkgewogICd1c2Ugc3RyaWN0JzsKCiAgLyoqCiAgICogQXVkaW9CdWZmZXItYmFzZWQgV2F2ZWZvcm1EYXRhIGdlbmVyYXRvcgogICAqCiAgICogQWRhcHRlZCBmcm9tIEJsb2NrRmlsZTo6Q2FsY1N1bW1hcnkgaW4gQXVkYWNpdHksIHdpdGggcGVybWlzc2lvbi4KICAgKiBTZWUgaHR0cHM6Ly9naXRodWIuY29tL2F1ZGFjaXR5L2F1ZGFjaXR5L2Jsb2IvCiAgICogICAxMTA4YzEzNzZjMDkxNjYxNjIzMzVmYWI0NzQzMDA4Y2JhNTdjNGVlL3NyYy9CbG9ja0ZpbGUuY3BwI0wxOTgKICAgKi8KCiAgdmFyIElOVDhfTUFYID0gMTI3OwogIHZhciBJTlQ4X01JTiA9IC0xMjg7CiAgdmFyIElOVDE2X01BWCA9IDMyNzY3OwogIHZhciBJTlQxNl9NSU4gPSAtMzI3Njg7CiAgZnVuY3Rpb24gY2FsY3VsYXRlV2F2ZWZvcm1EYXRhTGVuZ3RoKGF1ZGlvX3NhbXBsZV9jb3VudCwgc2NhbGUpIHsKICAgIHZhciBkYXRhX2xlbmd0aCA9IE1hdGguZmxvb3IoYXVkaW9fc2FtcGxlX2NvdW50IC8gc2NhbGUpOwogICAgdmFyIHNhbXBsZXNfcmVtYWluaW5nID0gYXVkaW9fc2FtcGxlX2NvdW50IC0gZGF0YV9sZW5ndGggKiBzY2FsZTsKICAgIGlmIChzYW1wbGVzX3JlbWFpbmluZyA+IDApIHsKICAgICAgZGF0YV9sZW5ndGgrKzsKICAgIH0KICAgIHJldHVybiBkYXRhX2xlbmd0aDsKICB9CiAgZnVuY3Rpb24gZ2VuZXJhdGVXYXZlZm9ybURhdGEob3B0aW9ucykgewogICAgdmFyIHNjYWxlID0gb3B0aW9ucy5zY2FsZTsKICAgIHZhciBhbXBsaXR1ZGVfc2NhbGUgPSBvcHRpb25zLmFtcGxpdHVkZV9zY2FsZTsKICAgIHZhciBzcGxpdF9jaGFubmVscyA9IG9wdGlvbnMuc3BsaXRfY2hhbm5lbHM7CiAgICB2YXIgbGVuZ3RoID0gb3B0aW9ucy5sZW5ndGg7CiAgICB2YXIgc2FtcGxlX3JhdGUgPSBvcHRpb25zLnNhbXBsZV9yYXRlOwogICAgdmFyIGNoYW5uZWxzID0gb3B0aW9ucy5jaGFubmVscy5tYXAoZnVuY3Rpb24gKGNoYW5uZWwpIHsKICAgICAgcmV0dXJuIG5ldyBGbG9hdDMyQXJyYXkoY2hhbm5lbCk7CiAgICB9KTsKICAgIHZhciBvdXRwdXRfY2hhbm5lbHMgPSBzcGxpdF9jaGFubmVscyA/IGNoYW5uZWxzLmxlbmd0aCA6IDE7CiAgICB2YXIgaGVhZGVyX3NpemUgPSAyNDsKICAgIHZhciBkYXRhX2xlbmd0aCA9IGNhbGN1bGF0ZVdhdmVmb3JtRGF0YUxlbmd0aChsZW5ndGgsIHNjYWxlKTsKICAgIHZhciBieXRlc19wZXJfc2FtcGxlID0gb3B0aW9ucy5iaXRzID09PSA4ID8gMSA6IDI7CiAgICB2YXIgdG90YWxfc2l6ZSA9IGhlYWRlcl9zaXplICsgZGF0YV9sZW5ndGggKiAyICogYnl0ZXNfcGVyX3NhbXBsZSAqIG91dHB1dF9jaGFubmVsczsKICAgIHZhciBidWZmZXIgPSBuZXcgQXJyYXlCdWZmZXIodG90YWxfc2l6ZSk7CiAgICB2YXIgZGF0YV92aWV3ID0gbmV3IERhdGFWaWV3KGJ1ZmZlcik7CiAgICB2YXIgc2NhbGVfY291bnRlciA9IDA7CiAgICB2YXIgb2Zmc2V0ID0gaGVhZGVyX3NpemU7CiAgICB2YXIgbWluX3ZhbHVlID0gbmV3IEFycmF5KG91dHB1dF9jaGFubmVscyk7CiAgICB2YXIgbWF4X3ZhbHVlID0gbmV3IEFycmF5KG91dHB1dF9jaGFubmVscyk7CiAgICBmb3IgKHZhciBjaGFubmVsID0gMDsgY2hhbm5lbCA8IG91dHB1dF9jaGFubmVsczsgY2hhbm5lbCsrKSB7CiAgICAgIG1pbl92YWx1ZVtjaGFubmVsXSA9IEluZmluaXR5OwogICAgICBtYXhfdmFsdWVbY2hhbm5lbF0gPSAtSW5maW5pdHk7CiAgICB9CiAgICB2YXIgcmFuZ2VfbWluID0gb3B0aW9ucy5iaXRzID09PSA4ID8gSU5UOF9NSU4gOiBJTlQxNl9NSU47CiAgICB2YXIgcmFuZ2VfbWF4ID0gb3B0aW9ucy5iaXRzID09PSA4ID8gSU5UOF9NQVggOiBJTlQxNl9NQVg7CiAgICBkYXRhX3ZpZXcuc2V0SW50MzIoMCwgMiwgdHJ1ZSk7IC8vIFZlcnNpb24KICAgIGRhdGFfdmlldy5zZXRVaW50MzIoNCwgb3B0aW9ucy5iaXRzID09PSA4LCB0cnVlKTsgLy8gSXMgOCBiaXQ/CiAgICBkYXRhX3ZpZXcuc2V0SW50MzIoOCwgc2FtcGxlX3JhdGUsIHRydWUpOyAvLyBTYW1wbGUgcmF0ZQogICAgZGF0YV92aWV3LnNldEludDMyKDEyLCBzY2FsZSwgdHJ1ZSk7IC8vIFNjYWxlCiAgICBkYXRhX3ZpZXcuc2V0SW50MzIoMTYsIGRhdGFfbGVuZ3RoLCB0cnVlKTsgLy8gTGVuZ3RoCiAgICBkYXRhX3ZpZXcuc2V0SW50MzIoMjAsIG91dHB1dF9jaGFubmVscywgdHJ1ZSk7CiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICAgIHZhciBzYW1wbGUgPSAwOwogICAgICBpZiAob3V0cHV0X2NoYW5uZWxzID09PSAxKSB7CiAgICAgICAgZm9yICh2YXIgX2NoYW5uZWwgPSAwOyBfY2hhbm5lbCA8IGNoYW5uZWxzLmxlbmd0aDsgKytfY2hhbm5lbCkgewogICAgICAgICAgc2FtcGxlICs9IGNoYW5uZWxzW19jaGFubmVsXVtpXTsKICAgICAgICB9CiAgICAgICAgc2FtcGxlID0gTWF0aC5mbG9vcihyYW5nZV9tYXggKiBzYW1wbGUgKiBhbXBsaXR1ZGVfc2NhbGUgLyBjaGFubmVscy5sZW5ndGgpOwogICAgICAgIGlmIChzYW1wbGUgPCBtaW5fdmFsdWVbMF0pIHsKICAgICAgICAgIG1pbl92YWx1ZVswXSA9IHNhbXBsZTsKICAgICAgICAgIGlmIChtaW5fdmFsdWVbMF0gPCByYW5nZV9taW4pIHsKICAgICAgICAgICAgbWluX3ZhbHVlWzBdID0gcmFuZ2VfbWluOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpZiAoc2FtcGxlID4gbWF4X3ZhbHVlWzBdKSB7CiAgICAgICAgICBtYXhfdmFsdWVbMF0gPSBzYW1wbGU7CiAgICAgICAgICBpZiAobWF4X3ZhbHVlWzBdID4gcmFuZ2VfbWF4KSB7CiAgICAgICAgICAgIG1heF92YWx1ZVswXSA9IHJhbmdlX21heDsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZm9yICh2YXIgX2NoYW5uZWwyID0gMDsgX2NoYW5uZWwyIDwgb3V0cHV0X2NoYW5uZWxzOyArK19jaGFubmVsMikgewogICAgICAgICAgc2FtcGxlID0gTWF0aC5mbG9vcihyYW5nZV9tYXggKiBjaGFubmVsc1tfY2hhbm5lbDJdW2ldICogYW1wbGl0dWRlX3NjYWxlKTsKICAgICAgICAgIGlmIChzYW1wbGUgPCBtaW5fdmFsdWVbX2NoYW5uZWwyXSkgewogICAgICAgICAgICBtaW5fdmFsdWVbX2NoYW5uZWwyXSA9IHNhbXBsZTsKICAgICAgICAgICAgaWYgKG1pbl92YWx1ZVtfY2hhbm5lbDJdIDwgcmFuZ2VfbWluKSB7CiAgICAgICAgICAgICAgbWluX3ZhbHVlW19jaGFubmVsMl0gPSByYW5nZV9taW47CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICAgIGlmIChzYW1wbGUgPiBtYXhfdmFsdWVbX2NoYW5uZWwyXSkgewogICAgICAgICAgICBtYXhfdmFsdWVbX2NoYW5uZWwyXSA9IHNhbXBsZTsKICAgICAgICAgICAgaWYgKG1heF92YWx1ZVtfY2hhbm5lbDJdID4gcmFuZ2VfbWF4KSB7CiAgICAgICAgICAgICAgbWF4X3ZhbHVlW19jaGFubmVsMl0gPSByYW5nZV9tYXg7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKCsrc2NhbGVfY291bnRlciA9PT0gc2NhbGUpIHsKICAgICAgICBmb3IgKHZhciBfY2hhbm5lbDMgPSAwOyBfY2hhbm5lbDMgPCBvdXRwdXRfY2hhbm5lbHM7IF9jaGFubmVsMysrKSB7CiAgICAgICAgICBpZiAob3B0aW9ucy5iaXRzID09PSA4KSB7CiAgICAgICAgICAgIGRhdGFfdmlldy5zZXRJbnQ4KG9mZnNldCsrLCBtaW5fdmFsdWVbX2NoYW5uZWwzXSk7CiAgICAgICAgICAgIGRhdGFfdmlldy5zZXRJbnQ4KG9mZnNldCsrLCBtYXhfdmFsdWVbX2NoYW5uZWwzXSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBkYXRhX3ZpZXcuc2V0SW50MTYob2Zmc2V0LCBtaW5fdmFsdWVbX2NoYW5uZWwzXSwgdHJ1ZSk7CiAgICAgICAgICAgIGRhdGFfdmlldy5zZXRJbnQxNihvZmZzZXQgKyAyLCBtYXhfdmFsdWVbX2NoYW5uZWwzXSwgdHJ1ZSk7CiAgICAgICAgICAgIG9mZnNldCArPSA0OwogICAgICAgICAgfQogICAgICAgICAgbWluX3ZhbHVlW19jaGFubmVsM10gPSBJbmZpbml0eTsKICAgICAgICAgIG1heF92YWx1ZVtfY2hhbm5lbDNdID0gLUluZmluaXR5OwogICAgICAgIH0KICAgICAgICBzY2FsZV9jb3VudGVyID0gMDsKICAgICAgfQogICAgfQogICAgaWYgKHNjYWxlX2NvdW50ZXIgPiAwKSB7CiAgICAgIGZvciAodmFyIF9jaGFubmVsNCA9IDA7IF9jaGFubmVsNCA8IG91dHB1dF9jaGFubmVsczsgX2NoYW5uZWw0KyspIHsKICAgICAgICBpZiAob3B0aW9ucy5iaXRzID09PSA4KSB7CiAgICAgICAgICBkYXRhX3ZpZXcuc2V0SW50OChvZmZzZXQrKywgbWluX3ZhbHVlW19jaGFubmVsNF0pOwogICAgICAgICAgZGF0YV92aWV3LnNldEludDgob2Zmc2V0KyssIG1heF92YWx1ZVtfY2hhbm5lbDRdKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgZGF0YV92aWV3LnNldEludDE2KG9mZnNldCwgbWluX3ZhbHVlW19jaGFubmVsNF0sIHRydWUpOwogICAgICAgICAgZGF0YV92aWV3LnNldEludDE2KG9mZnNldCArIDIsIG1heF92YWx1ZVtfY2hhbm5lbDRdLCB0cnVlKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIHJldHVybiBidWZmZXI7CiAgfQoKICBvbm1lc3NhZ2UgPSBmdW5jdGlvbiBvbm1lc3NhZ2UoZXZ0KSB7CiAgICB2YXIgYnVmZmVyID0gZ2VuZXJhdGVXYXZlZm9ybURhdGEoZXZ0LmRhdGEpOwoKICAgIC8vIFRyYW5zZmVyIGJ1ZmZlciB0byB0aGUgY2FsbGluZyB0aHJlYWQKICAgIHRoaXMucG9zdE1lc3NhZ2UoYnVmZmVyLCBbYnVmZmVyXSk7CiAgICB0aGlzLmNsb3NlKCk7CiAgfTsKCn0pKCk7Ci8vIyBzb3VyY2VNYXBwaW5nVVJMPXdhdmVmb3JtLWRhdGEtd29ya2VyLmpzLm1hcAoK', null, false);\n/* eslint-enable */\n\n/**\n * Provides access to waveform data.\n */\n\nfunction WaveformData(data) {\n  if (isJsonWaveformData(data)) {\n    data = convertJsonToBinary(data);\n  }\n  if (isBinaryWaveformData(data)) {\n    this._data = new DataView(data);\n    this._offset = this._version() === 2 ? 24 : 20;\n    this._channels = [];\n    for (var channel = 0; channel < this.channels; channel++) {\n      this._channels[channel] = new WaveformDataChannel(this, channel);\n    }\n  } else {\n    throw new TypeError('WaveformData.create(): Unknown data format');\n  }\n}\nvar defaultOptions = {\n  scale: 512,\n  bits: 8,\n  amplitude_scale: 1.0,\n  split_channels: false,\n  disable_worker: false\n};\nfunction getOptions(options) {\n  var opts = {\n    scale: options.scale || defaultOptions.scale,\n    bits: options.bits || defaultOptions.bits,\n    amplitude_scale: options.amplitude_scale || defaultOptions.amplitude_scale,\n    split_channels: options.split_channels || defaultOptions.split_channels,\n    disable_worker: options.disable_worker || defaultOptions.disable_worker\n  };\n  return opts;\n}\nfunction getChannelData(audio_buffer) {\n  var channels = [];\n  for (var i = 0; i < audio_buffer.numberOfChannels; ++i) {\n    channels.push(audio_buffer.getChannelData(i).buffer);\n  }\n  return channels;\n}\nfunction createFromAudioBuffer(audio_buffer, options, callback) {\n  var channels = getChannelData(audio_buffer);\n  if (options.disable_worker) {\n    var buffer = generateWaveformData({\n      scale: options.scale,\n      bits: options.bits,\n      amplitude_scale: options.amplitude_scale,\n      split_channels: options.split_channels,\n      length: audio_buffer.length,\n      sample_rate: audio_buffer.sampleRate,\n      channels: channels\n    });\n    callback(undefined, new WaveformData(buffer), audio_buffer);\n  } else {\n    var worker = new WorkerFactory();\n    worker.onmessage = function (evt) {\n      callback(undefined, new WaveformData(evt.data), audio_buffer);\n    };\n    worker.postMessage({\n      scale: options.scale,\n      bits: options.bits,\n      amplitude_scale: options.amplitude_scale,\n      split_channels: options.split_channels,\n      length: audio_buffer.length,\n      sample_rate: audio_buffer.sampleRate,\n      channels: channels\n    }, channels);\n  }\n}\nfunction createFromArrayBuffer(audioContext, audioData, options, callback) {\n  // The following function is a workaround for a Webkit bug where decodeAudioData\n  // invokes the errorCallback with null instead of a DOMException.\n  // See https://webaudio.github.io/web-audio-api/#dom-baseaudiocontext-decodeaudiodata\n  // and http://stackoverflow.com/q/10365335/103396\n\n  function errorCallback(error) {\n    if (!error) {\n      error = new DOMException('EncodingError');\n    }\n    callback(error);\n    // prevent double-calling the callback on errors:\n    callback = function callback() {};\n  }\n  var promise = audioContext.decodeAudioData(audioData, function (audio_buffer) {\n    createFromAudioBuffer(audio_buffer, options, callback);\n  }, errorCallback);\n  if (promise) {\n    promise.catch(errorCallback);\n  }\n}\n\n/**\n * Creates and returns a WaveformData instance from the given waveform data.\n */\n\nWaveformData.create = function create(data) {\n  return new WaveformData(data);\n};\n\n/**\n * Creates a WaveformData instance from audio.\n */\n\nWaveformData.createFromAudio = function (options, callback) {\n  var opts = getOptions(options);\n  if (options.audio_context && options.array_buffer) {\n    return createFromArrayBuffer(options.audio_context, options.array_buffer, opts, callback);\n  } else if (options.audio_buffer) {\n    return createFromAudioBuffer(options.audio_buffer, opts, callback);\n  } else {\n    throw new TypeError(\n    // eslint-disable-next-line\n    'WaveformData.createFromAudio(): Pass either an AudioContext and ArrayBuffer, or an AudioBuffer object');\n  }\n};\nfunction WaveformResampler(options) {\n  this._inputData = options.waveformData;\n\n  // Scale we want to reach\n  this._output_samples_per_pixel = options.scale;\n  this._scale = this._inputData.scale; // scale we are coming from\n\n  // The amount of data we want to resample i.e. final zoom want to resample\n  // all data but for intermediate zoom we want to resample subset\n  this._input_buffer_size = this._inputData.length;\n  var input_buffer_length_samples = this._input_buffer_size * this._inputData.scale;\n  var output_buffer_length_samples = Math.ceil(input_buffer_length_samples / this._output_samples_per_pixel);\n  var output_header_size = 24; // version 2\n  var bytes_per_sample = this._inputData.bits === 8 ? 1 : 2;\n  var total_size = output_header_size + output_buffer_length_samples * 2 * this._inputData.channels * bytes_per_sample;\n  this._output_data = new ArrayBuffer(total_size);\n  this.output_dataview = new DataView(this._output_data);\n  this.output_dataview.setInt32(0, 2, true); // Version\n  this.output_dataview.setUint32(4, this._inputData.bits === 8, true); // Is 8 bit?\n  this.output_dataview.setInt32(8, this._inputData.sample_rate, true);\n  this.output_dataview.setInt32(12, this._output_samples_per_pixel, true);\n  this.output_dataview.setInt32(16, output_buffer_length_samples, true);\n  this.output_dataview.setInt32(20, this._inputData.channels, true);\n  this._outputWaveformData = new WaveformData(this._output_data);\n  this._input_index = 0;\n  this._output_index = 0;\n  var channels = this._inputData.channels;\n  this._min = new Array(channels);\n  this._max = new Array(channels);\n  for (var channel = 0; channel < channels; ++channel) {\n    if (this._input_buffer_size > 0) {\n      this._min[channel] = this._inputData.channel(channel).min_sample(this._input_index);\n      this._max[channel] = this._inputData.channel(channel).max_sample(this._input_index);\n    } else {\n      this._min[channel] = 0;\n      this._max[channel] = 0;\n    }\n  }\n  this._min_value = this._inputData.bits === 8 ? -128 : -32768;\n  this._max_value = this._inputData.bits === 8 ? 127 : 32767;\n  this._where = 0;\n  this._prev_where = 0;\n  this._stop = 0;\n  this._last_input_index = 0;\n}\nWaveformResampler.prototype.sample_at_pixel = function (x) {\n  return Math.floor(x * this._output_samples_per_pixel);\n};\nWaveformResampler.prototype.next = function () {\n  var count = 0;\n  var total = 1000;\n  var channels = this._inputData.channels;\n  var channel;\n  while (this._input_index < this._input_buffer_size && count < total) {\n    while (Math.floor(this.sample_at_pixel(this._output_index) / this._scale) === this._input_index) {\n      if (this._output_index > 0) {\n        for (var i = 0; i < channels; ++i) {\n          channel = this._outputWaveformData.channel(i);\n          channel.set_min_sample(this._output_index - 1, this._min[i]);\n          channel.set_max_sample(this._output_index - 1, this._max[i]);\n        }\n      }\n      this._last_input_index = this._input_index;\n      this._output_index++;\n      this._where = this.sample_at_pixel(this._output_index);\n      this._prev_where = this.sample_at_pixel(this._output_index - 1);\n      if (this._where !== this._prev_where) {\n        for (var _i = 0; _i < channels; ++_i) {\n          this._min[_i] = this._max_value;\n          this._max[_i] = this._min_value;\n        }\n      }\n    }\n    this._where = this.sample_at_pixel(this._output_index);\n    this._stop = Math.floor(this._where / this._scale);\n    if (this._stop > this._input_buffer_size) {\n      this._stop = this._input_buffer_size;\n    }\n    while (this._input_index < this._stop) {\n      for (var _i2 = 0; _i2 < channels; ++_i2) {\n        channel = this._inputData.channel(_i2);\n        var value = channel.min_sample(this._input_index);\n        if (value < this._min[_i2]) {\n          this._min[_i2] = value;\n        }\n        value = channel.max_sample(this._input_index);\n        if (value > this._max[_i2]) {\n          this._max[_i2] = value;\n        }\n      }\n      this._input_index++;\n    }\n    count++;\n  }\n  if (this._input_index < this._input_buffer_size) {\n    // More to do\n    return false;\n  } else {\n    // Done\n    if (this._input_index !== this._last_input_index) {\n      for (var _i3 = 0; _i3 < channels; ++_i3) {\n        channel = this._outputWaveformData.channel(_i3);\n        channel.set_min_sample(this._output_index - 1, this._min[_i3]);\n        channel.set_max_sample(this._output_index - 1, this._max[_i3]);\n      }\n    }\n    return true;\n  }\n};\nWaveformResampler.prototype.getOutputData = function () {\n  return this._output_data;\n};\nWaveformData.prototype = {\n  _getResampleOptions: function _getResampleOptions(options) {\n    var opts = {};\n    opts.scale = options.scale;\n    opts.width = options.width;\n    if (!isNullOrUndefined(opts.width) && (typeof opts.width !== 'number' || opts.width <= 0)) {\n      throw new RangeError('WaveformData.resample(): width should be a positive integer value');\n    }\n    if (!isNullOrUndefined(opts.scale) && (typeof opts.scale !== 'number' || opts.scale <= 0)) {\n      throw new RangeError('WaveformData.resample(): scale should be a positive integer value');\n    }\n    if (!opts.scale && !opts.width) {\n      throw new Error('WaveformData.resample(): Missing scale or width option');\n    }\n    if (opts.width) {\n      // Calculate the target scale for the resampled waveform\n      opts.scale = Math.floor(this.duration * this.sample_rate / opts.width);\n    }\n    if (opts.scale < this.scale) {\n      throw new Error('WaveformData.resample(): Zoom level ' + opts.scale + ' too low, minimum: ' + this.scale);\n    }\n    opts.abortSignal = options.abortSignal;\n    return opts;\n  },\n  resample: function resample(options) {\n    options = this._getResampleOptions(options);\n    options.waveformData = this;\n    var resampler = new WaveformResampler(options);\n    while (!resampler.next()) {\n      // nothing\n    }\n    return new WaveformData(resampler.getOutputData());\n  },\n  /**\n   * Concatenates with one or more other waveforms, returning a new WaveformData object.\n   */\n\n  concat: function concat() {\n    var self = this;\n    var otherWaveforms = Array.prototype.slice.call(arguments);\n\n    // Check that all the supplied waveforms are compatible\n    otherWaveforms.forEach(function (otherWaveform) {\n      if (self.channels !== otherWaveform.channels || self.sample_rate !== otherWaveform.sample_rate || self.bits !== otherWaveform.bits || self.scale !== otherWaveform.scale) {\n        throw new Error('WaveformData.concat(): Waveforms are incompatible');\n      }\n    });\n    var combinedBuffer = this._concatBuffers.apply(this, otherWaveforms);\n    return WaveformData.create(combinedBuffer);\n  },\n  /**\n   * Returns a new ArrayBuffer with the concatenated waveform.\n   * All waveforms must have identical metadata (version, channels, etc)\n   */\n\n  _concatBuffers: function _concatBuffers() {\n    var otherWaveforms = Array.prototype.slice.call(arguments);\n    var headerSize = this._offset;\n    var totalSize = headerSize;\n    var totalDataLength = 0;\n    var bufferCollection = [this].concat(otherWaveforms).map(function (w) {\n      return w._data.buffer;\n    });\n    for (var i = 0; i < bufferCollection.length; i++) {\n      var buffer = bufferCollection[i];\n      var dataSize = new DataView(buffer).getInt32(16, true);\n      totalSize += buffer.byteLength - headerSize;\n      totalDataLength += dataSize;\n    }\n    var totalBuffer = new ArrayBuffer(totalSize);\n    var sourceHeader = new DataView(bufferCollection[0]);\n    var totalBufferView = new DataView(totalBuffer);\n\n    // Copy the header from the first chunk\n    for (var _i4 = 0; _i4 < headerSize; _i4++) {\n      totalBufferView.setUint8(_i4, sourceHeader.getUint8(_i4));\n    }\n\n    // Rewrite the data-length header item to reflect all of the samples concatenated together\n    totalBufferView.setInt32(16, totalDataLength, true);\n    var offset = 0;\n    var dataOfTotalBuffer = new Uint8Array(totalBuffer, headerSize);\n    for (var _i5 = 0; _i5 < bufferCollection.length; _i5++) {\n      var _buffer = bufferCollection[_i5];\n      dataOfTotalBuffer.set(new Uint8Array(_buffer, headerSize), offset);\n      offset += _buffer.byteLength - headerSize;\n    }\n    return totalBuffer;\n  },\n  slice: function slice(options) {\n    var startIndex = 0;\n    var endIndex = 0;\n    if (!isNullOrUndefined(options.startIndex) && !isNullOrUndefined(options.endIndex)) {\n      startIndex = options.startIndex;\n      endIndex = options.endIndex;\n    } else if (!isNullOrUndefined(options.startTime) && !isNullOrUndefined(options.endTime)) {\n      startIndex = this.at_time(options.startTime);\n      endIndex = this.at_time(options.endTime);\n    }\n    if (startIndex < 0) {\n      throw new RangeError('startIndex or startTime must not be negative');\n    }\n    if (endIndex < 0) {\n      throw new RangeError('endIndex or endTime must not be negative');\n    }\n    if (startIndex > this.length) {\n      startIndex = this.length;\n    }\n    if (endIndex > this.length) {\n      endIndex = this.length;\n    }\n    if (startIndex > endIndex) {\n      startIndex = endIndex;\n    }\n    var length = endIndex - startIndex;\n    var header_size = 24; // Version 2\n    var bytes_per_sample = this.bits === 8 ? 1 : 2;\n    var total_size = header_size + length * 2 * this.channels * bytes_per_sample;\n    var output_data = new ArrayBuffer(total_size);\n    var output_dataview = new DataView(output_data);\n    output_dataview.setInt32(0, 2, true); // Version\n    output_dataview.setUint32(4, this.bits === 8, true); // Is 8 bit?\n    output_dataview.setInt32(8, this.sample_rate, true);\n    output_dataview.setInt32(12, this.scale, true);\n    output_dataview.setInt32(16, length, true);\n    output_dataview.setInt32(20, this.channels, true);\n    for (var i = 0; i < length * this.channels * 2; i++) {\n      var sample = this._at(startIndex * this.channels * 2 + i);\n      if (this.bits === 8) {\n        output_dataview.setInt8(header_size + i, sample);\n      } else {\n        output_dataview.setInt16(header_size + i * 2, sample, true);\n      }\n    }\n    return new WaveformData(output_data);\n  },\n  /**\n   * Returns the data format version number.\n   */\n\n  _version: function _version() {\n    return this._data.getInt32(0, true);\n  },\n  /**\n   * Returns the length of the waveform, in pixels.\n   */\n\n  get length() {\n    return this._data.getUint32(16, true);\n  },\n  /**\n   * Returns the number of bits per sample, either 8 or 16.\n   */\n\n  get bits() {\n    var bits = Boolean(this._data.getUint32(4, true));\n    return bits ? 8 : 16;\n  },\n  /**\n   * Returns the (approximate) duration of the audio file, in seconds.\n   */\n\n  get duration() {\n    return this.length * this.scale / this.sample_rate;\n  },\n  /**\n   * Returns the number of pixels per second.\n   */\n\n  get pixels_per_second() {\n    return this.sample_rate / this.scale;\n  },\n  /**\n   * Returns the amount of time represented by a single pixel, in seconds.\n   */\n\n  get seconds_per_pixel() {\n    return this.scale / this.sample_rate;\n  },\n  /**\n   * Returns the number of waveform channels.\n   */\n\n  get channels() {\n    if (this._version() === 2) {\n      return this._data.getInt32(20, true);\n    } else {\n      return 1;\n    }\n  },\n  /**\n   * Returns a waveform channel.\n   */\n\n  channel: function channel(index) {\n    if (index >= 0 && index < this._channels.length) {\n      return this._channels[index];\n    } else {\n      throw new RangeError('Invalid channel: ' + index);\n    }\n  },\n  /**\n   * Returns the number of audio samples per second.\n   */\n\n  get sample_rate() {\n    return this._data.getInt32(8, true);\n  },\n  /**\n   * Returns the number of audio samples per pixel.\n   */\n\n  get scale() {\n    return this._data.getInt32(12, true);\n  },\n  /**\n   * Returns a waveform data value at a specific offset.\n   */\n\n  _at: function at_sample(index) {\n    if (this.bits === 8) {\n      return this._data.getInt8(this._offset + index);\n    } else {\n      return this._data.getInt16(this._offset + index * 2, true);\n    }\n  },\n  /**\n   * Sets a waveform data value at a specific offset.\n   */\n\n  _set_at: function set_at(index, sample) {\n    if (this.bits === 8) {\n      return this._data.setInt8(this._offset + index, sample);\n    } else {\n      return this._data.setInt16(this._offset + index * 2, sample, true);\n    }\n  },\n  /**\n   * Returns the waveform data index position for a given time.\n   */\n\n  at_time: function at_time(time) {\n    return Math.floor(time * this.sample_rate / this.scale);\n  },\n  /**\n   * Returns the time in seconds for a given index.\n   */\n\n  time: function time(index) {\n    return index * this.scale / this.sample_rate;\n  },\n  /**\n   * Returns an object containing the waveform data.\n   */\n\n  toJSON: function toJSON() {\n    var waveform = {\n      version: 2,\n      channels: this.channels,\n      sample_rate: this.sample_rate,\n      samples_per_pixel: this.scale,\n      bits: this.bits,\n      length: this.length,\n      data: []\n    };\n    for (var i = 0; i < this.length; i++) {\n      for (var channel = 0; channel < this.channels; channel++) {\n        waveform.data.push(this.channel(channel).min_sample(i));\n        waveform.data.push(this.channel(channel).max_sample(i));\n      }\n    }\n    return waveform;\n  },\n  /**\n   * Returns the waveform data in binary format as an ArrayBuffer.\n   */\n\n  toArrayBuffer: function toArrayBuffer() {\n    return this._data.buffer;\n  }\n};\n\nexport { WaveformData as default };\n","/**\n * @file\n *\n * Defines the {@link WaveformBuilder} class.\n *\n * @module waveform-builder\n */\n\nimport { isArrayBuffer, isObject } from './utils';\nimport WaveformData from 'waveform-data';\n\nconst isXhr2 = ('withCredentials' in new XMLHttpRequest());\n\n/**\n * Creates and returns a WaveformData object, either by requesting the\n * waveform data from the server, or by creating the waveform data using the\n * Web Audio API.\n *\n * @class\n * @alias WaveformBuilder\n *\n * @param {Peaks} peaks\n */\n\nfunction WaveformBuilder(peaks) {\n  this._peaks = peaks;\n}\n\n/**\n * Options for requesting remote waveform data.\n *\n * @typedef {Object} RemoteWaveformDataOptions\n * @global\n * @property {String=} arraybuffer\n * @property {String=} json\n */\n\n/**\n * Options for supplying local waveform data.\n *\n * @typedef {Object} LocalWaveformDataOptions\n * @global\n * @property {ArrayBuffer=} arraybuffer\n * @property {Object=} json\n */\n\n/**\n * Options for the Web Audio waveform builder.\n *\n * @typedef {Object} WaveformBuilderWebAudioOptions\n * @global\n * @property {AudioContext} audioContext\n * @property {AudioBuffer=} audioBuffer\n * @property {Number=} scale\n * @property {Boolean=} multiChannel\n */\n\n/**\n * Options for [WaveformBuilder.init]{@link WaveformBuilder#init}.\n *\n * @typedef {Object} WaveformBuilderInitOptions\n * @global\n * @property {RemoteWaveformDataOptions=} dataUri\n * @property {LocalWaveformDataOptions=} waveformData\n * @property {WaveformBuilderWebAudioOptions=} webAudio\n * @property {Boolean=} withCredentials\n * @property {Array<Number>=} zoomLevels\n */\n\n/**\n * Callback for receiving the waveform data.\n *\n * @callback WaveformBuilderInitCallback\n * @global\n * @param {Error} error\n * @param {WaveformData} waveformData\n */\n\n/**\n * Loads or creates the waveform data.\n *\n * @private\n * @param {WaveformBuilderInitOptions} options\n * @param {WaveformBuilderInitCallback} callback\n */\n\nWaveformBuilder.prototype.init = function(options, callback) {\n  if ((options.dataUri && (options.webAudio || options.audioContext)) ||\n      (options.waveformData && (options.webAudio || options.audioContext)) ||\n      (options.dataUri && options.waveformData)) {\n    // eslint-disable-next-line @stylistic/js/max-len\n    callback(new TypeError('Peaks.init(): You may only pass one source (webAudio, dataUri, or waveformData) to render waveform data.'));\n    return;\n  }\n\n  if (options.audioContext) {\n    // eslint-disable-next-line @stylistic/js/max-len\n    this._peaks._logger('Peaks.init(): The audioContext option is deprecated, please pass a webAudio object instead');\n\n    options.webAudio = {\n      audioContext: options.audioContext\n    };\n  }\n\n  if (options.dataUri) {\n    return this._getRemoteWaveformData(options, callback);\n  }\n  else if (options.waveformData) {\n    return this._buildWaveformFromLocalData(options, callback);\n  }\n  else if (options.webAudio) {\n    if (options.webAudio.audioBuffer) {\n      return this._buildWaveformDataFromAudioBuffer(options, callback);\n    }\n    else {\n      return this._buildWaveformDataUsingWebAudio(options, callback);\n    }\n  }\n  else {\n    // eslint-disable-next-line @stylistic/js/max-len\n    callback(new Error('Peaks.init(): You must pass an audioContext, or dataUri, or waveformData to render waveform data'));\n  }\n};\n\nfunction hasValidContentRangeHeader(xhr) {\n  const contentRange = xhr.getResponseHeader('content-range');\n\n  if (!contentRange) {\n    return false;\n  }\n\n  const matches = contentRange.match(/^bytes (\\d+)-(\\d+)\\/(\\d+)$/);\n\n  if (matches && matches.length === 4) {\n    const firstPos = parseInt(matches[1], 10);\n    const lastPos = parseInt(matches[2], 10);\n    const length = parseInt(matches[3], 10);\n\n    if (firstPos === 0 && (lastPos + 1) === length) {\n      return true;\n    }\n\n    return false;\n  }\n\n  return false;\n}\n\n/* eslint-disable @stylistic/js/max-len */\n\n/**\n * Fetches waveform data, based on the given options.\n *\n * @private\n * @param {Object} options\n * @param {String|Object} options.dataUri\n * @param {String} options.dataUri.arraybuffer Waveform data URL\n *   (binary format)\n * @param {String} options.dataUri.json Waveform data URL (JSON format)\n * @param {String} options.defaultUriFormat Either 'arraybuffer' (for binary\n *   data) or 'json'\n * @param {WaveformBuilderInitCallback} callback\n *\n * @see Refer to the <a href=\"https://codeberg.org/chrisn/audiowaveform/src/branch/master/doc/DataFormat.md\">data format documentation</a>\n *   for details of the binary and JSON waveform data formats.\n */\n\n/* eslint-enable @stylistic/js/max-len */\n\nWaveformBuilder.prototype._getRemoteWaveformData = function(options, callback) {\n  const self = this;\n\n  let dataUri = null;\n  let requestType = null;\n  let url;\n\n  if (isObject(options.dataUri)) {\n    dataUri = options.dataUri;\n  }\n  else {\n    callback(new TypeError('Peaks.init(): The dataUri option must be an object'));\n    return;\n  }\n\n  ['ArrayBuffer', 'JSON'].some(function(connector) {\n    if (window[connector]) {\n      requestType = connector.toLowerCase();\n      url = dataUri[requestType];\n\n      return Boolean(url);\n    }\n  });\n\n  if (!url) {\n    // eslint-disable-next-line @stylistic/js/max-len\n    callback(new Error('Peaks.init(): Unable to determine a compatible dataUri format for this browser'));\n    return;\n  }\n\n  self._xhr = self._createXHR(url, requestType, options.withCredentials, function(event) {\n    if (this.readyState !== 4) {\n      return;\n    }\n\n    // See https://codeberg.org/chrisn/peaks.js/issues/491\n\n    if (this.status !== 200 &&\n        !(this.status === 206 && hasValidContentRangeHeader(this))) {\n      callback(\n        new Error('Unable to fetch remote data. HTTP status ' + this.status)\n      );\n\n      return;\n    }\n\n    self._xhr = null;\n\n    const waveformData = WaveformData.create(event.target.response);\n\n    if (waveformData.channels !== 1 && waveformData.channels !== 2) {\n      callback(new Error('Peaks.init(): Only mono or stereo waveforms are currently supported'));\n      return;\n    }\n    else if (waveformData.bits !== 8) {\n      callback(new Error('Peaks.init(): 16-bit waveform data is not supported'));\n      return;\n    }\n\n    callback(undefined, waveformData);\n  },\n  function() {\n    callback(new Error('XHR failed'));\n  },\n  function() {\n    callback(new Error('XHR aborted'));\n  });\n\n  self._xhr.send();\n};\n\n/* eslint-disable @stylistic/js/max-len */\n\n/**\n * Creates a waveform from given data, based on the given options.\n *\n * @private\n * @param {Object} options\n * @param {Object} options.waveformData\n * @param {ArrayBuffer} options.waveformData.arraybuffer Waveform data (binary format)\n * @param {Object} options.waveformData.json Waveform data (JSON format)\n * @param {WaveformBuilderInitCallback} callback\n *\n * @see Refer to the <a href=\"https://codeberg.org/chrisn/audiowaveform/src/branch/master/doc/DataFormat.md\">data format documentation</a>\n *   for details of the binary and JSON waveform data formats.\n */\n\n/* eslint-enable @stylistic/js/max-len */\n\nWaveformBuilder.prototype._buildWaveformFromLocalData = function(options, callback) {\n  let waveformData = null;\n  let data = null;\n\n  if (isObject(options.waveformData)) {\n    waveformData = options.waveformData;\n  }\n  else {\n    callback(new Error('Peaks.init(): The waveformData option must be an object'));\n    return;\n  }\n\n  if (isObject(waveformData.json)) {\n    data = waveformData.json;\n  }\n  else if (isArrayBuffer(waveformData.arraybuffer)) {\n    data = waveformData.arraybuffer;\n  }\n\n  if (!data) {\n    callback(new Error('Peaks.init(): Unable to determine a compatible waveformData format'));\n    return;\n  }\n\n  try {\n    const createdWaveformData = WaveformData.create(data);\n\n    if (createdWaveformData.channels !== 1 && createdWaveformData.channels !== 2) {\n      callback(new Error('Peaks.init(): Only mono or stereo waveforms are currently supported'));\n      return;\n    }\n    else if (createdWaveformData.bits !== 8) {\n      callback(new Error('Peaks.init(): 16-bit waveform data is not supported'));\n      return;\n    }\n\n    callback(undefined, createdWaveformData);\n  }\n  catch (err) {\n    callback(err);\n  }\n};\n\n/**\n * Creates waveform data using the Web Audio API.\n *\n * @private\n * @param {Object} options\n * @param {AudioContext} options.audioContext\n * @param {HTMLMediaElement} options.mediaElement\n * @param {WaveformBuilderInitCallback} callback\n */\n\nWaveformBuilder.prototype._buildWaveformDataUsingWebAudio = function(options, callback) {\n  const self = this;\n\n  const audioContext = window.AudioContext || window.webkitAudioContext;\n\n  if (!(options.webAudio.audioContext instanceof audioContext)) {\n    // eslint-disable-next-line @stylistic/js/max-len\n    callback(new TypeError('Peaks.init(): The webAudio.audioContext option must be a valid AudioContext'));\n    return;\n  }\n\n  const webAudioOptions = options.webAudio;\n\n  if (webAudioOptions.scale !== options.zoomLevels[0]) {\n    webAudioOptions.scale = options.zoomLevels[0];\n  }\n\n  // If the media element has already selected which source to play, its\n  // currentSrc attribute will contain the source media URL. Otherwise,\n  // we wait for a canplay event to tell us when the media is ready.\n\n  const mediaSourceUrl = self._peaks.options.mediaElement.currentSrc;\n\n  if (mediaSourceUrl) {\n    self._requestAudioAndBuildWaveformData(\n      mediaSourceUrl,\n      webAudioOptions,\n      options.withCredentials,\n      callback\n    );\n  }\n  else {\n    self._peaks.once('player.canplay', function() {\n      self._requestAudioAndBuildWaveformData(\n        self._peaks.options.mediaElement.currentSrc,\n        webAudioOptions,\n        options.withCredentials,\n        callback\n      );\n    });\n  }\n};\n\nWaveformBuilder.prototype._buildWaveformDataFromAudioBuffer = function(options, callback) {\n  const webAudioOptions = options.webAudio;\n\n  if (webAudioOptions.scale !== options.zoomLevels[0]) {\n    webAudioOptions.scale = options.zoomLevels[0];\n  }\n\n  const webAudioBuilderOptions = {\n    audio_buffer: webAudioOptions.audioBuffer,\n    split_channels: webAudioOptions.multiChannel,\n    scale: webAudioOptions.scale,\n    disable_worker: true\n  };\n\n  WaveformData.createFromAudio(webAudioBuilderOptions, callback);\n};\n\n/**\n * Fetches the audio content, based on the given options, and creates waveform\n * data using the Web Audio API.\n *\n * @private\n * @param {url} The media source URL\n * @param {WaveformBuilderWebAudioOptions} webAudio\n * @param {Boolean} withCredentials\n * @param {WaveformBuilderInitCallback} callback\n */\n\nWaveformBuilder.prototype._requestAudioAndBuildWaveformData = function(url,\n    webAudio, withCredentials, callback) {\n  const self = this;\n\n  if (!url) {\n    self._peaks._logger('Peaks.init(): The mediaElement src is invalid');\n    return;\n  }\n\n  self._xhr = self._createXHR(url, 'arraybuffer', withCredentials, function(event) {\n    if (this.readyState !== 4) {\n      return;\n    }\n\n    // See https://codeberg.org/chrisn/peaks.js/issues/491\n\n    if (this.status !== 200 &&\n        !(this.status === 206 && hasValidContentRangeHeader(this))) {\n      callback(\n        new Error('Unable to fetch remote data. HTTP status ' + this.status)\n      );\n\n      return;\n    }\n\n    self._xhr = null;\n\n    const webAudioBuilderOptions = {\n      audio_context: webAudio.audioContext,\n      array_buffer: event.target.response,\n      split_channels: webAudio.multiChannel,\n      scale: webAudio.scale\n    };\n\n    WaveformData.createFromAudio(webAudioBuilderOptions, callback);\n  },\n  function() {\n    callback(new Error('XHR failed'));\n  },\n  function() {\n    callback(new Error('XHR aborted'));\n  });\n\n  self._xhr.send();\n};\n\nWaveformBuilder.prototype.abort = function() {\n  if (this._xhr) {\n    this._xhr.abort();\n  }\n};\n\n/**\n * @private\n * @param {String} url\n * @param {String} requestType\n * @param {Boolean} withCredentials\n * @param {Function} onLoad\n * @param {Function} onError\n *\n * @returns {XMLHttpRequest}\n */\n\nWaveformBuilder.prototype._createXHR = function(url, requestType,\n    withCredentials, onLoad, onError, onAbort) {\n  const xhr = new XMLHttpRequest();\n\n  // open an XHR request to the data source file\n  xhr.open('GET', url, true);\n\n  if (isXhr2) {\n    try {\n      xhr.responseType = requestType;\n    }\n    catch (error) { // eslint-disable-line no-unused-vars\n      // Some browsers like Safari 6 do handle XHR2 but not the json\n      // response type, doing only a try/catch fails in IE9\n    }\n  }\n\n  xhr.onload = onLoad;\n  xhr.onerror = onError;\n\n  if (isXhr2 && withCredentials) {\n    xhr.withCredentials = true;\n  }\n\n  xhr.addEventListener('abort', onAbort);\n\n  return xhr;\n};\n\nexport default WaveformBuilder;\n","/**\n * @file\n *\n * Defines the {@link Peaks} class.\n *\n * @module main\n */\n\nimport EventEmitter from 'eventemitter3';\nimport CueEmitter from './cue-emitter';\nimport WaveformPoints from './waveform-points';\nimport WaveformSegments from './waveform-segments';\nimport KeyboardHandler from './keyboard-handler';\nimport MediaElementPlayer from './mediaelement-player';\nimport Player from './player';\nimport { createPointMarker, createSegmentMarker, createSegmentLabel } from './marker-factories';\nimport ViewController from './view-controller';\nimport ZoomController from './zoom-controller';\nimport WaveformBuilder from './waveform-builder';\nimport {\n  isHTMLElement, isFunction, isInAscendingOrder, isObject,\n  objectHasProperty,\n  extend\n} from './utils';\n\n/**\n * Initialises a new Peaks instance with default option settings.\n *\n * @class\n * @alias Peaks\n *\n * @param {Object} opts Configuration options\n */\n\nfunction Peaks() {\n  EventEmitter.call(this);\n\n  // Set default options\n  this.options = {\n    zoomLevels:          [512, 1024, 2048, 4096],\n    waveformCache:       true,\n\n    mediaElement:        null,\n    mediaUrl:            null,\n\n    dataUri:             null,\n    withCredentials:     false,\n\n    waveformData:        null,\n    webAudio:            null,\n\n    nudgeIncrement:      1.0,\n\n    pointMarkerColor:    '#39cccc',\n\n    createSegmentMarker: createSegmentMarker,\n    createSegmentLabel:  createSegmentLabel,\n    createPointMarker:   createPointMarker,\n\n    // eslint-disable-next-line no-console\n    logger:              console.error.bind(console)\n  };\n\n  return this;\n}\n\nPeaks.prototype = Object.create(EventEmitter.prototype);\n\nconst defaultViewOptions = {\n  playheadColor:           '#111111',\n  playheadTextColor:       '#aaaaaa',\n  playheadBackgroundColor: 'transparent',\n  playheadPadding:         2,\n  playheadWidth:           1,\n  axisGridlineColor:       '#cccccc',\n  showAxisLabels:          true,\n  axisTopMarkerHeight:     10,\n  axisBottomMarkerHeight:  10,\n  axisLabelColor:          '#aaaaaa',\n  fontFamily:              'sans-serif',\n  fontSize:                11,\n  fontStyle:               'normal',\n  timeLabelPrecision:      2,\n  enablePoints:            true,\n  enableSegments:          true\n};\n\nconst defaultZoomviewOptions = {\n  // showPlayheadTime:    true,\n  playheadClickTolerance: 3,\n  waveformColor:          'rgba(0, 225, 128, 1)',\n  wheelMode:              'none',\n  autoScroll:             true,\n  autoScrollOffset:       100,\n  enableEditing:          true\n};\n\nconst defaultOverviewOptions = {\n  // showPlayheadTime:    false,\n  waveformColor:          'rgba(0, 0, 0, 0.2)',\n  highlightColor:         '#aaaaaa',\n  highlightStrokeColor:   'transparent',\n  highlightOpacity:       0.3,\n  highlightOffset:        11,\n  highlightCornerRadius:  2,\n  enableEditing:          false\n};\n\nconst defaultSegmentOptions = {\n  overlay:                   false,\n  markers:                   true,\n  startMarkerColor:          '#aaaaaa',\n  endMarkerColor:            '#aaaaaa',\n  waveformColor:             '#0074d9',\n  overlayColor:              '#ff0000',\n  overlayOpacity:            0.3,\n  overlayBorderColor:        '#ff0000',\n  overlayBorderWidth:        2,\n  overlayCornerRadius:       5,\n  overlayOffset:             25,\n  overlayLabelAlign:         'left',\n  overlayLabelVerticalAlign: 'top',\n  overlayLabelPadding:       8,\n  overlayLabelColor:         '#000000',\n  overlayFontFamily:         'sans-serif',\n  overlayFontSize:           12,\n  overlayFontStyle:          'normal'\n};\n\nconst defaultScrollbarOptions = {\n  color: '#888888',\n  minWidth: 50\n};\n\nfunction getOverviewOptions(opts) {\n  const overviewOptions = {};\n\n  if (opts.overview && opts.overview.showPlayheadTime) {\n    overviewOptions.showPlayheadTime = opts.overview.showPlayheadTime;\n  }\n\n  const optNames = [\n    'container',\n    'waveformColor',\n    'playedWaveformColor',\n    'playheadColor',\n    'playheadTextColor',\n    'playheadBackgroundColor',\n    'playheadPadding',\n    'playheadWidth',\n    'formatPlayheadTime',\n    'timeLabelPrecision',\n    'axisGridlineColor',\n    'showAxisLabels',\n    'axisTopMarkerHeight',\n    'axisBottomMarkerHeight',\n    'axisLabelColor',\n    'formatAxisTime',\n    'fontFamily',\n    'fontSize',\n    'fontStyle',\n    'highlightColor',\n    'highlightStrokeColor',\n    'highlightOpacity',\n    'highlightCornerRadius',\n    'highlightOffset',\n    'enablePoints',\n    'enableSegments',\n    'enableEditing'\n  ];\n\n  optNames.forEach(function(optName) {\n    if (opts.overview && objectHasProperty(opts.overview, optName)) {\n      overviewOptions[optName] = opts.overview[optName];\n    }\n    else if (objectHasProperty(opts, optName)) {\n      overviewOptions[optName] = opts[optName];\n    }\n    else if (!objectHasProperty(overviewOptions, optName)) {\n      if (objectHasProperty(defaultOverviewOptions, optName)) {\n        overviewOptions[optName] = defaultOverviewOptions[optName];\n      }\n      else if (objectHasProperty(defaultViewOptions, optName)) {\n        overviewOptions[optName] = defaultViewOptions[optName];\n      }\n    }\n  });\n\n  return overviewOptions;\n}\n\nfunction getZoomviewOptions(opts) {\n  const zoomviewOptions = {};\n\n  if (opts.showPlayheadTime) {\n    zoomviewOptions.showPlayheadTime = opts.showPlayheadTime;\n  }\n  else if (opts.zoomview && opts.zoomview.showPlayheadTime) {\n    zoomviewOptions.showPlayheadTime = opts.zoomview.showPlayheadTime;\n  }\n\n  const optNames = [\n    'container',\n    'waveformColor',\n    'playedWaveformColor',\n    'playheadColor',\n    'playheadTextColor',\n    'playheadBackgroundColor',\n    'playheadPadding',\n    'playheadWidth',\n    'formatPlayheadTime',\n    'playheadClickTolerance',\n    'timeLabelPrecision',\n    'axisGridlineColor',\n    'showAxisLabels',\n    'axisTopMarkerHeight',\n    'axisBottomMarkerHeight',\n    'axisLabelColor',\n    'formatAxisTime',\n    'fontFamily',\n    'fontSize',\n    'fontStyle',\n    'wheelMode',\n    'autoScroll',\n    'autoScrollOffset',\n    'enablePoints',\n    'enableSegments',\n    'enableEditing'\n  ];\n\n  optNames.forEach(function(optName) {\n    if (opts.zoomview && objectHasProperty(opts.zoomview, optName)) {\n      zoomviewOptions[optName] = opts.zoomview[optName];\n    }\n    else if (objectHasProperty(opts, optName)) {\n      zoomviewOptions[optName] = opts[optName];\n    }\n    else if (!objectHasProperty(zoomviewOptions, optName)) {\n      if (objectHasProperty(defaultZoomviewOptions, optName)) {\n        zoomviewOptions[optName] = defaultZoomviewOptions[optName];\n      }\n      else if (objectHasProperty(defaultViewOptions, optName)) {\n        zoomviewOptions[optName] = defaultViewOptions[optName];\n      }\n    }\n  });\n\n  return zoomviewOptions;\n}\n\nfunction getScrollbarOptions(opts) {\n  if (!objectHasProperty(opts, 'scrollbar')) {\n    return null;\n  }\n\n  const scrollbarOptions = {};\n\n  const optNames = [\n    'container',\n    'color',\n    'minWidth'\n  ];\n\n  optNames.forEach(function(optName) {\n    if (objectHasProperty(opts.scrollbar, optName)) {\n      scrollbarOptions[optName] = opts.scrollbar[optName];\n    }\n    else {\n      scrollbarOptions[optName] = defaultScrollbarOptions[optName];\n    }\n  });\n\n  return scrollbarOptions;\n}\n\nfunction extendOptions(to, from) {\n  for (const key in from) {\n    if (objectHasProperty(from, key) &&\n        objectHasProperty(to, key)) {\n      to[key] = from[key];\n    }\n  }\n\n  return to;\n}\n\nfunction addSegmentOptions(options, opts) {\n  options.segmentOptions = {};\n\n  extend(options.segmentOptions, defaultSegmentOptions);\n\n  if (opts.segmentOptions) {\n    extendOptions(options.segmentOptions, opts.segmentOptions);\n  }\n\n  options.zoomview.segmentOptions = {};\n  extend(options.zoomview.segmentOptions, options.segmentOptions);\n\n  if (opts.zoomview && opts.zoomview.segmentOptions) {\n    extendOptions(options.zoomview.segmentOptions, opts.zoomview.segmentOptions);\n  }\n\n  options.overview.segmentOptions = {};\n  extend(options.overview.segmentOptions, options.segmentOptions);\n\n  if (opts.overview && opts.overview.segmentOptions) {\n    extendOptions(options.overview.segmentOptions, opts.overview.segmentOptions);\n  }\n}\n\nfunction checkContainerElements(options) {\n  const zoomviewContainer = options.zoomview.container;\n  const overviewContainer = options.overview.container;\n\n  if (!isHTMLElement(zoomviewContainer) &&\n      !isHTMLElement(overviewContainer)) {\n    // eslint-disable-next-line @stylistic/js/max-len\n    return new TypeError('Peaks.init(): The zoomview and/or overview container options must be valid HTML elements');\n  }\n\n  if (zoomviewContainer &&\n      (zoomviewContainer.clientWidth  <= 0 ||\n       zoomviewContainer.clientHeight <= 0)) {\n    // eslint-disable-next-line @stylistic/js/max-len\n    return new Error('Peaks.init(): The zoomview container must be visible and have non-zero width and height');\n  }\n\n  if (overviewContainer &&\n      (overviewContainer.clientWidth  <= 0 ||\n       overviewContainer.clientHeight <= 0)) {\n    // eslint-disable-next-line @stylistic/js/max-len\n    return new Error('Peaks.init(): The overview container must be visible and have non-zero width and height');\n  }\n}\n\n/**\n * Creates and initialises a new Peaks instance with the given options.\n *\n * @param {Object} opts Configuration options\n * @param {Function} callback\n *\n * @return {Peaks}\n */\n\nPeaks.init = function(opts, callback) {\n  if (!callback) {\n    throw new Error('Peaks.init(): Missing callback function');\n  }\n\n  const instance = new Peaks();\n\n  let err = instance._setOptions(opts);\n\n  if (!err) {\n    err = checkContainerElements(instance.options);\n  }\n\n  if (err) {\n    callback(err);\n    return;\n  }\n\n  let scrollbarContainer = null;\n\n  if (instance.options.scrollbar) {\n    scrollbarContainer = instance.options.scrollbar.container;\n\n    if (!isHTMLElement(scrollbarContainer)) {\n    // eslint-disable-next-line @stylistic/js/max-len\n      callback(new TypeError('Peaks.init(): The scrollbar container option must be a valid HTML element'));\n      return;\n    }\n\n    if (scrollbarContainer.clientWidth <= 0) {\n    // eslint-disable-next-line @stylistic/js/max-len\n      callback(new TypeError('Peaks.init(): The scrollbar container must be visible and have non-zero width'));\n      return;\n    }\n  }\n\n  if (opts.keyboard) {\n    instance._keyboardHandler = new KeyboardHandler(instance);\n  }\n\n  const player = opts.player ?\n    opts.player :\n    new MediaElementPlayer(instance.options.mediaElement);\n\n  instance.player = new Player(instance, player);\n  instance.segments = new WaveformSegments(instance);\n  instance.points = new WaveformPoints(instance);\n  instance.zoom = new ZoomController(instance, instance.options.zoomLevels);\n  instance.views = new ViewController(instance);\n\n  // Setup the UI components\n  instance._waveformBuilder = new WaveformBuilder(instance);\n\n  instance.player.init(instance)\n    .then(function() {\n      instance._waveformBuilder.init(instance.options, function(err, waveformData) {\n        if (err) {\n          callback(err);\n          return;\n        }\n\n        err = checkContainerElements(instance.options);\n\n        if (err) {\n          callback(err);\n          return;\n        }\n\n        instance._waveformBuilder = null;\n        instance._waveformData = waveformData;\n\n        const zoomviewContainer = instance.options.zoomview.container;\n        const overviewContainer = instance.options.overview.container;\n\n        if (zoomviewContainer) {\n          instance.views.createZoomview(zoomviewContainer);\n        }\n\n        if (overviewContainer) {\n          instance.views.createOverview(overviewContainer);\n        }\n\n        if (scrollbarContainer) {\n          instance.views.createScrollbar(scrollbarContainer);\n        }\n\n        if (opts.segments) {\n          instance.segments.add(opts.segments);\n        }\n\n        if (opts.points) {\n          instance.points.add(opts.points);\n        }\n\n        if (opts.emitCueEvents) {\n          instance._cueEmitter = new CueEmitter(instance);\n        }\n\n        callback(null, instance);\n      });\n    })\n    .catch(function(err) {\n      callback(err);\n    });\n};\n\nPeaks.prototype._setOptions = function(opts) {\n  if (!isObject(opts)) {\n    return new TypeError('Peaks.init(): The options parameter should be an object');\n  }\n\n  if (!opts.player) {\n    if (!opts.mediaElement) {\n      return new Error('Peaks.init(): Missing mediaElement option');\n    }\n\n    if (!(opts.mediaElement instanceof HTMLMediaElement)) {\n      return new TypeError('Peaks.init(): The mediaElement option should be an HTMLMediaElement');\n    }\n  }\n\n  if (opts.logger && !isFunction(opts.logger)) {\n    return new TypeError('Peaks.init(): The logger option should be a function');\n  }\n\n  if (opts.segments && !Array.isArray(opts.segments)) {\n    return new TypeError('Peaks.init(): options.segments must be an array of segment objects');\n  }\n\n  if (opts.points && !Array.isArray(opts.points)) {\n    return new TypeError('Peaks.init(): options.points must be an array of point objects');\n  }\n\n  extendOptions(this.options, opts);\n\n  this.options.overview = getOverviewOptions(opts);\n  this.options.zoomview = getZoomviewOptions(opts);\n  this.options.scrollbar = getScrollbarOptions(opts);\n\n  addSegmentOptions(this.options, opts);\n\n  if (!Array.isArray(this.options.zoomLevels)) {\n    return new TypeError('Peaks.init(): The zoomLevels option should be an array');\n  }\n  else if (this.options.zoomLevels.length === 0) {\n    return new Error('Peaks.init(): The zoomLevels array must not be empty');\n  }\n  else {\n    if (!isInAscendingOrder(this.options.zoomLevels)) {\n      return new Error('Peaks.init(): The zoomLevels array must be sorted in ascending order');\n    }\n  }\n\n  this._logger = this.options.logger;\n};\n\n/**\n * Remote waveform data options for [Peaks.setSource]{@link Peaks#setSource}.\n *\n * @typedef {Object} RemoteWaveformDataOptions\n * @global\n * @property {String=} arraybuffer\n * @property {String=} json\n */\n\n/**\n * Local waveform data options for [Peaks.setSource]{@link Peaks#setSource}.\n *\n * @typedef {Object} LocalWaveformDataOptions\n * @global\n * @property {ArrayBuffer=} arraybuffer\n * @property {Object=} json\n */\n\n/**\n * Web Audio options for [Peaks.setSource]{@link Peaks#setSource}.\n *\n * @typedef {Object} WebAudioOptions\n * @global\n * @property {AudioContext=} audioContext\n * @property {AudioBuffer=} audioBuffer\n * @property {Number=} scale\n * @property {Boolean=} multiChannel\n */\n\n/**\n * Options for [Peaks.setSource]{@link Peaks#setSource}.\n *\n * @typedef {Object} PeaksSetSourceOptions\n * @global\n * @property {String=} mediaUrl\n * @property {RemoteWaveformDataOptions=} dataUri\n * @property {LocalWaveformDataOptions=} waveformData\n * @property {WebAudioOptions=} webAudio\n * @property {Boolean=} withCredentials\n * @property {Array<Number>=} zoomLevels\n */\n\n/**\n * Changes the audio or video media source associated with the {@link Peaks}\n * instance.\n *\n * @see SetSourceHandler\n *\n * @param {PeaksSetSourceOptions} options\n * @param {Function} callback\n */\n\nPeaks.prototype.setSource = function(options, callback) {\n  const self = this;\n\n  self.player._setSource(options)\n    .then(function() {\n      if (!options.zoomLevels) {\n        options.zoomLevels = self.options.zoomLevels;\n      }\n\n      self._waveformBuilder = new WaveformBuilder(self);\n\n      self._waveformBuilder.init(options, function(err, waveformData) {\n        if (err) {\n          callback(err);\n          return;\n        }\n\n        self._waveformBuilder = null;\n        self._waveformData = waveformData;\n\n        ['overview', 'zoomview'].forEach(function(viewName) {\n          const view = self.views.getView(viewName);\n\n          if (view) {\n            view.setWaveformData(waveformData);\n          }\n        });\n\n        self.zoom.setZoomLevels(options.zoomLevels);\n\n        callback();\n      });\n    })\n    .catch(function(err) {\n      callback(err);\n    });\n};\n\nPeaks.prototype.getWaveformData = function() {\n  return this._waveformData;\n};\n\n/**\n * Cleans up a Peaks instance after use.\n */\n\nPeaks.prototype.destroy = function() {\n  if (this._waveformBuilder) {\n    this._waveformBuilder.abort();\n  }\n\n  if (this._keyboardHandler) {\n    this._keyboardHandler.destroy();\n  }\n\n  if (this.views) {\n    this.views.destroy();\n  }\n\n  if (this.player) {\n    this.player.destroy();\n  }\n\n  if (this._cueEmitter) {\n    this._cueEmitter.destroy();\n  }\n};\n\nexport default Peaks;\n"],"names":["has","Object","prototype","hasOwnProperty","prefix","Events","EE","fn","context","once","this","addListener","emitter","event","TypeError","listener","evt","_events","push","_eventsCount","clearEvent","EventEmitter","create","__proto__","eventNames","events","name","names","call","slice","getOwnPropertySymbols","concat","listeners","handlers","i","l","length","ee","Array","listenerCount","emit","a1","a2","a3","a4","a5","args","len","arguments","removeListener","undefined","apply","j","on","removeAllListeners","off","prefixed","module","Cue","time","type","id","POINT","SEGMENT_START","SEGMENT_END","sorter","a","b","defineProperty","exports","value","_registerNode","Konva","glob","PI_OVER_180","Math","PI","global","window","WorkerGlobalScope","self","_global","version","isBrowser","toString","isUnminified","test","param","dblClickWindow","getAngle","angle","angleDeg","enableTrace","pointerEventsEnabled","autoDrawEnabled","hitOnDragEnabled","capturePointerEventsEnabled","_mouseListenClick","_touchListenClick","_pointerListenClick","_mouseInDblClickWindow","_touchInDblClickWindow","_pointerInDblClickWindow","_mouseDblClickPointerId","_touchDblClickPointerId","_pointerDblClickPointerId","_fixTextRendering","pixelRatio","devicePixelRatio","dragDistance","showWarnings","dragButtons","isDragging","isTransforming","_a","isDragReady","node","releaseCanvasOnDestroy","document","_injectGlobal","NodeClass","getClassName","Util","Transform","Global_1","require$$0","m","_classCallCheck","dirty","_createClass","key","tr","point","x","y","sx","sy","rad","c","cos","s","sin","m11","m12","m21","m22","matrix","dx","dy","d","m0","m1","m2","m3","m4","m5","delta","result","rotation","scaleX","scaleY","skewX","skewY","r","sqrt","acos","_getRotation","PI_OVER_DEG180","DEG180_OVER_PI","KONVA_ERROR","COLORS","aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","green","greenyellow","grey","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","teal","thistle","transparent","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen","RGB_REGEX","animQueue","req","requestAnimationFrame","f","setTimeout","_isElement","obj","nodeType","_isFunction","constructor","_isPlainObject","_isArray","_isNumber","isNaN","isFinite","_isString","_isBoolean","isObject","val","isValidSelector","selector","firstChar","toUpperCase","_sign","number","requestAnimFrame","callback","queue","forEach","cb","createCanvasElement","canvas","createElement","style","e","createImageElement","_isInDocument","el","parentNode","_urlToImage","url","imageObj","onload","src","_rgbToHex","g","_hexToRgb","hex","replace","bigint","parseInt","getRandomColor","randColor","random","getRGB","color","rgb","substring","substr","exec","colorToRGBA","str","_namedColorToRBA","_hex3ColorToRGBA","_hex4ColorToRGBA","_hex6ColorToRGBA","_hex8ColorToRGBA","_rgbColorToRGBA","_rgbaColorToRGBA","_hslColorToRGBA","toLowerCase","indexOf","parts","match","split","map","Number","n","index","_exec","_exec2","t2","t3","hsl","h","round","t1","haveIntersection","r1","r2","width","height","cloneObject","retObj","cloneArray","arr","degToRad","deg","radToDeg","_degToRad","warn","_radToDeg","radians","_capitalize","charAt","throw","Error","error","console","each","func","_inRange","left","right","_getProjectionToSegment","x1","y1","x2","y2","x3","y3","dist","pd2","u","_getProjectionToLine","pt","line","isClosed","pc","MAX_VALUE","p1","p2","proj","px","py","pdist","_prepareArrayForTween","startArray","endArray","start","end","temp","newStart","pr","_prepareToStringify","desc","visitedByCircularReferenceRemoval","_typeof","getOwnPropertyDescriptor","configurable","_assign","target","source","_getFirstPointerId","touches","changedTouches","identifier","pointerId","releaseCanvas","_len","canvases","_key","drawRoundedRectPath","cornerRadius","topLeft","topRight","bottomLeft","bottomRight","min","moveTo","lineTo","arc","Context_1","HitContext","SceneContext","Context","Util_1","require$$1","CONTEXT_METHODS","traceArr","_enableTrace","shape","fillEnabled","_fill","hasStroke","_stroke","attrs","fillAfterStrokeEnabled","strokeShape","fillShape","relaxed","rounded","trace","method","join","floor","property","shift","getCanvas","getPixelRatio","setTransform","bounds","clearRect","getWidth","getHeight","lineCap","setAttr","absOpacity","getAbsoluteOpacity","lineJoin","attr","_context","radius","startAngle","endAngle","counterClockwise","arcTo","beginPath","cp1x","cp1y","cp2x","cp2y","bezierCurveTo","clip","closePath","createImageData","x0","y0","createLinearGradient","image","repetition","createPattern","r0","createRadialGradient","sWidth","sHeight","dWidth","dHeight","drawImage","radiusX","radiusY","counterclockwise","ellipse","path","fillRule","isPointInPath","_len2","_key2","fill","fillRect","strokeRect","text","maxWidth","fillText","measureText","sw","sh","getImageData","rect","radii","roundRect","imageData","putImageData","cpx","cpy","quadraticCurveTo","restore","rotate","save","scale","segments","setLineDash","getLineDash","path2d","stroke","strokeText","transform","translate","that","origSetter","methodName","ret","origMethod","retArr","util","simplifyArray","_trace","prop","op","globalCompositeOperation","get","set","_Context","_this","_ref$willReadFrequent","willReadFrequently","_callSuper","_canvas","getContext","_inherits","_fillFunc","_getFillPattern","grd","_getLinearGradient","_getRadialGradient","hasColor","fillPriority","getFillPriority","_fillColor","hasPattern","getFillPatternImage","_fillPattern","hasLinearGradient","getFillLinearGradientColorStops","_fillLinearGradient","hasRadialGradient","getFillRadialGradientColorStops","_fillRadialGradient","getStrokeLinearGradientStartPoint","getStrokeLinearGradientEndPoint","colorStops","getStrokeLinearGradientColorStops","addColorStop","dash","strokeScaleEnabled","getStrokeScaleEnabled","_applyLineCap","dashEnabled","dashOffset","strokeWidth","getShadowForStrokeEnabled","_strokeLinearGradient","_strokeFunc","_b","_c","getShadowRGBA","blur","getShadowBlur","offset","getShadowOffset","getAbsoluteScale","ratio","abs","_Context2","_this2","colorKey","_fillFuncHit","hasHitStroke","hitStrokeWidth","_strokeFuncHit","Canvas_1","HitCanvas","SceneCanvas","Canvas","_pixelRatio","require$$2","config","isCache","webkitBackingStorePixelRatio","mozBackingStorePixelRatio","msBackingStorePixelRatio","oBackingStorePixelRatio","backingStorePixelRatio","getDevicePixelRatio","padding","margin","border","background","position","top","previousRatio","setSize","setWidth","setHeight","mimeType","quality","toDataURL","err","message","_Canvas","_Canvas2","hitCanvas","DD","flag","_dragElements","elem","dragStatus","justDragged","Map","_drag","nodesToFireEvents","stage","getStage","setPointersPositions","pos","_changedPointerPositions","find","max","startPointerPos","startDrag","_setDragPosition","fire","_endDragBefore","drawNodes","drawNode","getLayer","draw","_endDragAfter","delete","addEventListener","Validators","RGBComponent","alphaComponent","getNumberValidator","_formatValue","getNumberOrArrayOfNumbersValidator","noOfElements","isNumber","isValidArray","getNumberOrAutoValidator","getStringValidator","getStringOrGradientValidator","isString","isGradient","getFunctionValidator","getNumberArrayValidator","TypedArray","Int8Array","getPrototypeOf","item","getBooleanValidator","getComponentValidator","components","Factory","Validators_1","GET","SET","addGetterSetter","def","validator","after","addGetter","addSetter","addOverloadedGetterSetter","overWriteSetter","_setAttr","addComponentsGetterSetter","capitalize","getter","setter","component","getAttr","basicValidator","oldVal","_fireChangeEvent","capitalizedAttr","addDeprecatedGetterSetter","backCompat","methods","oldMethodName","newMethodName","oldGetter","oldSetter","deprecated","afterSetFilter","_filterUpToDate","Node_1","Node","DragAndDrop_1","Factory_1","require$$3","require$$4","require$$5","ABSOLUTE_OPACITY","ALL_LISTENERS","ABSOLUTE_TRANSFORM","ABSOLUTE_SCALE","CANVAS","LISTENING","SHAPE","SPACE","STAGE","TRANSFORM","VISIBLE","TRANSFORM_CHANGE_STR","idCounter","_id","eventListeners","_allEventListeners","parent","_cache","_attachedDepsListeners","_lastPos","_batchingTransformChange","_needClearTransformCache","_isUnderCache","_dragEventId","_shouldFireChangeEvents","setAttrs","clear","privateGetter","cache","deps","depsString","dep","_clearCache","_getCache","_this$_cache$get","scene","filter","hit","buffer","_clearSelfAndDescendantCache","_requestDraw","conf","getClientRect","skipTransform","relativeTo","getParent","ceil","drawBorder","hitCanvasPixelRatio","cachedSceneCanvas","cachedFilterCanvas","cachedHitCanvas","sceneContext","hitContext","bufferCanvas","bufferContext","imageSmoothingEnabled","drawScene","drawHit","points","minX","Infinity","minY","maxX","maxY","trans","getAbsoluteTransform","transformed","_applyOpacity","_applyGlobalCompositeOperation","canvasCache","_getCanvasCache","cacheCanvas","_getCachedSceneCanvas","filters","cachedCanvas","sceneCanvas","filterCanvas","filterContext","evtStr","handler","_delegate","baseEvent","t","_off","stopNode","targets","findAncestors","currentTarget","stopDrag","_remove","_clearCaches","children","splice","_setChildrenIndices","remove","clearCache","ancestors","_batchTransformChanges","_isListening","listening","_isVisible","visible","skipDragCheck","layer","layerUnderDrag","dragSkip","isListening","isVisible","nodes","child","depth","getDepth","addChildren","getChildren","_this3","getPointerPosition","copy","invert","haveCachedParent","isCached","absoluteMatrix","getMatrix","absoluteTransform","getTranslation","_this$_clearTransform","_clearTransform","origTrans","_objectWithoutProperties","_excluded","it","_getAbsoluteTransform","_setTransform","setPosition","offsetX","offsetY","change","changeX","changeY","family","unshift","theta","zIndex","_getAbsoluteOpacity","opacity","newContainer","add","defaultValue","getAttrs","className","JSON","stringify","toObject","includeSelf","res","_isMatch","ancestor","sel","selectorArr","hasName","_getStage","eventType","bubble","_fireAndBubble","_fire","at","_eachAncestorReverse","transformsEnabled","multiply","getTransform","copyInto","reset","decompose","_getTransform","skew","allListeners","box","_toKonvaCanvas","_this4","Promise","resolve","reject","img","_this5","toCanvas","toBlob","blob","size","getDragDistance","evtName","evtListeners","newVal","oldName","newName","fullName","batchDraw","compareShape","nonBubbling","isAncestorOf","stopBubble","cancelBubble","hierarchyEvents","_toConsumableArray","topListeners","_getProtoListeners","selfListeners","ap","getAbsolutePosition","_getPointerById","bubbleEvent","_createDragElement","newNodePos","dbf","dragBoundFunc","bounded","setAbsolutePosition","draggable","_dragChange","_dragCleanup","_this6","hasDraggingChild","_listenDrag","dragElement","isReady","screenRect","data","container","parse","_createNode","no","Class","_attrsAffectingSize","rotateDeg","setRotationDeg","getRotationDeg","Container_1","Container","_Node_1$Node","filterFunc","destroy","_validateAdd","hasChildren","destroyChildren","_superPropGet","_generalFind","findOne","_descendants","valid","_step","_iterator","_createForOfIteratorHelper","done","clone","intersects","can","caching","_drawCachedSceneCanvas","_drawChildren","shouldDrawHit","_drawCachedHitCanvas","drawMethod","clipWidth","clipHeight","clipFunc","hasClip","selfCache","clipArgs","clipX","clipY","hasComposition","selfRect","skipShadow","skipStroke","shapes","hasVisible","_transformedRect","PointerEvents","getCapturedShape","Captures","createEvent","hasPointerCapture","setPointerCapture","releaseCapture","SUPPORT_POINTER_EVENTS","PointerEvent","content","Shape","dummyContext","Global_2","HAS_SHADOW","SHADOW_RGBA","patternImage","linearGradient","radialGradient","getDummyContext","sceneFunc","hitFunc","_hasShadow","shadowEnabled","shadowOpacity","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","__getFillPattern","fillPatternImage","pattern","fillPatternRepeat","fillPatternX","fillPatternY","fillPatternRotation","fillPatternScaleX","fillPatternScaleY","fillPatternOffsetX","fillPatternOffsetY","DOMMatrix","__getLinearGradient","fillLinearGradientColorStops","ctx","fillLinearGradientStartPoint","fillLinearGradientEndPoint","__getRadialGradient","fillRadialGradientColorStops","fillRadialGradientStartPoint","fillRadialGradientEndPoint","fillRadialGradientStartRadius","fillRadialGradientEndRadius","_getShadowRGBA","hasShadow","rgba","_calculate","strokeEnabled","strokeLinearGradientColorStops","bufferHitCanvas","forceFill","perfectDrawEnabled","hasFill","isTransparent","strokeForShadow","shadowForStrokeEnabled","_centroid","hasCachedParent","getSelfRect","fillAndStrokeWidth","fillAndStrokeHeight","applyShadow","preWidth","preHeight","blurRadius","drawFunc","getSceneFunc","cachingSelf","_useBufferCanvas","bc","_applyLineJoin","o","_applyShadow","alphaThreshold","hitWidth","hitHeight","hitImageData","hitData","rgbColorKey","dashArray","getDashArray","setDashArray","getDrawFunc","setDrawFunc","drawHitFunc","getDrawHitFunc","setDrawHitFunc","Layer_1","Layer","Shape_1","require$$6","require$$7","INTERSECTION_OFFSETS","INTERSECTION_OFFSETS_LEN","_Container_1$Containe","_waitingForDraw","_checkVisibility","_setSmoothEnabled","createPNGStream","getHitCanvas","removeChild","getNativeCanvasElement","insertBefore","appendChild","moveToTop","moveUp","moveDown","moveToBottom","_ref","getType","display","spiralSearchDistance","continueSearch","intersectionOffset","_getIntersection","antialiased","p","p3","clearBeforeDraw","hitGraphEnabled","Animation_1","Animation","now","performance","Date","getTime","layers","animIdCounter","frame","timeDiff","lastTime","frameRate","setLayers","lays","isArray","animations","stop","_addAnimation","_removeAnimation","anim","_handleAnimation","layerHash","_updateFrameObject","layersLen","Anim","_runFrames","_animationLoop","animRunning","Stage_1","Stage","stages","MOUSELEAVE","MOUSEOVER","MOUSEENTER","MOUSEMOVE","MOUSEDOWN","MOUSEUP","POINTERMOVE","POINTERDOWN","POINTERUP","POINTERCANCEL","POINTEROUT","POINTERLEAVE","POINTEROVER","POINTERENTER","CONTEXTMENU","TOUCHSTART","TOUCHEND","TOUCHMOVE","TOUCHCANCEL","WHEEL","EVENTS","EVENTS_MAP","mouse","_defineProperty","touch","pointer","getEventType","getEventsMap","checkNoClip","_pointerPositions","_buildDOM","_bindContentEvents","_resizeDOM","isLayer","isFastLayer","getElementsByClassName","getElementById","parentElement","layerCanvas","getIntersection","rest","_ref2","_slicedToArray","passive","pointerenter","pointerover","evenType","targetShape","_getTargetShape","eventsEnabled","pointerout","pointerleave","pointerPos","triggeredOnShape","pointerdown","isTouch","preventDefault","cancelable","processedShapesIds","differentTarget","_objectSpread","pointermove","clickStartShape","clickEndShape","fireDblClick","clearTimeout","pointerup","pointerclick","pointerdblclick","contentPosition","_getContentPosition","clientX","clientY","getBoundingClientRect","clientWidth","clientHeight","innerHTML","userSelect","setAttribute","FastLayer_1","FastLayer","_Layer_1$Layer","Group_1","Group","require$$8","require$$9","require$$10","Tween_1","Easings","Tween","blacklist","duration","easing","onFinish","yoyo","colorAttrs","TweenEngine","propFunc","begin","finish","_pos","_change","prevPos","_time","_position","_startTime","_finish","pause","reverse","play","update","state","getTimer","onEnterFrame","getPosition","setTime","nodeId","Linear","getLayers","tween","_tweenFunc","_addListeners","tweens","_addAttr","onReset","onUpdate","diff","trueEnd","trueStart","endRGBA","tweenId","closed","startRGBA","onPlay","onReverse","onPause","seek","thisId","keys","to","params","BackEaseIn","BackEaseOut","BackEaseInOut","ElasticEaseIn","asin","pow","ElasticEaseOut","ElasticEaseInOut","BounceEaseOut","BounceEaseIn","BounceEaseInOut","EaseIn","EaseOut","EaseInOut","StrongEaseIn","StrongEaseOut","StrongEaseInOut","require$$12","require$$13","default","_CoreInternals_1","enumerable","_CoreInternals_2","zeroPad","precision","formatTime","fractionSeconds","seconds","minutes","hours","clamp","objectHasProperty","object","field","extend","from","isValidTime","isNullOrUndefined","isBoolean","isHTMLElement","HTMLElement","isLinearGradientColor","linearGradientStart","linearGradientEnd","linearGradientColorStops","getMarkerObject","isHeadless","navigator","userAgent","mozRequestAnimationFrame","webkitRequestAnimationFrame","msRequestAnimationFrame","cancelAnimationFrame","mozCancelAnimationFrame","webkitCancelAnimationFrame","msCancelAnimationFrame","eventTypes","forward","eventAttributes","getPointOrSegment","peaks","cue","getPoint","getSegment","CueEmitter","_cues","_peaks","_previousTime","_updateCues","bind","_onPlaying","_onSeeked","_onTimeUpdate","_onAnimationFrame","_rAFHandle","_activeSegments","_attachEventHandlers","getSegmentIdComparator","segment","getPoints","getSegments","startTime","endTime","sort","player","getCurrentTime","_updateActiveSegments","_onUpdate","previousTime","step","isForward","marker","webdriver","visibilityState","isPlaying","isSeeking","activeSegments","getSegmentsAtTime","_detachEventHandlers","pointOptions","invalidOptions","validatePointOptions","options","updating","RangeError","labelText","editable","Point","pid","_pid","_setUserData","WaveformPoints","_points","_pointsById","_pointsByPid","_pointIdCounter","_pointPid","defineProperties","_labelText","_color","_editable","updatePointId","_setTime","_getNextPointId","_getNextPid","_addPoint","_createPoint","peaksOptions","pointMarkerColor","setDefaultPointOptions","arrayArgs","newPointId","_findPoint","predicate","indexes","_removeIndexes","removed","itemRemoved","_removePoints","removeById","pointId","removeByTime","removeAll","segmentOptions","validateSegmentOptions","markers","overlay","borderColor","Segment","_endTime","_borderColor","_markers","_overlay","WaveformSegments","_segments","_segmentsById","_segmentsByPid","_segmentIdCounter","_segmentPid","_isInserting","updateSegmentId","_setStartTime","_setEndTime","_getNextSegmentId","_addSegment","_createSegment","globalSegmentOptions","overlayColor","waveformColor","overlayBorderColor","setDefaultSegmentOptions","_getSortedSegments","findPreviousSegment","sortedSegments","findIndex","findNextSegment","insert","newSegmentId","_findSegment","_removeSegments","segmentId","setInserting","isInserting","KeyboardHandler","eventEmitter","_handleKeyEvent","MediaElementPlayer","mediaElement","_mediaElement","SetSourceHandler","_eventEmitter","_playerCanPlayHandler","_playerErrorHandler","validateAdapter","adapter","allProperties","getOwnPropertyNames","getAllPropertiesFrom","includes","Player","_playingSegment","_segment","_loop","_playSegmentTimerCallback","_adapter","nodeName","keyCode","shiftKey","removeEventListener","_addMediaListener","_listeners","init","_duration","getDuration","_interval","querySelector","code","MediaError","MEDIA_ERR_SRC_NOT_SUPPORTED","eventHandler","readyState","HTMLMediaElement","HAVE_NOTHING","load","paused","seeking","currentTime","setSource","_options","_callback","_resolve","_reject","mediaUrl","_reset","_logger","playSegment","loop","_setSource","Line_1","Line","getControlPoints","d01","d12","fa","fb","expandPoints","tension","allPoints","cp","_Shape_1$Shape","bezier","tp","getTensionPoints","fillStrokeShape","_getTensionPoints","_getTensionPointsClosed","firstControlPoints","lastControlPoints","middle","Rect_1","Rect","Text_1","Text","stringToArray","string","reduce","acc","char","array","nextChar","AUTO","INHERIT","JUSTIFY","LEFT","MIDDLE","NORMAL","NONE","ATTR_CHANGE_LIST","attrChangeListLen","checkDefaultFill","_partialTextX","_partialTextY","_setTextData","textArr","textArrLen","fontSize","lineHeightPx","lineHeight","verticalAlign","direction","alignY","align","totalWidth","letterSpacing","textDecoration","shouldUnderline","shouldLineThrough","translateY","baseline","metrics","measureSize","fontBoundingBoxAscent","fontBoundingBoxDescent","_getContextFont","lineTranslateX","lastLine","lastInParagraph","lineWidth","gradient","strokeStyle","yOffset","_partialText","spacesNumber","li","letter","getTextWidth","textWidth","textHeight","_d","_e","_f","_g","_h","_j","_k","_l","font","scaleFactor","actualBoundingBoxAscent","actualBoundingBoxDescent","actualBoundingBoxLeft","actualBoundingBoxRight","alphabeticBaseline","emHeightAscent","emHeightDescent","hangingBaseline","ideographicBaseline","fontStyle","fontVariant","fontFamily","hasSpace","trim","hasQuotes","_getTextWidth","lines","fixedWidth","fixedHeight","maxHeightPx","currentHeightPx","wrap","wrapAtWord","shouldAddEllipsis","ellipsis","additionalWidth","low","high","matchWidth","mid","substrWidth","lineArray","matchArray","wrapIndex","lastSpaceIndex","lastIndexOf","lastDashIndex","trimRight","_addTextLine","_shouldHandleEllipsis","_tryToAddEllipsisToLastLine","trimLeft","hasLine","DefaultPointMarker","_draggable","DefaultSegmentMarker","createSegmentMarker","view","createSegmentLabel","textAlign","createPointMarker","HighlightLayer","_view","_offset","highlightOffset","highlightColor","_layer","_highlightRect","_strokeColor","highlightStrokeColor","_opacity","highlightOpacity","_cornerRadius","highlightCornerRadius","PointMarker","_point","_marker","_onDragStart","onDragStart","_onDragMove","onDragMove","_onDragEnd","onDragEnd","_dragBoundFunc","_onMouseEnter","onMouseEnter","_onMouseLeave","onMouseLeave","_group","_bindDefaultEventHandlers","PointsLayer","enableEditing","_enableEditing","_pointMarkers","_onPointsDrag","_onPointMarkerDragStart","_onPointMarkerDragMove","_onPointMarkerDragEnd","_pointMarkerDragBoundFunc","_onPointMarkerMouseEnter","_onPointMarkerMouseLeave","_onPointsUpdate","_onPointsAdd","_onPointsRemove","_onPointsRemoveAll","group","_label","_handle","_line","hide","fitToView","bindEventHandlers","setX","show","setText","xPosition","startMarker","addToStage","showHighlight","_createHighlightRect","_update","startOffset","timeToPixels","endOffset","removeHighlight","updateHighlight","addToLayer","getX","setListening","enable","getPointMarker","frameStartTime","getStartTime","frameEndTime","getEndTime","pointMarker","_removePoint","_updatePoint","pointMarkerX","getFrameOffset","removeChildren","_createPointMarker","viewOptions","getViewOptions","getName","_addPointMarker","_dragPointMarker","pixelOffsetToTime","updatePoints","_removeInvisiblePoints","pointPid","setVisible","PlayheadLayer","_player","_playheadPixel","_playheadLineAnimation","_playheadVisible","_playheadColor","playheadColor","_playheadTextColor","playheadTextColor","_playheadBackgroundColor","playheadBackgroundColor","_playheadPadding","playheadPadding","_playheadWidth","playheadWidth","_playheadFontFamily","playheadFontFamily","_playheadFontSize","playheadFontSize","_playheadFontStyle","playheadFontStyle","_playheadLayer","_createPlayhead","showPlayheadTime","_createPlayheadText","zoomLevelChanged","OverlaySegmentMarker","SegmentMarker","_segmentShape","segmentShape","_startMarker","_onClick","onClick","WaveformShape","shapeOptions","startY","_height","endY","fillLinearGradientStartPointY","fillLinearGradientEndPointY","_shape","_sceneFunc","SegmentShape","_endMarker","isSegmentDraggingEnabled","_dragging","_overlayOffset","overlayOffset","_waveformShape","_onMouseDown","_onMouseUp","_onSegmentDragStart","_onSegmentDragMove","_onSegmentDragEnd","_onSegmentMarkerClick","_onSegmentMarkerDragStart","_onSegmentMarkerDragMove","_onSegmentMarkerDragEnd","_segmentMarkerDragBoundFunc","overlayBorderWidth","overlayOpacity","overlayCornerRadius","segmentStartOffset","timeToPixelOffset","segmentEndOffset","overlayRectHeight","_overlayRect","_overlayText","overlayFontFamily","overlayFontSize","overlayFontStyle","overlayLabelColor","overlayLabelAlign","overlayLabelVerticalAlign","overlayLabelPadding","_createMarkers","createOverlayMarker","SegmentsLayer","_segmentShapes","_onSegmentsUpdate","_onSegmentsAdd","_onSegmentsRemove","_onSegmentsRemoveAll","_onSegmentsDragged","WaveformAxis","_axisGridlineColor","axisGridlineColor","_axisLabelColor","axisLabelColor","_showAxisLabels","showAxisLabels","_axisTopMarkerHeight","axisTopMarkerHeight","_axisBottomMarkerHeight","axisBottomMarkerHeight","formatAxisTime","_formatAxisTime","_axisLabelFont","_buildFontString","_axisShape","_drawAxis","WaveformView","waveformData","_container","_viewOptions","_originalWaveformData","_data","_frameOffset","_width","_amplitudeScale","_waveformColor","_playedWaveformColor","playedWaveformColor","_timeLabelPrecision","timeLabelPrecision","formatPlayheadTime","_formatPlayheadTime","_enableSeek","initWaveformData","_stage","_createWaveform","enableSegments","_segmentsLayer","enablePoints","_pointsLayer","initHighlightLayer","_createAxisLabels","_onDblClick","_onContextMenu","MouseDragHandler","_handlers","_mouseDown","_mouseUp","_mouseMove","_lastMouseClientX","SeekMouseDragHandler","_firstMove","_onMouseMove","_mouseDragHandler","onMouseDown","onMouseMove","onMouseUp","WaveformOverview","overview","_onPause","_onZoomviewUpdate","updatePlayheadTime","zoomview","views","getView","_highlightLayer","InsertSegmentMouseDragHandler","ScrollMouseDragHandler","_seeking","_segmentIsDraggable","_initialFrameOffset","_mouseDownX","WaveformZoomView","_onKeyboardLeft","_onKeyboardRight","_onKeyboardShiftLeft","_onKeyboardShiftRight","_autoScroll","autoScroll","_autoScrollOffset","autoScrollOffset","_enableSegmentDragging","_segmentDragMode","_minSegmentDragWidth","_insertSegmentShape","_playheadClickTolerance","playheadClickTolerance","_zoomLevelAuto","_zoomLevelSeconds","_syncPlayhead","_onWheel","_onWheelCaptureVerticalScroll","setWheelMode","wheelMode","Scrollbar","scrollbar","_zoomview","_onScrollboxDragStart","_onScrollboxDragMove","_onScrollboxDragEnd","_onScrollbarClick","_scrollboxX","_minScrollboxWidth","minWidth","_offsetY","_scrollbox","_scrollboxRect","_setScrollboxWidth","_updateScrollbarWidthAndPosition","ViewController","_overview","_scrollbar","ZoomController","zoomLevels","_zoomLevels","_zoomLevelIndex","WaveformDataChannel","channelIndex","_waveformData","_channelIndex","pixelsPerSecond","_useAnimation","_start","_playheadLine","_playheadText","_playheadGroup","fillStyle","pixelIndex","frameOffset","playheadX","playheadTextWidth","playheadPosChanged","lastPlayheadPosition","playheadPosition","getPlayheadPixel","updatePlayheadText","body","cursor","viewHeight","isStartMarker","setSegment","setWaveformColor","_drawWaveform","getWaveformData","startPixels","endPixels","limit","channels","waveformTop","waveformHeight","_drawChannel","channel","amplitude","lineX","lineY","amplitudeScale","getAmplitudeScale","min_sample","max_sample","endMarker","isEditingEnabled","startMarkerColor","endMarkerColor","getStartMarker","getEndMarker","bordercolor","segmentClicked","eventName","_moveToTop","moveSegmentMarkersToTop","enableSegmentDragging","_setPreviousAndNextSegments","getSegmentDragMode","_nextSegment","_previousSegment","_dragStartX","_dragStartTime","_dragEndTime","dragMode","timeOffset","pixelsToTime","segmentDuration","minSegmentWidth","getMinSegmentDragWidth","minSegmentDuration","previousSegmentUpdated","nextSegmentUpdated","previousSegmentEndX","previousSegmentEndTime","minPreviousSegmentEndTime","nextSegmentStartX","nextSegmentStartTime","maxNextSegmentStartTime","moveMarkersToTop","segmentMarker","_startMarkerX","_endMarkerX","_segmentStartMarkerDragMove","_segmentEndMarkerDragMove","startMarkerX","endMarkerX","upperLimit","previousSegmentVisible","fixedPreviousSegment","compressPreviousSegment","previousSegmentDuration","lowerLimit","nextSegmentVisible","fixedNextSegment","compressNextSegment","nextSegmentDuration","segmentPid","getSegmentShape","_removeSegment","_updateSegment","_addSegmentShape","_createSegmentShape","updateSegments","_removeInvisibleSegments","topMarkerHeight","bottomMarkerHeight","setAxisLabelColor","setAxisGridlineColor","_getAxisLabelScale","secs","baseSecs","steps","currentFrameStartTime","axisLabelIntervalSecs","firstAxisLabelSecs","multiple","multiplier","roundUpToNearest","axisLabelOffsetSecs","axisLabelOffsetPixels","label","labelX","labelY","setWaveformData","sample_rate","pixels","_getDuration","_waveformLayer","_createWaveformShapes","_playedWaveformShape","_playedSegment","_unplayedSegment","setPlayedWaveformColor","_destroyPlayedWaveformShape","_axisLayer","_axis","setTimeLabelPrecision","setAmplitudeScale","drawWaveformLayer","enableSeek","isSeekEnabled","_clickHandler","emitViewEvent","preventViewEvent","clickEvent","viewName","enableMarkerEditing","dragSeek","dragging","fitToContainer","updateWaveform","containerWidthChange","heightChanged","containerHeightChange","button","mouseDownPosX","_getMousePosX","capture","mousePosX","containerPos","getContainer","_seek","_resampleAndSetWaveformData","resample","removeHighlightRect","playheadTime","_insertSegment","playheadOffset","getPlayheadOffset","getPlayheadClickTolerance","isAutoZoom","newFrameOffset","_enableWaveformCache","waveformCache","_initWaveformCache","initialZoomLevel","zoom","getZoomLevel","_resampleData","_waveformScales","mode","_wheelMode","captureVerticalScroll","_captureVerticalScroll","wheelEvent","deltaY","deltaX","deltaMode","WheelEvent","DOM_DELTA_PAGE","_pixelLength","setWaveformDragMode","setSegmentDragMode","_keyboardScroll","large","increment","nudgeIncrement","scrollWaveform","endThreshold","_getScale","setZoom","isAutoScale","apexTime","playheadOffsetPixels","prevScale","_scale","currentZoom","previousZoom","sourceWaveform","setStartTime","getPixelLength","scrollAmount","forceUpdate","playheadPixel","enableAutoScroll","setMinSegmentDragWidth","resampleOptions","getSegmentsLayer","setZoomview","_scrollboxWidth","_getScrollbarRange","range","_updateWaveform","zoomviewRange","scrollBoxPos","createOverview","createZoomview","createScrollbar","destroyOverview","destroyZoomview","getScrollbar","setZoomLevels","zoomIn","zoomOut","zoomLevelIndex","getZoom","_at","set_min_sample","sample","_set_at","set_max_sample","min_array","values","max_array","generateWaveformData","amplitude_scale","split_channels","Float32Array","output_channels","data_length","audio_sample_count","calculateWaveformDataLength","bytes_per_sample","bits","ArrayBuffer","data_view","DataView","scale_counter","min_value","max_value","range_min","range_max","setInt32","setUint32","_channel","_channel2","_channel3","setInt8","setInt16","_channel4","Symbol","iterator","createURL","base64","sourcemapArg","enableUnicodeArg","atob","decodeBase64","Blob","URL","createObjectURL","createBase64WorkerFactory","Worker","WorkerFactory","WaveformData","isJsonWaveformData","expected_length","total_size","array_buffer","data_object","samples_per_pixel","_i","convertJsonToBinary","isCompatible","getInt32","isBinaryWaveformData","_version","_channels","defaultOptions","createFromAudioBuffer","audio_buffer","numberOfChannels","getChannelData","disable_worker","sampleRate","worker","onmessage","postMessage","WaveformResampler","_inputData","_output_samples_per_pixel","_input_buffer_size","input_buffer_length_samples","output_buffer_length_samples","_output_data","output_dataview","_outputWaveformData","_input_index","_output_index","_min","_max","_min_value","_max_value","_where","_prev_where","_stop","_last_input_index","createFromAudio","opts","getOptions","audio_context","audioContext","audioData","errorCallback","DOMException","promise","decodeAudioData","catch","createFromArrayBuffer","sample_at_pixel","next","count","_i2","_i3","getOutputData","_getResampleOptions","abortSignal","resampler","otherWaveforms","otherWaveform","combinedBuffer","_concatBuffers","headerSize","totalSize","totalDataLength","bufferCollection","w","dataSize","byteLength","totalBuffer","sourceHeader","totalBufferView","_i4","setUint8","getUint8","dataOfTotalBuffer","Uint8Array","_i5","_buffer","startIndex","endIndex","at_time","output_data","getUint32","Boolean","pixels_per_second","seconds_per_pixel","getInt8","getInt16","toJSON","waveform","toArrayBuffer","isXhr2","XMLHttpRequest","WaveformBuilder","hasValidContentRangeHeader","xhr","contentRange","getResponseHeader","matches","firstPos","lastPos","Peaks","dataUri","withCredentials","webAudio","logger","_getRemoteWaveformData","_buildWaveformFromLocalData","audioBuffer","_buildWaveformDataFromAudioBuffer","_buildWaveformDataUsingWebAudio","requestType","some","connector","_xhr","_createXHR","status","response","send","json","arraybuffer","createdWaveformData","AudioContext","webkitAudioContext","webAudioOptions","mediaSourceUrl","currentSrc","_requestAudioAndBuildWaveformData","webAudioBuilderOptions","multiChannel","abort","onLoad","onError","onAbort","open","responseType","onerror","defaultViewOptions","defaultZoomviewOptions","defaultOverviewOptions","defaultSegmentOptions","defaultScrollbarOptions","extendOptions","checkContainerElements","zoomviewContainer","overviewContainer","instance","_setOptions","scrollbarContainer","keyboard","_keyboardHandler","_waveformBuilder","then","emitCueEvents","_cueEmitter","overviewOptions","optName","getOverviewOptions","zoomviewOptions","getZoomviewOptions","scrollbarOptions","getScrollbarOptions","addSegmentOptions","isInAscendingOrder"],"mappings":"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","x_google_ignoreList":[0,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,30,31,32,56]}